uint64_t sub_100149C7C(uint64_t a1)
{
  uint64_t result;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  const char *v7;
  uint64_t v8;
  uint64_t v9;
  v8 = 0LL;
  v9 = 0LL;
  result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 10;
          return sub_10018BD78(291, v8, BYTE4(v9), a1, (uint64_t)sub_10013E320, v3, v4, v5);
        }

        v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7484, v7);
      }
    }

    v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100149D48(unint64_t a1, int a2, char a3, int a4, const void *a5, uint64_t a6)
{
  uint64_t v36 = 0LL;
  uint64_t v37 = 0LL;
  uint64_t result = sub_10018BCDC(&v36);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v37))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v13 = WORD2(v37);
      if (WORD1(v37) > WORD2(v37))
      {
        if (BYTE6(v37) == 2)
        {
          ++WORD2(v37);
          *(_BYTE *)(v36 + v13) = 11;
          uint64_t v14 = sub_1001BCDB0(a1);
          int v33 = v14;
          char v35 = BYTE6(v14);
          __int16 v34 = WORD2(v14);
          if (a2) {
            char v15 = 2;
          }
          else {
            char v15 = 0;
          }
          if (a2) {
            char v16 = 3;
          }
          else {
            char v16 = 1;
          }
          if ((a1 & 0xFF000000000000LL) != 0) {
            char v15 = v16;
          }
          if (HIBYTE(v37))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v17 = WORD2(v37);
            if (WORD1(v37) > WORD2(v37))
            {
              if (BYTE6(v37) == 2)
              {
                ++WORD2(v37);
                *(_BYTE *)(v36 + v17) = v15;
                if (HIBYTE(v37))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v37) - WORD2(v37) > 5)
                {
                  if (BYTE6(v37) == 2)
                  {
                    sub_1001F0050(v36 + WORD2(v37), (uint64_t)&v33 + 1, 6uLL);
                    __int16 v21 = WORD2(v37);
                    unsigned __int16 v22 = WORD2(v37) + 6;
                    WORD2(v37) += 6;
                    if (HIBYTE(v37))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v37) > v22)
                    {
                      if (BYTE6(v37) == 2)
                      {
                        if (a4) {
                          char v23 = a3;
                        }
                        else {
                          char v23 = 1;
                        }
                        WORD2(v37) = v21 + 7;
                        *(_BYTE *)(v36 + v22) = v23;
                        if (HIBYTE(v37))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v37) - WORD2(v37) > 1)
                        {
                          if (BYTE6(v37) == 2)
                          {
                            *(_WORD *)(v36 + WORD2(v37)) = a4;
                            unsigned __int16 v24 = WORD2(v37) + 2;
                            WORD2(v37) += 2;
                            if (a4)
                            {
                              uint64_t v25 = v36;
                              if (HIBYTE(v37))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                                int v26 = 0;
                              }

                              else
                              {
                                int v26 = WORD1(v37) - v24;
                              }

                              if (v26 < a4)
                              {
                                v32 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
                              }

                              else
                              {
                                if (BYTE6(v37) == 2)
                                {
                                  memmove((void *)(v25 + v24), a5, a4);
                                  LOBYTE(v24) = BYTE4(v37) + a4;
                                  WORD2(v37) += a4;
                                  return sub_10018BD78( 291,  v36,  v24,  a6,  (uint64_t)sub_10013A594,  v18,  v19,  v20);
                                }

                                v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                              }

                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7514,  v32);
                            }

                            return sub_10018BD78( 291,  v36,  v24,  a6,  (uint64_t)sub_10013A594,  v18,  v19,  v20);
                          }

                          v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7512,  v31);
                        }

                        v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_56;
                      }

                      v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7511,  v30);
                    }

                    v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_52;
                  }

                  v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7510,  v29);
                }

                v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_48;
              }

              v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7509,  v28);
            }
          }

          v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_44;
        }

        v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7499, v27);
      }
    }

    v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_40;
  }

  return result;
}

uint64_t sub_10014A124(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 12;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10018BD78(291, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
            }

            v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7530,  v10);
          }

          v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }

        v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7529, v9);
      }
    }

    v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10014A288(char a1, char a2, char a3, char a4, char a5, uint64_t a6)
{
  uint64_t v26 = 0LL;
  uint64_t v27 = 0LL;
  uint64_t result = sub_10018BCDC(&v26);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v27))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v16 = WORD2(v27);
      if (WORD1(v27) > WORD2(v27))
      {
        if (BYTE6(v27) == 2)
        {
          ++WORD2(v27);
          *(_BYTE *)(v26 + v16) = a1;
          if (HIBYTE(v27))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v17 = WORD2(v27);
            if (WORD1(v27) > WORD2(v27))
            {
              if (BYTE6(v27) == 2)
              {
                ++WORD2(v27);
                *(_BYTE *)(v26 + v17) = a2;
                if (HIBYTE(v27))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v18 = WORD2(v27);
                  if (WORD1(v27) > WORD2(v27))
                  {
                    if (BYTE6(v27) == 2)
                    {
                      ++WORD2(v27);
                      *(_BYTE *)(v26 + v18) = a3;
                      if (HIBYTE(v27))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v19 = WORD2(v27);
                        if (WORD1(v27) > WORD2(v27))
                        {
                          if (BYTE6(v27) == 2)
                          {
                            ++WORD2(v27);
                            *(_BYTE *)(v26 + v19) = a4;
                            if (HIBYTE(v27))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v20 = WORD2(v27);
                              if (WORD1(v27) > WORD2(v27))
                              {
                                if (BYTE6(v27) == 2)
                                {
                                  ++WORD2(v27);
                                  *(_BYTE *)(v26 + v20) = a5;
                                  return sub_10018BD78(652, v26, BYTE4(v27), a6, (uint64_t)sub_10013A594, v13, v14, v15);
                                }

                                uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7548,  v25);
                              }
                            }

                            uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_38;
                          }

                          unsigned __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7547,  v24);
                        }
                      }

                      unsigned __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_34;
                    }

                    char v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7546,  v23);
                  }
                }

                char v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_30;
              }

              unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  7545,  v22);
            }
          }

          unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }

        __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7544, v21);
      }
    }

    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_10014A554(unsigned int a1, uint64_t a2, uint64_t a3)
{
  uint64_t v24 = 0LL;
  uint64_t v25 = 0LL;
  uint64_t result = sub_10018BCDC(&v24);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v25))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_44;
  }

  uint64_t v10 = WORD2(v25);
  if (WORD1(v25) <= WORD2(v25))
  {
LABEL_44:
    unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_46;
  }

  if (BYTE6(v25) != 2)
  {
    unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7562, v22);
  }

  ++WORD2(v25);
  *(_BYTE *)(v24 + v10) = 17;
  if (HIBYTE(v25))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_48;
  }

  uint64_t v11 = WORD2(v25);
  if (WORD1(v25) <= WORD2(v25))
  {
LABEL_48:
    char v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_50;
  }

  if (BYTE6(v25) != 2)
  {
    char v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7563, v23);
  }

  ++WORD2(v25);
  *(_BYTE *)(v24 + v11) = a1;
  if (a1)
  {
    uint64_t v12 = a1;
    uint64_t v13 = (_BYTE *)(a2 + 4);
    while (!HIBYTE(v25))
    {
      if (WORD1(v25) - WORD2(v25) <= 1) {
        goto LABEL_28;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_30;
      }

      *(_WORD *)(v24 + WORD2(v25)) = *((_WORD *)v13 - 2);
      unsigned __int16 v14 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_32:
        uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_34:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7567, v19);
      }

      if (WORD1(v25) - v14 <= 1) {
        goto LABEL_32;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_34;
      }

      *(_BYTE *)(v24 + v14) = *(v13 - 2);
      *(_BYTE *)(v24 + WORD2(v25) + 1) = *(v13 - 1);
      unsigned __int16 v15 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_36:
        uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_38:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7568, v20);
      }

      if (WORD1(v25) - v15 <= 1) {
        goto LABEL_36;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_38;
      }

      *(_BYTE *)(v24 + v15) = *v13;
      *(_BYTE *)(v24 + WORD2(v25) + 1) = v13[1];
      unsigned __int16 v16 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_40:
        __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_42:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7569, v21);
      }

      if (WORD1(v25) - v16 <= 1) {
        goto LABEL_40;
      }
      if (BYTE6(v25) != 2)
      {
        __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_42;
      }

      *(_BYTE *)(v24 + v16) = v13[2];
      *(_BYTE *)(v24 + WORD2(v25) + 1) = v13[3];
      unsigned __int8 v17 = BYTE4(v25) + 2;
      WORD2(v25) += 2;
      v13 += 8;
      if (!--v12) {
        return sub_10018BD78(291, v24, v17, a3, (uint64_t)sub_10013A594, v7, v8, v9);
      }
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_28:
    uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_30:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7566, v18);
  }

  unsigned __int8 v17 = BYTE4(v25);
  return sub_10018BD78(291, v24, v17, a3, (uint64_t)sub_10013A594, v7, v8, v9);
}

void (**sub_10014A928( void (**result)(uint64_t a1, uint64_t a2), const void *a2))(uint64_t a1, uint64_t a2)
{
  *uint64_t result = sub_10014A99C;
  if (a2) {
    return (void (**)(uint64_t, uint64_t))memcpy(&off_1008E27C8, a2, 0x1C8uLL);
  }
  return result;
}

void *sub_10014A94C(void *a1)
{
  return sub_100133E14(sub_10013DEAC);
}

void *sub_10014A980(void *__src)
{
  if (__src) {
    return memcpy(&unk_1008E2990, __src, 0x1C8uLL);
  }
  return __src;
}

void sub_10014A99C(uint64_t a1, uint64_t a2)
{
  v2 = (_BYTE *)(a1 + 15);
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_775;
  }

  uint64_t v5 = (unsigned __int16 *)(a1 + 12);
  uint64_t v4 = *(unsigned __int16 *)(a1 + 12);
  uint64_t v6 = *(unsigned __int16 *)(a1 + 10);
  if (v6 <= v4)
  {
LABEL_775:
    v384 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_777;
  }

  if (*(_BYTE *)(a1 + 14) != 1)
  {
    v384 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_777:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1360, v384);
  }

  uint64_t v7 = a2;
  uint64_t v8 = *(void *)a1;
  uint64_t v9 = v4 + 1;
  *(_WORD *)(a1 + 12) = v4 + 1;
  unsigned int v10 = *(unsigned __int8 *)(v8 + v4);
  if (v10 > 0xB4)
  {
    switch(*(_BYTE *)(v8 + v4))
    {
      case 0xE5:
        uint64_t v11 = off_1008E2888;
        if (!off_1008E2888) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          unsigned __int16 v12 = *(_WORD *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1783,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 4;
          if (v6 <= (unsigned __int16)(v4 + 4)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1784,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 5;
          ((void (*)(void, uint64_t, void))v11)( v12,  v13,  *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4)));
          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1782,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xE6:
        v141 = (void (*)(size_t *))off_1008E2978;
        if (!off_1008E2978) {
          goto LABEL_757;
        }
        *(void *)&__int128 v410 = 0LL;
        *(_OWORD *)size = 0u;
        memset(ptr, 0, sizeof(ptr));
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          LOBYTE(size[0]) = *(_BYTE *)(v8 + v9);
          if ((int)v6 - ((int)v4 + 2) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2298,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 6;
          if (v6 <= (unsigned __int16)(v4 + 6)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2299,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 7;
          LOBYTE(size[1]) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 6));
          if ((int)(v6 - (unsigned __int16)(v4 + 7)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2300,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 7));
          *uint64_t v5 = v4 + 11;
          if ((int)(v6 - (unsigned __int16)(v4 + 11)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2301,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 11));
          *uint64_t v5 = v4 + 15;
          if ((int)(v6 - (unsigned __int16)(v4 + 15)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2302,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 15));
          *uint64_t v5 = v4 + 19;
          if ((int)(v6 - (unsigned __int16)(v4 + 19)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2303,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 19));
          *uint64_t v5 = v4 + 23;
          if ((int)(v6 - (unsigned __int16)(v4 + 23)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2304,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 23));
          *uint64_t v5 = v4 + 27;
          if ((int)(v6 - (unsigned __int16)(v4 + 27)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2305,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 27));
          *uint64_t v5 = v4 + 31;
          if ((int)(v6 - (unsigned __int16)(v4 + 31)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2306,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 31));
          *uint64_t v5 = v4 + 35;
          if ((int)(v6 - (unsigned __int16)(v4 + 35)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2307,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 35));
          *uint64_t v5 = v4 + 39;
          if ((int)(v6 - (unsigned __int16)(v4 + 39)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2308,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 39));
          *uint64_t v5 = v4 + 43;
          if ((int)(v6 - (unsigned __int16)(v4 + 43)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2309,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 43));
          *uint64_t v5 = v4 + 47;
          if (v6 <= (unsigned __int16)(v4 + 47)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2310,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 48;
          BYTE4(v410) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 47));
          if (v6 <= (unsigned __int16)(v4 + 48)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2311,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 49;
          BYTE5(v410) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 48));
          if (v6 <= (unsigned __int16)(v4 + 49)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2312,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 50;
          BYTE6(v410) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 49));
LABEL_433:
          v141(size);
          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2297,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0xE7:
      case 0xEA:
      case 0xF1:
      case 0xF2:
      case 0xF3:
      case 0xF4:
      case 0xF5:
      case 0xF6:
      case 0xF8:
      case 0xF9:
      case 0xFC:
        goto LABEL_757;
      case 0xE8:
        v53 = (void (*)(uint64_t, uint64_t))qword_1008E2890;
        if (!qword_1008E2890) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v58 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v58 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1798,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
LABEL_300:
          uint64_t v152 = v55 | (v56 << 8);
          *uint64_t v5 = v4 + 4;
          uint64_t v153 = *(unsigned __int8 *)(v8 + v57);
LABEL_301:
          v53(v152, v153);
          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1797,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xE9:
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (v6 > (unsigned __int16)v9)
        {
          uint64_t v142 = v4 + 2;
          *uint64_t v5 = v4 + 2;
          switch(*(_BYTE *)(v8 + v9))
          {
            case 1:
              uint64_t v143 = (unsigned __int16)(v6 - v142);
              if (v143 >= 8)
              {
                if (!off_1008E2940) {
                  goto LABEL_757;
                }
                WORD2(size[0]) = 0;
                LODWORD(size[0]) = 0;
                if ((int)v6 - (int)v142 <= 5) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1236,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
                }
                sub_1001F0050((uint64_t)size, v8 + v142, 6uLL);
                unsigned __int16 v144 = *v5;
                unsigned __int16 v145 = *v5 + 6;
                *uint64_t v5 = v145;
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  unsigned int v146 = *(unsigned __int16 *)(a1 + 10);
                  if (v146 > v145)
                  {
                    if (*(_BYTE *)(a1 + 14) == 1)
                    {
                      uint64_t v147 = *(void *)a1;
                      *(_WORD *)(a1 + 12) = v144 + 7;
                      if (v146 <= (unsigned __int16)(v144 + 7)) {
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1238,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                      }
                      uint64_t v148 = *(unsigned __int8 *)(v147 + v145);
                      *uint64_t v5 = v144 + 8;
                      off_1008E2940( LODWORD(size[0]) | ((unint64_t)WORD2(size[0]) << 32),  v148,  *(unsigned __int8 *)(v147 + (unsigned __int16)(v144 + 7)),  v7);
                      goto LABEL_757;
                    }

                    v394 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1074:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1237,  v394);
                  }
                }

                v394 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
                goto LABEL_1074;
              }

              sub_1001EE134( (uint64_t)"Sensor state report event returned invalid length %d of data",  v342,  v343,  v344,  v345,  v346,  v347,  v348,  v143);
              v349 = (os_log_s *)sub_100086554(0x54u);
              if (!os_log_type_enabled(v349, OS_LOG_TYPE_ERROR)) {
                goto LABEL_757;
              }
              goto LABEL_719;
            case 2:
              if ((int)(v6 - (unsigned __int16)v142) <= 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1272,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              int v309 = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 4;
              if (!sub_10012D6D8(v309))
              {
                sub_1001EE134( (uint64_t)"RSSI Prox alert: ACL handle invalid",  v358,  v359,  v360,  v361,  v362,  v363,  v364,  v395);
                v365 = (os_log_s *)sub_100086554(0x54u);
                if (!os_log_type_enabled(v365, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_757;
                }
LABEL_719:
                sub_100657858();
                goto LABEL_757;
              }

              if (*v2)
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else
              {
                unsigned int v310 = *(unsigned __int16 *)(a1 + 10);
                unsigned int v311 = *(unsigned __int16 *)(a1 + 12);
                if (v310 > v311)
                {
                  if (*(_BYTE *)(a1 + 14) == 1)
                  {
                    *(_WORD *)(a1 + 12) = v311 + 1;
                    if (v310 <= v311 + 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1277,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                    }
                    *uint64_t v5 = v311 + 2;
                    if (off_1008E27D8) {
                      off_1008E27D8();
                    }
                    goto LABEL_757;
                  }

                  v392 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1010:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1276,  v392);
                }
              }

              v392 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
              goto LABEL_1010;
            case 3:
            case 4:
            case 5:
            case 6:
            case 8:
            case 9:
            case 0xA:
              goto LABEL_757;
            case 7:
              unsigned int v312 = v6 - (unsigned __int16)v142;
              if ((v312 & 0x1FFFE) != 0)
              {
                if (off_1008E27D0) {
                  off_1008E27D0( v8 + (unsigned __int16)v142,  (v312 >> 1),  v8 + (unsigned __int16)v142 + (unsigned __int16)(v312 >> 1),  (v312 >> 1));
                }
                goto LABEL_757;
              }

              sub_1001EE134((uint64_t)"LostDevice size is zero", v350, v351, v352, v353, v354, v355, v356, v395);
              v357 = (os_log_s *)sub_100086554(0x54u);
              if (!os_log_type_enabled(v357, OS_LOG_TYPE_ERROR)) {
                goto LABEL_757;
              }
              goto LABEL_719;
            case 0xB:
              if ((int)(v6 - (unsigned __int16)v142) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1294,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              uint64_t v313 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 6;
              if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1295,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              uint64_t v314 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 6));
              *uint64_t v5 = v4 + 10;
              if (off_1008E27E0) {
                off_1008E27E0(v313, v314);
              }
              goto LABEL_757;
            case 0xC:
              if ((int)(v6 - (unsigned __int16)v142) <= 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1311,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              unsigned __int16 v315 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 4;
              if (v6 <= (unsigned __int16)(v4 + 4)) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1312,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              *uint64_t v5 = v4 + 5;
              uint64_t v316 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4));
              if (off_1008E29B0) {
                off_1008E29B0(v315, v316);
              }
              if ((_DWORD)v316 && off_1008E27E8) {
                off_1008E27E8(v315, v316);
              }
              goto LABEL_757;
            default:
              if (*(_BYTE *)(v8 + v9) == 33)
              {
                if (v6 <= (unsigned __int16)v142) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1335,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                }
                *uint64_t v5 = v4 + 3;
                if (v6 <= (unsigned __int16)(v4 + 3)) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1336,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                }
                uint64_t v301 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 2));
                *uint64_t v5 = v4 + 4;
                if ((int)v6 - ((int)v4 + 4) <= 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1337,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                }
                uint64_t v302 = *(unsigned __int8 *)(v8 + v4 + 3);
                unsigned __int16 v303 = *(_WORD *)(v8 + v4 + 4);
                *uint64_t v5 = v4 + 6;
                if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1338,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                }
                v304 = (unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 6));
                int v305 = *v304;
                int v306 = v304[1];
                *uint64_t v5 = v4 + 8;
                if (off_1008E28D0) {
                  off_1008E28D0(v301, v302, v303, v305 | (v306 << 8));
                }
              }

              goto LABEL_757;
          }
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1501,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0xEB:
        v53 = (void (*)(uint64_t, uint64_t))off_1008E2B28;
        if (!off_1008E2B28) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v149 = v8 + v9;
          int v150 = *(unsigned __int8 *)(v8 + v9);
          int v151 = *(unsigned __int8 *)(v149 + 1);
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2140,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v152 = v150 | (v151 << 8);
          *uint64_t v5 = v4 + 4;
          uint64_t v153 = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 3)) != 0;
          goto LABEL_301;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2139,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xEC:
        if (!off_1008E2840) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          __int16 v154 = ((uint64_t (*)(void, void))off_1008E2840)( *(void *)a1 + *(unsigned __int16 *)(a1 + 12),  0LL);
        }

        else
        {
          __int16 v154 = ((uint64_t (*)(uint64_t, void))off_1008E2840)( v8 + (unsigned __int16)v9,  (v6 - v9));
        }

        unsigned __int16 v253 = *v5 + v154;
        *uint64_t v5 = v253;
        if (*v2) {
          goto LABEL_499;
        }
        if (*(unsigned __int16 *)(a1 + 10) != v253) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1600,  "ByteStream_NumReadBytesAvail(*pBs) == 0");
        }
        return;
      case 0xED:
        v155 = (void (*)(uint64_t, uint64_t))qword_1008E2950;
        if (!qword_1008E2950) {
          goto LABEL_757;
        }
        unint64_t v156 = v6 - (unsigned __int16)v9;
        if (v156 > 0x26)
        {
          uint64_t v189 = v8 + (unsigned __int16)v9;
          goto LABEL_461;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"BT_VSE_HID_LATENCY_STATISTICS - Invalid data size %lu",  v157,  v158,  v159,  v160,  v161,  v162,  v163,  v156);
          v164 = (os_log_s *)sub_100086554(0x54u);
          if (os_log_type_enabled(v164, OS_LOG_TYPE_ERROR)) {
            goto LABEL_719;
          }
        }

        goto LABEL_757;
      case 0xEE:
        if (!off_1008E2968) {
          goto LABEL_757;
        }
        size[0] = 0LL;
        size[1] = 0LL;
        *(void **)((char *)ptr + 7) = 0LL;
        ptr[0] = 0LL;
        *(_WORD *)&buf[4] = 0;
        *(_DWORD *)buf = 0;
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v165 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v165 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2246,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          goto LABEL_659;
        }

        if ((int)(v6 - (unsigned __int16)v9) <= 1)
        {
          _BYTE *v2 = 1;
LABEL_659:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v317 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v317 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2247,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v254 = 0;
          goto LABEL_661;
        }

        unsigned __int16 v254 = *(_WORD *)(v8 + v9);
        *(_WORD *)(a1 + 12) = v4 + 3;
        if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v4 + 3))
        {
          _BYTE *v2 = 1;
LABEL_661:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v318 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v318 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2248,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          uint64_t v256 = 0LL;
          goto LABEL_663;
        }

        uint64_t v255 = *(void *)a1;
        *(_WORD *)(a1 + 12) = v4 + 4;
        uint64_t v256 = *(unsigned __int8 *)(v255 + (unsigned __int16)(v4 + 3));
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 4) <= 1)
        {
          _BYTE *v2 = 1;
LABEL_663:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v319 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v319 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2249,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v257 = 0;
          goto LABEL_665;
        }

        unsigned __int16 v257 = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v4 + 4));
        *(_WORD *)(a1 + 12) = v4 + 6;
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 6) <= 1)
        {
          _BYTE *v2 = 1;
LABEL_665:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v320 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v320 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2250,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v258 = 0;
          goto LABEL_667;
        }

        unsigned __int16 v258 = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v4 + 6));
        *(_WORD *)(a1 + 12) = v4 + 8;
        if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v4 + 8))
        {
          _BYTE *v2 = 1;
LABEL_667:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          unint64_t v260 = 0LL;
          goto LABEL_668;
        }

        uint64_t v259 = *(void *)a1;
        *(_WORD *)(a1 + 12) = v4 + 9;
        unint64_t v260 = (unint64_t)*(unsigned __int8 *)(v259 + (unsigned __int16)(v4 + 8)) << 48;
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 9) >= 6)
        {
          sub_1001F0050((uint64_t)buf, *(void *)a1 + (unsigned __int16)(v4 + 9), 6uLL);
          *(_WORD *)(a1 + 12) += 6;
          goto LABEL_669;
        }

LABEL_668:
        _BYTE *v2 = 1;
LABEL_669:
        if (!v257) {
          goto LABEL_676;
        }
        if (*(_BYTE *)(a1 + 14) == 1)
        {
          v321 = v2;
          uint64_t v322 = *(void *)a1;
          uint64_t v323 = *(unsigned __int16 *)(a1 + 12);
          if (*v321)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v324 = 0;
          }

          else
          {
            int v324 = *(unsigned __int16 *)(a1 + 10) - (_DWORD)v323;
          }

          if (v324 >= v257)
          {
            __memmove_chk(size, v322 + v323, v257, 31LL);
            *v5 += v257;
            v2 = v321;
LABEL_676:
            off_1008E2968( v254,  v256,  v257,  v258,  v260 | ((unint64_t)buf[0] << 40) | ((unint64_t)buf[1] << 32) | ((unint64_t)buf[2] << 24) | ((unint64_t)buf[3] << 16) | ((unint64_t)buf[4] << 8) | buf[5],  size);
            goto LABEL_757;
          }

          v391 = "ByteStream_NumReadBytesAvail(*pBs) >= (length)";
        }

        else
        {
          v391 = "(*pBs).__RWFlag == BYTESTREAM_READ";
        }

        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2252, v391);
      case 0xEF:
        if (*v2)
        {
          v386 = v2;
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v387 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v387 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2350,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
        }

        else
        {
          if ((int)(v6 - (unsigned __int16)v9) > 3)
          {
            int v59 = *(_DWORD *)(v8 + v9);
            *(_WORD *)(a1 + 12) = v4 + 5;
            if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v4 + 5))
            {
              uint64_t v60 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v4 + 6;
              uint64_t v61 = (unsigned __int16)(v4 + 5);
              int v62 = *(unsigned __int8 *)(v60 + v61);
              if (!*(_BYTE *)(v60 + v61)) {
                goto LABEL_757;
              }
              int v63 = 0;
              while (1)
              {
                __int128 v410 = 0u;
                __int128 v411 = 0u;
                *(_OWORD *)size = 0u;
                memset(ptr, 0, sizeof(ptr));
                if (*(_BYTE *)(a1 + 14) != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2356,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2) {
                  break;
                }
                uint64_t v64 = *(unsigned __int16 *)(a1 + 12);
                unsigned int v65 = *(unsigned __int16 *)(*(void *)a1 + v64);
                *(_WORD *)(a1 + 12) = v64 + 2;
LABEL_103:
                WORD1(ptr[1]) = v65 & 0x1F;
                BYTE4(ptr[1]) = (v65 >> 5) & 3;
                BYTE6(ptr[3]) = (v65 & 0x80) != 0;
                BYTE5(ptr[3]) = BYTE1(v65) & 0x3F;
                BYTE4(ptr[3]) = (v65 & 0x4000) != 0;
                HIBYTE(ptr[3]) = v65 >> 15;
                uint64_t v66 = (v65 & 0x1F) - 16LL;
                if (v66 < 0xE && ((0x2C2Du >> v66) & 1) != 0)
                {
                  char v77 = byte_1006BD0FE[v66];
                }

                else
                {
                  BYTE3(ptr[3]) = 1;
                  int v67 = sub_1000A86F0();
                  if ((v65 & 1) != 0)
                  {
                    if ((v65 & 4) != 0)
                    {
                      if (v67)
                      {
                        sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE & EXTENDED_ADVERTISING_EVENT _TYPE_DIRECTED_ADV",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  v395);
                        v83 = (os_log_s *)sub_100086554(0x54u);
                        if (os_log_type_enabled(v83, OS_LOG_TYPE_DEFAULT))
                        {
                          v84 = sub_1001EDDCC();
                          *(_DWORD *)buf = 136446210;
                          *(void *)&buf[4] = v84;
                          _os_log_impl((void *)&_mh_execute_header, v83, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                        }
                      }

                      char v77 = 1;
                    }

                    else
                    {
                      if (v67)
                      {
                        sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  v395);
                        v78 = (os_log_s *)sub_100086554(0x54u);
                        BOOL v79 = os_log_type_enabled(v78, OS_LOG_TYPE_DEFAULT);
                        char v77 = 0;
                        if (!v79) {
                          goto LABEL_125;
                        }
                        v80 = sub_1001EDDCC();
                        *(_DWORD *)buf = 136446210;
                        *(void *)&buf[4] = v80;
                        _os_log_impl((void *)&_mh_execute_header, v78, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }

                      char v77 = 0;
                    }
                  }

                  else if ((v65 & 8) != 0)
                  {
                    if (v67)
                    {
                      sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_SCAN_RSP",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  v395);
                      v81 = (os_log_s *)sub_100086554(0x54u);
                      if (os_log_type_enabled(v81, OS_LOG_TYPE_DEFAULT))
                      {
                        v82 = sub_1001EDDCC();
                        *(_DWORD *)buf = 136446210;
                        *(void *)&buf[4] = v82;
                        _os_log_impl((void *)&_mh_execute_header, v81, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }
                    }

                    char v77 = 4;
                  }

                  else
                  {
                    if (v67)
                    {
                      sub_1001EE134( (uint64_t)"legacy=false LE_ADVERTISING_TYPE_NON_CONNECTABLE_UNDIRECTED",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  v395);
                      v75 = (os_log_s *)sub_100086554(0x54u);
                      if (os_log_type_enabled(v75, OS_LOG_TYPE_DEFAULT))
                      {
                        v76 = sub_1001EDDCC();
                        *(_DWORD *)buf = 136446210;
                        *(void *)&buf[4] = v76;
                        _os_log_impl((void *)&_mh_execute_header, v75, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }
                    }

                    char v77 = 3;
                  }
                }

LABEL_174:
                _BYTE *v2 = 1;
LABEL_175:
                if ((v59 & 2) == 0) {
                  goto LABEL_187;
                }
                if (*(_BYTE *)(a1 + 14) != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2427,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v115 = *(unsigned __int8 *)(a1 + 14);
                  *(_BYTE *)(a1 + 15) = 1;
                  if (v115 != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2428,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_185;
                }

                uint64_t v116 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v116)
                {
                  _BYTE *v2 = 1;
LABEL_185:
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  goto LABEL_186;
                }

                uint64_t v117 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v116 + 1;
                BYTE1(size[0]) = *(_BYTE *)(v117 + v116);
                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v116 + 1) >= 6)
                {
                  sub_1001F0050((uint64_t)size + 2, *(void *)a1 + (unsigned __int16)(v116 + 1), 6uLL);
                  *(_WORD *)(a1 + 12) += 6;
                  goto LABEL_187;
                }

        *(_BYTE *)(v261 + 26) = BYTE4(v262);
        if ((v214 & 8) == 0)
        {
LABEL_148:
          if ((v214 & 0x10) == 0) {
            goto LABEL_149;
          }
          goto LABEL_176;
        }

  uint64_t v167 = 0;
  v81 = sub_1002E6E00();
  sub_10002418C(buf, "LE");
  sub_10002418C(__p, "MinRSSIConnection");
  v82 = (*(uint64_t (**)(uint64_t, _BYTE *, void **, int *))(*(void *)v81 + 88LL))(v81, buf, __p, &v167);
  if (v171 < 0) {
    operator delete(__p[0]);
  }
  if (v175 < 0)
  {
    operator delete(*(void **)buf);
    if (!v82) {
      goto LABEL_182;
    }
  }

  else if (!v82)
  {
    goto LABEL_182;
  }

  v83 = v167;
  *(_BYTE *)(a1 + 1117) = v167;
  v84 = (os_log_s *)qword_1008F7620;
  if (os_log_type_enabled((os_log_t)qword_1008F7620, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)buf = 67109120;
    *(_DWORD *)&buf[4] = v83;
    _os_log_impl((void *)&_mh_execute_header, v84, OS_LOG_TYPE_DEFAULT, "MinRSSIConnection %d overridden", buf, 8u);
  }

LABEL_186:
                _BYTE *v2 = 1;
LABEL_187:
                int v118 = *(unsigned __int8 *)(a1 + 14);
                if ((v59 & 8) == 0) {
                  goto LABEL_200;
                }
                if (v118 != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2432,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v119 = *(unsigned __int8 *)(a1 + 14);
                  *(_BYTE *)(a1 + 15) = 1;
                  if (v119 != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2433,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_197;
                }

                uint64_t v120 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v120)
                {
                  _BYTE *v2 = 1;
LABEL_197:
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v125 = *(unsigned __int8 *)(a1 + 14);
                  *(_BYTE *)(a1 + 15) = 1;
                  if (v125 != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2434,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_198;
                }

                uint64_t v121 = *(void *)a1;
                uint64_t v122 = v120 + 1;
                *(_WORD *)(a1 + 12) = v120 + 1;
                BYTE8(v411) = *(_BYTE *)(v121 + v120);
                if (*(unsigned __int16 *)(a1 + 10) > (v120 + 1))
                {
                  uint64_t v123 = *(void *)a1;
                  unsigned __int16 v124 = v120 + 2;
                  *(_WORD *)(a1 + 12) = v124;
                  BYTE9(v411) = *(_BYTE *)(v123 + v122);
                  if (*(unsigned __int16 *)(a1 + 10) - v124 >= 2)
                  {
                    WORD5(v411) = *(_WORD *)(*(void *)a1 + v124);
                    *(_WORD *)(a1 + 12) = v124 + 2;
                    goto LABEL_201;
                  }

                  int v118 = 1;
                  goto LABEL_199;
                }

                _BYTE *v2 = 1;
LABEL_198:
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v118 = *(unsigned __int8 *)(a1 + 14);
LABEL_199:
                _BYTE *v2 = 1;
LABEL_200:
                if (v118 != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2437,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
LABEL_201:
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v126 = *(unsigned __int16 *)(a1 + 12);
                  if (*(unsigned __int16 *)(a1 + 10) > v126)
                  {
                    uint64_t v127 = *(void *)a1;
                    *(_WORD *)(a1 + 12) = v126 + 1;
                    size_t v128 = *(unsigned __int8 *)(v127 + v126);
                    LOWORD(size[1]) = *(unsigned __int8 *)(v127 + v126);
                    goto LABEL_206;
                  }
                }

                _BYTE *v2 = 1;
                size_t v128 = LOWORD(size[1]);
LABEL_206:
                v129 = sub_1000B17F4(v128);
                ptr[0] = v129;
                if (v129)
                {
                  uint64_t v130 = LOWORD(size[1]);
                  if (LOWORD(size[1]))
                  {
                    if (*(_BYTE *)(a1 + 14) != 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2440,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    v131 = v129;
                    uint64_t v132 = *(void *)a1;
                    uint64_t v133 = *(unsigned __int16 *)(a1 + 12);
                    if (*v2)
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v134 = 0;
                    }

                    else
                    {
                      int v134 = *(unsigned __int16 *)(a1 + 10) - (_DWORD)v133;
                    }

                    if (v134 >= LOWORD(size[1]))
                    {
                      v135 = (char *)(v132 + v133);
                      v136 = &v131[v130];
                      do
                      {
                        char v137 = *v135++;
                        *v131++ = v137;
                      }

                      while (v131 < v136);
                      *v5 += LOWORD(size[1]);
                    }

                    else
                    {
                      _BYTE *v2 = 1;
                    }
                  }
                }

                sub_1001C5618((unsigned __int16 *)size);
                sub_1000B1838(ptr[0]);
                if (++v63 == v62) {
                  goto LABEL_757;
                }
              }

              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_102:
              unsigned int v65 = 0;
              _BYTE *v2 = 1;
              goto LABEL_103;
            }

LABEL_810:
            _BYTE *v2 = 1;
            goto LABEL_811;
          }

          v386 = v2;
          _BYTE *v2 = 1;
        }

        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        v2 = v386;
        goto LABEL_810;
      case 0xF0:
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          int v166 = *(unsigned __int16 *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if (v166 == 768)
          {
            if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 3) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1483,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            uint64_t v167 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 3));
            *uint64_t v5 = v4 + 7;
            if (off_1008E27C0)
            {
              off_1008E27C0(0LL, v167);
              off_1008E27C0 = 0LL;
            }
          }

          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1480,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xF7:
        if (*v2) {
          goto LABEL_812;
        }
        *uint64_t v5 = v4 + 2;
        if (v6 <= (unsigned __int16)(v4 + 2)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1511,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v138 = *(unsigned __int8 *)(v8 + v9);
        uint64_t v9 = v4 + 3;
        *uint64_t v5 = v4 + 3;
        if (v6 <= (unsigned __int16)(v4 + 3)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1512,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v139 = *(unsigned __int8 *)(v8 + v4 + 2);
        *uint64_t v5 = v4 + 4;
        if (!v138 && v139 == 146) {
          goto LABEL_231;
        }
        goto LABEL_757;
      case 0xFA:
        v168 = (void (*)(void))off_1008E2898;
        if (!off_1008E2898) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          goto LABEL_902;
        }

        if (v6 <= (unsigned __int16)v9) {
LABEL_902:
        }
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1809,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        goto LABEL_401;
      case 0xFB:
        v53 = (void (*)(uint64_t, uint64_t))qword_1008E2880;
        if (!qword_1008E2880) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v169 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v169 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1768,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1767,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xFD:
        v53 = (void (*)(uint64_t, uint64_t))qword_1008E2878;
        if (!qword_1008E2878) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v170 = v8 + v9;
          int v171 = *(unsigned __int8 *)(v8 + v9);
          int v172 = *(unsigned __int8 *)(v170 + 1);
          *uint64_t v5 = v4 + 3;
          if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1754,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v152 = v171 | (v172 << 8);
          uint64_t v153 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 7;
          goto LABEL_301;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1753,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xFE:
        v53 = (void (*)(uint64_t, uint64_t))qword_1008E2870;
        if (!qword_1008E2870) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v140 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v140 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1739,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1738,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      default:
        switch(*(_BYTE *)(v8 + v4))
        {
          case 0xB5:
            if (*v2)
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (v6 > (unsigned __int16)v9)
            {
              *uint64_t v5 = v4 + 2;
              if (v6 <= (unsigned __int16)(v4 + 2)) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1641,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              uint64_t v22 = *(unsigned __int8 *)(v8 + v9);
              *uint64_t v5 = v4 + 3;
              if (v6 <= (unsigned __int16)(v4 + 3)) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1642,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              uint64_t v23 = *(unsigned __int8 *)(v8 + v4 + 2);
              *uint64_t v5 = v4 + 4;
              if (off_1008E2860) {
                off_1008E2860( v22,  v23,  *(unsigned __int8 *)(v8 + v4 + 3),  v8 + v4 + 4,  (v6 - (v4 + 4)));
              }
              goto LABEL_757;
            }

            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1640,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          case 0xB6:
          case 0xB7:
          case 0xBA:
          case 0xBC:
          case 0xBD:
          case 0xBE:
          case 0xBF:
            goto LABEL_757;
          case 0xB8:
            v155 = (void (*)(uint64_t, uint64_t))off_1008E28C8;
            if (!off_1008E28C8) {
              goto LABEL_757;
            }
            if (!*v2) {
              goto LABEL_450;
            }
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            unsigned __int8 v173 = 0;
            v155 = (void (*)(uint64_t, uint64_t))off_1008E28C8;
            uint64_t v8 = *(void *)a1;
            LOWORD(v9) = *(_WORD *)(a1 + 12);
            goto LABEL_451;
          case 0xB9:
            v174 = (void (*)(uint64_t))off_1008E28F0;
            if (!off_1008E28F0) {
              goto LABEL_757;
            }
            goto LABEL_396;
          case 0xBB:
            v174 = (void (*)(uint64_t))qword_1008E2908;
            if (!qword_1008E2908) {
              goto LABEL_757;
            }
            goto LABEL_396;
          case 0xC0:
            if (!off_1008E2910) {
              goto LABEL_757;
            }
            if (*v2)
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              __int16 v175 = ((uint64_t (*)(void, void))off_1008E2910)( *(void *)a1 + *(unsigned __int16 *)(a1 + 12),  0LL);
            }

            else
            {
              __int16 v175 = ((uint64_t (*)(uint64_t, void))off_1008E2910)( v8 + (unsigned __int16)v9,  (v6 - v9));
            }

            unsigned __int16 v261 = *v5 + v175;
            *uint64_t v5 = v261;
            if (*v2) {
              goto LABEL_499;
            }
            if (*(unsigned __int16 *)(a1 + 10) != v261) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1614,  "ByteStream_NumReadBytesAvail(*pBs) == 0");
            }
            return;
          case 0xC1:
            if (*v2)
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (v6 > (unsigned __int16)v9)
            {
              *uint64_t v5 = v4 + 2;
              if ((int)v6 - ((int)v4 + 2) <= 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1377,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              int v176 = *(unsigned __int8 *)(v8 + v9);
              int v177 = *(unsigned __int16 *)(v8 + v4 + 2);
              *uint64_t v5 = v4 + 4;
              v178 = sub_10012D6D8(v177);
              if (*v2)
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else
              {
                int v179 = *(unsigned __int16 *)(a1 + 10);
                uint64_t v180 = *(unsigned __int16 *)(a1 + 12);
                if (v179 - (int)v180 > 3)
                {
                  if (*(_BYTE *)(a1 + 14) == 1)
                  {
                    uint64_t v181 = *(void *)a1;
                    uint64_t v182 = *(unsigned int *)(*(void *)a1 + v180);
                    *(_WORD *)(a1 + 12) = v180 + 4;
                    if (v179 - (unsigned __int16)(v180 + 4) <= 3) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1380,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                    }
                    uint64_t v183 = *(unsigned int *)(v181 + (unsigned __int16)(v180 + 4));
                    *uint64_t v5 = v180 + 8;
                    if (v179 - (unsigned __int16)(v180 + 8) <= 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1381,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                    }
                    unsigned __int16 v184 = *(_WORD *)(v181 + (unsigned __int16)(v180 + 8));
                    *uint64_t v5 = v180 + 10;
                    if (v179 - (unsigned __int16)(v180 + 10) <= 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1382,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                    }
                    v185 = v178;
                    unsigned __int8 v186 = *(_BYTE *)(v181 + (unsigned __int16)(v180 + 10));
                    *uint64_t v5 = v180 + 12;
                    if ((v186 & (v176 == 10)) != 0) {
                      LOBYTE(v176) = -118;
                    }
                    LODWORD(size[0]) = 0;
                    *(_DWORD *)buf = 0;
                    sub_1000B0740(size, (__darwin_suseconds_t *)buf);
                    BOOL v188 = v176 != 1 && v176 != 0 && v185 == 0LL;
                    if (v188 || v176 == 10)
                    {
                      if (sub_1000A86F0())
                      {
                        sub_1001EE134( (uint64_t)"updateBTControllerClockCB size is zero",  v229,  v230,  v231,  v232,  v233,  v234,  v235,  v395);
                        v236 = (os_log_s *)sub_100086554(0x54u);
                        if (os_log_type_enabled(v236, OS_LOG_TYPE_ERROR)) {
                          sub_100657858();
                        }
                      }
                    }

                    else if (off_1008E2920)
                    {
                      off_1008E2920( v185,  v176,  v182,  v183,  v184,  LODWORD(size[0]),  *(unsigned int *)buf);
                    }

                    goto LABEL_757;
                  }

                  v388 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_826:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1379,  v388);
                }
              }

              v388 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
              goto LABEL_826;
            }

            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1376,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          default:
            switch(*(_BYTE *)(v8 + v4))
            {
              case 0xCD:
                size[0] = 0LL;
                size[1] = 0LL;
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if ((int)(v6 - (unsigned __int16)v9) > 1)
                {
                  int v33 = *(unsigned __int16 *)(v8 + v9);
                  *uint64_t v5 = v4 + 3;
                  __int16 v34 = sub_10012D6D8(v33);
                  if (*v2)
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    unsigned int v35 = *(unsigned __int16 *)(a1 + 10);
                    int v36 = *(unsigned __int16 *)(a1 + 12);
                    if ((int)(v35 - v36) > 3)
                    {
                      if (*(_BYTE *)(a1 + 14) == 1)
                      {
                        uint64_t v37 = *(void *)a1;
                        *(_WORD *)(a1 + 12) = v36 + 4;
                        if ((int)(v35 - (unsigned __int16)(v36 + 4)) <= 3) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1426,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        *uint64_t v5 = v36 + 8;
                        if ((int)(v35 - (unsigned __int16)(v36 + 8)) <= 3) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1427,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        *uint64_t v5 = v36 + 12;
                        if ((int)(v35 - (unsigned __int16)(v36 + 12)) <= 3) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1428,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        uint64_t v38 = 0LL;
                        unsigned __int16 v39 = v36 + 16;
                        *uint64_t v5 = v36 + 16;
                        BOOL v40 = v35 >= (unsigned __int16)(v36 + 16);
                        unsigned int v41 = v35 - (unsigned __int16)(v36 + 16);
                        if (v40) {
                          uint64_t v42 = v41;
                        }
                        else {
                          uint64_t v42 = 0LL;
                        }
                        do
                        {
                          if (v42 == v38) {
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1432,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                          }
                          unsigned __int16 v43 = v39;
                          uint64_t v44 = v39++;
                          *uint64_t v5 = v39;
                          *((_BYTE *)size + v38++) = *(_BYTE *)(v37 + v44);
                        }

                        while (v38 != 16);
                        if (v35 <= v39) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1435,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 2;
                        if (v35 <= (unsigned __int16)(v43 + 2)) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1436,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 3;
                        if (v35 <= (unsigned __int16)(v43 + 3)) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1437,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 4;
                        if ((int)(v35 - (unsigned __int16)(v43 + 4)) <= 1)
                        {
                          _BYTE *v2 = 1;
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          *uint64_t v5 = v43 + 6;
                          if (v35 > (unsigned __int16)(v43 + 6))
                          {
                            *uint64_t v5 = v43 + 7;
                            if (v34)
                            {
                              if (off_1008E2918) {
                                off_1008E2918(v34);
                              }
                            }

                            else if (sub_1000A86F0())
                            {
                              sub_1001EE134( (uint64_t)"updateBTControllerClockCB size is zero",  v237,  v238,  v239,  v240,  v241,  v242,  v243,  v395);
                              v244 = (os_log_s *)sub_100086554(0x54u);
                              if (os_log_type_enabled(v244, OS_LOG_TYPE_ERROR)) {
                                sub_100657858();
                              }
                            }

                            goto LABEL_757;
                          }
                        }

                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1439,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                      }

                      v389 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_843:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1425,  v389);
                    }
                  }

                  v389 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
                  goto LABEL_843;
                }

                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1423,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              case 0xCF:
                v174 = (void (*)(uint64_t))qword_1008E2850;
                if (!qword_1008E2850) {
                  goto LABEL_757;
                }
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  uint64_t v221 = 0LL;
                }

                else
                {
                  uint64_t v221 = v6 - (unsigned __int16)v9;
                  if (v221 == 123)
                  {
                    uint64_t v213 = v8 + (unsigned __int16)v9;
                    goto LABEL_397;
                  }
                }

                if (sub_1000A86F0())
                {
                  sub_1001EE134( (uint64_t)"BT_VSE_PHY_STATISTIC_DUAL_CORE - Invalid data size %lu",  v293,  v294,  v295,  v296,  v297,  v298,  v299,  v221);
                  v300 = (os_log_s *)sub_100086554(0x54u);
                  if (os_log_type_enabled(v300, OS_LOG_TYPE_ERROR)) {
                    goto LABEL_719;
                  }
                }

                goto LABEL_757;
              case 0xD5:
                v141 = (void (*)(size_t *))qword_1008E2988;
                if (!qword_1008E2988) {
                  goto LABEL_757;
                }
                BYTE1(size[1]) = 0;
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (v6 > (unsigned __int16)v9)
                {
                  *uint64_t v5 = v4 + 2;
                  LOBYTE(size[0]) = *(_BYTE *)(v8 + v9);
                  if (v6 <= (unsigned __int16)(v4 + 2)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2331,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 3;
                  BYTE1(size[0]) = *(_BYTE *)(v8 + v4 + 2);
                  if (v6 <= (unsigned __int16)(v4 + 3)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2332,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 4;
                  BYTE2(size[0]) = *(_BYTE *)(v8 + v4 + 3);
                  if (v6 <= (unsigned __int16)(v4 + 4)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2333,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 5;
                  BYTE3(size[0]) = *(_BYTE *)(v8 + v4 + 4);
                  if (v6 <= (unsigned __int16)(v4 + 5)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2334,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 6;
                  BYTE4(size[0]) = *(_BYTE *)(v8 + v4 + 5);
                  if (v6 <= (unsigned __int16)(v4 + 6)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2335,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 7;
                  BYTE5(size[0]) = *(_BYTE *)(v8 + v4 + 6);
                  if (v6 <= (unsigned __int16)(v4 + 7)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2336,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 8;
                  BYTE6(size[0]) = *(_BYTE *)(v8 + v4 + 7);
                  if (v6 <= (unsigned __int16)(v4 + 8)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2337,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 9;
                  HIBYTE(size[0]) = *(_BYTE *)(v8 + v4 + 8);
                  if (v6 <= (unsigned __int16)(v4 + 9)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2338,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 10;
                  LOBYTE(size[1]) = *(_BYTE *)(v8 + v4 + 9);
                  if (v6 <= (unsigned __int16)(v4 + 10)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2339,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 11;
                  BYTE1(size[1]) = *(_BYTE *)(v8 + v4 + 10);
                  goto LABEL_433;
                }

                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2330,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              case 0xD6:
                v141 = (void (*)(size_t *))qword_1008E2980;
                if (!qword_1008E2980) {
                  goto LABEL_757;
                }
                if (*v2)
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (v6 > (unsigned __int16)v9)
                {
                  *uint64_t v5 = v4 + 2;
                  LOBYTE(size[0]) = *(_BYTE *)(v8 + v9);
                  if (v6 <= (unsigned __int16)(v4 + 2)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2321,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 3;
                  BYTE1(size[0]) = *(_BYTE *)(v8 + v4 + 2);
                  if (v6 <= (unsigned __int16)(v4 + 3)) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2322,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 4;
                  BYTE2(size[0]) = *(_BYTE *)(v8 + v4 + 3);
                  goto LABEL_433;
                }

                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2320,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              default:
                goto LABEL_757;
            }
        }
    }
  }

  if (*(unsigned __int8 *)(v8 + v4) <= 0x85u)
  {
    switch(*(_BYTE *)(v8 + v4))
    {
      case 0x12:
        if (!off_1008E28A0) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          if ((int)v6 - ((int)v4 + 2) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1827,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          uint64_t v24 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v25 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          if (v6 <= (unsigned __int16)(v4 + 4)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1828,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 5;
          if ((int)(v6 - (unsigned __int16)(v4 + 5)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1829,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v26 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4));
          uint64_t v27 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 5));
          *uint64_t v5 = v4 + 9;
          if ((int)(v6 - (unsigned __int16)(v4 + 9)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1830,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v28 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 9));
          *uint64_t v5 = v4 + 13;
          if (v6 <= (unsigned __int16)(v4 + 13)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1831,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 14;
          if (v6 <= (unsigned __int16)(v4 + 14)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1832,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v29 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 13));
          *uint64_t v5 = v4 + 15;
          uint64_t v30 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 14));
          if (v6 - (unint64_t)(unsigned __int16)(v4 + 15) < 2)
          {
            unsigned __int16 v32 = -1;
          }

          else
          {
            uint64_t v31 = (unsigned __int16)(v4 + 15);
            if ((int)v6 - (int)v31 <= 1) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1834,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unsigned __int16 v32 = *(_WORD *)(v8 + v31);
            *uint64_t v5 = v4 + 17;
          }

          uint64_t v245 = v25;
          uint64_t v246 = v32;
          off_1008E2A68(v24, v245, v26, v27, v28, v29, v30, v246);
          off_1008E28A0(v24, v245, v26, v27, v28, v29, v30, v246);
          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1826,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0x13:
        v48 = off_1008E28A8;
        if (!off_1008E28A8) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          unsigned __int16 v49 = *(_WORD *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1857,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          unsigned __int16 v50 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 5;
          if ((int)(v6 - (unsigned __int16)(v4 + 5)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1858,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v51 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 5));
          *uint64_t v5 = v4 + 9;
          if ((int)(v6 - (unsigned __int16)(v4 + 9)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1859,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v52 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 9));
          *uint64_t v5 = v4 + 13;
          ((void (*)(void, void, uint64_t, uint64_t))v48)(v49, v50, v51, v52);
          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1856,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0x14:
        v53 = (void (*)(uint64_t, uint64_t))qword_1008E28B0;
        if (!qword_1008E28B0) {
          goto LABEL_757;
        }
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v54 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v54 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1873,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1872,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0x15:
      case 0x16:
      case 0x17:
      case 0x18:
      case 0x19:
      case 0x1A:
        goto LABEL_757;
      case 0x1B:
        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
LABEL_231:
          if (*(_BYTE *)(v8 + v9) == 3)
          {
            sub_1000B19C0(v8, *(unsigned __int16 *)(a1 + 8));
            if ((byte_1008E2B58 & 1) == 0) {
              byte_1008E2B58 = 1;
            }
          }

          goto LABEL_757;
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1530,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      default:
        if (v10 != 90)
        {
          if (v10 != 128) {
            goto LABEL_757;
          }
          if (*v2)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if ((int)(v6 - (unsigned __int16)v9) > 1)
          {
            unsigned __int16 v45 = *(_WORD *)(v8 + v9);
            *uint64_t v5 = v4 + 3;
            if (v6 <= (unsigned __int16)(v4 + 3)) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1625,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
            }
            *uint64_t v5 = v4 + 4;
            if (v6 <= (unsigned __int16)(v4 + 4)) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1626,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
            }
            uint64_t v46 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 3));
            *uint64_t v5 = v4 + 5;
            if (off_1008E27F8) {
              off_1008E27F8(v45, v46, *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4)));
            }
            goto LABEL_757;
          }

          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1624,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }

        if (*v2)
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          unsigned int v222 = *(unsigned __int8 *)(v8 + v9);
          if (*(_BYTE *)(v8 + v9))
          {
            int v223 = 0;
            while (!*v2)
            {
              int v224 = *(unsigned __int16 *)(a1 + 10);
              uint64_t v225 = *(unsigned __int16 *)(a1 + 12);
              if (*(_BYTE *)(a1 + 14) != 1)
              {
                v385 = "(*pBs).__RWFlag == BYTESTREAM_READ";
                goto LABEL_789;
              }

              v226 = (unsigned __int8 *)(*(void *)a1 + v225);
              int v227 = *v226;
              int v228 = v226[1];
              *(_WORD *)(a1 + 12) = v225 + 2;
              if (v224 - (unsigned __int16)(v225 + 2) <= 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1462,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              *uint64_t v5 = v225 + 4;
              if (++v223 >= v222) {
                goto LABEL_757;
              }
            }

            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_787:
            v385 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_789:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1461,  v385);
          }

LABEL_757:
          if (!*v2) {
            return;
          }
LABEL_811:
          sub_1000AFE20(136LL);
LABEL_812:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_813:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1510,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }

        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1457,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    }
  }

  switch(*(_BYTE *)(v8 + v4))
  {
    case 0x86:
      __int128 v420 = 0u;
      memset(v421, 0, 27);
      __int128 v418 = 0u;
      __int128 v419 = 0u;
      __int128 v416 = 0u;
      __int128 v417 = 0u;
      __int128 v414 = 0u;
      __int128 v415 = 0u;
      __int128 v412 = 0u;
      __int128 v413 = 0u;
      __int128 v410 = 0u;
      __int128 v411 = 0u;
      *(_OWORD *)size = 0u;
      memset(ptr, 0, sizeof(ptr));
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if ((int)(v6 - (unsigned __int16)v9) > 1)
      {
        *uint64_t v5 = v4 + 3;
        __strlcpy_chk(size, v8 + (unsigned __int16)(v4 + 3), v6 - (unsigned __int16)(v4 + 3), 251LL);
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"controller debug - %s", v14, v15, v16, v17, v18, v19, v20, (uint64_t)size);
          __int16 v21 = (os_log_s *)sub_100086554(0x54u);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)buf = 136446210;
            *(void *)&buf[4] = sub_1001EDDCC();
            _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        goto LABEL_757;
      }

      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1680,  "ByteStream_NumReadBytesAvail(*pBs) >= (2)");
    case 0x87:
    case 0x89:
    case 0x8A:
    case 0x8B:
    case 0x8D:
    case 0x90:
    case 0x91:
    case 0x92:
    case 0x93:
    case 0x94:
    case 0x95:
    case 0x96:
    case 0x97:
    case 0x98:
    case 0x9C:
    case 0xA0:
    case 0xA1:
      goto LABEL_757;
    case 0x88:
      if (!off_1008E2830) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        __int16 v206 = ((uint64_t (*)(void, void))off_1008E2830)( *(void *)a1 + *(unsigned __int16 *)(a1 + 12),  0LL);
      }

      else
      {
        __int16 v206 = ((uint64_t (*)(uint64_t, void))off_1008E2830)( v8 + (unsigned __int16)v9,  (v6 - v9));
      }

      unsigned __int16 v262 = *v5 + v206;
      *uint64_t v5 = v262;
      if (*v2) {
        goto LABEL_499;
      }
      if (*(unsigned __int16 *)(a1 + 10) != v262) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1572,  "ByteStream_NumReadBytesAvail(*pBs) == 0");
      }
      return;
    case 0x8C:
      if (!off_1008E2958) {
        goto LABEL_757;
      }
      __int128 v410 = 0u;
      __int128 v411 = 0u;
      *(_OWORD *)size = 0u;
      memset(ptr, 0, sizeof(ptr));
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) > 1)
        {
          uint64_t v207 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v208 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          unsigned __int16 v397 = v208;
          if (v6 <= (unsigned __int16)(v4 + 4))
          {
            _BYTE *v2 = 1;
            memset(v402, 0, 7);
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            *uint64_t v5 = v4 + 5;
            memset(v402, 0, 7);
            if (v6 > (unsigned __int16)(v4 + 5))
            {
              *uint64_t v5 = v4 + 6;
              LOBYTE(v402[0]) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 5));
              uint64_t v209 = LOBYTE(v402[0]);
              BOOL v210 = (v402[0] & 0xFE) == 2;
              if (LOBYTE(v402[0]) == 3)
              {
                uint64_t v209 = 1LL;
                LOBYTE(v402[0]) = 1;
              }

              else if (LOBYTE(v402[0]) == 2)
              {
                uint64_t v209 = 0LL;
                LOBYTE(v402[0]) = 0;
              }

              if (*(_BYTE *)(a1 + 14) == 1)
              {
                uint64_t v366 = *(unsigned __int16 *)(a1 + 12);
                BOOL v399 = v210;
                if (*(unsigned __int16 *)(a1 + 10) - (int)v366 >= 6)
                {
                  sub_1001F0050((uint64_t)v402 + 1, *(void *)a1 + v366, 6uLL);
                  *(_WORD *)(a1 + 12) += 6;
                  uint64_t v252 = BYTE1(v402[0]);
                  uint64_t v251 = BYTE2(v402[0]);
                  unsigned int v250 = HIBYTE(v402[0]);
                  unsigned int v249 = LOBYTE(v402[1]);
                  unsigned int v248 = BYTE1(v402[1]);
                  unsigned int v247 = BYTE2(v402[1]);
                  uint64_t v209 = LOBYTE(v402[0]);
LABEL_466:
                  *(_DWORD *)((char *)v401 + 3) = 0;
                  v401[0] = 0;
                  if (*(_BYTE *)(a1 + 14) != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2185,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v272 = *(unsigned __int16 *)(a1 + 12);
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v272 >= 6)
                    {
                      sub_1001F0050((uint64_t)v401 + 1, *(void *)a1 + v272, 6uLL);
                      *(_WORD *)(a1 + 12) += 6;
                      goto LABEL_507;
                    }
                  }

                  _BYTE *v2 = 1;
LABEL_507:
                  LOBYTE(v401[0]) = 1;
                  ptr[1] = (void *)(((unint64_t)BYTE2(v401[0]) << 32) | ((unint64_t)BYTE1(v401[0]) << 40) | ((unint64_t)HIBYTE(v401[0]) << 24) | ((unint64_t)LOBYTE(v401[1]) << 16) | ((unint64_t)BYTE1(v401[1]) << 8) | BYTE2(v401[1]) | 0x1000000000000LL);
                  *(_DWORD *)((char *)v400 + 3) = 0;
                  v400[0] = 0;
                  if (*(_BYTE *)(a1 + 14) != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2190,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  unint64_t v273 = (v252 << 40) | (v251 << 32) | ((unint64_t)v250 << 24) | ((unint64_t)v249 << 16) | ((unint64_t)v248 << 8) | v247 | (v209 << 48);
                  if (*v2)
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    BOOL v274 = v399;
                  }

                  else
                  {
                    uint64_t v275 = *(unsigned __int16 *)(a1 + 12);
                    BOOL v274 = v399;
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v275 >= 6)
                    {
                      sub_1001F0050((uint64_t)v400 + 1, *(void *)a1 + v275, 6uLL);
                      *(_WORD *)(a1 + 12) += 6;
                      goto LABEL_513;
                    }
                  }

                  _BYTE *v2 = 1;
LABEL_513:
                  unint64_t v276 = (unint64_t)BYTE2(v400[0]) << 32;
                  v277 = (void *)(v276 | ((unint64_t)BYTE1(v400[0]) << 40) | ((unint64_t)HIBYTE(v400[0]) << 24) | ((unint64_t)LOBYTE(v400[1]) << 16) | ((unint64_t)BYTE1(v400[1]) << 8) | BYTE2(v400[1]) | 0x1000000000000LL);
                  if (v274) {
                    v278 = (void *)(v276 | ((unint64_t)BYTE1(v400[0]) << 40) | ((unint64_t)HIBYTE(v400[0]) << 24) | ((unint64_t)LOBYTE(v400[1]) << 16) | ((unint64_t)BYTE1(v400[1]) << 8) | BYTE2(v400[1]) | 0x1000000000000LL);
                  }
                  else {
                    v278 = (void *)v273;
                  }
                  if (!v274) {
                    v277 = 0LL;
                  }
                  ptr[0] = v278;
                  ptr[2] = v277;
                  if (*(_BYTE *)(a1 + 14) != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2196,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v279 = *(unsigned __int8 *)(a1 + 14);
                    *(_BYTE *)(a1 + 15) = 1;
                    if (v279 != 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2197,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                  }

                  else
                  {
                    uint64_t v280 = *(unsigned __int16 *)(a1 + 12);
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v280 > 1)
                    {
                      LOWORD(ptr[3]) = *(_WORD *)(*(void *)a1 + v280);
                      *(_WORD *)(a1 + 12) = v280 + 2;
                      if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v280 + 2) > 1)
                      {
                        WORD1(ptr[3]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v280 + 2));
                        *(_WORD *)(a1 + 12) = v280 + 4;
                        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v280 + 4) > 1)
                        {
                          WORD2(ptr[3]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v280 + 4));
                          unsigned __int16 v281 = v280 + 6;
                          *(_WORD *)(a1 + 12) = v280 + 6;
                          if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v280 + 6))
                          {
                            uint64_t v282 = *(void *)a1;
                            unsigned __int16 v283 = v280 + 7;
                            *(_WORD *)(a1 + 12) = v283;
                            BYTE6(ptr[3]) = *(_BYTE *)(v282 + v281);
                            if (*(unsigned __int16 *)(a1 + 10) > v283)
                            {
                              uint64_t v284 = v283;
                              uint64_t v285 = *(void *)a1;
                              unsigned __int16 v286 = v283 + 1;
                              *(_WORD *)(a1 + 12) = v286;
                              HIBYTE(ptr[3]) = *(_BYTE *)(v285 + v284);
                              if (*(unsigned __int16 *)(a1 + 10) - v286 > 1)
                              {
                                uint64_t v287 = v286;
                                uint64_t v288 = *(void *)a1;
                                LOWORD(v410) = *(_WORD *)(*(void *)a1 + v287);
                                *(_WORD *)(a1 + 12) = v287 + 2;
                                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v287 + 2) > 1)
                                {
                                  WORD1(v410) = *(_WORD *)(v288 + (unsigned __int16)(v287 + 2));
                                  unsigned __int16 v289 = v287 + 4;
                                  *(_WORD *)(a1 + 12) = v289;
                                  int v290 = 8;
                                  BYTE12(v410) = 8;
                                  uint64_t v291 = v288 + v289;
                                  int v292 = *(unsigned __int16 *)(a1 + 10) - v289;
LABEL_686:
                                  if (v292 >= v290)
                                  {
                                    __memmove_chk((char *)&v410 + 4, v291, v290, 28LL);
                                    unsigned __int16 v333 = *(_WORD *)(a1 + 12) + BYTE12(v410);
                                    *(_WORD *)(a1 + 12) = v333;
                                    if (*(_BYTE *)(a1 + 14) != 1) {
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2208,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                    }
                                    if (*v2)
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                      int v334 = *(unsigned __int8 *)(a1 + 14);
                                      *(_BYTE *)(a1 + 15) = 1;
                                      if (v334 != 1) {
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2209,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                      }
                                    }

                                    else
                                    {
                                      if (*(unsigned __int16 *)(a1 + 10) > v333)
                                      {
                                        uint64_t v335 = *(void *)a1;
                                        *(_WORD *)(a1 + 12) = v333 + 1;
                                        BYTE13(v410) = *(_BYTE *)(v335 + v333);
                                        if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v333 + 1))
                                        {
                                          uint64_t v336 = *(void *)a1;
                                          *(_WORD *)(a1 + 12) = v333 + 2;
                                          BYTE14(v410) = *(_BYTE *)(v336 + (unsigned __int16)(v333 + 1));
                                          if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v333 + 2) > 1)
                                          {
                                            LOWORD(v411) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v333 + 2));
                                            *(_WORD *)(a1 + 12) = v333 + 4;
                                            if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v333 + 4) > 1)
                                            {
                                              WORD1(v411) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v333 + 4));
                                              *(_WORD *)(a1 + 12) = v333 + 6;
                                              if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v333 + 6) > 1)
                                              {
                                                WORD2(v411) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v333 + 6));
                                                *(_WORD *)(a1 + 12) = v333 + 8;
                                                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v333 + 8) > 1)
                                                {
                                                  WORD3(v411) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v333 + 8));
                                                  *(_WORD *)(a1 + 12) = v333 + 10;
                                                  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v333 + 10) >= 2)
                                                  {
                                                    WORD4(v411) = *(_WORD *)(*(void *)a1
                                                                           + (unsigned __int16)(v333 + 10));
                                                    *(_WORD *)(a1 + 12) = v333 + 12;
LABEL_707:
                                                    size[0] = (size_t)sub_10012D6D8(v397);
                                                    __int128 v405 = *(_OWORD *)&ptr[2];
                                                    __int128 v406 = v410;
                                                    __int128 v407 = v411;
                                                    *(_OWORD *)buf = *(_OWORD *)size;
                                                    __int128 v404 = *(_OWORD *)ptr;
                                                    off_1008E2958(v207, buf);
                                                    goto LABEL_757;
                                                  }

LABEL_706:
                                                  _BYTE *v2 = 1;
                                                  goto LABEL_707;
                                                }

                                                _BYTE *v2 = 1;
LABEL_705:
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                goto LABEL_706;
                                              }

                                              _BYTE *v2 = 1;
LABEL_704:
                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetoo"
                                                                     "th_base/Stack/vsc/bcm/bcm_vsc.c");
                                              int v341 = *(unsigned __int8 *)(a1 + 14);
                                              *(_BYTE *)(a1 + 15) = 1;
                                              if (v341 != 1) {
                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2214,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                              }
                                              goto LABEL_705;
                                            }

                                            _BYTE *v2 = 1;
LABEL_703:
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                            int v340 = *(unsigned __int8 *)(a1 + 14);
                                            *(_BYTE *)(a1 + 15) = 1;
                                            if (v340 != 1) {
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2213,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                            }
                                            goto LABEL_704;
                                          }

                                          _BYTE *v2 = 1;
LABEL_702:
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                          int v339 = *(unsigned __int8 *)(a1 + 14);
                                          *(_BYTE *)(a1 + 15) = 1;
                                          if (v339 != 1) {
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2212,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                          }
                                          goto LABEL_703;
                                        }

                                        _BYTE *v2 = 1;
LABEL_701:
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                        int v338 = *(unsigned __int8 *)(a1 + 14);
                                        *(_BYTE *)(a1 + 15) = 1;
                                        if (v338 != 1) {
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2211,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                        }
                                        goto LABEL_702;
                                      }

                                      _BYTE *v2 = 1;
                                    }

                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                    int v337 = *(unsigned __int8 *)(a1 + 14);
                                    *(_BYTE *)(a1 + 15) = 1;
                                    if (v337 != 1) {
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2210,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                                    }
                                    goto LABEL_701;
                                  }

                                  v390 = "ByteStream_NumReadBytesAvail(*pBs) >= (params.featuresLength)";
LABEL_925:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2206,  v390);
                                }

                                _BYTE *v2 = 1;
                                BYTE12(v410) = 8;
                                uint64_t v291 = v288 + (unsigned __int16)(v287 + 2);
LABEL_685:
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                                int v292 = 0;
                                int v290 = BYTE12(v410);
                                goto LABEL_686;
                              }

                              _BYTE *v2 = 1;
LABEL_683:
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              uint64_t v330 = *(void *)a1;
                              uint64_t v331 = *(unsigned __int16 *)(a1 + 12);
                              int v332 = *(unsigned __int8 *)(a1 + 14);
                              *(_BYTE *)(a1 + 15) = 1;
                              BYTE12(v410) = 8;
                              if (v332 != 1)
                              {
                                v390 = "(*pBs).__RWFlag == BYTESTREAM_READ";
                                goto LABEL_925;
                              }

                              uint64_t v291 = v330 + v331;
                              goto LABEL_685;
                            }

                            _BYTE *v2 = 1;
LABEL_682:
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            int v329 = *(unsigned __int8 *)(a1 + 14);
                            *(_BYTE *)(a1 + 15) = 1;
                            if (v329 != 1) {
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2203,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                            }
                            goto LABEL_683;
                          }

                          _BYTE *v2 = 1;
LABEL_681:
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v328 = *(unsigned __int8 *)(a1 + 14);
                          *(_BYTE *)(a1 + 15) = 1;
                          if (v328 != 1) {
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2202,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                          }
                          goto LABEL_682;
                        }

                        _BYTE *v2 = 1;
LABEL_680:
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        int v327 = *(unsigned __int8 *)(a1 + 14);
                        *(_BYTE *)(a1 + 15) = 1;
                        if (v327 != 1) {
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2201,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                        }
                        goto LABEL_681;
                      }

                      _BYTE *v2 = 1;
LABEL_679:
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v326 = *(unsigned __int8 *)(a1 + 14);
                      *(_BYTE *)(a1 + 15) = 1;
                      if (v326 != 1) {
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2199,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                      }
                      goto LABEL_680;
                    }

                    _BYTE *v2 = 1;
                  }

                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v325 = *(unsigned __int8 *)(a1 + 14);
                  *(_BYTE *)(a1 + 15) = 1;
                  if (v325 != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2198,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_679;
                }

LABEL_465:
                unsigned int v247 = 0;
                unsigned int v248 = 0;
                unsigned int v249 = 0;
                unsigned int v250 = 0;
                uint64_t v251 = 0LL;
                uint64_t v252 = 0LL;
                _BYTE *v2 = 1;
                goto LABEL_466;
              }

              goto LABEL_923;
            }
          }

          *(_BYTE *)(a1 + 15) = 1;
          if (*(_BYTE *)(a1 + 14) == 1)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            BOOL v399 = 0;
            uint64_t v209 = 0LL;
            goto LABEL_465;
          }

LABEL_923:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2181,  "(*pBs).__RWFlag == BYTESTREAM_READ");
        }

LABEL_915:
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2162,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }

      _BYTE *v2 = 1;
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      goto LABEL_915;
    case 0x8E:
      if (!off_1008E2848) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unint64_t v211 = 0LL;
      }

      else
      {
        unint64_t v211 = v6 - (unsigned __int16)v9;
      }

      if (v211 > 0xCD || v211 == 39)
      {
        off_1008E2848(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), v7);
        goto LABEL_757;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"BT_VSE_PHY_STATISTIC - Invalid data size %lu",  v263,  v264,  v265,  v266,  v267,  v268,  v269,  v211);
        v270 = (os_log_s *)sub_100086554(0x54u);
        if (os_log_type_enabled(v270, OS_LOG_TYPE_ERROR)) {
          goto LABEL_719;
        }
      }

      goto LABEL_757;
    case 0x8F:
      if (!off_1008E2838) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        __int16 v212 = ((uint64_t (*)(void, void))off_1008E2838)( *(void *)a1 + *(unsigned __int16 *)(a1 + 12),  0LL);
      }

      else
      {
        __int16 v212 = ((uint64_t (*)(uint64_t, void))off_1008E2838)( v8 + (unsigned __int16)v9,  (v6 - v9));
      }

      unsigned __int16 v271 = *v5 + v212;
      *uint64_t v5 = v271;
      if (*v2)
      {
LABEL_499:
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_757;
      }

      if (*(unsigned __int16 *)(a1 + 10) != v271) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1586,  "ByteStream_NumReadBytesAvail(*pBs) == 0");
      }
      return;
    case 0x99:
      v155 = (void (*)(uint64_t, uint64_t))qword_1008E28D8;
      if (!qword_1008E28D8) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unsigned __int8 v173 = 0;
        uint64_t v8 = *(void *)a1;
        LOWORD(v9) = *(_WORD *)(a1 + 12);
        v155 = (void (*)(uint64_t, uint64_t))qword_1008E28D8;
      }

      else
      {
LABEL_450:
        unsigned __int8 v173 = v6 - v9;
      }

LABEL_451:
      uint64_t v189 = v8 + (unsigned __int16)v9;
      a2 = v173;
      goto LABEL_461;
    case 0x9A:
      v174 = (void (*)(uint64_t))qword_1008E28F8;
      if (qword_1008E28F8) {
        goto LABEL_396;
      }
      goto LABEL_757;
    case 0x9B:
      v174 = (void (*)(uint64_t))qword_1008E28E0;
      if (!qword_1008E28E0) {
        goto LABEL_757;
      }
LABEL_396:
      uint64_t v213 = v8 + (unsigned __int16)v9;
LABEL_397:
      v174(v213);
      goto LABEL_757;
    case 0x9D:
      v155 = (void (*)(uint64_t, uint64_t))qword_1008E2858;
      if (!qword_1008E2858) {
        goto LABEL_757;
      }
      uint64_t v189 = v8 + (unsigned __int16)v9;
      goto LABEL_461;
    case 0x9E:
      if (v6 <= (unsigned __int16)v9) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1961,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      }
      uint64_t v190 = v4 + 2;
      *uint64_t v5 = v4 + 2;
      switch(*(_BYTE *)(v8 + v9))
      {
        case 0:
          if (!qword_1008E2928) {
            goto LABEL_757;
          }
          size[0] = 0LL;
          size[1] = 0LL;
          LOWORD(ptr[0]) = 0;
          if (*(_BYTE *)(a1 + 14) != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1969,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          if (*v2)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v191 = *(unsigned __int8 *)(a1 + 14);
            *(_BYTE *)(a1 + 15) = 1;
            if (v191 != 1) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1970,  "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
            goto LABEL_731;
          }

          if ((int)v6 - (int)v190 <= 1)
          {
            _BYTE *v2 = 1;
LABEL_731:
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            goto LABEL_732;
          }

          LOWORD(size[0]) = *(_WORD *)(*(void *)a1 + v190);
          *(_WORD *)(a1 + 12) = v4 + 4;
          if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 4) >= 6)
          {
            sub_1001F0050((uint64_t)size + 2, *(void *)a1 + (unsigned __int16)(v4 + 4), 6uLL);
            *(_WORD *)(a1 + 12) += 6;
            goto LABEL_733;
          }

LABEL_732:
          _BYTE *v2 = 1;
LABEL_733:
          if (*(_BYTE *)(a1 + 14) != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1971,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          if (*v2)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v367 = *(unsigned __int8 *)(a1 + 14);
            *(_BYTE *)(a1 + 15) = 1;
            if (v367 != 1) {
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1972,  "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
          }

          else
          {
            uint64_t v368 = *(unsigned __int16 *)(a1 + 12);
            if (*(unsigned __int16 *)(a1 + 10) > v368)
            {
              uint64_t v369 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v368 + 1;
              LOBYTE(size[1]) = *(_BYTE *)(v369 + v368);
              if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v368 + 1))
              {
                uint64_t v370 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v368 + 2;
                BYTE1(size[1]) = *(_BYTE *)(v370 + (unsigned __int16)(v368 + 1));
                if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v368 + 2))
                {
                  uint64_t v371 = *(void *)a1;
                  *(_WORD *)(a1 + 12) = v368 + 3;
                  BYTE2(size[1]) = *(_BYTE *)(v371 + (unsigned __int16)(v368 + 2));
                  if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v368 + 3))
                  {
                    uint64_t v372 = *(void *)a1;
                    *(_WORD *)(a1 + 12) = v368 + 4;
                    BYTE3(size[1]) = *(_BYTE *)(v372 + (unsigned __int16)(v368 + 3));
                    if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v368 + 4) > 1)
                    {
                      uint64_t v373 = (unsigned __int16)(v368 + 4);
                      WORD2(size[1]) = *(_WORD *)(*(void *)a1 + v373);
                      *(_WORD *)(a1 + 12) = v368 + 6;
                      if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v368 + 6) > 1)
                      {
                        HIWORD(size[1]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v368 + 6));
                        unsigned __int16 v374 = v368 + 8;
                        *(_WORD *)(a1 + 12) = v373 + 4;
                        if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v373 + 4))
                        {
                          uint64_t v375 = *(void *)a1;
                          unsigned __int16 v376 = v373 + 5;
                          *(_WORD *)(a1 + 12) = v376;
                          LOBYTE(ptr[0]) = *(_BYTE *)(v375 + v374);
                          if (*(unsigned __int16 *)(a1 + 10) > v376)
                          {
                            uint64_t v377 = *(void *)a1;
                            *(_WORD *)(a1 + 12) = v376 + 1;
                            BYTE1(ptr[0]) = *(_BYTE *)(v377 + v376);
LABEL_755:
                            v307 = (void (*)(size_t *))qword_1008E2928;
                            goto LABEL_756;
                          }

LABEL_754:
                          _BYTE *v2 = 1;
                          goto LABEL_755;
                        }

                        _BYTE *v2 = 1;
LABEL_753:
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        goto LABEL_754;
                      }

                      _BYTE *v2 = 1;
LABEL_752:
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v383 = *(unsigned __int8 *)(a1 + 14);
                      *(_BYTE *)(a1 + 15) = 1;
                      if (v383 != 1) {
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1978,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                      }
                      goto LABEL_753;
                    }

                    _BYTE *v2 = 1;
LABEL_751:
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v382 = *(unsigned __int8 *)(a1 + 14);
                    *(_BYTE *)(a1 + 15) = 1;
                    if (v382 != 1) {
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1977,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    goto LABEL_752;
                  }

                  _BYTE *v2 = 1;
LABEL_750:
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v381 = *(unsigned __int8 *)(a1 + 14);
                  *(_BYTE *)(a1 + 15) = 1;
                  if (v381 != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1976,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_751;
                }

                _BYTE *v2 = 1;
LABEL_749:
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v380 = *(unsigned __int8 *)(a1 + 14);
                *(_BYTE *)(a1 + 15) = 1;
                if (v380 != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1975,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                goto LABEL_750;
              }

              _BYTE *v2 = 1;
LABEL_748:
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              int v379 = *(unsigned __int8 *)(a1 + 14);
              *(_BYTE *)(a1 + 15) = 1;
              if (v379 != 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1974,  "(*pBs).__RWFlag == BYTESTREAM_READ");
              }
              goto LABEL_749;
            }

            _BYTE *v2 = 1;
          }

          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v378 = *(unsigned __int8 *)(a1 + 14);
          *(_BYTE *)(a1 + 15) = 1;
          if (v378 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1973,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          goto LABEL_748;
        case 1:
          v307 = (void (*)(size_t *))off_1008E2930;
          if (!off_1008E2930) {
            goto LABEL_757;
          }
          int v422 = 0;
          memset(v421, 0, sizeof(v421));
          __int128 v419 = 0u;
          __int128 v420 = 0u;
          __int128 v417 = 0u;
          __int128 v418 = 0u;
          __int128 v415 = 0u;
          __int128 v416 = 0u;
          __int128 v413 = 0u;
          __int128 v414 = 0u;
          __int128 v411 = 0u;
          __int128 v412 = 0u;
          __int128 v410 = 0u;
          *(_OWORD *)size = 0u;
          memset(ptr, 0, sizeof(ptr));
          if ((int)(v6 - (unsigned __int16)v190) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1993,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 2));
          *uint64_t v5 = v4 + 6;
          if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1994,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 6));
          *uint64_t v5 = v4 + 10;
          if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1995,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 10));
          *uint64_t v5 = v4 + 14;
          if ((int)(v6 - (unsigned __int16)(v4 + 14)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1996,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 14));
          *uint64_t v5 = v4 + 18;
          if ((int)(v6 - (unsigned __int16)(v4 + 18)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1997,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 18));
          *uint64_t v5 = v4 + 22;
          if ((int)(v6 - (unsigned __int16)(v4 + 22)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1998,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 22));
          *uint64_t v5 = v4 + 26;
          if ((int)(v6 - (unsigned __int16)(v4 + 26)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1999,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 26));
          *uint64_t v5 = v4 + 30;
          if ((int)(v6 - (unsigned __int16)(v4 + 30)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2000,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 30));
          *uint64_t v5 = v4 + 34;
          if ((int)(v6 - (unsigned __int16)(v4 + 34)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2001,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 34));
          *uint64_t v5 = v4 + 38;
          if ((int)(v6 - (unsigned __int16)(v4 + 38)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2002,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 38));
          *uint64_t v5 = v4 + 42;
          int v308 = v6 - (unsigned __int16)(v4 + 42);
          if ((v308 & 0x1FFFE) == 0) {
            goto LABEL_756;
          }
          if (v308 <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2006,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 42));
          *uint64_t v5 = v4 + 46;
          if ((int)(v6 - (unsigned __int16)(v4 + 46)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2007,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 46));
          *uint64_t v5 = v4 + 50;
          if ((int)(v6 - (unsigned __int16)(v4 + 50)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2008,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 50));
          *uint64_t v5 = v4 + 54;
          if ((int)(v6 - (unsigned __int16)(v4 + 54)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2009,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 54));
          *uint64_t v5 = v4 + 58;
          if ((int)(v6 - (unsigned __int16)(v4 + 58)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2010,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 58));
          *uint64_t v5 = v4 + 62;
          if ((int)(v6 - (unsigned __int16)(v4 + 62)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2011,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 62));
          *uint64_t v5 = v4 + 66;
          if ((int)(v6 - (unsigned __int16)(v4 + 66)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2012,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 66));
          *uint64_t v5 = v4 + 70;
          if ((int)(v6 - (unsigned __int16)(v4 + 70)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2013,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 70));
          *uint64_t v5 = v4 + 74;
          if ((int)(v6 - (unsigned __int16)(v4 + 74)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2014,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 74));
          *uint64_t v5 = v4 + 78;
          if ((int)(v6 - (unsigned __int16)(v4 + 78)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2016,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 78));
          *uint64_t v5 = v4 + 82;
          if ((int)(v6 - (unsigned __int16)(v4 + 82)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2017,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 82));
          *uint64_t v5 = v4 + 86;
          if ((int)(v6 - (unsigned __int16)(v4 + 86)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2018,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 86));
          *uint64_t v5 = v4 + 90;
          if ((int)(v6 - (unsigned __int16)(v4 + 90)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2019,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 90));
          *uint64_t v5 = v4 + 94;
          if ((int)(v6 - (unsigned __int16)(v4 + 94)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2020,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 94));
          *uint64_t v5 = v4 + 98;
          if ((int)(v6 - (unsigned __int16)(v4 + 98)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2021,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v413) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 98));
          *uint64_t v5 = v4 + 102;
          if ((int)(v6 - (unsigned __int16)(v4 + 102)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2022,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v413) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 102));
          *uint64_t v5 = v4 + 106;
          if ((int)(v6 - (unsigned __int16)(v4 + 106)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2023,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v413) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 106));
          *uint64_t v5 = v4 + 110;
          if ((int)(v6 - (unsigned __int16)(v4 + 110)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2024,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v413) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 110));
          *uint64_t v5 = v4 + 114;
          if ((int)(v6 - (unsigned __int16)(v4 + 114)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2025,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v414) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 114));
          *uint64_t v5 = v4 + 118;
          if ((int)(v6 - (unsigned __int16)(v4 + 118)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2026,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v414) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 118));
          *uint64_t v5 = v4 + 122;
          if ((int)(v6 - (unsigned __int16)(v4 + 122)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2027,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v414) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 122));
          *uint64_t v5 = v4 + 126;
          if ((int)(v6 - (unsigned __int16)(v4 + 126)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2028,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v414) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 126));
          *uint64_t v5 = v4 + 130;
          if ((int)(v6 - (unsigned __int16)(v4 + 130)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2029,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 130));
          *uint64_t v5 = v4 + 134;
          if ((int)(v6 - (unsigned __int16)(v4 + 134)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2030,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 134));
          *uint64_t v5 = v4 + 138;
          if ((int)(v6 - (unsigned __int16)(v4 + 138)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2031,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 138));
          *uint64_t v5 = v4 + 142;
          if ((int)(v6 - (unsigned __int16)(v4 + 142)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2032,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 142));
          *uint64_t v5 = v4 + 146;
          if ((int)(v6 - (unsigned __int16)(v4 + 146)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2033,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v416) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 146));
          *uint64_t v5 = v4 + 150;
          if ((int)(v6 - (unsigned __int16)(v4 + 150)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2034,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v416) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 150));
          *uint64_t v5 = v4 + 154;
          if ((int)(v6 - (unsigned __int16)(v4 + 154)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2035,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v416) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 154));
          *uint64_t v5 = v4 + 158;
          if ((int)(v6 - (unsigned __int16)(v4 + 158)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2036,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v416) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 158));
          *uint64_t v5 = v4 + 162;
          if ((int)(v6 - (unsigned __int16)(v4 + 162)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2037,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v417) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 162));
          *uint64_t v5 = v4 + 166;
          if ((int)(v6 - (unsigned __int16)(v4 + 166)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2038,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v417) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 166));
          *uint64_t v5 = v4 + 170;
          if ((int)(v6 - (unsigned __int16)(v4 + 170)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2039,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v417) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 170));
          *uint64_t v5 = v4 + 174;
          if ((int)(v6 - (unsigned __int16)(v4 + 174)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2040,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          HIDWORD(v417) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 174));
          *uint64_t v5 = v4 + 176;
          if ((int)(v6 - (unsigned __int16)(v4 + 176)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2041,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          LODWORD(v418) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 176));
          *uint64_t v5 = v4 + 178;
          if ((int)(v6 - (unsigned __int16)(v4 + 178)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2042,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD1(v418) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 178));
          *uint64_t v5 = v4 + 180;
          if ((int)(v6 - (unsigned __int16)(v4 + 180)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2043,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD2(v418) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 180));
          *uint64_t v5 = v4 + 182;
          if ((int)(v6 - (unsigned __int16)(v4 + 182)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2044,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v418) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 182));
          *uint64_t v5 = v4 + 186;
          if ((int)(v6 - (unsigned __int16)(v4 + 186)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2045,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v419) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 186));
          *uint64_t v5 = v4 + 190;
          if ((int)(v6 - (unsigned __int16)(v4 + 190)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2046,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD1(v419) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 190));
          *uint64_t v5 = v4 + 192;
          if ((int)(v6 - (unsigned __int16)(v4 + 192)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2047,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD2(v419) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 192));
          *uint64_t v5 = v4 + 194;
          if ((int)(v6 - (unsigned __int16)(v4 + 194)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2048,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          HIDWORD(v419) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 194));
          *uint64_t v5 = v4 + 196;
          if ((int)(v6 - (unsigned __int16)(v4 + 196)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2049,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          LODWORD(v420) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 196));
          *uint64_t v5 = v4 + 198;
          if ((int)(v6 - (unsigned __int16)(v4 + 198)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2050,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v420) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 198));
          *uint64_t v5 = v4 + 202;
          if ((int)(v6 - (unsigned __int16)(v4 + 202)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2051,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v420) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 202));
          *uint64_t v5 = v4 + 206;
          if ((int)(v6 - (unsigned __int16)(v4 + 206)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2052,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v420) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 206));
          *uint64_t v5 = v4 + 210;
          if ((int)(v6 - (unsigned __int16)(v4 + 210)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2053,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[0] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 210));
          *uint64_t v5 = v4 + 214;
          if ((int)(v6 - (unsigned __int16)(v4 + 214)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2054,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[1] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 214));
          *uint64_t v5 = v4 + 218;
          if ((int)(v6 - (unsigned __int16)(v4 + 218)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2055,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[2] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 218));
          *uint64_t v5 = v4 + 222;
          if ((int)(v6 - (unsigned __int16)(v4 + 222)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2056,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[3] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 222));
          *uint64_t v5 = v4 + 226;
          if ((int)(v6 - (unsigned __int16)(v4 + 226)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2057,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[4] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 226));
          *uint64_t v5 = v4 + 230;
          if ((int)(v6 - (unsigned __int16)(v4 + 230)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2058,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[5] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 230));
          *uint64_t v5 = v4 + 234;
          if ((int)(v6 - (unsigned __int16)(v4 + 234)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2059,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[6] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 234));
          *uint64_t v5 = v4 + 238;
          if ((int)(v6 - (unsigned __int16)(v4 + 238)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2060,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v421[7] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 238));
          *uint64_t v5 = v4 + 242;
          if (*v2)
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 242) > 3)
          {
            if (*(_BYTE *)(a1 + 14) == 1)
            {
              int v422 = *(_DWORD *)(*(void *)a1 + (unsigned __int16)(v4 + 242));
              *(_WORD *)(a1 + 12) = v4 + 246;
LABEL_756:
              v307(size);
              goto LABEL_757;
            }

            v393 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1069:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2061,  v393);
          }

          v393 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
          goto LABEL_1069;
        case 2:
          v307 = (void (*)(size_t *))qword_1008E2948;
          if (!qword_1008E2948) {
            goto LABEL_757;
          }
          LODWORD(ptr[2]) = 0;
          if ((int)(v6 - (unsigned __int16)v190) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2098,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 2));
          *uint64_t v5 = v4 + 6;
          if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2099,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 6));
          *uint64_t v5 = v4 + 10;
          if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2100,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 10));
          *uint64_t v5 = v4 + 14;
          if ((int)(v6 - (unsigned __int16)(v4 + 14)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2101,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 14));
          *uint64_t v5 = v4 + 18;
          if ((int)(v6 - (unsigned __int16)(v4 + 18)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2102,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 18));
          *uint64_t v5 = v4 + 22;
          if ((int)(v6 - (unsigned __int16)(v4 + 22)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2103,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 22));
          *uint64_t v5 = v4 + 26;
          if ((int)(v6 - (unsigned __int16)(v4 + 26)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2104,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 26));
          *uint64_t v5 = v4 + 30;
          if ((int)(v6 - (unsigned __int16)(v4 + 30)) <= 3) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2105,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 30));
          *uint64_t v5 = v4 + 34;
          if (v6 <= (unsigned __int16)(v4 + 34)) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2106,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 35;
          LOBYTE(ptr[2]) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 34));
          goto LABEL_756;
        case 3:
          v307 = (void (*)(size_t *))qword_1008E2938;
          if (!qword_1008E2938) {
            goto LABEL_757;
          }
          *(_OWORD *)size = 0u;
          memset(ptr, 0, 28);
          if (v6 <= (unsigned __int16)v190)
          {
            _BYTE *v2 = 1;
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            *uint64_t v5 = v4 + 3;
            LOBYTE(size[0]) = *(_BYTE *)(v8 + (unsigned __int16)(v4 + 2));
            if ((int)v6 - ((int)v4 + 3) > 3)
            {
              HIDWORD(size[0]) = *(_DWORD *)(v8 + v4 + 3);
              *uint64_t v5 = v4 + 7;
              if ((int)(v6 - (unsigned __int16)(v4 + 7)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2079,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 7));
              *uint64_t v5 = v4 + 11;
              if ((int)(v6 - (unsigned __int16)(v4 + 11)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2080,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 11));
              *uint64_t v5 = v4 + 15;
              if ((int)(v6 - (unsigned __int16)(v4 + 15)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2081,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 15));
              *uint64_t v5 = v4 + 19;
              if ((int)(v6 - (unsigned __int16)(v4 + 19)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2082,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 19));
              *uint64_t v5 = v4 + 23;
              if ((int)(v6 - (unsigned __int16)(v4 + 23)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2083,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 23));
              *uint64_t v5 = v4 + 27;
              if ((int)(v6 - (unsigned __int16)(v4 + 27)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2084,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 27));
              *uint64_t v5 = v4 + 31;
              if ((int)(v6 - (unsigned __int16)(v4 + 31)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2085,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 31));
              *uint64_t v5 = v4 + 35;
              if ((int)(v6 - (unsigned __int16)(v4 + 35)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2086,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 35));
              *uint64_t v5 = v4 + 39;
              if ((int)(v6 - (unsigned __int16)(v4 + 39)) <= 3) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2087,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 39));
              *uint64_t v5 = v4 + 43;
              goto LABEL_756;
            }
          }

          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2078,  "ByteStream_NumReadBytesAvail(*pBs) >= 4");
        default:
          goto LABEL_757;
      }

    case 0x9F:
      v168 = (void (*)(void))qword_1008E28E8;
      if (!qword_1008E28E8) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if (v6 > (unsigned __int16)v9)
      {
LABEL_401:
        *uint64_t v5 = v4 + 2;
        v168(*(unsigned __int8 *)(v8 + v9));
        goto LABEL_757;
      }

      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1918,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    case 0xA2:
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1549,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v214 = *(_WORD *)(v8 + v4 + 2);
        *uint64_t v5 = v4 + 4;
        if ((int)(v6 - (unsigned __int16)(v4 + 4)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1550,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v215 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 4));
        *uint64_t v5 = v4 + 6;
        if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1551,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v216 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 6));
        *uint64_t v5 = v4 + 8;
        if ((int)(v6 - (unsigned __int16)(v4 + 8)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1552,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v217 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 8));
        *uint64_t v5 = v4 + 10;
        if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1553,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        v218 = (unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 10));
        int v219 = *v218;
        int v220 = v218[1];
        *uint64_t v5 = v4 + 12;
        if (off_1008E27F0) {
          off_1008E27F0(v214, v215, v216, v217, v219 | (v220 << 8));
        }
        goto LABEL_757;
      }

      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  1548,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    case 0xA3:
      v192 = off_1008E2970;
      if (!off_1008E2970) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) > 1)
        {
          uint64_t v193 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v194 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          if ((int)(v6 - (unsigned __int16)(v4 + 4)) <= 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2270,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          unsigned __int16 v195 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 4));
          *uint64_t v5 = v4 + 6;
          if (v6 <= (unsigned __int16)(v4 + 6))
          {
            uint64_t v196 = 0LL;
            _BYTE *v2 = 1;
            *(_OWORD *)size = 0u;
            memset(ptr, 0, 24);
          }

          else
          {
            *uint64_t v5 = v4 + 7;
            uint64_t v196 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 6));
            *(_OWORD *)size = 0u;
            memset(ptr, 0, 24);
            if (v196)
            {
              unsigned __int16 v396 = v194;
              unsigned int v398 = v193;
              v197 = size;
              uint64_t v198 = v196;
              while (1)
              {
                *(_WORD *)&buf[4] = 0;
                *(_DWORD *)buf = 0;
                if (*(_BYTE *)(a1 + 14) != 1) {
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2277,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2) {
                  break;
                }
                uint64_t v200 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v200)
                {
                  _BYTE *v2 = 1;
LABEL_370:
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  unsigned __int8 v205 = 0;
LABEL_371:
                  _BYTE *v2 = 1;
                  goto LABEL_372;
                }

                uint64_t v201 = *(void *)a1;
                uint64_t v202 = v200 + 1;
                *(_WORD *)(a1 + 12) = v200 + 1;
                unsigned __int8 v203 = *(_BYTE *)(v201 + v200);
                int v204 = v203;
                if (v203 == 3) {
                  unsigned __int8 v203 = 1;
                }
                if (v204 == 2) {
                  unsigned __int8 v205 = 0;
                }
                else {
                  unsigned __int8 v205 = v203;
                }
                sub_1001F0050((uint64_t)buf, *(void *)a1 + v202, 6uLL);
                *(_WORD *)(a1 + 12) += 6;
LABEL_372:
                *v197++ = ((unint64_t)v205 << 48) | ((unint64_t)buf[0] << 40) | ((unint64_t)buf[1] << 32) | ((unint64_t)buf[2] << 24) | ((unint64_t)buf[3] << 16) | ((unint64_t)buf[4] << 8) | buf[5];
                if (!--v198)
                {
                  ((void (*)(void, void, void, uint64_t, size_t *))off_1008E2970)( v398,  v195,  v396,  v196,  size);
                  goto LABEL_757;
                }
              }

              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              int v199 = *(unsigned __int8 *)(a1 + 14);
              *(_BYTE *)(a1 + 15) = 1;
              if (v199 != 1) {
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2285,  "(*pBs).__RWFlag == BYTESTREAM_READ");
              }
              goto LABEL_370;
            }
          }

          ((void (*)(uint64_t, void, void, uint64_t, size_t *))v192)(v193, v195, v194, v196, size);
          goto LABEL_757;
        }

LABEL_911:
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2269,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }

      _BYTE *v2 = 1;
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      goto LABEL_911;
    default:
      if (v10 != 175) {
        goto LABEL_757;
      }
      if (*v2)
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unsigned __int16 v47 = 0;
      }

      else
      {
        unsigned __int16 v47 = v6 - v9;
      }

      v155 = (void (*)(uint64_t, uint64_t))qword_1008E2868;
      if (!qword_1008E2868) {
        goto LABEL_757;
      }
      uint64_t v189 = *(void *)a1 + *(unsigned __int16 *)(a1 + 12);
      a2 = v47;
LABEL_461:
      v155(v189, a2);
      goto LABEL_757;
  }

uint64_t sub_1001507CC(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t v8 = 0LL;
  uint64_t result = sub_10018BCDC(&v7);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v8))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(_BYTE *)(v7 + WORD2(v8)) = 5;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(_BYTE *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10018BD78(226, v7, BYTE4(v8), a1, (uint64_t)sub_10013A61C, v3, v4, v5);
      }

      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2618, v6);
    }

    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001508D0(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 11;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2586, v11);
        }

        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      unsigned int v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2585, v10);
    }

    unsigned int v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100150A50(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t v8 = 0LL;
  uint64_t result = sub_10018BCDC(&v7);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v8))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(_BYTE *)(v7 + WORD2(v8)) = 10;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(_BYTE *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10018BD78(226, v7, BYTE4(v8), a1, (uint64_t)sub_10013A61C, v3, v4, v5);
      }

      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2604, v6);
    }

    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100150B54(_WORD *a1, char a2, char a3, uint64_t a4)
{
  uint64_t v22 = 0LL;
  uint64_t v23 = 0LL;
  if (!sub_10018BCDC(&v22))
  {
    if (HIBYTE(v23))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v23) - WORD2(v23) > 3)
    {
      if (BYTE6(v23) == 2)
      {
        *(_BYTE *)(v22 + WORD2(v23)) = 9;
        *(_WORD *)(v22 + WORD2(v23) + 1) = 0;
        *(_BYTE *)(v22 + WORD2(v23) + 3) = 0;
        unsigned __int16 v12 = WORD2(v23) + 4;
        WORD2(v23) += 4;
        if (HIBYTE(v23))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v23) - v12 > 3)
        {
          if (BYTE6(v23) == 2)
          {
            *(_DWORD *)(v22 + v12) = 0;
            unsigned __int16 v13 = WORD2(v23) + 4;
            WORD2(v23) += 4;
            if (HIBYTE(v23))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v23) > v13)
            {
              if (BYTE6(v23) == 2)
              {
                *(_BYTE *)(v22 + v13) = 0;
                __int16 v14 = WORD2(v23);
                unsigned __int16 v15 = ++WORD2(v23);
                if (HIBYTE(v23))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v23) > v15)
                {
                  if (BYTE6(v23) == 2)
                  {
                    WORD2(v23) = v14 + 2;
                    *(_BYTE *)(v22 + v15) = a3 | (16 * a2);
                    if (HIBYTE(v23))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v23) - WORD2(v23) > 1)
                    {
                      if (BYTE6(v23) == 2)
                      {
                        *(_WORD *)(v22 + WORD2(v23)) = *a1;
                        unsigned __int8 v11 = BYTE4(v23) + 2;
                        WORD2(v23) += 2;
                        return sub_10018BD78(226, v22, v11, a4, (uint64_t)sub_10013A594, v8, v9, v10);
                      }

                      __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2635,  v21);
                    }

                    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_39;
                  }

                  uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2634,  v20);
                }

                uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_35;
              }

              uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2633,  v19);
            }

            uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
            goto LABEL_31;
          }

          uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2632, v18);
        }

        uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= (4)";
        goto LABEL_27;
      }

      uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2631, v17);
    }

    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_23;
  }

  unsigned __int8 v11 = BYTE4(v23);
  return sub_10018BD78(226, v22, v11, a4, (uint64_t)sub_10013A594, v8, v9, v10);
}

uint64_t sub_100150E84(_BYTE *a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  if (!sub_10018BCDC(&v16))
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(_BYTE *)(v16 + WORD2(v17)) = 43;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(_BYTE *)(v16 + WORD2(v17) + 3) = 0;
        unsigned __int16 v9 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v17) - v9 > 1)
        {
          if (BYTE6(v17) == 2)
          {
            *(_BYTE *)(v16 + v9) = *a1;
            *(_BYTE *)(v16 + WORD2(v17) + 1) = a1[1];
            __int16 v10 = WORD2(v17);
            unsigned __int16 v11 = WORD2(v17) + 2;
            WORD2(v17) += 2;
            if (HIBYTE(v17))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v17) > v11)
            {
              if (BYTE6(v17) == 2)
              {
                WORD2(v17) = v10 + 3;
                *(_BYTE *)(v16 + v11) = a2;
                return sub_10018BD78(226, v16, BYTE4(v17), a3, (uint64_t)sub_10013A594, v6, v7, v8);
              }

              unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2651,  v15);
            }

            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2650, v14);
        }

        __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }

      unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2649, v13);
    }

    unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return sub_10018BD78(226, v16, BYTE4(v17), a3, (uint64_t)sub_10013A594, v6, v7, v8);
}

uint64_t sub_1001510A8(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 15;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2666, v11);
        }

        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2665, v10);
    }

    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100151228(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 16;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2681, v11);
        }

        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2680, v10);
    }

    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_1001513A8(char a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(_BYTE *)(v14 + WORD2(v15)) = 25;
        *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
        *(_BYTE *)(v14 + WORD2(v15) + 3) = 0;
        __int16 v8 = WORD2(v15);
        unsigned __int16 v9 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v9)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v8 + 5;
            *(_BYTE *)(v14 + v9) = a1;
            if (HIBYTE(v15))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v15) - WORD2(v15) > 2)
            {
              if (BYTE6(v15) == 2)
              {
                uint64_t v10 = v14 + WORD2(v15);
                *(_BYTE *)(v10 + 2) = 0;
                *(_WORD *)uint64_t v10 = 0;
                WORD2(v15) += 3;
                return sub_10018BD78(226, v14, BYTE4(v15), a2, (uint64_t)sub_10013A594, v5, v6, v7);
              }

              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2697,  v13);
            }

            uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_24;
          }

          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2696, v12);
        }

        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }

      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2695, v11);
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_1001515B0(_BYTE *a1, char a2, uint64_t a3)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(_BYTE *)(v18 + v10) = 20;
          if (HIBYTE(v19))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v19) - WORD2(v19) > 1)
          {
            if (BYTE6(v19) == 2)
            {
              *(_WORD *)(v18 + WORD2(v19)) = 0;
              unsigned __int16 v11 = WORD2(v19) + 2;
              WORD2(v19) += 2;
              if (HIBYTE(v19))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v19) - v11 > 1)
              {
                if (BYTE6(v19) == 2)
                {
                  *(_BYTE *)(v18 + v11 + 1) = *a1;
                  *(_BYTE *)(v18 + WORD2(v19)) = a1[1];
                  __int16 v12 = WORD2(v19);
                  unsigned __int16 v13 = WORD2(v19) + 2;
                  WORD2(v19) += 2;
                  if (HIBYTE(v19))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v19) > v13)
                  {
                    if (BYTE6(v19) == 2)
                    {
                      WORD2(v19) = v12 + 3;
                      *(_BYTE *)(v18 + v13) = a2;
                      return sub_10018BD78(226, v18, BYTE4(v19), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                    }

                    uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2717,  v17);
                  }

                  uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }

                uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2716,  v16);
              }

              uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_27;
            }

            uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2714,  v15);
          }

          uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= (2)";
          goto LABEL_23;
        }

        uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2713, v14);
      }
    }

    uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100151818(unsigned int a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (a1 > 3) {
    return 101LL;
  }
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(_BYTE *)(v14 + WORD2(v15)) = 0;
        *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
        *(_BYTE *)(v14 + WORD2(v15) + 3) = 0;
        __int16 v8 = WORD2(v15);
        unsigned __int16 v9 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v9)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v8 + 5;
            *(_BYTE *)(v14 + v9) = a1;
            if (HIBYTE(v15))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v15) - WORD2(v15) > 2)
            {
              if (BYTE6(v15) == 2)
              {
                uint64_t v10 = v14 + WORD2(v15);
                *(_BYTE *)(v10 + 2) = 0;
                *(_WORD *)uint64_t v10 = 0;
                WORD2(v15) += 3;
                return sub_10018BD78(226, v14, BYTE4(v15), a2, (uint64_t)sub_10013A594, v5, v6, v7);
              }

              unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2737,  v13);
            }

            unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_26;
          }

          __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2736, v12);
        }

        __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_22;
      }

      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_18:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2735, v11);
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_18;
  }

  return result;
}

uint64_t sub_100151A2C(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 14;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2887, v11);
        }

        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2886, v10);
    }

    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100151BAC(int a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(_BYTE *)(v11 + WORD2(v12)) = 30;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(_BYTE *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(_BYTE *)(v11 + v8) = a1;
            *(_BYTE *)(v11 + WORD2(v12) + 1) = BYTE1(a1);
            *(_BYTE *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
            *(_BYTE *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
            WORD2(v12) += 4;
            return sub_10018BD78(226, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2901, v10);
        }

        uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }

      unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2900, v9);
    }

    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100151D70(int a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(_BYTE *)(v11 + WORD2(v12)) = 4;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(_BYTE *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(_BYTE *)(v11 + v8) = a1;
            *(_BYTE *)(v11 + WORD2(v12) + 1) = BYTE1(a1);
            *(_BYTE *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
            *(_BYTE *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
            WORD2(v12) += 4;
            return sub_10018BD78(226, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2916, v10);
        }

        uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }

      unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2915, v9);
    }

    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100151F34(int a1, int a2, uint64_t a3)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(_BYTE *)(v15 + WORD2(v16)) = 31;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(_BYTE *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v10 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v16) - v10 > 3)
        {
          if (BYTE6(v16) == 2)
          {
            *(_BYTE *)(v15 + v10) = a1;
            *(_BYTE *)(v15 + WORD2(v16) + 1) = BYTE1(a1);
            *(_BYTE *)(v15 + WORD2(v16) + 2) = BYTE2(a1);
            *(_BYTE *)(v15 + WORD2(v16) + 3) = HIBYTE(a1);
            unsigned __int16 v11 = WORD2(v16) + 4;
            WORD2(v16) += 4;
            if (HIBYTE(v16))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v16) - v11 > 3)
            {
              if (BYTE6(v16) == 2)
              {
                *(_BYTE *)(v15 + v11) = a2;
                *(_BYTE *)(v15 + WORD2(v16) + 1) = BYTE1(a2);
                *(_BYTE *)(v15 + WORD2(v16) + 2) = BYTE2(a2);
                *(_BYTE *)(v15 + WORD2(v16) + 3) = HIBYTE(a2);
                WORD2(v16) += 4;
                return sub_10018BD78(226, v15, BYTE4(v16), a3, (uint64_t)sub_10013A594, v7, v8, v9);
              }

              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2931,  v14);
            }

            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_24;
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2930, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_20;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2929, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_1001521C0(_BYTE *a1, __int16 a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6)
{
  uint64_t v27 = 0LL;
  uint64_t v28 = 0LL;
  uint64_t result = sub_10018BCDC(&v27);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v28))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v28) - WORD2(v28) > 3)
    {
      if (BYTE6(v28) == 2)
      {
        *(_BYTE *)(v27 + WORD2(v28)) = 33;
        *(_WORD *)(v27 + WORD2(v28) + 1) = 0;
        *(_BYTE *)(v27 + WORD2(v28) + 3) = 0;
        unsigned __int16 v16 = WORD2(v28) + 4;
        WORD2(v28) += 4;
        if (HIBYTE(v28))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v28) - v16 > 1)
        {
          if (BYTE6(v28) == 2)
          {
            *(_BYTE *)(v27 + v16) = *a1;
            *(_BYTE *)(v27 + WORD2(v28) + 1) = a1[1];
            unsigned __int16 v17 = WORD2(v28) + 2;
            WORD2(v28) += 2;
            if (HIBYTE(v28))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v28) - v17 > 1)
            {
              if (BYTE6(v28) == 2)
              {
                *(_BYTE *)(v27 + v17) = a2;
                *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a2);
                unsigned __int16 v18 = WORD2(v28) + 2;
                WORD2(v28) += 2;
                if (HIBYTE(v28))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v28) - v18 > 1)
                {
                  if (BYTE6(v28) == 2)
                  {
                    *(_BYTE *)(v27 + v18) = a3;
                    *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a3);
                    unsigned __int16 v19 = WORD2(v28) + 2;
                    WORD2(v28) += 2;
                    if (HIBYTE(v28))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v28) - v19 > 1)
                    {
                      if (BYTE6(v28) == 2)
                      {
                        *(_BYTE *)(v27 + v19) = a4;
                        *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a4);
                        unsigned __int16 v20 = WORD2(v28) + 2;
                        WORD2(v28) += 2;
                        if (HIBYTE(v28))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v28) - v20 > 1)
                        {
                          if (BYTE6(v28) == 2)
                          {
                            *(_BYTE *)(v27 + v20) = a5;
                            *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a5);
                            WORD2(v28) += 2;
                            return sub_10018BD78(226, v27, BYTE4(v28), a6, (uint64_t)sub_10013A594, v13, v14, v15);
                          }

                          uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2950,  v26);
                        }

                        uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_45;
                      }

                      unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2949,  v25);
                    }

                    unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_41;
                  }

                  uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2948,  v24);
                }

                uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_37;
              }

              uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2947,  v23);
            }

            uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }

          uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2946, v22);
        }

        uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_29;
      }

      __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2945, v21);
    }

    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_1001525D0(__int16 a1, __int16 a2, __int16 a3, __int16 a4, uint64_t a5)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v24) - WORD2(v24) > 3)
    {
      if (BYTE6(v24) == 2)
      {
        *(_BYTE *)(v23 + WORD2(v24)) = 34;
        *(_WORD *)(v23 + WORD2(v24) + 1) = 0;
        *(_BYTE *)(v23 + WORD2(v24) + 3) = 0;
        unsigned __int16 v14 = WORD2(v24) + 4;
        WORD2(v24) += 4;
        if (HIBYTE(v24))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v24) - v14 > 1)
        {
          if (BYTE6(v24) == 2)
          {
            *(_BYTE *)(v23 + v14) = a1;
            *(_BYTE *)(v23 + WORD2(v24) + 1) = HIBYTE(a1);
            unsigned __int16 v15 = WORD2(v24) + 2;
            WORD2(v24) += 2;
            if (HIBYTE(v24))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v24) - v15 > 1)
            {
              if (BYTE6(v24) == 2)
              {
                *(_BYTE *)(v23 + v15) = a2;
                *(_BYTE *)(v23 + WORD2(v24) + 1) = HIBYTE(a2);
                unsigned __int16 v16 = WORD2(v24) + 2;
                WORD2(v24) += 2;
                if (HIBYTE(v24))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v24) - v16 > 1)
                {
                  if (BYTE6(v24) == 2)
                  {
                    *(_BYTE *)(v23 + v16) = a3;
                    *(_BYTE *)(v23 + WORD2(v24) + 1) = HIBYTE(a3);
                    unsigned __int16 v17 = WORD2(v24) + 2;
                    WORD2(v24) += 2;
                    if (HIBYTE(v24))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v24) - v17 > 1)
                    {
                      if (BYTE6(v24) == 2)
                      {
                        *(_BYTE *)(v23 + v17) = a4;
                        *(_BYTE *)(v23 + WORD2(v24) + 1) = HIBYTE(a4);
                        WORD2(v24) += 2;
                        return sub_10018BD78(226, v23, BYTE4(v24), a5, (uint64_t)sub_10013A594, v11, v12, v13);
                      }

                      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2968,  v22);
                    }

                    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_38;
                  }

                  __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2967,  v21);
                }

                __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_34;
              }

              unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2966,  v20);
            }

            unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_30;
          }

          unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2965, v19);
        }

        unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_26;
      }

      unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2964, v18);
    }

    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_100152944(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t v8 = 0LL;
  uint64_t result = sub_10018BCDC(&v7);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v8))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(_BYTE *)(v7 + WORD2(v8)) = 35;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(_BYTE *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10018BD78(226, v7, BYTE4(v8), a1, (uint64_t)sub_10013A594, v3, v4, v5);
      }

      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2982, v6);
    }

    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100152A48(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 37;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2996, v11);
        }

        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2995, v10);
    }

    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100152BC8(char a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(_BYTE *)(v16 + WORD2(v17)) = 38;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(_BYTE *)(v16 + WORD2(v17) + 3) = 0;
        __int16 v10 = WORD2(v17);
        unsigned __int16 v11 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v17) > v11)
        {
          if (BYTE6(v17) == 2)
          {
            WORD2(v17) = v10 + 5;
            *(_BYTE *)(v16 + v11) = a1;
            if (HIBYTE(v17))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v12 = WORD2(v17);
              if (WORD1(v17) > WORD2(v17))
              {
                if (BYTE6(v17) == 2)
                {
                  ++WORD2(v17);
                  *(_BYTE *)(v16 + v12) = a2;
                  return sub_10018BD78(226, v16, BYTE4(v17), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                }

                unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3012,  v15);
              }
            }

            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3011, v14);
        }

        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }

      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3010, v13);
    }

    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100152DCC(char a1, char a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6)
{
  uint64_t v25 = 0LL;
  uint64_t v26 = 0LL;
  uint64_t result = sub_10018BCDC(&v25);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v26))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v16 = WORD2(v26);
      if (WORD1(v26) > WORD2(v26))
      {
        if (BYTE6(v26) == 2)
        {
          ++WORD2(v26);
          *(_BYTE *)(v25 + v16) = a1;
          if (HIBYTE(v26))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v17 = WORD2(v26);
            if (WORD1(v26) > WORD2(v26))
            {
              if (BYTE6(v26) == 2)
              {
                ++WORD2(v26);
                *(_BYTE *)(v25 + v17) = a2;
                if (HIBYTE(v26))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v26) - WORD2(v26) > 1)
                {
                  if (BYTE6(v26) == 2)
                  {
                    *(_WORD *)(v25 + WORD2(v26)) = a4;
                    unsigned __int16 v18 = WORD2(v26) + 2;
                    WORD2(v26) += 2;
                    if (HIBYTE(v26))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v26) - v18 > 1)
                    {
                      if (BYTE6(v26) == 2)
                      {
                        *(_BYTE *)(v25 + v18) = a5;
                        *(_BYTE *)(v25 + WORD2(v26) + 1) = HIBYTE(a5);
                        unsigned __int16 v19 = WORD2(v26) + 2;
                        WORD2(v26) += 2;
                        if (HIBYTE(v26))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v26) - v19 > 1)
                        {
                          if (BYTE6(v26) == 2)
                          {
                            *(_BYTE *)(v25 + v19) = a3;
                            *(_BYTE *)(v25 + WORD2(v26) + 1) = HIBYTE(a3);
                            WORD2(v26) += 2;
                            return sub_10018BD78(517, v25, BYTE4(v26), a6, (uint64_t)sub_10013A594, v13, v14, v15);
                          }

                          uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3029,  v24);
                        }

                        uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_38;
                      }

                      uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3028,  v23);
                    }

                    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_34;
                  }

                  uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3027,  v22);
                }

                uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_30;
              }

              __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3026,  v21);
            }
          }

          __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }

        unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3025, v20);
      }
    }

    unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_1001530EC(char a1, char a2, char a3, char a4, char a5, __int16 a6, __int16 a7, uint64_t a8)
{
  uint64_t v33 = 0LL;
  uint64_t v34 = 0LL;
  uint64_t result = sub_10018BCDC(&v33);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v34))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v20 = WORD2(v34);
      if (WORD1(v34) > WORD2(v34))
      {
        if (BYTE6(v34) == 2)
        {
          ++WORD2(v34);
          *(_BYTE *)(v33 + v20) = a1;
          if (HIBYTE(v34))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v21 = WORD2(v34);
            if (WORD1(v34) > WORD2(v34))
            {
              if (BYTE6(v34) == 2)
              {
                ++WORD2(v34);
                *(_BYTE *)(v33 + v21) = a2;
                if (HIBYTE(v34))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v22 = WORD2(v34);
                  if (WORD1(v34) > WORD2(v34))
                  {
                    if (BYTE6(v34) == 2)
                    {
                      ++WORD2(v34);
                      *(_BYTE *)(v33 + v22) = a3;
                      if (HIBYTE(v34))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v23 = WORD2(v34);
                        if (WORD1(v34) > WORD2(v34))
                        {
                          if (BYTE6(v34) == 2)
                          {
                            ++WORD2(v34);
                            *(_BYTE *)(v33 + v23) = a4;
                            if (HIBYTE(v34))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v24 = WORD2(v34);
                              if (WORD1(v34) > WORD2(v34))
                              {
                                if (BYTE6(v34) == 2)
                                {
                                  ++WORD2(v34);
                                  *(_BYTE *)(v33 + v24) = a5;
                                  if (HIBYTE(v34))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else if (WORD1(v34) - WORD2(v34) > 1)
                                  {
                                    if (BYTE6(v34) == 2)
                                    {
                                      *(_WORD *)(v33 + WORD2(v34)) = a7;
                                      unsigned __int16 v25 = WORD2(v34) + 2;
                                      WORD2(v34) += 2;
                                      if (HIBYTE(v34))
                                      {
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }

                                      else if (WORD1(v34) - v25 > 1)
                                      {
                                        if (BYTE6(v34) == 2)
                                        {
                                          *(_BYTE *)(v33 + v25) = a6;
                                          *(_BYTE *)(v33 + WORD2(v34) + 1) = HIBYTE(a6);
                                          WORD2(v34) += 2;
                                          return sub_10018BD78( 553,  v33,  BYTE4(v34),  a8,  (uint64_t)sub_10013A594,  v17,  v18,  v19);
                                        }

                                        unsigned __int16 v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6107,  v32);
                                      }

                                      unsigned __int16 v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                      goto LABEL_52;
                                    }

                                    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6106,  v31);
                                  }

                                  uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_48;
                                }

                                uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6105,  v30);
                              }
                            }

                            uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_44;
                          }

                          uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6104,  v29);
                        }
                      }

                      uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_40;
                    }

                    uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6103,  v28);
                  }
                }

                uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_36;
              }

              uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6102,  v27);
            }
          }

          uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }

        uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6101, v26);
      }
    }

    uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }

  return result;
}

uint64_t sub_1001534F0( char a1, char a2, unsigned __int8 a3, char *a4, _WORD *a5, _BYTE *a6, char a7, char a8, _BYTE *a9, char a10, uint64_t a11)
{
  uint64_t v46 = 0LL;
  uint64_t v47 = 0LL;
  uint64_t result = sub_10018BCDC(&v46);
  if ((_DWORD)result) {
    return result;
  }
  LOBYTE(v23) = 0;
  int v25 = 3;
  unsigned __int8 v26 = a3;
  do
  {
    LOBYTE(v23) = (v26 & 1) + v23;
    v26 >>= 1;
    --v25;
  }

  while (v25);
  if (HIBYTE(v47))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_55;
  }

  uint64_t v27 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_55:
    unsigned int v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_57;
  }

  if (BYTE6(v47) != 2)
  {
    unsigned int v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6137, v41);
  }

  ++WORD2(v47);
  *(_BYTE *)(v46 + v27) = a1;
  if (HIBYTE(v47))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_59;
  }

  uint64_t v28 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_59:
    uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_61;
  }

  if (BYTE6(v47) != 2)
  {
    uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6138, v42);
  }

  ++WORD2(v47);
  *(_BYTE *)(v46 + v28) = a2;
  if (HIBYTE(v47))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_63;
  }

  uint64_t v29 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_63:
    unsigned __int16 v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_65;
  }

  if (BYTE6(v47) != 2)
  {
    unsigned __int16 v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6139, v43);
  }

  ++WORD2(v47);
  *(_BYTE *)(v46 + v29) = a3;
  if (HIBYTE(v47))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_67;
  }

  uint64_t v30 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_67:
    uint64_t v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_69;
  }

  if (BYTE6(v47) != 2)
  {
    uint64_t v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6140, v44);
  }

  ++WORD2(v47);
  *(_BYTE *)(v46 + v30) = (4 * a10) | a7;
  if (HIBYTE(v47))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_71;
  }

  uint64_t v31 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_71:
    unsigned __int16 v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_73;
  }

  if (BYTE6(v47) != 2)
  {
    unsigned __int16 v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6141, v45);
  }

  ++WORD2(v47);
  *(_BYTE *)(v46 + v31) = a8;
  if ((_BYTE)v23)
  {
    uint64_t v23 = v23;
    while (!HIBYTE(v47))
    {
      uint64_t v32 = WORD2(v47);
      if (BYTE6(v47) != 2)
      {
        uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_41;
      }

      char v33 = *a4;
      ++WORD2(v47);
      *(_BYTE *)(v46 + v32) = v33;
      if (HIBYTE(v47))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_43:
        uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_45:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6145, v38);
      }

      if (WORD1(v47) - WORD2(v47) <= 1) {
        goto LABEL_43;
      }
      if (BYTE6(v47) != 2)
      {
        uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_45;
      }

      *(_WORD *)(v46 + WORD2(v47)) = *a5;
      unsigned __int16 v34 = WORD2(v47) + 2;
      WORD2(v47) += 2;
      if (HIBYTE(v47))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_47:
        unsigned __int16 v39 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_49:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6146, v39);
      }

      if (WORD1(v47) - v34 <= 1) {
        goto LABEL_47;
      }
      if (BYTE6(v47) != 2)
      {
        unsigned __int16 v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_49;
      }

      *(_BYTE *)(v46 + v34) = *a6;
      *(_BYTE *)(v46 + WORD2(v47) + 1) = a6[1];
      unsigned __int16 v35 = WORD2(v47) + 2;
      WORD2(v47) += 2;
      if (HIBYTE(v47))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_51:
        BOOL v40 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_53:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6147, v40);
      }

      if (WORD1(v47) - v35 <= 1) {
        goto LABEL_51;
      }
      if (BYTE6(v47) != 2)
      {
        BOOL v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_53;
      }

      *(_BYTE *)(v46 + v35) = *a9;
      *(_BYTE *)(v46 + WORD2(v47) + 1) = a9[1];
      unsigned __int8 v36 = BYTE4(v47) + 2;
      a9 += 2;
      WORD2(v47) += 2;
      a6 += 2;
      ++a5;
      ++a4;
      if (!--v23) {
        return sub_10018BD78(567, v46, v36, a11, (uint64_t)sub_10013A594, v20, v21, v22);
      }
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_39:
    uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_41:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6144, v37);
  }

  unsigned __int8 v36 = BYTE4(v47);
  return sub_10018BD78(567, v46, v36, a11, (uint64_t)sub_10013A594, v20, v21, v22);
}

uint64_t sub_100153A6C(char a1, __int16 a2, char a3, __int16 a4, char a5, uint64_t a6)
{
  uint64_t v28 = 0LL;
  uint64_t v29 = 0LL;
  uint64_t result = sub_10018BCDC(&v28);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v29))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v29) - WORD2(v29) > 3)
    {
      if (BYTE6(v29) == 2)
      {
        *(_BYTE *)(v28 + WORD2(v29)) = 44;
        *(_WORD *)(v28 + WORD2(v29) + 1) = 0;
        *(_BYTE *)(v28 + WORD2(v29) + 3) = 0;
        __int16 v16 = WORD2(v29);
        unsigned __int16 v17 = WORD2(v29) + 4;
        WORD2(v29) += 4;
        if (HIBYTE(v29))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v29) > v17)
        {
          if (BYTE6(v29) == 2)
          {
            WORD2(v29) = v16 + 5;
            *(_BYTE *)(v28 + v17) = a1;
            if (HIBYTE(v29))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v29) - WORD2(v29) > 1)
            {
              if (BYTE6(v29) == 2)
              {
                *(_WORD *)(v28 + WORD2(v29)) = a2;
                __int16 v18 = WORD2(v29);
                unsigned __int16 v19 = WORD2(v29) + 2;
                WORD2(v29) += 2;
                if (HIBYTE(v29))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v29) > v19)
                {
                  if (BYTE6(v29) == 2)
                  {
                    WORD2(v29) = v18 + 3;
                    *(_BYTE *)(v28 + v19) = a3;
                    if (HIBYTE(v29))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v29) - WORD2(v29) > 1)
                    {
                      if (BYTE6(v29) == 2)
                      {
                        *(_WORD *)(v28 + WORD2(v29)) = a4;
                        __int16 v20 = WORD2(v29);
                        unsigned __int16 v21 = WORD2(v29) + 2;
                        WORD2(v29) += 2;
                        if (HIBYTE(v29))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v29) > v21)
                        {
                          if (BYTE6(v29) == 2)
                          {
                            WORD2(v29) = v20 + 3;
                            *(_BYTE *)(v28 + v21) = a5;
                            return sub_10018BD78(226, v28, BYTE4(v29), a6, (uint64_t)sub_10013DC24, v13, v14, v15);
                          }

                          uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6169,  v27);
                        }

                        uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_45;
                      }

                      unsigned __int8 v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6168,  v26);
                    }

                    unsigned __int8 v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_41;
                  }

                  int v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6167,  v25);
                }

                int v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_37;
              }

              uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6166,  v24);
            }

            uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }

          uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6165, v23);
        }

        uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_29;
      }

      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6164, v22);
    }

    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_100153E24(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t v8 = 0LL;
  uint64_t result = sub_10018BCDC(&v7);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v8))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(_BYTE *)(v7 + WORD2(v8)) = 45;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(_BYTE *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10018BD78(226, v7, BYTE4(v8), a1, (uint64_t)sub_10013E054, v3, v4, v5);
      }

      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6184, v6);
    }

    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100153F28(char a1, __int16 a2, uint64_t a3)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(_BYTE *)(v15 + WORD2(v16)) = 46;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(_BYTE *)(v15 + WORD2(v16) + 3) = 0;
        __int16 v10 = WORD2(v16);
        unsigned __int16 v11 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v16) > v11)
        {
          if (BYTE6(v16) == 2)
          {
            WORD2(v16) = v10 + 5;
            *(_BYTE *)(v15 + v11) = a1;
            if (HIBYTE(v16))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v16) - WORD2(v16) > 1)
            {
              if (BYTE6(v16) == 2)
              {
                *(_WORD *)(v15 + WORD2(v16)) = a2;
                WORD2(v16) += 2;
                return sub_10018BD78(226, v15, BYTE4(v16), a3, (uint64_t)sub_10013DC24, v7, v8, v9);
              }

              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6201,  v14);
            }

            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_24;
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6200, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6199, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100154148(char a1, __int16 a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(_BYTE *)(v20 + WORD2(v21)) = 49;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(_BYTE *)(v20 + WORD2(v21) + 3) = 0;
        __int16 v12 = WORD2(v21);
        unsigned __int16 v13 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v21) > v13)
        {
          if (BYTE6(v21) == 2)
          {
            WORD2(v21) = v12 + 5;
            *(_BYTE *)(v20 + v13) = a1;
            if (HIBYTE(v21))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v21) - WORD2(v21) > 1)
            {
              if (BYTE6(v21) == 2)
              {
                *(_WORD *)(v20 + WORD2(v21)) = a2;
                __int16 v14 = WORD2(v21);
                unsigned __int16 v15 = WORD2(v21) + 2;
                WORD2(v21) += 2;
                if (HIBYTE(v21))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v21) > v15)
                {
                  if (BYTE6(v21) == 2)
                  {
                    WORD2(v21) = v14 + 3;
                    *(_BYTE *)(v20 + v15) = a3;
                    return sub_10018BD78(226, v20, BYTE4(v21), a4, (uint64_t)sub_10013DC24, v9, v10, v11);
                  }

                  unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6237,  v19);
                }

                unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }

              __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6236,  v18);
            }

            __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_27;
          }

          unsigned __int16 v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6235, v17);
        }

        unsigned __int16 v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_23;
      }

      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6234, v16);
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_1001543E4(char a1, _BYTE *a2, uint64_t a3)
{
  uint64_t v17 = 0LL;
  uint64_t v18 = 0LL;
  uint64_t result = sub_10018BCDC(&v17);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v18))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v18) - WORD2(v18) > 3)
    {
      if (BYTE6(v18) == 2)
      {
        *(_BYTE *)(v17 + WORD2(v18)) = 48;
        *(_WORD *)(v17 + WORD2(v18) + 1) = 0;
        *(_BYTE *)(v17 + WORD2(v18) + 3) = 0;
        __int16 v10 = WORD2(v18);
        unsigned __int16 v11 = WORD2(v18) + 4;
        WORD2(v18) += 4;
        if (HIBYTE(v18))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v18) > v11)
        {
          if (BYTE6(v18) == 2)
          {
            WORD2(v18) = v10 + 5;
            *(_BYTE *)(v17 + v11) = a1;
            if (HIBYTE(v18))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v18) > WORD2(v18))
            {
              if (BYTE6(v18) == 2)
              {
                *(_BYTE *)(v17 + WORD2(v18)) = 0;
                unsigned __int16 v12 = ++WORD2(v18);
                if (HIBYTE(v18))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v18) - v12 > 1)
                {
                  if (BYTE6(v18) == 2)
                  {
                    *(_BYTE *)(v17 + v12) = *a2;
                    *(_BYTE *)(v17 + WORD2(v18) + 1) = a2[1];
                    WORD2(v18) += 2;
                    return sub_10018BD78(226, v17, BYTE4(v18), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                  }

                  uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2477,  v16);
                }

                uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_31;
              }

              unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2476,  v15);
            }

            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
            goto LABEL_27;
          }

          __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2475, v14);
        }

        __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_23;
      }

      unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2473, v13);
    }

    unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100154684(__int16 a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(_BYTE *)(v20 + WORD2(v21)) = 47;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(_BYTE *)(v20 + WORD2(v21) + 3) = 0;
        unsigned __int16 v12 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v21) - v12 > 1)
        {
          if (BYTE6(v21) == 2)
          {
            *(_BYTE *)(v20 + v12) = a1;
            *(_BYTE *)(v20 + WORD2(v21) + 1) = HIBYTE(a1);
            __int16 v13 = WORD2(v21);
            unsigned __int16 v14 = WORD2(v21) + 2;
            WORD2(v21) += 2;
            if (HIBYTE(v21))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v21) > v14)
            {
              if (BYTE6(v21) == 2)
              {
                WORD2(v21) = v13 + 3;
                *(_BYTE *)(v20 + v14) = a2;
                if (HIBYTE(v21))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v15 = WORD2(v21);
                  if (WORD1(v21) > WORD2(v21))
                  {
                    if (BYTE6(v21) == 2)
                    {
                      ++WORD2(v21);
                      *(_BYTE *)(v20 + v15) = a3;
                      return sub_10018BD78(226, v20, BYTE4(v21), a4, (uint64_t)sub_10013DC24, v9, v10, v11);
                    }

                    unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6219,  v19);
                  }
                }

                unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }

              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6218,  v18);
            }

            uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_27;
          }

          uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6217, v17);
        }

        uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_23;
      }

      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6216, v16);
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100154920(unsigned int a1, unsigned int a2, uint64_t a3)
{
  uint64_t v17 = 0LL;
  uint64_t v18 = 0LL;
  uint64_t result = sub_10018BCDC(&v17);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v18))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v18) - WORD2(v18) > 3)
    {
      if (BYTE6(v18) == 2)
      {
        *(_BYTE *)(v17 + WORD2(v18)) = 50;
        *(_WORD *)(v17 + WORD2(v18) + 1) = 0;
        *(_BYTE *)(v17 + WORD2(v18) + 3) = 0;
        unsigned __int16 v10 = WORD2(v18) + 4;
        WORD2(v18) += 4;
        if (HIBYTE(v18))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v18) - v10 > 3)
        {
          if (BYTE6(v18) == 2)
          {
            double v11 = (double)a1 / 1.25;
            *(_BYTE *)(v17 + v10) = v11;
            *(_BYTE *)(v17 + WORD2(v18) + 1) = (unsigned __int16)v11 >> 8;
            *(_BYTE *)(v17 + WORD2(v18) + 2) = v11 >> 16;
            *(_BYTE *)(v17 + WORD2(v18) + 3) = v11 >> 24;
            unsigned __int16 v12 = WORD2(v18) + 4;
            WORD2(v18) += 4;
            if (HIBYTE(v18))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v18) - v12 > 3)
            {
              if (BYTE6(v18) == 2)
              {
                double v13 = (double)a2 / 1.25;
                *(_BYTE *)(v17 + v12) = v13;
                *(_BYTE *)(v17 + WORD2(v18) + 1) = (unsigned __int16)v13 >> 8;
                *(_BYTE *)(v17 + WORD2(v18) + 2) = v13 >> 16;
                *(_BYTE *)(v17 + WORD2(v18) + 3) = v13 >> 24;
                WORD2(v18) += 4;
                return sub_10018BD78(226, v17, BYTE4(v18), a3, (uint64_t)sub_10013A594, v7, v8, v9);
              }

              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2500,  v16);
            }

            uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_24;
          }

          uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2499, v15);
        }

        uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_20;
      }

      unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2497, v14);
    }

    unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100154BC8(char a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(_BYTE *)(v11 + WORD2(v12)) = 51;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(_BYTE *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(_BYTE *)(v11 + v8) = a1;
            *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
            *(_BYTE *)(v11 + WORD2(v12) + 3) = 0;
            WORD2(v12) += 4;
            return sub_10018BD78(226, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2519, v10);
        }

        unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }

      uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2518, v9);
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100154D80(int a1, _WORD *a2, uint64_t a3)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v19) - WORD2(v19) > 3)
    {
      if (BYTE6(v19) == 2)
      {
        *(_BYTE *)(v18 + WORD2(v19)) = 53;
        *(_WORD *)(v18 + WORD2(v19) + 1) = 0;
        *(_BYTE *)(v18 + WORD2(v19) + 3) = 0;
        __int16 v10 = WORD2(v19);
        unsigned __int16 v11 = WORD2(v19) + 4;
        WORD2(v19) += 4;
        if (HIBYTE(v19))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v19) > v11)
        {
          if (BYTE6(v19) == 2)
          {
            WORD2(v19) = v10 + 5;
            *(_BYTE *)(v18 + v11) = 1;
            if (HIBYTE(v19))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v19) - WORD2(v19) > 1)
            {
              if (BYTE6(v19) == 2)
              {
                *(_WORD *)(v18 + WORD2(v19)) = *a2;
                unsigned __int16 v12 = WORD2(v19) + 2;
                WORD2(v19) += 2;
                if (a1)
                {
                  if (HIBYTE(v19))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v19) - v12 > 3)
                  {
                    if (BYTE6(v19) == 2)
                    {
                      *(_DWORD *)(v18 + v12) = 0;
LABEL_20:
                      WORD2(v19) += 4;
                      return sub_10018BD78(226, v18, BYTE4(v19), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                    }

                    uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2541,  v16);
                  }

                  uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (4)";
                  goto LABEL_37;
                }

                if (HIBYTE(v19))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v19) - v12 > 3)
                {
                  if (BYTE6(v19) == 2)
                  {
                    *(_BYTE *)(v18 + v12) = 0x80;
                    *(_WORD *)(v18 + WORD2(v19) + 1) = 0;
                    *(_BYTE *)(v18 + WORD2(v19) + 3) = 0;
                    goto LABEL_20;
                  }

                  uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2543,  v17);
                }

                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                goto LABEL_41;
              }

              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2538,  v15);
            }

            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }

          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2537, v14);
        }

        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_29;
      }

      double v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2536, v13);
    }

    double v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_1001550D8(uint64_t a1, uint64_t a2)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(_BYTE *)(v15 + WORD2(v16)) = 52;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(_BYTE *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v5 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        v14[0] = BYTE5(a1);
        v14[1] = BYTE4(a1);
        v14[2] = BYTE3(a1);
        v14[3] = BYTE2(a1);
        v14[4] = BYTE1(a1);
        v14[5] = a1;
        if (HIBYTE(v16))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v16) - v5 > 5)
        {
          if (BYTE6(v16) == 2)
          {
            sub_1001F0050(v15 + v5, (uint64_t)v14, 6uLL);
            __int16 v9 = WORD2(v16);
            unsigned __int16 v10 = WORD2(v16) + 6;
            WORD2(v16) += 6;
            if (HIBYTE(v16))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v16) > v10)
            {
              if (BYTE6(v16) == 2)
              {
                WORD2(v16) = v9 + 7;
                *(_BYTE *)(v15 + v10) = BYTE6(a1);
                return sub_10018BD78(226, v15, BYTE4(v16), a2, (uint64_t)sub_10013A594, v6, v7, v8);
              }

              double v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  2566,  v13);
            }

            double v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2565, v12);
        }

        unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
        goto LABEL_20;
      }

      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2562, v11);
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100155310(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 54;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013DC24, v5, v6, v7);
          }

          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6252, v11);
        }

        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6251, v10);
    }

    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100155490(__int16 a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(_BYTE *)(v20 + WORD2(v21)) = 57;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(_BYTE *)(v20 + WORD2(v21) + 3) = 0;
        unsigned __int16 v12 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v21) - v12 > 1)
        {
          if (BYTE6(v21) == 2)
          {
            *(_BYTE *)(v20 + v12) = a1;
            *(_BYTE *)(v20 + WORD2(v21) + 1) = HIBYTE(a1);
            __int16 v13 = WORD2(v21);
            unsigned __int16 v14 = WORD2(v21) + 2;
            WORD2(v21) += 2;
            if (HIBYTE(v21))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v21) > v14)
            {
              if (BYTE6(v21) == 2)
              {
                WORD2(v21) = v13 + 3;
                *(_BYTE *)(v20 + v14) = a2;
                if (HIBYTE(v21))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v15 = WORD2(v21);
                  if (WORD1(v21) > WORD2(v21))
                  {
                    if (BYTE6(v21) == 2)
                    {
                      ++WORD2(v21);
                      *(_BYTE *)(v20 + v15) = a3;
                      return sub_10018BD78(226, v20, BYTE4(v21), a4, (uint64_t)sub_10013DC24, v9, v10, v11);
                    }

                    uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6269,  v19);
                  }
                }

                uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }

              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6268,  v18);
            }

            uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_27;
          }

          uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6267, v17);
        }

        uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_23;
      }

      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6266, v16);
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_10015572C(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(_BYTE *)(v16 + WORD2(v17)) = 64;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(_BYTE *)(v16 + WORD2(v17) + 3) = 0;
        unsigned __int16 v10 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v17) - v10 > 1)
        {
          if (BYTE6(v17) == 2)
          {
            *(_BYTE *)(v16 + v10) = a1;
            *(_BYTE *)(v16 + WORD2(v17) + 1) = HIBYTE(a1);
            __int16 v11 = WORD2(v17);
            unsigned __int16 v12 = WORD2(v17) + 2;
            WORD2(v17) += 2;
            if (HIBYTE(v17))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v17) > v12)
            {
              if (BYTE6(v17) == 2)
              {
                WORD2(v17) = v11 + 3;
                *(_BYTE *)(v16 + v12) = a2;
                return sub_10018BD78(226, v16, BYTE4(v17), a3, (uint64_t)sub_10013DC24, v7, v8, v9);
              }

              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6285,  v15);
            }

            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6284, v14);
        }

        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }

      __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6283, v13);
    }

    __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10015594C(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 66;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013DC24, v5, v6, v7);
          }

          __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6299, v11);
        }

        __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6298, v10);
    }

    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100155ACC(int a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 1;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 3)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              *(_BYTE *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
              *(_BYTE *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
              WORD2(v12) += 4;
              return sub_10018BD78(233, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
            }

            unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3121,  v10);
          }

          unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_17;
        }

        unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3120, v9);
      }
    }

    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100155C58(char a1, uint64_t a2, const void *a3, int a4, uint64_t a5)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v11 = WORD2(v24);
      if (WORD1(v24) > WORD2(v24))
      {
        if (BYTE6(v24) == 2)
        {
          ++WORD2(v24);
          *(_BYTE *)(v23 + v11) = 2;
          uint64_t v12 = v23;
          uint64_t v13 = WORD2(v24);
          if (HIBYTE(v24))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v14 = 0;
          }

          else
          {
            int v14 = WORD1(v24) - WORD2(v24);
          }

          if (v14 < a4)
          {
            uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= (IrkLength)";
          }

          else
          {
            if (BYTE6(v24) == 2)
            {
              memmove((void *)(v12 + v13), a3, a4);
              unsigned __int16 v15 = WORD2(v24) + a4;
              WORD2(v24) += a4;
              if (HIBYTE(v24))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v24) > v15)
              {
                if (BYTE6(v24) == 2)
                {
                  WORD2(v24) = v15 + 1;
                  *(_BYTE *)(v23 + v15) = a1;
                  if (HIBYTE(v24))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v24) - WORD2(v24) > 5)
                  {
                    if (BYTE6(v24) == 2)
                    {
                      sub_1001F0050(v23 + WORD2(v24), a2, 6uLL);
                      WORD2(v24) += 6;
                      return sub_10018BD78(233, v23, BYTE4(v24), a5, (uint64_t)sub_10013A594, v16, v17, v18);
                    }

                    uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3143,  v22);
                  }

                  uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                  goto LABEL_32;
                }

                uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3142,  v21);
              }

              uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_28;
            }

            uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }

          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3141, v20);
        }

        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_21:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3140, v19);
      }
    }

    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_21;
  }

  return result;
}

uint64_t sub_100155EE4(char a1, uint64_t a2, uint64_t a3)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v7 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v7) = 3;
          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v8 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(_BYTE *)(v15 + v8) = a1;
                if (HIBYTE(v16))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    sub_1001F0050(v15 + WORD2(v16), a2, 6uLL);
                    WORD2(v16) += 6;
                    return sub_10018BD78(233, v15, BYTE4(v16), a3, (uint64_t)sub_10013A594, v9, v10, v11);
                  }

                  int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3158,  v14);
                }

                int v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_24;
              }

              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3157,  v13);
            }
          }

          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3156, v12);
      }
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_1001560C4(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 4;
          return sub_10018BD78(233, v8, BYTE4(v9), a1, (uint64_t)sub_10013A594, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3171, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100156190(uint64_t a1)
{
  uint64_t v21 = 0LL;
  uint64_t v22 = 0LL;
  uint64_t result = sub_10018BCDC(&v21);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v22))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v22);
      if (WORD1(v22) > WORD2(v22))
      {
        if (BYTE6(v22) == 2)
        {
          ++WORD2(v22);
          *(_BYTE *)(v21 + v6) = 5;
          if (HIBYTE(v22))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v7 = WORD2(v22);
            if (WORD1(v22) > WORD2(v22))
            {
              if (BYTE6(v22) == 2)
              {
                ++WORD2(v22);
                *(_BYTE *)(v21 + v7) = 0;
                if (HIBYTE(v22))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v22) - WORD2(v22) > 5)
                {
                  if (BYTE6(v22) == 2)
                  {
                    uint64_t v8 = v21 + WORD2(v22);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v22);
                    unsigned __int16 v10 = WORD2(v22) + 6;
                    WORD2(v22) += 6;
                    if (HIBYTE(v22))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v22) > v10)
                    {
                      if (BYTE6(v22) == 2)
                      {
                        WORD2(v22) = v9 + 7;
                        *(_BYTE *)(v21 + v10) = 2;
                        if (HIBYTE(v22))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v11 = WORD2(v22);
                          if (WORD1(v22) > WORD2(v22))
                          {
                            if (BYTE6(v22) == 2)
                            {
                              ++WORD2(v22);
                              *(_BYTE *)(v21 + v11) = 4;
                              if (HIBYTE(v22))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v12 = WORD2(v22);
                                if (WORD1(v22) > WORD2(v22))
                                {
                                  if (BYTE6(v22) == 2)
                                  {
                                    ++WORD2(v22);
                                    *(_BYTE *)(v21 + v12) = 0;
                                    if (HIBYTE(v22))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v22) - WORD2(v22) > 2)
                                    {
                                      if (BYTE6(v22) == 2)
                                      {
                                        uint64_t v13 = v21 + WORD2(v22);
                                        *(_BYTE *)(v13 + 2) = 0;
                                        *(_WORD *)uint64_t v13 = 0;
                                        WORD2(v22) += 3;
                                        return sub_10018BD78( 233,  v21,  BYTE4(v22),  a1,  (uint64_t)sub_10013A594,  v3,  v4,  v5);
                                      }

                                      uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3191,  v20);
                                    }

                                    uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
                                    goto LABEL_52;
                                  }

                                  uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3190,  v19);
                                }
                              }

                              uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_48;
                            }

                            uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3189,  v18);
                          }
                        }

                        uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_44;
                      }

                      uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3188,  v17);
                    }

                    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_40;
                  }

                  uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3187,  v16);
                }

                uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_36;
              }

              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3186,  v15);
            }
          }

          uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }

        int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3185, v14);
      }
    }

    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }

  return result;
}

uint64_t sub_100156554(uint64_t a1)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v6) = 5;
          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v7 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(_BYTE *)(v15 + v7) = 2;
                if (HIBYTE(v16))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    uint64_t v8 = v15 + WORD2(v16);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v16);
                    unsigned __int16 v10 = WORD2(v16) + 6;
                    WORD2(v16) += 6;
                    if (HIBYTE(v16))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v16) > v10)
                    {
                      if (BYTE6(v16) == 2)
                      {
                        WORD2(v16) = v9 + 7;
                        *(_BYTE *)(v15 + v10) = 2;
                        return sub_10018BD78(233, v15, BYTE4(v16), a1, (uint64_t)sub_10013A594, v3, v4, v5);
                      }

                      int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3208,  v14);
                    }

                    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }

                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3207,  v13);
                }

                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_27;
              }

              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3206,  v12);
            }
          }

          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3205, v11);
      }
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_1001567A0(uint64_t a1)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v6) = 7;
          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v7 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(_BYTE *)(v15 + v7) = 2;
                if (HIBYTE(v16))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    uint64_t v8 = v15 + WORD2(v16);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v16);
                    unsigned __int16 v10 = WORD2(v16) + 6;
                    WORD2(v16) += 6;
                    if (HIBYTE(v16))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v16) > v10)
                    {
                      if (BYTE6(v16) == 2)
                      {
                        WORD2(v16) = v9 + 7;
                        *(_BYTE *)(v15 + v10) = 2;
                        return sub_10018BD78(233, v15, BYTE4(v16), a1, (uint64_t)sub_10013A594, v3, v4, v5);
                      }

                      int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3225,  v14);
                    }

                    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }

                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3224,  v13);
                }

                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_27;
              }

              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3223,  v12);
            }
          }

          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3222, v11);
      }
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_1001569EC(uint64_t a1, unsigned int a2, int a3, uint64_t a4)
{
  uint64_t v29 = 0LL;
  uint64_t v30 = 0LL;
  uint64_t result = sub_10018BCDC(&v29);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v30))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_38;
  }

  uint64_t v12 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_38:
    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_40;
  }

  if (BYTE6(v30) != 2)
  {
    uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3239, v23);
  }

  ++WORD2(v30);
  *(_BYTE *)(v29 + v12) = 7;
  if (a3)
  {
    if (HIBYTE(v30))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      unsigned int v13 = WORD2(v30);
      if (WORD1(v30) > WORD2(v30))
      {
        if (BYTE6(v30) == 2)
        {
          char v14 = 0;
          goto LABEL_14;
        }

        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3242, v27);
      }
    }

    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_56;
  }

  if (HIBYTE(v30))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_58;
  }

  unsigned int v13 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_58:
    uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_60;
  }

  if (BYTE6(v30) != 2)
  {
    uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_60:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3244, v28);
  }

  char v14 = 1;
LABEL_14:
  WORD2(v30) = v13 + 1;
  *(_BYTE *)(v29 + v13) = v14;
  if (HIBYTE(v30))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_42;
  }

  if (WORD1(v30) - WORD2(v30) <= 5)
  {
LABEL_42:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_44;
  }

  if (BYTE6(v30) != 2)
  {
    uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3246, v24);
  }

  uint64_t v15 = v29 + WORD2(v30);
  *(_WORD *)(v15 + 4) = 0;
  *(_DWORD *)uint64_t v15 = 0;
  __int16 v16 = WORD2(v30);
  unsigned __int16 v17 = WORD2(v30) + 6;
  WORD2(v30) += 6;
  if (HIBYTE(v30))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_46;
  }

  if (WORD1(v30) <= v17)
  {
LABEL_46:
    int v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_48;
  }

  if (BYTE6(v30) != 2)
  {
    int v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3247, v25);
  }

  WORD2(v30) = v16 + 7;
  *(_BYTE *)(v29 + v17) = 2;
  if (HIBYTE(v30))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_50;
  }

  uint64_t v18 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_50:
    unsigned __int8 v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_52;
  }

  if (BYTE6(v30) != 2)
  {
    unsigned __int8 v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3248, v26);
  }

  ++WORD2(v30);
  *(_BYTE *)(v29 + v18) = 0;
  if (a2 == 2 || a2 == 16 || (sub_1001EE2A0(), a2))
  {
    uint64_t v19 = a2;
    while (!HIBYTE(v30))
    {
      uint64_t v20 = WORD2(v30);
      if (BYTE6(v30) != 2)
      {
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_36;
      }

      char v21 = *(_BYTE *)(a1 - 1 + v19--);
      ++WORD2(v30);
      *(_BYTE *)(v29 + v20) = v21;
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_34:
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_36:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3256, v22);
  }

  return sub_10018BD78(233, v29, BYTE4(v30), a4, (uint64_t)sub_10013A594, v9, v10, v11);
}

uint64_t sub_100156DE0(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 28;
          return sub_10018BD78(233, v8, BYTE4(v9), a1, (uint64_t)sub_10013A61C, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3343, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100156EAC(const void *a1, int a2, char a3, uint64_t a4)
{
  uint64_t v33 = 0LL;
  uint64_t v34 = 0LL;
  uint64_t result = sub_10018BCDC(&v33);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v34))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v9 = WORD2(v34);
      if (WORD1(v34) > WORD2(v34))
      {
        if (BYTE6(v34) == 2)
        {
          ++WORD2(v34);
          *(_BYTE *)(v33 + v9) = 29;
          uint64_t v10 = v33;
          uint64_t v11 = WORD2(v34);
          if (HIBYTE(v34))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v12 = 0;
          }

          else
          {
            int v12 = WORD1(v34) - WORD2(v34);
          }

          if (v12 < a2)
          {
            uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
          }

          else
          {
            if (BYTE6(v34) == 2)
            {
              memmove((void *)(v10 + v11), a1, a2);
              unsigned __int16 v13 = WORD2(v34) + a2;
              WORD2(v34) += a2;
              uint64_t v14 = v33;
              if (HIBYTE(v34))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v15 = 0;
              }

              else
              {
                int v15 = WORD1(v34) - v13;
              }

              int v16 = 21 - a2;
              if (v15 < 21 - a2)
              {
                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
              }

              else
              {
                if (BYTE6(v34) == 2)
                {
                  bzero((void *)(v14 + v13), v16);
                  unsigned __int16 v17 = WORD2(v34) + v16;
                  WORD2(v34) += v16;
                  uint64_t v18 = v33;
                  if (HIBYTE(v34))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v19 = 0;
                  }

                  else
                  {
                    int v19 = WORD1(v34) - v17;
                  }

                  if (v19 < a2)
                  {
                    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                  }

                  else
                  {
                    if (BYTE6(v34) == 2)
                    {
                      memset((void *)(v18 + v17), 255, a2);
                      unsigned __int16 v20 = WORD2(v34) + a2;
                      WORD2(v34) = v20;
                      uint64_t v21 = v33;
                      if (HIBYTE(v34))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        int v22 = 0;
                      }

                      else
                      {
                        int v22 = WORD1(v34) - v20;
                      }

                      if (v22 < v16)
                      {
                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
                      }

                      else
                      {
                        if (BYTE6(v34) == 2)
                        {
                          bzero((void *)(v21 + v20), v16);
                          unsigned __int16 v26 = WORD2(v34) + v16;
                          WORD2(v34) += v16;
                          if (HIBYTE(v34))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v34) > v26)
                          {
                            if (BYTE6(v34) == 2)
                            {
                              WORD2(v34) = v26 + 1;
                              *(_BYTE *)(v33 + v26) = a3;
                              return sub_10018BD78(233, v33, BYTE4(v34), a4, (uint64_t)sub_10013A594, v23, v24, v25);
                            }

                            uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3362,  v32);
                          }

                          uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_49;
                        }

                        uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      }

                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3361,  v31);
                    }

                    uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  }

                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3360,  v30);
                }

                uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              }

              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3359,  v29);
            }

            uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }

          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3358, v28);
        }

        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3357, v27);
      }
    }

    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_33;
  }

  return result;
}

uint64_t sub_100157260(const void *a1, int a2, uint64_t a3)
{
  uint64_t v25 = 0LL;
  uint64_t v26 = 0LL;
  uint64_t result = sub_10018BCDC(&v25);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v26))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v7 = WORD2(v26);
      if (WORD1(v26) > WORD2(v26))
      {
        if (BYTE6(v26) == 2)
        {
          ++WORD2(v26);
          *(_BYTE *)(v25 + v7) = 31;
          uint64_t v8 = v25;
          uint64_t v9 = WORD2(v26);
          if (HIBYTE(v26))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v10 = 0;
          }

          else
          {
            int v10 = WORD1(v26) - WORD2(v26);
          }

          if (v10 < a2)
          {
            int v22 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
          }

          else
          {
            if (BYTE6(v26) == 2)
            {
              memmove((void *)(v8 + v9), a1, a2);
              unsigned __int16 v11 = WORD2(v26) + a2;
              WORD2(v26) += a2;
              uint64_t v12 = v25;
              if (HIBYTE(v26))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v13 = 0;
              }

              else
              {
                int v13 = WORD1(v26) - v11;
              }

              int v14 = 21 - a2;
              if (v13 < 21 - a2)
              {
                uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
              }

              else
              {
                if (BYTE6(v26) == 2)
                {
                  bzero((void *)(v12 + v11), v14);
                  unsigned __int16 v15 = WORD2(v26) + v14;
                  WORD2(v26) += v14;
                  uint64_t v16 = v25;
                  if (HIBYTE(v26))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v17 = 0;
                  }

                  else
                  {
                    int v17 = WORD1(v26) - v15;
                  }

                  if (v17 < a2)
                  {
                    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                  }

                  else
                  {
                    if (BYTE6(v26) == 2)
                    {
                      memset((void *)(v16 + v15), 255, a2);
                      WORD2(v26) += a2;
                      return sub_10018BD78(233, v25, BYTE4(v26), a3, (uint64_t)sub_10013A594, v18, v19, v20);
                    }

                    uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  }

                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3379,  v24);
                }

                uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              }

              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3378,  v23);
            }

            int v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }

          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3377, v22);
        }

        uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3376, v21);
      }
    }

    uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_100157500(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 32;
          return sub_10018BD78(233, v8, BYTE4(v9), a1, (uint64_t)sub_10013A594, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3393, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001575CC( const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, int a8, uint64_t a9, uint64_t a10)
{
  uint64_t v54 = 0LL;
  uint64_t v55 = 0LL;
  uint64_t result = sub_10018BCDC(&v54);
  if (!(_DWORD)result)
  {
    if (a7)
    {
      if (HIBYTE(v55))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        unsigned int v19 = WORD2(v55);
        if (WORD1(v55) > WORD2(v55))
        {
          if (BYTE6(v55) == 2)
          {
            char v20 = 50;
            goto LABEL_11;
          }

          uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3408, v51);
        }
      }

      uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_78;
    }

    if (HIBYTE(v55))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      unsigned int v19 = WORD2(v55);
      if (WORD1(v55) > WORD2(v55))
      {
        if (BYTE6(v55) == 2)
        {
          char v20 = 51;
LABEL_11:
          WORD2(v55) = v19 + 1;
          *(_BYTE *)(v54 + v19) = v20;
          if (a8)
          {
            if (HIBYTE(v55))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              unsigned int v21 = WORD2(v55);
              if (WORD1(v55) > WORD2(v55))
              {
                char v22 = BYTE6(v55);
                if (BYTE6(v55) != 2)
                {
                  uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_85;
                }

uint64_t sub_100157BE0(_WORD *a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v12 = WORD2(v21);
      if (WORD1(v21) > WORD2(v21))
      {
        if (BYTE6(v21) == 2)
        {
          ++WORD2(v21);
          *(_BYTE *)(v20 + v12) = 48;
          if (HIBYTE(v21))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v13 = WORD2(v21);
            if (WORD1(v21) > WORD2(v21))
            {
              if (BYTE6(v21) == 2)
              {
                ++WORD2(v21);
                *(_BYTE *)(v20 + v13) = a2;
                if (HIBYTE(v21))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v21) - WORD2(v21) > 1)
                {
                  if (BYTE6(v21) == 2)
                  {
                    *(_WORD *)(v20 + WORD2(v21)) = *a1;
                    __int16 v14 = WORD2(v21);
                    unsigned __int16 v15 = WORD2(v21) + 2;
                    WORD2(v21) += 2;
                    if (HIBYTE(v21))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v21) > v15)
                    {
                      if (BYTE6(v21) == 2)
                      {
                        WORD2(v21) = v14 + 3;
                        *(_BYTE *)(v20 + v15) = a3;
                        return sub_10018BD78(233, v20, BYTE4(v21), a4, (uint64_t)sub_10013A594, v9, v10, v11);
                      }

                      unsigned int v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3442,  v19);
                    }

                    unsigned int v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }

                  uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3441,  v18);
                }

                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_27;
              }

              int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3440,  v17);
            }
          }

          int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3439, v16);
      }
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100157E48(uint64_t a1, char a2, uint64_t a3)
{
  uint64_t v19 = 0LL;
  uint64_t v20 = 0LL;
  uint64_t result = sub_10018BCDC(&v19);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v20))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v7 = WORD2(v20);
      if (WORD1(v20) > WORD2(v20))
      {
        if (BYTE6(v20) == 2)
        {
          ++WORD2(v20);
          *(_BYTE *)(v19 + v7) = 12;
          v18[0] = BYTE5(a1);
          v18[1] = BYTE4(a1);
          v18[2] = BYTE3(a1);
          v18[3] = BYTE2(a1);
          v18[4] = BYTE1(a1);
          v18[5] = a1;
          if (HIBYTE(v20))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v20) - WORD2(v20) > 5)
          {
            if (BYTE6(v20) == 2)
            {
              sub_1001F0050(v19 + WORD2(v20), (uint64_t)v18, 6uLL);
              __int16 v11 = WORD2(v20);
              unsigned __int16 v12 = WORD2(v20) + 6;
              WORD2(v20) += 6;
              if (HIBYTE(v20))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v20) > v12)
              {
                if (BYTE6(v20) == 2)
                {
                  WORD2(v20) = v11 + 7;
                  *(_BYTE *)(v19 + v12) = BYTE6(a1);
                  if (HIBYTE(v20))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v13 = WORD2(v20);
                    if (WORD1(v20) > WORD2(v20))
                    {
                      if (BYTE6(v20) == 2)
                      {
                        ++WORD2(v20);
                        *(_BYTE *)(v19 + v13) = a2;
                        return sub_10018BD78(233, v19, BYTE4(v20), a3, (uint64_t)sub_10013E160, v8, v9, v10);
                      }

                      int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3479,  v17);
                    }
                  }

                  int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }

                uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3478,  v16);
              }

              uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_27;
            }

            unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3477,  v15);
          }

          unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_23;
        }

        __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3474, v14);
      }
    }

    __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_1001580D0(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 30;
          return sub_10018BD78(233, v8, BYTE4(v9), a1, (uint64_t)sub_10013A594, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3717, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10015819C(uint64_t a1, uint64_t a2)
{
  uint64_t v26 = 0LL;
  uint64_t v27 = 0LL;
  uint64_t result = sub_10018BCDC(&v26);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v27))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v5 = WORD2(v27);
      if (WORD1(v27) > WORD2(v27))
      {
        if (BYTE6(v27) == 2)
        {
          ++WORD2(v27);
          *(_BYTE *)(v26 + v5) = 52;
          if (HIBYTE(v27))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v6 = WORD2(v27);
            if (WORD1(v27) > WORD2(v27))
            {
              if (BYTE6(v27) == 2)
              {
                char v7 = *(_BYTE *)(a1 + 20);
                ++WORD2(v27);
                *(_BYTE *)(v26 + v6) = v7;
                if (HIBYTE(v27))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v27) - WORD2(v27) > 5)
                {
                  if (BYTE6(v27) == 2)
                  {
                    sub_1001F0050(v26 + WORD2(v27), *(void *)a1, 6uLL);
                    unsigned __int16 v11 = WORD2(v27) + 6;
                    WORD2(v27) += 6;
                    if (HIBYTE(v27))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v27) - v11 > 1)
                    {
                      if (BYTE6(v27) == 2)
                      {
                        *(_BYTE *)(v26 + v11) = *(_BYTE *)(a1 + 8);
                        *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 9);
                        unsigned __int16 v12 = WORD2(v27) + 2;
                        WORD2(v27) += 2;
                        if (HIBYTE(v27))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v27) - v12 > 1)
                        {
                          if (BYTE6(v27) == 2)
                          {
                            *(_BYTE *)(v26 + v12) = *(_BYTE *)(a1 + 10);
                            *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 11);
                            unsigned __int16 v13 = WORD2(v27) + 2;
                            WORD2(v27) += 2;
                            if (HIBYTE(v27))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v27) - v13 > 1)
                            {
                              if (BYTE6(v27) == 2)
                              {
                                *(_BYTE *)(v26 + v13) = *(_BYTE *)(a1 + 12);
                                *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 13);
                                unsigned __int16 v14 = WORD2(v27) + 2;
                                WORD2(v27) += 2;
                                if (HIBYTE(v27))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else if (WORD1(v27) - v14 > 1)
                                {
                                  if (BYTE6(v27) == 2)
                                  {
                                    *(_BYTE *)(v26 + v14) = *(_BYTE *)(a1 + 14);
                                    *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 15);
                                    unsigned __int16 v15 = WORD2(v27) + 2;
                                    WORD2(v27) += 2;
                                    if (HIBYTE(v27))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v27) - v15 > 1)
                                    {
                                      if (BYTE6(v27) == 2)
                                      {
                                        *(_BYTE *)(v26 + v15) = *(_BYTE *)(a1 + 16);
                                        *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 17);
                                        unsigned __int16 v16 = WORD2(v27) + 2;
                                        WORD2(v27) += 2;
                                        if (HIBYTE(v27))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else if (WORD1(v27) - v16 > 1)
                                        {
                                          if (BYTE6(v27) == 2)
                                          {
                                            *(_BYTE *)(v26 + v16) = *(_BYTE *)(a1 + 18);
                                            *(_BYTE *)(v26 + WORD2(v27) + 1) = *(_BYTE *)(a1 + 19);
                                            WORD2(v27) += 2;
                                            return sub_10018BD78( 233,  v26,  BYTE4(v27),  a2,  (uint64_t)sub_10013A594,  v8,  v9,  v10);
                                          }

                                          unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3739,  v25);
                                        }

                                        unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                        goto LABEL_66;
                                      }

                                      uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3738,  v24);
                                    }

                                    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                    goto LABEL_62;
                                  }

                                  uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3737,  v23);
                                }

                                uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                goto LABEL_58;
                              }

                              char v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3736,  v22);
                            }

                            char v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                            goto LABEL_54;
                          }

                          uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3735,  v21);
                        }

                        uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_50;
                      }

                      uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3734,  v20);
                    }

                    uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_46;
                  }

                  uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3733,  v19);
                }

                uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_42;
              }

              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3732,  v18);
            }
          }

          uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_38;
        }

        int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3731, v17);
      }
    }

    int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }

  return result;
}

uint64_t sub_100158704(uint64_t a1, uint64_t a2)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v5 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(_BYTE *)(v16 + v5) = 53;
          if (HIBYTE(v17))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v6 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(_BYTE *)(v16 + v6) = 0;
                if (HIBYTE(v17))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v7 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(_BYTE *)(v16 + v7) = BYTE6(a1);
                      v15[0] = BYTE5(a1);
                      v15[1] = BYTE4(a1);
                      v15[2] = BYTE3(a1);
                      v15[3] = BYTE2(a1);
                      v15[4] = BYTE1(a1);
                      v15[5] = a1;
                      if (HIBYTE(v17))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v17) - WORD2(v17) > 5)
                      {
                        if (BYTE6(v17) == 2)
                        {
                          sub_1001F0050(v16 + WORD2(v17), (uint64_t)v15, 6uLL);
                          WORD2(v17) += 6;
                          return sub_10018BD78(233, v16, BYTE4(v17), a2, (uint64_t)sub_10013A594, v8, v9, v10);
                        }

                        unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3760,  v14);
                      }

                      unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                      goto LABEL_31;
                    }

                    unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3756,  v13);
                  }
                }

                unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_27;
              }

              unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3755,  v12);
            }
          }

          unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3754, v11);
      }
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100158980(uint64_t a1, uint64_t a2)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v5 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(_BYTE *)(v16 + v5) = 53;
          if (HIBYTE(v17))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v6 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(_BYTE *)(v16 + v6) = 1;
                if (HIBYTE(v17))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v7 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(_BYTE *)(v16 + v7) = BYTE6(a1);
                      v15[0] = BYTE5(a1);
                      v15[1] = BYTE4(a1);
                      v15[2] = BYTE3(a1);
                      v15[3] = BYTE2(a1);
                      v15[4] = BYTE1(a1);
                      v15[5] = a1;
                      if (HIBYTE(v17))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v17) - WORD2(v17) > 5)
                      {
                        if (BYTE6(v17) == 2)
                        {
                          sub_1001F0050(v16 + WORD2(v17), (uint64_t)v15, 6uLL);
                          WORD2(v17) += 6;
                          return sub_10018BD78(233, v16, BYTE4(v17), a2, (uint64_t)sub_10013A594, v8, v9, v10);
                        }

                        unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3781,  v14);
                      }

                      unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                      goto LABEL_31;
                    }

                    unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3777,  v13);
                  }
                }

                unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_27;
              }

              unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3776,  v12);
            }
          }

          unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3775, v11);
      }
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100158C00(uint64_t a1)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v6) = 53;
          if (HIBYTE(v11))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v7 = WORD2(v11);
            if (WORD1(v11) > WORD2(v11))
            {
              if (BYTE6(v11) == 2)
              {
                ++WORD2(v11);
                *(_BYTE *)(v10 + v7) = 2;
                return sub_10018BD78(233, v10, BYTE4(v11), a1, (uint64_t)sub_10013A594, v3, v4, v5);
              }

              uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3797,  v9);
            }
          }

          uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }

        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3796, v8);
      }
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100158D48( const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, char a8, char a9, char a10, char a11, char a12, char a13, char a14, __int16 a15, char a16, char a17, char a18, uint64_t a19)
{
  uint64_t v67 = 0LL;
  uint64_t v68 = 0LL;
  uint64_t result = sub_10018BCDC(&v67);
  if (!(_DWORD)result)
  {
    if (a7)
    {
      if (HIBYTE(v68))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        unsigned int v28 = WORD2(v68);
        if (WORD1(v68) > WORD2(v68))
        {
          if (BYTE6(v68) == 2)
          {
            char v29 = 55;
            goto LABEL_11;
          }

          uint64_t v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_97:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3813, v64);
        }
      }

      uint64_t v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_97;
    }

    if (HIBYTE(v68))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      unsigned int v28 = WORD2(v68);
      if (WORD1(v68) > WORD2(v68))
      {
        if (BYTE6(v68) == 2)
        {
          char v29 = 56;
LABEL_11:
          WORD2(v68) = v28 + 1;
          *(_BYTE *)(v67 + v28) = v29;
          if (HIBYTE(v68))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v30 = WORD2(v68);
            if (WORD1(v68) > WORD2(v68))
            {
              if (BYTE6(v68) == 2)
              {
                ++WORD2(v68);
                *(_BYTE *)(v67 + v30) = a8;
                v66[0] = a14;
                v66[1] = a13;
                v66[2] = a12;
                v66[3] = a11;
                v66[4] = a10;
                v66[5] = a9;
                if (HIBYTE(v68))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v68) - WORD2(v68) > 5)
                {
                  if (BYTE6(v68) == 2)
                  {
                    sub_1001F0050(v67 + WORD2(v68), (uint64_t)v66, 6uLL);
                    unsigned __int16 v31 = WORD2(v68) + 6;
                    WORD2(v68) += 6;
                    uint64_t v32 = v67;
                    if (HIBYTE(v68))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v33 = 0;
                    }

                    else
                    {
                      int v33 = WORD1(v68) - v31;
                    }

                    if (v33 < a2)
                    {
                      uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                    }

                    else
                    {
                      if (BYTE6(v68) == 2)
                      {
                        memmove((void *)(v32 + v31), a1, a2);
                        unsigned __int16 v34 = WORD2(v68) + a2;
                        WORD2(v68) += a2;
                        uint64_t v35 = v67;
                        if (HIBYTE(v68))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v36 = 0;
                        }

                        else
                        {
                          int v36 = WORD1(v68) - v34;
                        }

                        int v37 = 22 - a2;
                        if (v36 < v37)
                        {
                          int v56 = "ByteStream_NumReadBytesAvail(bs) >= (22 - dataLen)";
                        }

                        else
                        {
                          if (BYTE6(v68) == 2)
                          {
                            bzero((void *)(v35 + v34), v37);
                            unsigned __int16 v38 = WORD2(v68) + v37;
                            WORD2(v68) = v38;
                            uint64_t v39 = v67;
                            if (HIBYTE(v68))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v40 = 0;
                            }

                            else
                            {
                              int v40 = WORD1(v68) - v38;
                            }

                            if (v40 < a4)
                            {
                              unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                            }

                            else
                            {
                              if (BYTE6(v68) == 2)
                              {
                                memmove((void *)(v39 + v38), a3, a4);
                                unsigned __int16 v41 = WORD2(v68) + a4;
                                WORD2(v68) += a4;
                                uint64_t v42 = v67;
                                if (HIBYTE(v68))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v43 = 0;
                                }

                                else
                                {
                                  int v43 = WORD1(v68) - v41;
                                }

                                int v44 = 22 - a4;
                                if (v43 < v44)
                                {
                                  uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= (22 - maskLen)";
                                }

                                else
                                {
                                  if (BYTE6(v68) == 2)
                                  {
                                    bzero((void *)(v42 + v41), v44);
                                    unsigned __int16 v48 = WORD2(v68) + v44;
                                    WORD2(v68) += v44;
                                    if (HIBYTE(v68))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v68) > v48)
                                    {
                                      if (BYTE6(v68) == 2)
                                      {
                                        WORD2(v68) = v48 + 1;
                                        *(_BYTE *)(v67 + v48) = a5;
                                        if (HIBYTE(v68))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v49 = WORD2(v68);
                                          if (WORD1(v68) > WORD2(v68))
                                          {
                                            if (BYTE6(v68) == 2)
                                            {
                                              ++WORD2(v68);
                                              *(_BYTE *)(v67 + v49) = a6;
                                              if (HIBYTE(v68))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else
                                              {
                                                uint64_t v50 = WORD2(v68);
                                                if (WORD1(v68) > WORD2(v68))
                                                {
                                                  if (BYTE6(v68) == 2)
                                                  {
                                                    ++WORD2(v68);
                                                    *(_BYTE *)(v67 + v50) = a16;
                                                    if (HIBYTE(v68))
                                                    {
                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }

                                                    else
                                                    {
                                                      uint64_t v51 = WORD2(v68);
                                                      if (WORD1(v68) > WORD2(v68))
                                                      {
                                                        if (BYTE6(v68) == 2)
                                                        {
                                                          ++WORD2(v68);
                                                          *(_BYTE *)(v67 + v51) = a17;
                                                          if (HIBYTE(v68))
                                                          {
                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }

                                                          else
                                                          {
                                                            uint64_t v52 = WORD2(v68);
                                                            if (WORD1(v68) > WORD2(v68))
                                                            {
                                                              if (BYTE6(v68) == 2)
                                                              {
                                                                ++WORD2(v68);
                                                                *(_BYTE *)(v67 + v52) = a18;
                                                                return sub_10018BD78( 233,  v67,  BYTE4(v68),  a19,  (uint64_t)sub_10013A594,  v45,  v46,  v47);
                                                              }

                                                              int v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_93:
                                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ba se/Stack/vsc/bcm/bcm_vsc.c",  3830,  v63);
                                                            }
                                                          }

                                                          int v63 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                          goto LABEL_93;
                                                        }

                                                        int v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Sta ck/vsc/bcm/bcm_vsc.c",  3829,  v62);
                                                      }
                                                    }

                                                    int v62 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_89;
                                                  }

                                                  uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3828,  v61);
                                                }
                                              }

                                              uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_85;
                                            }

                                            uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3827,  v60);
                                          }
                                        }

                                        uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_81;
                                      }

                                      int v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3826,  v59);
                                    }

                                    int v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_77;
                                  }

                                  uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }

                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3825,  v58);
                              }

                              unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }

                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3824,  v57);
                          }

                          int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }

                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3823,  v56);
                      }

                      uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }

                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3822,  v55);
                  }

                  uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3821,  v54);
                }

                uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_61;
              }

              v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3818,  v53);
            }
          }

          v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_57;
        }

        unsigned int v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_101:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3815, v65);
      }
    }

    unsigned int v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_101;
  }

  return result;
}

uint64_t sub_100159498( const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, char a8, char a9, char a10, char a11, char a12, char a13, char a14, __int16 a15, char a16, char a17, char a18, uint64_t a19)
{
  uint64_t v67 = 0LL;
  uint64_t v68 = 0LL;
  uint64_t result = sub_10018BCDC(&v67);
  if (!(_DWORD)result)
  {
    if (a7)
    {
      if (HIBYTE(v68))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        unsigned int v28 = WORD2(v68);
        if (WORD1(v68) > WORD2(v68))
        {
          if (BYTE6(v68) == 2)
          {
            char v29 = 55;
            goto LABEL_11;
          }

          uint64_t v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_97:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3845, v64);
        }
      }

      uint64_t v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_97;
    }

    if (HIBYTE(v68))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      unsigned int v28 = WORD2(v68);
      if (WORD1(v68) > WORD2(v68))
      {
        if (BYTE6(v68) == 2)
        {
          char v29 = 56;
LABEL_11:
          WORD2(v68) = v28 + 1;
          *(_BYTE *)(v67 + v28) = v29;
          if (HIBYTE(v68))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v30 = WORD2(v68);
            if (WORD1(v68) > WORD2(v68))
            {
              if (BYTE6(v68) == 2)
              {
                ++WORD2(v68);
                *(_BYTE *)(v67 + v30) = a8;
                v66[0] = a14;
                v66[1] = a13;
                v66[2] = a12;
                v66[3] = a11;
                v66[4] = a10;
                v66[5] = a9;
                if (HIBYTE(v68))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v68) - WORD2(v68) > 5)
                {
                  if (BYTE6(v68) == 2)
                  {
                    sub_1001F0050(v67 + WORD2(v68), (uint64_t)v66, 6uLL);
                    unsigned __int16 v31 = WORD2(v68) + 6;
                    WORD2(v68) += 6;
                    uint64_t v32 = v67;
                    if (HIBYTE(v68))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v33 = 0;
                    }

                    else
                    {
                      int v33 = WORD1(v68) - v31;
                    }

                    if (v33 < a2)
                    {
                      uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                    }

                    else
                    {
                      if (BYTE6(v68) == 2)
                      {
                        memmove((void *)(v32 + v31), a1, a2);
                        unsigned __int16 v34 = WORD2(v68) + a2;
                        WORD2(v68) += a2;
                        uint64_t v35 = v67;
                        if (HIBYTE(v68))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v36 = 0;
                        }

                        else
                        {
                          int v36 = WORD1(v68) - v34;
                        }

                        int v37 = 22 - a2;
                        if (v36 < v37)
                        {
                          int v56 = "ByteStream_NumReadBytesAvail(bs) >= (22 - dataLen)";
                        }

                        else
                        {
                          if (BYTE6(v68) == 2)
                          {
                            bzero((void *)(v35 + v34), v37);
                            unsigned __int16 v38 = WORD2(v68) + v37;
                            WORD2(v68) = v38;
                            uint64_t v39 = v67;
                            if (HIBYTE(v68))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v40 = 0;
                            }

                            else
                            {
                              int v40 = WORD1(v68) - v38;
                            }

                            if (v40 < a4)
                            {
                              unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                            }

                            else
                            {
                              if (BYTE6(v68) == 2)
                              {
                                memmove((void *)(v39 + v38), a3, a4);
                                unsigned __int16 v41 = WORD2(v68) + a4;
                                WORD2(v68) += a4;
                                uint64_t v42 = v67;
                                if (HIBYTE(v68))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v43 = 0;
                                }

                                else
                                {
                                  int v43 = WORD1(v68) - v41;
                                }

                                int v44 = 22 - a4;
                                if (v43 < v44)
                                {
                                  uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= (22 - maskLen)";
                                }

                                else
                                {
                                  if (BYTE6(v68) == 2)
                                  {
                                    bzero((void *)(v42 + v41), v44);
                                    unsigned __int16 v48 = WORD2(v68) + v44;
                                    WORD2(v68) += v44;
                                    if (HIBYTE(v68))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v68) > v48)
                                    {
                                      if (BYTE6(v68) == 2)
                                      {
                                        WORD2(v68) = v48 + 1;
                                        *(_BYTE *)(v67 + v48) = a5;
                                        if (HIBYTE(v68))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v49 = WORD2(v68);
                                          if (WORD1(v68) > WORD2(v68))
                                          {
                                            if (BYTE6(v68) == 2)
                                            {
                                              ++WORD2(v68);
                                              *(_BYTE *)(v67 + v49) = a6;
                                              if (HIBYTE(v68))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else
                                              {
                                                uint64_t v50 = WORD2(v68);
                                                if (WORD1(v68) > WORD2(v68))
                                                {
                                                  if (BYTE6(v68) == 2)
                                                  {
                                                    ++WORD2(v68);
                                                    *(_BYTE *)(v67 + v50) = a16;
                                                    if (HIBYTE(v68))
                                                    {
                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }

                                                    else
                                                    {
                                                      uint64_t v51 = WORD2(v68);
                                                      if (WORD1(v68) > WORD2(v68))
                                                      {
                                                        if (BYTE6(v68) == 2)
                                                        {
                                                          ++WORD2(v68);
                                                          *(_BYTE *)(v67 + v51) = a17;
                                                          if (HIBYTE(v68))
                                                          {
                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }

                                                          else
                                                          {
                                                            uint64_t v52 = WORD2(v68);
                                                            if (WORD1(v68) > WORD2(v68))
                                                            {
                                                              if (BYTE6(v68) == 2)
                                                              {
                                                                ++WORD2(v68);
                                                                *(_BYTE *)(v67 + v52) = a18;
                                                                return sub_10018BD78( 233,  v67,  BYTE4(v68),  a19,  (uint64_t)sub_10013A864,  v45,  v46,  v47);
                                                              }

                                                              int v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_93:
                                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ba se/Stack/vsc/bcm/bcm_vsc.c",  3862,  v63);
                                                            }
                                                          }

                                                          int v63 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                          goto LABEL_93;
                                                        }

                                                        int v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Sta ck/vsc/bcm/bcm_vsc.c",  3861,  v62);
                                                      }
                                                    }

                                                    int v62 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_89;
                                                  }

                                                  uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3860,  v61);
                                                }
                                              }

                                              uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_85;
                                            }

                                            uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3859,  v60);
                                          }
                                        }

                                        uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_81;
                                      }

                                      int v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3858,  v59);
                                    }

                                    int v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_77;
                                  }

                                  uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }

                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3857,  v58);
                              }

                              unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }

                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3856,  v57);
                          }

                          int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }

                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3855,  v56);
                      }

                      uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }

                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3854,  v55);
                  }

                  uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3853,  v54);
                }

                uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_61;
              }

              v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3850,  v53);
            }
          }

          v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_57;
        }

        unsigned int v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_101:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3847, v65);
      }
    }

    unsigned int v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_101;
  }

  return result;
}

uint64_t sub_100159BE8(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 57;
          return sub_10018BD78(233, v8, BYTE4(v9), a1, (uint64_t)sub_10013A728, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3897, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100159CB4(char a1, const void *a2, int a3, const void *a4, int a5, uint64_t a6)
{
  uint64_t v38 = 0LL;
  uint64_t v39 = 0LL;
  uint64_t result = sub_10018BCDC(&v38);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v39))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v13 = WORD2(v39);
      if (WORD1(v39) > WORD2(v39))
      {
        if (BYTE6(v39) == 2)
        {
          ++WORD2(v39);
          *(_BYTE *)(v38 + v13) = 91;
          if (HIBYTE(v39))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v14 = WORD2(v39);
            if (WORD1(v39) > WORD2(v39))
            {
              if (BYTE6(v39) == 2)
              {
                ++WORD2(v39);
                *(_BYTE *)(v38 + v14) = a1;
                uint64_t v15 = v38;
                uint64_t v16 = WORD2(v39);
                if (HIBYTE(v39))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v17 = 0;
                }

                else
                {
                  int v17 = WORD1(v39) - WORD2(v39);
                }

                if (v17 < a3)
                {
                  unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                }

                else
                {
                  if (BYTE6(v39) == 2)
                  {
                    memmove((void *)(v15 + v16), a2, a3);
                    unsigned __int16 v18 = WORD2(v39) + a3;
                    WORD2(v39) += a3;
                    uint64_t v19 = v38;
                    if (HIBYTE(v39))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v20 = 0;
                    }

                    else
                    {
                      int v20 = WORD1(v39) - v18;
                    }

                    int v21 = 3 - a3;
                    if (v20 < v21)
                    {
                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= (3 - dataLen)";
                    }

                    else
                    {
                      if (BYTE6(v39) == 2)
                      {
                        bzero((void *)(v19 + v18), v21);
                        unsigned __int16 v22 = WORD2(v39) + v21;
                        WORD2(v39) = v22;
                        uint64_t v23 = v38;
                        if (HIBYTE(v39))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v24 = 0;
                        }

                        else
                        {
                          int v24 = WORD1(v39) - v22;
                        }

                        if (v24 < a5)
                        {
                          int v36 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                        }

                        else
                        {
                          if (BYTE6(v39) == 2)
                          {
                            memmove((void *)(v23 + v22), a4, a5);
                            unsigned __int16 v25 = WORD2(v39) + a5;
                            WORD2(v39) += a5;
                            uint64_t v26 = v38;
                            if (HIBYTE(v39))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v27 = 0;
                            }

                            else
                            {
                              int v27 = WORD1(v39) - v25;
                            }

                            int v28 = 3 - a5;
                            if (v27 < v28)
                            {
                              int v37 = "ByteStream_NumReadBytesAvail(bs) >= (3 - maskLen)";
                            }

                            else
                            {
                              if (BYTE6(v39) == 2)
                              {
                                bzero((void *)(v26 + v25), v28);
                                WORD2(v39) += v28;
                                return sub_10018BD78(233, v38, BYTE4(v39), a6, (uint64_t)sub_10013A594, v29, v30, v31);
                              }

                              int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }

                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3882,  v37);
                          }

                          int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }

                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3881,  v36);
                      }

                      uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }

                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3880,  v35);
                  }

                  unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                }

                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3879,  v34);
              }

              int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3878,  v33);
            }
          }

          int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_37;
        }

        uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3877, v32);
      }
    }

    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_33;
  }

  return result;
}

uint64_t sub_10015A070(char a1, int a2, uint64_t a3)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v10) = a1;
          if (a2 != 1)
          {
            __int16 v12 = 571;
            return sub_10018BD78(v12, v15, BYTE4(v16), a3, (uint64_t)sub_10013E4B4, v7, v8, v9);
          }

          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v11 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(_BYTE *)(v15 + v11) = 0;
                __int16 v12 = 583;
                return sub_10018BD78(v12, v15, BYTE4(v16), a3, (uint64_t)sub_10013E4B4, v7, v8, v9);
              }

              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3917,  v14);
            }
          }

          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3912, v13);
      }
    }

    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10015A1D0(char a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(_BYTE *)(v14 + v10) = a1;
          if (HIBYTE(v15))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v11 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                ++WORD2(v15);
                *(_BYTE *)(v14 + v11) = a2;
                return sub_10018BD78(583, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
              }

              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3932,  v13);
            }
          }

          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }

        __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3931, v12);
      }
    }

    __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015A320(char a1, uint64_t a2, char a3, uint64_t a4)
{
  uint64_t v19 = 0LL;
  uint64_t v20 = 0LL;
  uint64_t result = sub_10018BCDC(&v19);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v20))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v9 = WORD2(v20);
      if (WORD1(v20) > WORD2(v20))
      {
        if (BYTE6(v20) == 2)
        {
          ++WORD2(v20);
          *(_BYTE *)(v19 + v9) = a1;
          v18[0] = BYTE5(a2);
          v18[1] = BYTE4(a2);
          v18[2] = BYTE3(a2);
          v18[3] = BYTE2(a2);
          v18[4] = BYTE1(a2);
          v18[5] = a2;
          if (HIBYTE(v20))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v20) - WORD2(v20) > 5)
          {
            if (BYTE6(v20) == 2)
            {
              sub_1001F0050(v19 + WORD2(v20), (uint64_t)v18, 6uLL);
              __int16 v13 = WORD2(v20);
              unsigned __int16 v14 = WORD2(v20) + 6;
              WORD2(v20) += 6;
              if (HIBYTE(v20))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v20) > v14)
              {
                if (BYTE6(v20) == 2)
                {
                  WORD2(v20) = v13 + 7;
                  *(_BYTE *)(v19 + v14) = a3;
                  return sub_10018BD78(555, v19, BYTE4(v20), a4, (uint64_t)sub_10013A594, v10, v11, v12);
                }

                int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3951,  v17);
              }

              int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }

            uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3950,  v16);
          }

          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_20;
        }

        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3947, v15);
      }
    }

    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10015A52C(uint64_t a1, unsigned int a2, char a3, char a4, uint64_t a5)
{
  uint64_t v36 = 0LL;
  uint64_t v37 = 0LL;
  uint64_t result = sub_10018BCDC(&v36);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v37))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v11 = WORD2(v37);
      if (WORD1(v37) > WORD2(v37))
      {
        if (BYTE6(v37) == 2)
        {
          ++WORD2(v37);
          *(_BYTE *)(v36 + v11) = 77;
          if (HIBYTE(v37))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v12 = WORD2(v37);
            if (WORD1(v37) > WORD2(v37))
            {
              if (BYTE6(v37) == 2)
              {
                ++WORD2(v37);
                *(_BYTE *)(v36 + v12) = a2;
                if (!a2)
                {
LABEL_18:
                  uint64_t v20 = a2;
                  uint64_t v21 = a1 - a2 + 8LL * a2 + 1;
                  uint64_t v22 = v20 - 8;
                  while (!HIBYTE(v37))
                  {
                    uint64_t v23 = WORD2(v37);
                    if (BYTE6(v37) != 2)
                    {
                      int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      goto LABEL_38;
                    }

                    char v24 = *(_BYTE *)(v21 - 1);
                    ++WORD2(v37);
                    *(_BYTE *)(v36 + v23) = v24;
                    if (HIBYTE(v37))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_40:
                      uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_42:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3974,  v29);
                    }

                    if (WORD1(v37) - WORD2(v37) <= 5) {
                      goto LABEL_40;
                    }
                    if (BYTE6(v37) != 2)
                    {
                      uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      goto LABEL_42;
                    }

                    sub_1001F0050(v36 + WORD2(v37), v21, 6uLL);
                    WORD2(v37) += 6;
                    v21 += 7LL;
                    if (__CFADD__(v22++, 1LL)) {
                      goto LABEL_27;
                    }
                  }

                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_36:
                  int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_38:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3973,  v28);
                }

                uint64_t v13 = a2;
                uint64_t v14 = a1 + 1;
                while (!HIBYTE(v37))
                {
                  uint64_t v15 = WORD2(v37);
                  if (BYTE6(v37) != 2)
                  {
                    uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    goto LABEL_46;
                  }

                  char v16 = *(_BYTE *)(v14 - 1);
                  ++WORD2(v37);
                  *(_BYTE *)(v36 + v15) = v16;
                  if (HIBYTE(v37))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_48:
                    uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_50:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3970,  v31);
                  }

                  if (WORD1(v37) - WORD2(v37) <= 5) {
                    goto LABEL_48;
                  }
                  if (BYTE6(v37) != 2)
                  {
                    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    goto LABEL_50;
                  }

                  sub_1001F0050(v36 + WORD2(v37), v14, 6uLL);
                  WORD2(v37) += 6;
                  v14 += 7LL;
                  if (!--v13)
                  {
                    if (a2 <= 7) {
                      goto LABEL_18;
                    }
LABEL_27:
                    if (HIBYTE(v37))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else
                    {
                      uint64_t v26 = WORD2(v37);
                      if (WORD1(v37) > WORD2(v37))
                      {
                        if (BYTE6(v37) == 2)
                        {
                          ++WORD2(v37);
                          *(_BYTE *)(v36 + v26) = a3;
                          if (HIBYTE(v37))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else
                          {
                            uint64_t v27 = WORD2(v37);
                            if (WORD1(v37) > WORD2(v37))
                            {
                              if (BYTE6(v37) == 2)
                              {
                                ++WORD2(v37);
                                *(_BYTE *)(v36 + v27) = a4;
                                return sub_10018BD78(233, v36, BYTE4(v37), a5, (uint64_t)sub_10013A594, v17, v18, v19);
                              }

                              uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3977,  v35);
                            }
                          }

                          uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_66;
                        }

                        unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3976,  v34);
                      }
                    }

                    unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_62;
                  }
                }

                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_44:
                uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_46:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3969,  v30);
              }

              int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3967,  v33);
            }
          }

          int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_58;
        }

        uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3966, v32);
      }
    }

    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_54;
  }

  return result;
}

uint64_t sub_10015A9D8(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(554, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3991, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10015AAA4(unsigned __int8 *a1, uint64_t a2)
{
  uint64_t v39 = 0LL;
  uint64_t v40 = 0LL;
  uint64_t result = sub_10018BCDC(&v39);
  if (!(_DWORD)result)
  {
    int v5 = *a1;
    if (v5 != 3)
    {
      if (v5 == 1)
      {
        if (HIBYTE(v40))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else
        {
          unsigned int v6 = WORD2(v40);
          if (WORD1(v40) > WORD2(v40))
          {
            if (BYTE6(v40) == 2)
            {
              char v7 = 74;
              goto LABEL_16;
            }

            unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_75:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4007,  v34);
          }
        }

        unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_75;
      }

      if (HIBYTE(v40))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        unsigned int v6 = WORD2(v40);
        if (WORD1(v40) > WORD2(v40))
        {
          if (BYTE6(v40) == 2) {
            goto LABEL_15;
          }
          uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_82:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4011, v35);
        }
      }

      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_82;
    }

    if (HIBYTE(v40))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      unsigned int v6 = WORD2(v40);
      if (WORD1(v40) > WORD2(v40))
      {
        if (BYTE6(v40) == 2)
        {
LABEL_15:
          char v7 = 92;
LABEL_16:
          WORD2(v40) = v6 + 1;
          *(_BYTE *)(v39 + v6) = v7;
          if (HIBYTE(v40))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v9 = WORD2(v40);
            if (WORD1(v40) > WORD2(v40))
            {
              if (BYTE6(v40) == 2)
              {
                unsigned __int8 v10 = a1[16];
                ++WORD2(v40);
                *(_BYTE *)(v39 + v9) = v10;
                if (HIBYTE(v40))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v40) - WORD2(v40) > 5)
                {
                  if (BYTE6(v40) == 2)
                  {
                    sub_1001F0050(v39 + WORD2(v40), *((void *)a1 + 1), 6uLL);
                    __int16 v14 = WORD2(v40);
                    unsigned __int16 v15 = WORD2(v40) + 6;
                    WORD2(v40) += 6;
                    if (HIBYTE(v40))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v40) > v15)
                    {
                      if (BYTE6(v40) == 2)
                      {
                        unsigned __int8 v16 = a1[17];
                        WORD2(v40) = v14 + 7;
                        *(_BYTE *)(v39 + v15) = v16;
                        if (HIBYTE(v40))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v40) > WORD2(v40))
                        {
                          if (BYTE6(v40) == 2)
                          {
                            *(_BYTE *)(v39 + WORD2(v40)) = a1[18];
                            __int16 v17 = WORD2(v40);
                            unsigned __int16 v18 = ++WORD2(v40);
                            if (HIBYTE(v40))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v40) > v18)
                            {
                              if (BYTE6(v40) == 2)
                              {
                                unsigned __int8 v19 = a1[19];
                                WORD2(v40) = v17 + 2;
                                *(_BYTE *)(v39 + v18) = v19;
                                if (*a1 < 2u) {
                                  return sub_10018BD78(233, v39, BYTE4(v40), a2, (uint64_t)sub_10013A594, v11, v12, v13);
                                }
                                if (HIBYTE(v40))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else
                                {
                                  uint64_t v20 = WORD2(v40);
                                  if (WORD1(v40) > WORD2(v40))
                                  {
                                    if (BYTE6(v40) == 2)
                                    {
                                      unsigned __int8 v21 = a1[20];
                                      ++WORD2(v40);
                                      *(_BYTE *)(v39 + v20) = v21;
                                      if (*a1 == 3)
                                      {
                                        if (HIBYTE(v40))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v22 = WORD2(v40);
                                          if (WORD1(v40) > WORD2(v40))
                                          {
                                            if (BYTE6(v40) == 2)
                                            {
                                              unsigned __int8 v23 = a1[21];
                                              ++WORD2(v40);
                                              *(_BYTE *)(v39 + v22) = v23;
                                              if (HIBYTE(v40))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else
                                              {
                                                uint64_t v24 = WORD2(v40);
                                                if (WORD1(v40) > WORD2(v40))
                                                {
                                                  if (BYTE6(v40) == 2)
                                                  {
                                                    unsigned __int8 v25 = a1[22];
                                                    ++WORD2(v40);
                                                    *(_BYTE *)(v39 + v24) = v25;
                                                    if (HIBYTE(v40))
                                                    {
                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }

                                                    else
                                                    {
                                                      uint64_t v26 = WORD2(v40);
                                                      if (WORD1(v40) > WORD2(v40))
                                                      {
                                                        if (BYTE6(v40) == 2)
                                                        {
                                                          unsigned __int8 v27 = a1[23];
                                                          ++WORD2(v40);
                                                          *(_BYTE *)(v39 + v26) = v27;
                                                          return sub_10018BD78( 233,  v39,  BYTE4(v40),  a2,  (uint64_t)sub_10013A594,  v11,  v12,  v13);
                                                        }

                                                        uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_94:
                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Sta ck/vsc/bcm/bcm_vsc.c",  4024,  v38);
                                                      }
                                                    }

                                                    uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_94;
                                                  }

                                                  uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_90:
                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4023,  v37);
                                                }
                                              }

                                              uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_90;
                                            }

                                            uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_86:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4022,  v36);
                                          }
                                        }

                                        uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_86;
                                      }

                                      return sub_10018BD78( 233,  v39,  BYTE4(v40),  a2,  (uint64_t)sub_10013A594,  v11,  v12,  v13);
                                    }

                                    int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_71:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4019,  v33);
                                  }
                                }

                                int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                goto LABEL_71;
                              }

                              uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_67:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4017,  v32);
                            }

                            uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_67;
                          }

                          uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_63:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4016,  v31);
                        }

                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                        goto LABEL_63;
                      }

                      uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4015,  v30);
                    }

                    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_59;
                  }

                  uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4014,  v29);
                }

                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_55;
              }

              int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4013,  v28);
            }
          }

          int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_51;
        }

        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4009, v8);
      }
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_78;
  }

  return result;
}

uint64_t sub_10015B0EC(uint64_t a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v5 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(_BYTE *)(v14 + v5) = 75;
          if (HIBYTE(v15))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v6 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                char v7 = *(_BYTE *)(a1 + 8);
                ++WORD2(v15);
                *(_BYTE *)(v14 + v6) = v7;
                if (HIBYTE(v15))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v15) - WORD2(v15) > 5)
                {
                  if (BYTE6(v15) == 2)
                  {
                    sub_1001F0050(v14 + WORD2(v15), *(void *)a1, 6uLL);
                    WORD2(v15) += 6;
                    return sub_10018BD78(233, v14, BYTE4(v15), a2, (uint64_t)sub_10013F498, v8, v9, v10);
                  }

                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4041,  v13);
                }

                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_24;
              }

              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4040,  v12);
            }
          }

          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4039, v11);
      }
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10015B2C4(char a1, __int16 a2, __int16 a3, char a4, uint64_t a5)
{
  uint64_t v24 = 0LL;
  uint64_t v25 = 0LL;
  uint64_t result = sub_10018BCDC(&v24);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v25))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v25);
      if (WORD1(v25) > WORD2(v25))
      {
        if (BYTE6(v25) == 2)
        {
          ++WORD2(v25);
          *(_BYTE *)(v24 + v14) = 76;
          if (HIBYTE(v25))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v15 = WORD2(v25);
            if (WORD1(v25) > WORD2(v25))
            {
              if (BYTE6(v25) == 2)
              {
                ++WORD2(v25);
                *(_BYTE *)(v24 + v15) = a1;
                if (HIBYTE(v25))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v25) - WORD2(v25) > 1)
                {
                  if (BYTE6(v25) == 2)
                  {
                    *(_WORD *)(v24 + WORD2(v25)) = a2;
                    unsigned __int16 v16 = WORD2(v25) + 2;
                    WORD2(v25) += 2;
                    if (HIBYTE(v25))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v25) - v16 > 1)
                    {
                      if (BYTE6(v25) == 2)
                      {
                        *(_BYTE *)(v24 + v16) = a3;
                        *(_BYTE *)(v24 + WORD2(v25) + 1) = HIBYTE(a3);
                        __int16 v17 = WORD2(v25);
                        unsigned __int16 v18 = WORD2(v25) + 2;
                        WORD2(v25) += 2;
                        if (HIBYTE(v25))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v25) > v18)
                        {
                          if (BYTE6(v25) == 2)
                          {
                            WORD2(v25) = v17 + 3;
                            *(_BYTE *)(v24 + v18) = a4;
                            return sub_10018BD78(233, v24, BYTE4(v25), a5, (uint64_t)sub_10013A594, v11, v12, v13);
                          }

                          unsigned __int8 v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4060,  v23);
                        }

                        unsigned __int8 v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_38;
                      }

                      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4059,  v22);
                    }

                    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_34;
                  }

                  unsigned __int8 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4058,  v21);
                }

                unsigned __int8 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_30;
              }

              uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4057,  v20);
            }
          }

          uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }

        unsigned __int8 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4056, v19);
      }
    }

    unsigned __int8 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_10015B5C8(uint64_t a1, unsigned int a2, unsigned int a3, char a4, char a5, char a6, uint64_t a7)
{
  uint64_t v39 = 0LL;
  uint64_t v40 = 0LL;
  uint64_t result = sub_10018BCDC(&v39);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_43;
  }

  uint64_t v18 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_43:
    uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_45;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3272, v31);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v18) = 80;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_47;
  }

  uint64_t v19 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_47:
    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_49;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3274, v32);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v19) = a3;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_51;
  }

  if (WORD1(v40) - WORD2(v40) <= 5)
  {
LABEL_51:
    int v33 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_53;
  }

  if (BYTE6(v40) != 2)
  {
    int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3275, v33);
  }

  uint64_t v20 = v39 + WORD2(v40);
  *(_WORD *)(v20 + 4) = 0;
  *(_DWORD *)uint64_t v20 = 0;
  __int16 v21 = WORD2(v40);
  unsigned __int16 v22 = WORD2(v40) + 6;
  WORD2(v40) += 6;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_55;
  }

  if (WORD1(v40) <= v22)
  {
LABEL_55:
    unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_57;
  }

  if (BYTE6(v40) != 2)
  {
    unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3276, v34);
  }

  WORD2(v40) = v21 + 7;
  *(_BYTE *)(v39 + v22) = 2;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_59;
  }

  uint64_t v23 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_59:
    uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_61;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3277, v35);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v23) = 0;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_63;
  }

  uint64_t v24 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_63:
    uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_65;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3279, v36);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v24) = a4;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_67;
  }

  uint64_t v25 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_67:
    uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_69;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3280, v37);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v25) = a5;
  if (HIBYTE(v40))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_71;
  }

  uint64_t v26 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_71:
    uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_73;
  }

  if (BYTE6(v40) != 2)
  {
    uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3281, v38);
  }

  ++WORD2(v40);
  *(_BYTE *)(v39 + v26) = a6;
  if (a3 <= 1)
  {
    if (a2 == 2 || a2 == 16) {
      goto LABEL_31;
    }
    sub_1001EE2A0();
  }

  if (a2)
  {
LABEL_31:
    uint64_t v27 = a2;
    while (!HIBYTE(v40))
    {
      uint64_t v28 = WORD2(v40);
      if (BYTE6(v40) != 2)
      {
        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_41;
      }

      char v29 = *(_BYTE *)(a1 - 1 + v27--);
      ++WORD2(v40);
      *(_BYTE *)(v39 + v28) = v29;
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_39:
    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_41:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3288, v30);
  }

  return sub_10018BD78(233, v39, BYTE4(v40), a7, (uint64_t)sub_10013A594, v15, v16, v17);
}

uint64_t sub_10015BAD4( uint64_t a1, unsigned int a2, unsigned int a3, char a4, char a5, char a6, unsigned int a7, uint64_t a8, uint64_t a9, uint64_t a10)
{
  uint64_t v61 = 0LL;
  uint64_t v62 = 0LL;
  uint64_t result = sub_10018BCDC(&v61);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_77;
  }

  uint64_t v19 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_77:
    uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_79;
  }

  if (BYTE6(v62) != 2)
  {
    uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_79:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3303, v51);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v19) = 97;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_81;
  }

  uint64_t v20 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_81:
    uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_83;
  }

  if (BYTE6(v62) != 2)
  {
    uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_83:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3305, v52);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v20) = a3;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_85;
  }

  if (WORD1(v62) - WORD2(v62) <= 5)
  {
LABEL_85:
    v53 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_87;
  }

  if (BYTE6(v62) != 2)
  {
    v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_87:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3306, v53);
  }

  uint64_t v21 = v61 + WORD2(v62);
  *(_WORD *)(v21 + 4) = 0;
  *(_DWORD *)uint64_t v21 = 0;
  __int16 v22 = WORD2(v62);
  unsigned __int16 v23 = WORD2(v62) + 6;
  WORD2(v62) += 6;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_89;
  }

  if (WORD1(v62) <= v23)
  {
LABEL_89:
    uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_91;
  }

  if (BYTE6(v62) != 2)
  {
    uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_91:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3307, v54);
  }

  WORD2(v62) = v22 + 7;
  *(_BYTE *)(v61 + v23) = 2;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_93;
  }

  uint64_t v24 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_93:
    uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_95;
  }

  if (BYTE6(v62) != 2)
  {
    uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_95:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3308, v55);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v24) = 0;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_97;
  }

  uint64_t v25 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_97:
    int v56 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_99;
  }

  if (BYTE6(v62) != 2)
  {
    int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_99:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3310, v56);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v25) = a4;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_101;
  }

  uint64_t v26 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_101:
    unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_103;
  }

  if (BYTE6(v62) != 2)
  {
    unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_103:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3311, v57);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v26) = a5;
  if (HIBYTE(v62))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_105;
  }

  uint64_t v27 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_105:
    uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_107;
  }

  if (BYTE6(v62) != 2)
  {
    uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_107:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3312, v58);
  }

  ++WORD2(v62);
  *(_BYTE *)(v61 + v27) = a6;
  if (a3 <= 1 && a2 != 2 && a2 != 16) {
    sub_1001EE2A0();
  }
  if (a8 && a7)
  {
    uint64_t v28 = 0LL;
    while (!HIBYTE(v62))
    {
      uint64_t v29 = WORD2(v62);
      if (BYTE6(v62) != 2)
      {
        uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_71;
      }

      char v30 = *(_BYTE *)(a8 + v28);
      ++WORD2(v62);
      *(_BYTE *)(v61 + v29) = v30;
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_69:
    uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_71:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3319, v49);
  }

uint64_t sub_10015C248( __int16 a1, __int16 a2, const void *a3, int a4, const void *a5, int a6, char a7, char a8, char a9, uint64_t a10)
{
  uint64_t v53 = 0LL;
  uint64_t v54 = 0LL;
  uint64_t result = sub_10018BCDC(&v53);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v54))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v19 = WORD2(v54);
      if (WORD1(v54) > WORD2(v54))
      {
        if (BYTE6(v54) == 2)
        {
          ++WORD2(v54);
          *(_BYTE *)(v53 + v19) = 90;
          if (HIBYTE(v54))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v20 = WORD2(v54);
            if (WORD1(v54) > WORD2(v54))
            {
              if (BYTE6(v54) == 2)
              {
                ++WORD2(v54);
                *(_BYTE *)(v53 + v20) = 1;
                if (HIBYTE(v54))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v54) - WORD2(v54) > 1)
                {
                  if (BYTE6(v54) == 2)
                  {
                    *(_WORD *)(v53 + WORD2(v54)) = a1;
                    unsigned __int16 v21 = WORD2(v54) + 2;
                    WORD2(v54) += 2;
                    if (HIBYTE(v54))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v54) - v21 > 1)
                    {
                      if (BYTE6(v54) == 2)
                      {
                        *(_BYTE *)(v53 + v21) = a2;
                        *(_BYTE *)(v53 + WORD2(v54) + 1) = HIBYTE(a2);
                        unsigned __int16 v22 = WORD2(v54) + 2;
                        WORD2(v54) += 2;
                        uint64_t v23 = v53;
                        if (HIBYTE(v54))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v24 = 0;
                        }

                        else
                        {
                          int v24 = WORD1(v54) - v22;
                        }

                        if (v24 < a4)
                        {
                          uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                        }

                        else
                        {
                          if (BYTE6(v54) == 2)
                          {
                            memmove((void *)(v23 + v22), a3, a4);
                            unsigned __int16 v25 = WORD2(v54) + a4;
                            WORD2(v54) += a4;
                            uint64_t v26 = v53;
                            if (HIBYTE(v54))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v27 = 0;
                            }

                            else
                            {
                              int v27 = WORD1(v54) - v25;
                            }

                            int v28 = 27 - a4;
                            if (v27 < v28)
                            {
                              char v47 = "ByteStream_NumReadBytesAvail(bs) >= (27 - maskLen)";
                            }

                            else
                            {
                              if (BYTE6(v54) == 2)
                              {
                                bzero((void *)(v26 + v25), v28);
                                unsigned __int16 v29 = WORD2(v54) + v28;
                                WORD2(v54) = v29;
                                uint64_t v30 = v53;
                                if (HIBYTE(v54))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v31 = 0;
                                }

                                else
                                {
                                  int v31 = WORD1(v54) - v29;
                                }

                                if (v31 < a6)
                                {
                                  unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= (blobLen)";
                                }

                                else
                                {
                                  if (BYTE6(v54) == 2)
                                  {
                                    memmove((void *)(v30 + v29), a5, a6);
                                    unsigned __int16 v32 = WORD2(v54) + a6;
                                    WORD2(v54) += a6;
                                    uint64_t v33 = v53;
                                    if (HIBYTE(v54))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                      int v34 = 0;
                                    }

                                    else
                                    {
                                      int v34 = WORD1(v54) - v32;
                                    }

                                    int v35 = 27 - a6;
                                    if (v34 < v35)
                                    {
                                      uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= (27 - blobLen)";
                                    }

                                    else
                                    {
                                      if (BYTE6(v54) == 2)
                                      {
                                        bzero((void *)(v33 + v32), v35);
                                        unsigned __int16 v39 = WORD2(v54) + v35;
                                        WORD2(v54) += v35;
                                        if (HIBYTE(v54))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else if (WORD1(v54) > v39)
                                        {
                                          if (BYTE6(v54) == 2)
                                          {
                                            WORD2(v54) = v39 + 1;
                                            *(_BYTE *)(v53 + v39) = a7;
                                            if (HIBYTE(v54))
                                            {
                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetoo"
                                                                     "th_base/Stack/vsc/bcm/bcm_vsc.c");
                                            }

                                            else
                                            {
                                              uint64_t v40 = WORD2(v54);
                                              if (WORD1(v54) > WORD2(v54))
                                              {
                                                if (BYTE6(v54) == 2)
                                                {
                                                  ++WORD2(v54);
                                                  *(_BYTE *)(v53 + v40) = a8;
                                                  if (HIBYTE(v54))
                                                  {
                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileB"
                                                                           "luetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                  }

                                                  else
                                                  {
                                                    uint64_t v41 = WORD2(v54);
                                                    if (WORD1(v54) > WORD2(v54))
                                                    {
                                                      if (BYTE6(v54) == 2)
                                                      {
                                                        ++WORD2(v54);
                                                        *(_BYTE *)(v53 + v41) = a9;
                                                        return sub_10018BD78( 233,  v53,  BYTE4(v54),  a10,  (uint64_t)sub_10013A594,  v36,  v37,  v38);
                                                      }

                                                      uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_84:
                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack /vsc/bcm/bcm_vsc.c",  3573,  v52);
                                                    }
                                                  }

                                                  uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                  goto LABEL_84;
                                                }

                                                uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_80:
                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3572,  v51);
                                              }
                                            }

                                            uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                            goto LABEL_80;
                                          }

                                          uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_76:
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3571,  v50);
                                        }

                                        uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_76;
                                      }

                                      uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                    }

                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3570,  v49);
                                  }

                                  unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }

                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3569,  v48);
                              }

                              char v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }

                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3568,  v47);
                          }

                          uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }

                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3567,  v46);
                      }

                      uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_60:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3566,  v45);
                    }

                    uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_60;
                  }

                  unsigned __int8 v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3565,  v44);
                }

                unsigned __int8 v44 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_56;
              }

              uint64_t v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3564,  v43);
            }
          }

          uint64_t v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_52;
        }

        uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3563, v42);
      }
    }

    uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_48;
  }

  return result;
}

uint64_t sub_10015C8A0(__int16 a1, uint64_t a2)
{
  uint64_t v13 = 0LL;
  uint64_t v14 = 0LL;
  uint64_t result = sub_10018BCDC(&v13);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v14))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v14);
      if (WORD1(v14) > WORD2(v14))
      {
        if (BYTE6(v14) == 2)
        {
          ++WORD2(v14);
          *(_BYTE *)(v13 + v8) = 90;
          if (HIBYTE(v14))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v9 = WORD2(v14);
            if (WORD1(v14) > WORD2(v14))
            {
              if (BYTE6(v14) == 2)
              {
                ++WORD2(v14);
                *(_BYTE *)(v13 + v9) = 2;
                if (HIBYTE(v14))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v14) - WORD2(v14) > 1)
                {
                  if (BYTE6(v14) == 2)
                  {
                    *(_WORD *)(v13 + WORD2(v14)) = a1;
                    WORD2(v14) += 2;
                    return sub_10018BD78(233, v13, BYTE4(v14), a2, (uint64_t)sub_10013A594, v5, v6, v7);
                  }

                  uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3587,  v12);
                }

                uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_24;
              }

              uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3586,  v11);
            }
          }

          uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3585, v10);
      }
    }

    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10015CA80(uint64_t a1)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v6) = 90;
          if (HIBYTE(v11))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v7 = WORD2(v11);
            if (WORD1(v11) > WORD2(v11))
            {
              if (BYTE6(v11) == 2)
              {
                ++WORD2(v11);
                *(_BYTE *)(v10 + v7) = 3;
                return sub_10018BD78(233, v10, BYTE4(v11), a1, (uint64_t)sub_10013A594, v3, v4, v5);
              }

              uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3600,  v9);
            }
          }

          uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }

        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3599, v8);
      }
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015CBC8(__int16 a1, char a2, char a3, char a4, uint64_t a5, char a6, uint64_t a7)
{
  uint64_t v29 = 0LL;
  uint64_t v30 = 0LL;
  uint64_t result = sub_10018BCDC(&v29);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v30))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v17 = WORD2(v30);
      if (WORD1(v30) > WORD2(v30))
      {
        if (BYTE6(v30) == 2)
        {
          ++WORD2(v30);
          *(_BYTE *)(v29 + v17) = 89;
          if (HIBYTE(v30))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v30) - WORD2(v30) > 1)
          {
            if (BYTE6(v30) == 2)
            {
              *(_WORD *)(v29 + WORD2(v30)) = a1;
              __int16 v18 = WORD2(v30);
              unsigned __int16 v19 = WORD2(v30) + 2;
              WORD2(v30) += 2;
              if (HIBYTE(v30))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v30) > v19)
              {
                if (BYTE6(v30) == 2)
                {
                  WORD2(v30) = v18 + 3;
                  *(_BYTE *)(v29 + v19) = a2;
                  if (HIBYTE(v30))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v20 = WORD2(v30);
                    if (WORD1(v30) > WORD2(v30))
                    {
                      if (BYTE6(v30) == 2)
                      {
                        ++WORD2(v30);
                        *(_BYTE *)(v29 + v20) = a3;
                        if (HIBYTE(v30))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v21 = WORD2(v30);
                          if (WORD1(v30) > WORD2(v30))
                          {
                            if (BYTE6(v30) == 2)
                            {
                              ++WORD2(v30);
                              *(_BYTE *)(v29 + v21) = a4;
                              if (HIBYTE(v30))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v22 = WORD2(v30);
                                if (WORD1(v30) > WORD2(v30))
                                {
                                  if (BYTE6(v30) == 2)
                                  {
                                    ++WORD2(v30);
                                    *(_BYTE *)(v29 + v22) = a6;
                                    return sub_10018BD78( 233,  v29,  BYTE4(v30),  a7,  (uint64_t)sub_10013A594,  v14,  v15,  v16);
                                  }

                                  int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3618,  v28);
                                }
                              }

                              int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_45;
                            }

                            int v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3617,  v27);
                          }
                        }

                        int v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_41;
                      }

                      uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3615,  v26);
                    }
                  }

                  uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_37;
                }

                unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3614,  v25);
              }

              unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_33;
            }

            int v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3613,  v24);
          }

          int v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_29;
        }

        uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3612, v23);
      }
    }

    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_10015CF2C( __int16 a1, char a2, char a3, unsigned int a4, int *a5, char a6, char a7, __int16 a8, __int16 a9, char a10, char a11, char a12, char a13, __int16 a14, uint64_t a15)
{
  uint64_t v60 = 0LL;
  uint64_t v61 = 0LL;
  uint64_t result = sub_10018BCDC(&v60);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v61))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v27 = WORD2(v61);
      if (WORD1(v61) > WORD2(v61))
      {
        if (BYTE6(v61) == 2)
        {
          ++WORD2(v61);
          *(_BYTE *)(v60 + v27) = 13;
          if (HIBYTE(v61))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v61) - WORD2(v61) > 1)
          {
            if (BYTE6(v61) == 2)
            {
              *(_WORD *)(v60 + WORD2(v61)) = a1;
              __int16 v28 = WORD2(v61);
              unsigned __int16 v29 = WORD2(v61) + 2;
              WORD2(v61) += 2;
              if (HIBYTE(v61))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v61) > v29)
              {
                if (BYTE6(v61) == 2)
                {
                  WORD2(v61) = v28 + 3;
                  *(_BYTE *)(v60 + v29) = a2;
                  if (HIBYTE(v61))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v30 = WORD2(v61);
                    if (WORD1(v61) > WORD2(v61))
                    {
                      if (BYTE6(v61) == 2)
                      {
                        ++WORD2(v61);
                        *(_BYTE *)(v60 + v30) = a3;
                        if (!a4) {
                          goto LABEL_36;
                        }
                        uint64_t v31 = a4;
                        do
                        {
                          int v33 = *a5++;
                          int v32 = v33;
                          if (v33 == 762) {
                            char v34 = 62;
                          }
                          else {
                            char v34 = 0;
                          }
                          if (v32 == 761) {
                            char v34 = 61;
                          }
                          if (v32 == 734) {
                            char v34 = 34;
                          }
                          if (v32 == 719) {
                            char v35 = 19;
                          }
                          else {
                            char v35 = 0;
                          }
                          if (v32 == 708) {
                            char v35 = 8;
                          }
                          if (v32 <= 733) {
                            char v36 = v35;
                          }
                          else {
                            char v36 = v34;
                          }
                          if (HIBYTE(v61))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_70:
                            unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_72:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3662,  v48);
                          }

                          uint64_t v37 = WORD2(v61);
                          if (BYTE6(v61) != 2)
                          {
                            unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            goto LABEL_72;
                          }

                          ++WORD2(v61);
                          *(_BYTE *)(v60 + v37) = v36;
                          --v31;
                        }

                        while (v31);
                        if (a4 <= 4)
                        {
LABEL_36:
                          unsigned int v38 = a4 - 5;
                          while (!HIBYTE(v61))
                          {
                            uint64_t v39 = WORD2(v61);
                            if (BYTE6(v61) != 2)
                            {
                              char v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                              goto LABEL_68;
                            }

                            ++WORD2(v61);
                            *(_BYTE *)(v60 + v39) = 0;
                            if (__CFADD__(v38++, 1)) {
                              goto LABEL_42;
                            }
                          }

                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_66:
                          char v47 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_68:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3665,  v47);
                        }

uint64_t sub_10015D6D4(char a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = a1;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) > WORD2(v12))
          {
            if (BYTE6(v12) == 2)
            {
              *(_BYTE *)(v11 + WORD2(v12)) = 0;
              ++WORD2(v12);
              return sub_10018BD78(348, v11, BYTE4(v12), a2, (uint64_t)sub_10013A594, v5, v6, v7);
            }

            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  4080,  v10);
          }

          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
          goto LABEL_17;
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4079, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015D81C(uint64_t a1, char a2, uint64_t a3, uint64_t a4)
{
  uint64_t v25 = 0LL;
  uint64_t v26 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t v6 = sub_10010EEE0(a1, (uint64_t *)&v26);
  if (!(_DWORD)v6)
  {
    uint64_t v7 = sub_10018BCDC(&v24);
    if ((_DWORD)v7) {
      return v7;
    }
    if (HIBYTE(v25))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v25) - WORD2(v25) > 1)
    {
      if (BYTE6(v25) == 2)
      {
        *(_WORD *)(v24 + WORD2(v25)) = *v26;
        __int16 v19 = WORD2(v25);
        unsigned __int16 v20 = WORD2(v25) + 2;
        WORD2(v25) += 2;
        if (HIBYTE(v25))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v25) > v20)
        {
          if (BYTE6(v25) == 2)
          {
            WORD2(v25) = v19 + 3;
            *(_BYTE *)(v24 + v20) = a2;
            return sub_10018BD78(87, v24, BYTE4(v25), a4, (uint64_t)sub_10013A594, v16, v17, v18);
          }

          uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_21:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4103, v23);
        }

        uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_21;
      }

      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4102, v22);
    }

    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_17;
  }

  uint64_t v7 = v6;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC Error %!", v8, v9, v10, v11, v12, v13, v14, v7);
    uint64_t v15 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v7;
}

uint64_t sub_10015D9F4(__int16 a1, char a2, char a3, char a4, char a5, uint64_t a6)
{
  uint64_t v25 = 0LL;
  uint64_t v26 = 0LL;
  uint64_t result = sub_10018BCDC(&v25);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v26))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v26) - WORD2(v26) > 1)
    {
      if (BYTE6(v26) == 2)
      {
        *(_WORD *)(v25 + WORD2(v26)) = a1;
        __int16 v16 = WORD2(v26);
        unsigned __int16 v17 = WORD2(v26) + 2;
        WORD2(v26) += 2;
        if (HIBYTE(v26))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v26) > v17)
        {
          if (BYTE6(v26) == 2)
          {
            WORD2(v26) = v16 + 3;
            *(_BYTE *)(v25 + v17) = a2;
            if (HIBYTE(v26))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v18 = WORD2(v26);
              if (WORD1(v26) > WORD2(v26))
              {
                if (BYTE6(v26) == 2)
                {
                  ++WORD2(v26);
                  *(_BYTE *)(v25 + v18) = a3;
                  if (HIBYTE(v26))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v19 = WORD2(v26);
                    if (WORD1(v26) > WORD2(v26))
                    {
                      if (BYTE6(v26) == 2)
                      {
                        ++WORD2(v26);
                        *(_BYTE *)(v25 + v19) = a4;
                        if (HIBYTE(v26))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v26) > WORD2(v26))
                        {
                          if (BYTE6(v26) == 2)
                          {
                            *(_BYTE *)(v25 + WORD2(v26)) = a5;
                            ++WORD2(v26);
                            return sub_10018BD78(435, v25, BYTE4(v26), a6, (uint64_t)sub_10013A594, v13, v14, v15);
                          }

                          uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5099,  v24);
                        }

                        uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                        goto LABEL_38;
                      }

                      uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5098,  v23);
                    }
                  }

                  uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_34;
                }

                uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5097,  v22);
              }
            }

            uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_30;
          }

          uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5096, v21);
        }

        uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_26;
      }

      unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5095, v20);
    }

    unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_10015DCE4(char a1, uint64_t a2)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v19) - WORD2(v19) > 3)
    {
      if (BYTE6(v19) == 2)
      {
        *(_BYTE *)(v18 + WORD2(v19)) = 32;
        *(_WORD *)(v18 + WORD2(v19) + 1) = 0;
        *(_BYTE *)(v18 + WORD2(v19) + 3) = 0;
        __int16 v8 = WORD2(v19);
        unsigned __int16 v9 = WORD2(v19) + 4;
        WORD2(v19) += 4;
        if (HIBYTE(v19))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v19) > v9)
        {
          if (BYTE6(v19) == 2)
          {
            WORD2(v19) = v8 + 5;
            *(_BYTE *)(v18 + v9) = a1;
            if (HIBYTE(v19))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v10 = WORD2(v19);
              if (WORD1(v19) > WORD2(v19))
              {
                if (BYTE6(v19) == 2)
                {
                  ++WORD2(v19);
                  *(_BYTE *)(v18 + v10) = 0;
                  if (HIBYTE(v19))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v11 = WORD2(v19);
                    if (WORD1(v19) > WORD2(v19))
                    {
                      if (BYTE6(v19) == 2)
                      {
                        ++WORD2(v19);
                        *(_BYTE *)(v18 + v11) = 0;
                        if (HIBYTE(v19))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v12 = WORD2(v19);
                          if (WORD1(v19) > WORD2(v19))
                          {
                            if (BYTE6(v19) == 2)
                            {
                              ++WORD2(v19);
                              *(_BYTE *)(v18 + v12) = 0;
                              return sub_10018BD78(226, v18, BYTE4(v19), a2, (uint64_t)sub_10013A594, v5, v6, v7);
                            }

                            unsigned __int16 v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5119,  v17);
                          }
                        }

                        unsigned __int16 v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_38;
                      }

                      __int16 v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5118,  v16);
                    }
                  }

                  __int16 v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_34;
                }

                uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5117,  v15);
              }
            }

            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_30;
          }

          uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5115, v14);
        }

        uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_26;
      }

      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5114, v13);
    }

    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_10015DFCC(_WORD *a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = *a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(449, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5133, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5132, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015E13C(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 39;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5148, v11);
        }

        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5147, v10);
    }

    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015E2BC(int a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(_BYTE *)(v14 + v8) = -16;
          if (a1)
          {
            if (HIBYTE(v15))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              unsigned int v9 = WORD2(v15);
              if (WORD1(v15) > WORD2(v15))
              {
                if (BYTE6(v15) == 2)
                {
                  char v10 = 3;
LABEL_14:
                  WORD2(v15) = v9 + 1;
                  *(_BYTE *)(v14 + v9) = v10;
                  return sub_10018BD78(490, v14, BYTE4(v15), a2, (uint64_t)sub_10013A594, v5, v6, v7);
                }

                uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5163,  v12);
              }
            }

            uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_23;
          }

          if (HIBYTE(v15))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            unsigned int v9 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                char v10 = 0;
                goto LABEL_14;
              }

              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5165,  v13);
            }
          }

          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_27;
        }

        unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5161, v11);
      }
    }

    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_10015E478(__int16 a1, char a2, char a3, char a4, uint64_t a5)
{
  uint64_t v51 = 0LL;
  uint64_t v52 = 0LL;
  uint64_t result = sub_10018BCDC(&v51);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v52))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v52) - WORD2(v52) > 1)
    {
      if (BYTE6(v52) == 2)
      {
        *(_WORD *)(v51 + WORD2(v52)) = a1;
        __int16 v14 = WORD2(v52);
        unsigned __int16 v15 = WORD2(v52) + 2;
        WORD2(v52) += 2;
        if (HIBYTE(v52))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v52) > v15)
        {
          if (BYTE6(v52) == 2)
          {
            WORD2(v52) = v14 + 3;
            *(_BYTE *)(v51 + v15) = a2;
            if (HIBYTE(v52))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v16 = WORD2(v52);
              if (WORD1(v52) > WORD2(v52))
              {
                if (BYTE6(v52) == 2)
                {
                  ++WORD2(v52);
                  *(_BYTE *)(v51 + v16) = a3;
                  if (HIBYTE(v52))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v17 = WORD2(v52);
                    if (WORD1(v52) > WORD2(v52))
                    {
                      if (BYTE6(v52) == 2)
                      {
                        ++WORD2(v52);
                        *(_BYTE *)(v51 + v17) = a3;
                        if (HIBYTE(v52))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v18 = WORD2(v52);
                          if (WORD1(v52) > WORD2(v52))
                          {
                            if (BYTE6(v52) == 2)
                            {
                              ++WORD2(v52);
                              *(_BYTE *)(v51 + v18) = a3;
                              if (HIBYTE(v52))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v19 = WORD2(v52);
                                if (WORD1(v52) > WORD2(v52))
                                {
                                  if (BYTE6(v52) == 2)
                                  {
                                    ++WORD2(v52);
                                    *(_BYTE *)(v51 + v19) = a3;
                                    if (HIBYTE(v52))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v20 = WORD2(v52);
                                      if (WORD1(v52) > WORD2(v52))
                                      {
                                        if (BYTE6(v52) == 2)
                                        {
                                          ++WORD2(v52);
                                          *(_BYTE *)(v51 + v20) = a3;
                                          if (HIBYTE(v52))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v21 = WORD2(v52);
                                            if (WORD1(v52) > WORD2(v52))
                                            {
                                              if (BYTE6(v52) == 2)
                                              {
                                                ++WORD2(v52);
                                                *(_BYTE *)(v51 + v21) = a3;
                                                if (HIBYTE(v52))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  uint64_t v22 = WORD2(v52);
                                                  if (WORD1(v52) > WORD2(v52))
                                                  {
                                                    if (BYTE6(v52) == 2)
                                                    {
                                                      ++WORD2(v52);
                                                      *(_BYTE *)(v51 + v22) = a3;
                                                      if (HIBYTE(v52))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else
                                                      {
                                                        uint64_t v23 = WORD2(v52);
                                                        if (WORD1(v52) > WORD2(v52))
                                                        {
                                                          if (BYTE6(v52) == 2)
                                                          {
                                                            ++WORD2(v52);
                                                            *(_BYTE *)(v51 + v23) = a3;
                                                            if (HIBYTE(v52))
                                                            {
                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sourc"
                                                                                     "es/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                            }

                                                            else
                                                            {
                                                              uint64_t v24 = WORD2(v52);
                                                              if (WORD1(v52) > WORD2(v52))
                                                              {
                                                                if (BYTE6(v52) == 2)
                                                                {
                                                                  ++WORD2(v52);
                                                                  *(_BYTE *)(v51 + v24) = a3;
                                                                  if (HIBYTE(v52))
                                                                  {
                                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs"
                                                                                           "/Sources/MobileBluetooth_base"
                                                                                           "/Stack/vsc/bcm/bcm_vsc.c");
                                                                  }

                                                                  else
                                                                  {
                                                                    uint64_t v25 = WORD2(v52);
                                                                    if (WORD1(v52) > WORD2(v52))
                                                                    {
                                                                      if (BYTE6(v52) == 2)
                                                                      {
                                                                        ++WORD2(v52);
                                                                        *(_BYTE *)(v51 + v25) = a3;
                                                                        if (HIBYTE(v52))
                                                                        {
                                                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.app"
                                                                                                 "le.xbs/Sources/MobileBl"
                                                                                                 "uetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                        }

                                                                        else
                                                                        {
                                                                          uint64_t v26 = WORD2(v52);
                                                                          if (WORD1(v52) > WORD2(v52))
                                                                          {
                                                                            if (BYTE6(v52) == 2)
                                                                            {
                                                                              ++WORD2(v52);
                                                                              *(_BYTE *)(v51 + v26) = a3;
                                                                              if (HIBYTE(v52))
                                                                              {
                                                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                              }

                                                                              else
                                                                              {
                                                                                uint64_t v27 = WORD2(v52);
                                                                                if (WORD1(v52) > WORD2(v52))
                                                                                {
                                                                                  if (BYTE6(v52) == 2)
                                                                                  {
                                                                                    ++WORD2(v52);
                                                                                    *(_BYTE *)(v51 + v27) = a3;
                                                                                    if (HIBYTE(v52))
                                                                                    {
                                                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                    }

                                                                                    else
                                                                                    {
                                                                                      uint64_t v28 = WORD2(v52);
                                                                                      if (WORD1(v52) > WORD2(v52))
                                                                                      {
                                                                                        if (BYTE6(v52) == 2)
                                                                                        {
                                                                                          ++WORD2(v52);
                                                                                          *(_BYTE *)(v51 + v28) = a3;
                                                                                          if (HIBYTE(v52))
                                                                                          {
                                                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                          }

                                                                                          else
                                                                                          {
                                                                                            uint64_t v29 = WORD2(v52);
                                                                                            if (WORD1(v52) > WORD2(v52))
                                                                                            {
                                                                                              if (BYTE6(v52) == 2)
                                                                                              {
                                                                                                ++WORD2(v52);
                                                                                                *(_BYTE *)(v51 + v29) = a3;
                                                                                                if (HIBYTE(v52))
                                                                                                {
                                                                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                }

                                                                                                else
                                                                                                {
                                                                                                  uint64_t v30 = WORD2(v52);
                                                                                                  if (WORD1(v52) > WORD2(v52))
                                                                                                  {
                                                                                                    if (BYTE6(v52) == 2)
                                                                                                    {
                                                                                                      ++WORD2(v52);
                                                                                                      *(_BYTE *)(v51 + v30) = a3;
                                                                                                      if (HIBYTE(v52))
                                                                                                      {
                                                                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                      }

                                                                                                      else
                                                                                                      {
                                                                                                        uint64_t v31 = WORD2(v52);
                                                                                                        if (WORD1(v52) > WORD2(v52))
                                                                                                        {
                                                                                                          if (BYTE6(v52) == 2)
                                                                                                          {
                                                                                                            ++WORD2(v52);
                                                                                                            *(_BYTE *)(v51 + v31) = a3;
                                                                                                            if (HIBYTE(v52))
                                                                                                            {
                                                                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                            }

                                                                                                            else if (WORD1(v52) > WORD2(v52))
                                                                                                            {
                                                                                                              if (BYTE6(v52) == 2)
                                                                                                              {
                                                                                                                *(_BYTE *)(v51 + WORD2(v52)) = a4;
                                                                                                                ++WORD2(v52);
                                                                                                                return sub_10018BD78(441, v51, BYTE4(v52), a5, (uint64_t)sub_10013A594, v11, v12, v13);
                                                                                                              }

                                                                                                              uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_136:
                                                                                                              sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5276, v50);
                                                                                                            }

                                                                                                            uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                                                                                            goto LABEL_136;
                                                                                                          }

                                                                                                          uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_132:
                                                                                                          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5275, v49);
                                                                                                        }
                                                                                                      }

                                                                                                      uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                      goto LABEL_132;
                                                                                                    }

                                                                                                    unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_128:
                                                                                                    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5274, v48);
                                                                                                  }
                                                                                                }

                                                                                                unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                goto LABEL_128;
                                                                                              }

                                                                                              char v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_124:
                                                                                              sub_1000E6B88( "/Library/Caches/com.appl e.xbs/Sources/MobileBlue tooth_base/Stack/vsc/bcm/bcm_vsc.c",  5273,  v47);
                                                                                            }
                                                                                          }

                                                                                          char v47 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                          goto LABEL_124;
                                                                                        }

                                                                                        unsigned __int16 v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_120:
                                                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/ Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  5272,  v46);
                                                                                      }
                                                                                    }

                                                                                    unsigned __int16 v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                    goto LABEL_120;
                                                                                  }

                                                                                  unsigned __int16 v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_116:
                                                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Source s/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5271,  v45);
                                                                                }
                                                                              }

                                                                              unsigned __int16 v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                              goto LABEL_116;
                                                                            }

                                                                            __int16 v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_112:
                                                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/Mobi leBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5270,  v44);
                                                                          }
                                                                        }

                                                                        __int16 v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                        goto LABEL_112;
                                                                      }

                                                                      unsigned __int16 v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_108:
                                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBlue tooth_base/Stack/vsc/bcm/bcm_vsc.c",  5269,  v43);
                                                                    }
                                                                  }

                                                                  unsigned __int16 v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                  goto LABEL_108;
                                                                }

                                                                uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_104:
                                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ base/Stack/vsc/bcm/bcm_vsc.c",  5268,  v42);
                                                              }
                                                            }

                                                            uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                            goto LABEL_104;
                                                          }

                                                          uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_100:
                                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  5267,  v41);
                                                        }
                                                      }

                                                      uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_100;
                                                    }

                                                    uint64_t v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_96:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  5266,  v40);
                                                  }
                                                }

                                                uint64_t v40 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_96;
                                              }

                                              uint64_t v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_92:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5265,  v39);
                                            }
                                          }

                                          uint64_t v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_92;
                                        }

                                        unsigned int v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_88:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5264,  v38);
                                      }
                                    }

                                    unsigned int v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_88;
                                  }

                                  uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_84:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5263,  v37);
                                }
                              }

                              uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_84;
                            }

                            char v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_80:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5262,  v36);
                          }
                        }

                        char v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_80;
                      }

                      char v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_76:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5261,  v35);
                    }
                  }

                  char v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_76;
                }

                char v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_72:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5260,  v34);
              }
            }

            char v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_72;
          }

          int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_68:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5259, v33);
        }

        int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_68;
      }

      int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_64:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5258, v32);
    }

    int v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_64;
  }

  return result;
}

uint64_t sub_10015EDF4(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(484, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5080, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5079, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015EF60(_WORD *a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = *a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(491, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5332, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5331, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015F0D0(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(509, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5346, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10015F19C(uint64_t a1)
{
  uint64_t v6 = 0LL;
  uint64_t v7 = 0LL;
  uint64_t result = sub_10018BCDC(&v6);
  if (!(_DWORD)result) {
    return sub_10018BD78(474, v6, BYTE4(v7), a1, (uint64_t)sub_10013BE9C, v3, v4, v5);
  }
  return result;
}

uint64_t sub_10015F1EC(__int16 a1, uint64_t a2)
{
  uint64_t v9 = 0LL;
  uint64_t v10 = 0LL;
  uint64_t result = sub_10018BCDC(&v9);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v10))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = a1;
        WORD2(v10) += 2;
        return sub_10018BD78(522, v9, BYTE4(v10), a2, (uint64_t)sub_10013BFA8, v5, v6, v7);
      }

      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5372, v8);
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10015F2D4(__int16 a1, int a2, uint64_t a3)
{
  uint64_t v13 = 0LL;
  uint64_t v14 = 0LL;
  uint64_t result = sub_10018BCDC(&v13);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v14))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v14) - WORD2(v14) > 1)
    {
      if (BYTE6(v14) == 2)
      {
        *(_WORD *)(v13 + WORD2(v14)) = a1;
        unsigned __int16 v10 = WORD2(v14) + 2;
        WORD2(v14) += 2;
        if (HIBYTE(v14))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v14) - v10 > 3)
        {
          if (BYTE6(v14) == 2)
          {
            *(_BYTE *)(v13 + v10) = a2;
            *(_BYTE *)(v13 + WORD2(v14) + 1) = BYTE1(a2);
            *(_BYTE *)(v13 + WORD2(v14) + 2) = BYTE2(a2);
            *(_BYTE *)(v13 + WORD2(v14) + 3) = HIBYTE(a2);
            WORD2(v14) += 4;
            return sub_10018BD78(475, v13, BYTE4(v14), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5387, v12);
        }

        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }

      uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5386, v11);
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10015F484(__int16 a1, int a2, int a3, __int16 a4, __int16 a5, char a6, int a7, uint64_t a8)
{
  uint64_t v38 = 0LL;
  uint64_t v39 = 0LL;
  uint64_t result = sub_10018BCDC(&v38);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v39))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v39) - WORD2(v39) > 1)
    {
      if (BYTE6(v39) == 2)
      {
        *(_WORD *)(v38 + WORD2(v39)) = a1;
        unsigned __int16 v20 = WORD2(v39) + 2;
        WORD2(v39) += 2;
        if (HIBYTE(v39))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v39) - v20 > 3)
        {
          if (BYTE6(v39) == 2)
          {
            *(_BYTE *)(v38 + v20) = a2;
            *(_BYTE *)(v38 + WORD2(v39) + 1) = BYTE1(a2);
            *(_BYTE *)(v38 + WORD2(v39) + 2) = BYTE2(a2);
            *(_BYTE *)(v38 + WORD2(v39) + 3) = HIBYTE(a2);
            unsigned __int16 v21 = WORD2(v39) + 4;
            WORD2(v39) += 4;
            if (HIBYTE(v39))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v39) - v21 > 3)
            {
              if (BYTE6(v39) == 2)
              {
                *(_BYTE *)(v38 + v21) = a3;
                *(_BYTE *)(v38 + WORD2(v39) + 1) = BYTE1(a3);
                *(_BYTE *)(v38 + WORD2(v39) + 2) = BYTE2(a3);
                *(_BYTE *)(v38 + WORD2(v39) + 3) = HIBYTE(a3);
                unsigned __int16 v22 = WORD2(v39) + 4;
                WORD2(v39) += 4;
                if (HIBYTE(v39))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v39) - v22 > 1)
                {
                  if (BYTE6(v39) == 2)
                  {
                    *(_BYTE *)(v38 + v22) = a4;
                    *(_BYTE *)(v38 + WORD2(v39) + 1) = HIBYTE(a4);
                    unsigned __int16 v23 = WORD2(v39) + 2;
                    WORD2(v39) += 2;
                    if (HIBYTE(v39))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v39) - v23 > 1)
                    {
                      if (BYTE6(v39) == 2)
                      {
                        *(_BYTE *)(v38 + v23) = a5;
                        *(_BYTE *)(v38 + WORD2(v39) + 1) = HIBYTE(a5);
                        __int16 v24 = WORD2(v39);
                        unsigned __int16 v25 = WORD2(v39) + 2;
                        WORD2(v39) += 2;
                        if (HIBYTE(v39))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v39) > v25)
                        {
                          if (BYTE6(v39) == 2)
                          {
                            WORD2(v39) = v24 + 3;
                            *(_BYTE *)(v38 + v25) = a6;
                            if (HIBYTE(v39))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v26 = WORD2(v39);
                              if (WORD1(v39) > WORD2(v39))
                              {
                                if (BYTE6(v39) == 2)
                                {
                                  ++WORD2(v39);
                                  *(_BYTE *)(v38 + v26) = a7;
                                  if (HIBYTE(v39))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    uint64_t v27 = WORD2(v39);
                                    if (WORD1(v39) > WORD2(v39))
                                    {
                                      if (BYTE6(v39) == 2)
                                      {
                                        ++WORD2(v39);
                                        *(_BYTE *)(v38 + v27) = BYTE1(a7);
                                        if (HIBYTE(v39))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v28 = WORD2(v39);
                                          if (WORD1(v39) > WORD2(v39))
                                          {
                                            if (BYTE6(v39) == 2)
                                            {
                                              ++WORD2(v39);
                                              *(_BYTE *)(v38 + v28) = BYTE2(a7);
                                              return sub_10018BD78( 476,  v38,  BYTE4(v39),  a8,  (uint64_t)sub_10013A594,  v17,  v18,  v19);
                                            }

                                            uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5414,  v37);
                                          }
                                        }

                                        uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_66;
                                      }

                                      char v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5412,  v36);
                                    }
                                  }

                                  char v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_62;
                                }

                                char v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5410,  v35);
                              }
                            }

                            char v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_58;
                          }

                          char v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5407,  v34);
                        }

                        char v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_54;
                      }

                      int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5406,  v33);
                    }

                    int v33 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_50;
                  }

                  int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5405,  v32);
                }

                int v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_46;
              }

              uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5404,  v31);
            }

            uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_42;
          }

          uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5403, v30);
        }

        uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_38;
      }

      uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5402, v29);
    }

    uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_34;
  }

  return result;
}

uint64_t sub_10015FA24(uint64_t a1, int a2, int a3, __int16 a4, __int16 a5, char a6, int a7, uint64_t a8)
{
  uint64_t v38 = 0LL;
  uint64_t v39 = 0LL;
  uint64_t result = sub_10018BCDC(&v38);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v39))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v39) - WORD2(v39) > 5)
    {
      if (BYTE6(v39) == 2)
      {
        sub_1001F0050(v38 + WORD2(v39), a1, 6uLL);
        unsigned __int16 v20 = WORD2(v39) + 6;
        WORD2(v39) += 6;
        if (HIBYTE(v39))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v39) - v20 > 3)
        {
          if (BYTE6(v39) == 2)
          {
            *(_BYTE *)(v38 + v20) = a2;
            *(_BYTE *)(v38 + WORD2(v39) + 1) = BYTE1(a2);
            *(_BYTE *)(v38 + WORD2(v39) + 2) = BYTE2(a2);
            *(_BYTE *)(v38 + WORD2(v39) + 3) = HIBYTE(a2);
            unsigned __int16 v21 = WORD2(v39) + 4;
            WORD2(v39) += 4;
            if (HIBYTE(v39))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v39) - v21 > 3)
            {
              if (BYTE6(v39) == 2)
              {
                *(_BYTE *)(v38 + v21) = a3;
                *(_BYTE *)(v38 + WORD2(v39) + 1) = BYTE1(a3);
                *(_BYTE *)(v38 + WORD2(v39) + 2) = BYTE2(a3);
                *(_BYTE *)(v38 + WORD2(v39) + 3) = HIBYTE(a3);
                unsigned __int16 v22 = WORD2(v39) + 4;
                WORD2(v39) += 4;
                if (HIBYTE(v39))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v39) - v22 > 1)
                {
                  if (BYTE6(v39) == 2)
                  {
                    *(_BYTE *)(v38 + v22) = a4;
                    *(_BYTE *)(v38 + WORD2(v39) + 1) = HIBYTE(a4);
                    unsigned __int16 v23 = WORD2(v39) + 2;
                    WORD2(v39) += 2;
                    if (HIBYTE(v39))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v39) - v23 > 1)
                    {
                      if (BYTE6(v39) == 2)
                      {
                        *(_BYTE *)(v38 + v23) = a5;
                        *(_BYTE *)(v38 + WORD2(v39) + 1) = HIBYTE(a5);
                        __int16 v24 = WORD2(v39);
                        unsigned __int16 v25 = WORD2(v39) + 2;
                        WORD2(v39) += 2;
                        if (HIBYTE(v39))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v39) > v25)
                        {
                          if (BYTE6(v39) == 2)
                          {
                            WORD2(v39) = v24 + 3;
                            *(_BYTE *)(v38 + v25) = a6;
                            if (HIBYTE(v39))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v26 = WORD2(v39);
                              if (WORD1(v39) > WORD2(v39))
                              {
                                if (BYTE6(v39) == 2)
                                {
                                  ++WORD2(v39);
                                  *(_BYTE *)(v38 + v26) = a7;
                                  if (HIBYTE(v39))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    uint64_t v27 = WORD2(v39);
                                    if (WORD1(v39) > WORD2(v39))
                                    {
                                      if (BYTE6(v39) == 2)
                                      {
                                        ++WORD2(v39);
                                        *(_BYTE *)(v38 + v27) = BYTE1(a7);
                                        if (HIBYTE(v39))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v28 = WORD2(v39);
                                          if (WORD1(v39) > WORD2(v39))
                                          {
                                            if (BYTE6(v39) == 2)
                                            {
                                              ++WORD2(v39);
                                              *(_BYTE *)(v38 + v28) = BYTE2(a7);
                                              return sub_10018BD78( 516,  v38,  BYTE4(v39),  a8,  (uint64_t)sub_10013A594,  v17,  v18,  v19);
                                            }

                                            uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5440,  v37);
                                          }
                                        }

                                        uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_66;
                                      }

                                      char v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5438,  v36);
                                    }
                                  }

                                  char v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_62;
                                }

                                char v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5436,  v35);
                              }
                            }

                            char v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_58;
                          }

                          char v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5433,  v34);
                        }

                        char v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_54;
                      }

                      int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5432,  v33);
                    }

                    int v33 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_50;
                  }

                  int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5431,  v32);
                }

                int v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_46;
              }

              uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5430,  v31);
            }

            uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_42;
          }

          uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5429, v30);
        }

        uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_38;
      }

      uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5428, v29);
    }

    uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_34;
  }

  return result;
}

uint64_t sub_10015FFBC(char a1, __int16 a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v12 = WORD2(v21);
      if (WORD1(v21) > WORD2(v21))
      {
        if (BYTE6(v21) == 2)
        {
          ++WORD2(v21);
          *(_BYTE *)(v20 + v12) = 0;
          if (HIBYTE(v21))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v13 = WORD2(v21);
            if (WORD1(v21) > WORD2(v21))
            {
              if (BYTE6(v21) == 2)
              {
                ++WORD2(v21);
                *(_BYTE *)(v20 + v13) = a1;
                if (HIBYTE(v21))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v21) - WORD2(v21) > 1)
                {
                  if (BYTE6(v21) == 2)
                  {
                    *(_WORD *)(v20 + WORD2(v21)) = a2;
                    __int16 v14 = WORD2(v21);
                    unsigned __int16 v15 = WORD2(v21) + 2;
                    WORD2(v21) += 2;
                    if (HIBYTE(v21))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v21) > v15)
                    {
                      if (BYTE6(v21) == 2)
                      {
                        WORD2(v21) = v14 + 3;
                        *(_BYTE *)(v20 + v15) = a3;
                        return sub_10018BD78(622, v20, BYTE4(v21), a4, (uint64_t)sub_10013D2DC, v9, v10, v11);
                      }

                      uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5456,  v19);
                    }

                    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }

                  uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5455,  v18);
                }

                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_27;
              }

              uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5454,  v17);
            }
          }

          uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5453, v16);
      }
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_10016021C(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(592, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5470, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001602E8(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(593, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5484, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001603B4(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(604, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5498, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100160480(uint64_t a1, __int16 a2, char a3, __int16 a4, char a5, char a6, char a7)
{
  uint64_t v34 = 0LL;
  uint64_t v35 = 0LL;
  uint64_t result = sub_10018BCDC(&v34);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v35))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v35) - WORD2(v35) > 5)
    {
      if (BYTE6(v35) == 2)
      {
        sub_1001F0050(v34 + WORD2(v35), a1, 6uLL);
        unsigned __int16 v18 = WORD2(v35) + 6;
        WORD2(v35) += 6;
        if (HIBYTE(v35))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v35) - v18 > 1)
        {
          if (BYTE6(v35) == 2)
          {
            *(_BYTE *)(v34 + v18) = a2;
            *(_BYTE *)(v34 + WORD2(v35) + 1) = HIBYTE(a2);
            __int16 v19 = WORD2(v35);
            unsigned __int16 v20 = WORD2(v35) + 2;
            WORD2(v35) += 2;
            if (HIBYTE(v35))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v35) > v20)
            {
              if (BYTE6(v35) == 2)
              {
                WORD2(v35) = v19 + 3;
                *(_BYTE *)(v34 + v20) = a3;
                if (HIBYTE(v35))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v21 = WORD2(v35);
                  if (WORD1(v35) > WORD2(v35))
                  {
                    if (BYTE6(v35) == 2)
                    {
                      ++WORD2(v35);
                      *(_BYTE *)(v34 + v21) = 0;
                      if (HIBYTE(v35))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v35) - WORD2(v35) > 1)
                      {
                        if (BYTE6(v35) == 2)
                        {
                          *(_WORD *)(v34 + WORD2(v35)) = a4;
                          __int16 v22 = WORD2(v35);
                          unsigned __int16 v23 = WORD2(v35) + 2;
                          WORD2(v35) += 2;
                          if (HIBYTE(v35))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v35) > v23)
                          {
                            if (BYTE6(v35) == 2)
                            {
                              WORD2(v35) = v22 + 3;
                              *(_BYTE *)(v34 + v23) = a5;
                              if (HIBYTE(v35))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v24 = WORD2(v35);
                                if (WORD1(v35) > WORD2(v35))
                                {
                                  if (BYTE6(v35) == 2)
                                  {
                                    ++WORD2(v35);
                                    *(_BYTE *)(v34 + v24) = a6;
                                    if (HIBYTE(v35))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v25 = WORD2(v35);
                                      if (WORD1(v35) > WORD2(v35))
                                      {
                                        if (BYTE6(v35) == 2)
                                        {
                                          ++WORD2(v35);
                                          *(_BYTE *)(v34 + v25) = a7;
                                          return sub_10018BD78( 598,  v34,  BYTE4(v35),  0LL,  (uint64_t)sub_10013A594,  v15,  v16,  v17);
                                        }

                                        int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5520,  v33);
                                      }
                                    }

                                    int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_59;
                                  }

                                  int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5519,  v32);
                                }
                              }

                              int v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_55;
                            }

                            uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5518,  v31);
                          }

                          uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_51;
                        }

                        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5517,  v30);
                      }

                      uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                      goto LABEL_47;
                    }

                    uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5516,  v29);
                  }
                }

                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_43;
              }

              uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5515,  v28);
            }

            uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_39;
          }

          uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5514, v27);
        }

        uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_35;
      }

      uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5513, v26);
    }

    uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_31;
  }

  return result;
}

uint64_t sub_10016090C(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(599, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5535, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5534, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100160A78(char a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(_BYTE *)(v14 + v10) = a1;
          if (HIBYTE(v15))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v11 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                ++WORD2(v15);
                *(_BYTE *)(v14 + v11) = a2;
                return sub_10018BD78(600, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
              }

              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5550,  v13);
            }
          }

          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }

        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5549, v12);
      }
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100160BC8(__int16 a1, __int16 a2, uint64_t a3)
{
  uint64_t v13 = 0LL;
  uint64_t v14 = 0LL;
  uint64_t result = sub_10018BCDC(&v13);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v14))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v14) - WORD2(v14) > 1)
    {
      if (BYTE6(v14) == 2)
      {
        *(_WORD *)(v13 + WORD2(v14)) = a1;
        unsigned __int16 v10 = WORD2(v14) + 2;
        WORD2(v14) += 2;
        if (HIBYTE(v14))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v14) - v10 > 1)
        {
          if (BYTE6(v14) == 2)
          {
            *(_BYTE *)(v13 + v10) = a2;
            *(_BYTE *)(v13 + WORD2(v14) + 1) = HIBYTE(a2);
            WORD2(v14) += 2;
            return sub_10018BD78(601, v13, BYTE4(v14), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5565, v12);
        }

        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_17;
      }

      uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5564, v11);
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100160D50(int a1, _WORD *a2, _BYTE *a3, char *a4, uint64_t a5)
{
  LODWORD(v9) = a1;
  uint64_t v22 = 0LL;
  uint64_t v23 = 0LL;
  uint64_t result = sub_10018BCDC(&v22);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v23))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_34;
  }

  uint64_t v14 = WORD2(v23);
  if (WORD1(v23) <= WORD2(v23))
  {
LABEL_34:
    uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_36;
  }

  if (BYTE6(v23) != 2)
  {
    uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5580, v21);
  }

  ++WORD2(v23);
  *(_BYTE *)(v22 + v14) = v9;
  if ((_DWORD)v9)
  {
    uint64_t v9 = v9;
    while (!HIBYTE(v23))
    {
      if (WORD1(v23) - WORD2(v23) <= 1) {
        goto LABEL_22;
      }
      if (BYTE6(v23) != 2)
      {
        unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_24;
      }

      *(_WORD *)(v22 + WORD2(v23)) = *a2;
      unsigned __int16 v15 = WORD2(v23) + 2;
      WORD2(v23) += 2;
      if (HIBYTE(v23))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_26:
        __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5584, v19);
      }

      if (WORD1(v23) - v15 <= 1) {
        goto LABEL_26;
      }
      if (BYTE6(v23) != 2)
      {
        __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_28;
      }

      *(_BYTE *)(v22 + v15) = *a3;
      *(_BYTE *)(v22 + WORD2(v23) + 1) = a3[1];
      unsigned __int16 v16 = WORD2(v23) + 2;
      WORD2(v23) += 2;
      if (HIBYTE(v23))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_30:
        unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= (63)";
LABEL_32:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5585, v20);
      }

      if (WORD1(v23) - v16 <= 62) {
        goto LABEL_30;
      }
      if (BYTE6(v23) != 2)
      {
        unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_32;
      }

      memmove((void *)(v22 + v16), a4, 0x3FuLL);
      unsigned __int8 v17 = BYTE4(v23) + 63;
      WORD2(v23) += 63;
      a4 += 63;
      a3 += 2;
      ++a2;
      if (!--v9) {
        return sub_10018BD78(606, v22, v17, a5, (uint64_t)sub_10013A594, v11, v12, v13);
      }
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_22:
    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_24:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5583, v18);
  }

  unsigned __int8 v17 = BYTE4(v23);
  return sub_10018BD78(606, v22, v17, a5, (uint64_t)sub_10013A594, v11, v12, v13);
}

uint64_t sub_100161014(char a1, char a2, char a3, char a4, uint64_t a5)
{
  uint64_t v22 = 0LL;
  uint64_t v23 = 0LL;
  uint64_t result = sub_10018BCDC(&v22);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v23))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v23);
      if (WORD1(v23) > WORD2(v23))
      {
        if (BYTE6(v23) == 2)
        {
          ++WORD2(v23);
          *(_BYTE *)(v22 + v14) = a1;
          if (HIBYTE(v23))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v15 = WORD2(v23);
            if (WORD1(v23) > WORD2(v23))
            {
              if (BYTE6(v23) == 2)
              {
                ++WORD2(v23);
                *(_BYTE *)(v22 + v15) = a2;
                if (HIBYTE(v23))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v16 = WORD2(v23);
                  if (WORD1(v23) > WORD2(v23))
                  {
                    if (BYTE6(v23) == 2)
                    {
                      ++WORD2(v23);
                      *(_BYTE *)(v22 + v16) = a3;
                      if (HIBYTE(v23))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v17 = WORD2(v23);
                        if (WORD1(v23) > WORD2(v23))
                        {
                          if (BYTE6(v23) == 2)
                          {
                            ++WORD2(v23);
                            *(_BYTE *)(v22 + v17) = a4;
                            return sub_10018BD78(609, v22, BYTE4(v23), a5, (uint64_t)sub_10013D4B8, v11, v12, v13);
                          }

                          uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5603,  v21);
                        }
                      }

                      uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_31;
                    }

                    unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5602,  v20);
                  }
                }

                unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_27;
              }

              __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5601,  v19);
            }
          }

          __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }

        unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5600, v18);
      }
    }

    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100161264(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(605, v14, BYTE4(v15), a3, (uint64_t)sub_10013D7A0, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5618, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5617, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_1001613D0(__int16 a1, uint64_t a2)
{
  uint64_t v9 = 0LL;
  uint64_t v10 = 0LL;
  uint64_t result = sub_10018BCDC(&v9);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v10))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = a1;
        WORD2(v10) += 2;
        return sub_10018BD78(602, v9, BYTE4(v10), a2, (uint64_t)sub_10013DAFC, v5, v6, v7);
      }

      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5630, v8);
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001614B8(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(621, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5642, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100161584(unsigned int a1, char *a2, char *a3, char *a4, uint64_t a5)
{
  uint64_t v26 = 0LL;
  uint64_t v27 = 0LL;
  uint64_t result = sub_10018BCDC(&v26);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v27))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_32;
  }

  uint64_t v14 = WORD2(v27);
  if (WORD1(v27) <= WORD2(v27))
  {
LABEL_32:
    uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }

  if (BYTE6(v27) != 2)
  {
    uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5654, v25);
  }

  ++WORD2(v27);
  *(_BYTE *)(v26 + v14) = a1;
  if (a1)
  {
    uint64_t v15 = a1;
    while (!HIBYTE(v27))
    {
      uint64_t v16 = WORD2(v27);
      if (BYTE6(v27) != 2)
      {
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_22;
      }

      char v17 = *a2;
      ++WORD2(v27);
      *(_BYTE *)(v26 + v16) = v17;
      if (HIBYTE(v27))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_24:
        uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_26:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5657, v23);
      }

      uint64_t v18 = WORD2(v27);
      if (BYTE6(v27) != 2)
      {
        uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_26;
      }

      char v19 = *a3;
      ++WORD2(v27);
      *(_BYTE *)(v26 + v18) = v19;
      if (HIBYTE(v27))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_28:
        uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_30:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5658, v24);
      }

      uint64_t v20 = WORD2(v27);
      if (BYTE6(v27) != 2)
      {
        uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_30;
      }

      char v21 = *a4++;
      ++WORD2(v27);
      *(_BYTE *)(v26 + v20) = v21;
      ++a3;
      ++a2;
      if (!--v15) {
        return sub_10018BD78(637, v26, BYTE4(v27), a5, (uint64_t)sub_10013A594, v11, v12, v13);
      }
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_20:
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_22:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5656, v22);
  }

  return sub_10018BD78(637, v26, BYTE4(v27), a5, (uint64_t)sub_10013A594, v11, v12, v13);
}

uint64_t sub_1001617F8( uint64_t a1, int a2, char a3, char a4, char a5, uint64_t *a6, char a7, char a8, char a9, char a10, __int16 a11, char a12, char a13, uint64_t a14)
{
  uint64_t v115 = 0LL;
  uint64_t v116 = 0LL;
  uint64_t result = sub_10018BCDC(&v115);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v116))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_153;
  }

  if (WORD1(v116) - WORD2(v116) <= 5)
  {
LABEL_153:
    v75 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_155;
  }

  if (BYTE6(v116) != 2)
  {
    v75 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_155:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5681, v75);
  }

  sub_1001F0050(v115 + WORD2(v116), a1, 6uLL);
  __int16 v26 = WORD2(v116);
  unsigned __int16 v27 = WORD2(v116) + 6;
  WORD2(v116) += 6;
  if (HIBYTE(v116))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_157;
  }

  if (WORD1(v116) <= v27)
  {
LABEL_157:
    v76 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_159;
  }

  if (BYTE6(v116) != 2)
  {
    v76 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_159:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5682, v76);
  }

  WORD2(v116) = v26 + 7;
  *(_BYTE *)(v115 + v27) = a2;
  switch(a2)
  {
    case 0:
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        uint64_t v36 = WORD2(v116);
        if (WORD1(v116) > WORD2(v116))
        {
          if (BYTE6(v116) == 2)
          {
            ++WORD2(v116);
            *(_BYTE *)(v115 + v36) = a8;
            if (HIBYTE(v116))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v37 = WORD2(v116);
              if (WORD1(v116) > WORD2(v116))
              {
                if (BYTE6(v116) == 2)
                {
                  ++WORD2(v116);
                  *(_BYTE *)(v115 + v37) = a9;
                  if (HIBYTE(v116))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v38 = WORD2(v116);
                    if (WORD1(v116) > WORD2(v116))
                    {
                      if (BYTE6(v116) == 2)
                      {
                        ++WORD2(v116);
                        *(_BYTE *)(v115 + v38) = a10;
                        if (HIBYTE(v116))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v116) - WORD2(v116) > 1)
                        {
                          if (BYTE6(v116) == 2)
                          {
                            *(_WORD *)(v115 + WORD2(v116)) = a11;
                            __int16 v39 = WORD2(v116);
                            unsigned __int16 v40 = WORD2(v116) + 2;
                            WORD2(v116) += 2;
                            if (HIBYTE(v116))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v116) > v40)
                            {
                              if (BYTE6(v116) == 2)
                              {
                                WORD2(v116) = v39 + 3;
                                *(_BYTE *)(v115 + v40) = a12;
                                if (HIBYTE(v116))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else
                                {
                                  unsigned int v34 = WORD2(v116);
                                  if (WORD1(v116) > WORD2(v116))
                                  {
                                    if (BYTE6(v116) != 2)
                                    {
                                      uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                      goto LABEL_209;
                                    }

                                    goto LABEL_149;
                                  }
                                }

                                uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_209:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5691,  v41);
                              }

                              int v87 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_206:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5690,  v87);
                            }

                            int v87 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_206;
                          }

                          int v86 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_202:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5689,  v86);
                        }

                        int v86 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_202;
                      }

                      int v85 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_198:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5688,  v85);
                    }
                  }

                  int v85 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_198;
                }

                v84 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_194:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5687,  v84);
              }
            }

            v84 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_194;
          }

          v83 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_190:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5686, v83);
        }
      }

      v83 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_190;
    case 1:
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_211;
      }

      uint64_t v42 = WORD2(v116);
      if (WORD1(v116) <= WORD2(v116))
      {
LABEL_211:
        uint64_t v88 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_213;
      }

      if (BYTE6(v116) != 2)
      {
        uint64_t v88 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_213:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5695, v88);
      }

      ++WORD2(v116);
      *(_BYTE *)(v115 + v42) = a3;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_215;
      }

      uint64_t v43 = WORD2(v116);
      if (WORD1(v116) <= WORD2(v116))
      {
LABEL_215:
        uint64_t v89 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_217;
      }

      if (BYTE6(v116) != 2)
      {
        uint64_t v89 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_217:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5696, v89);
      }

      ++WORD2(v116);
      *(_BYTE *)(v115 + v43) = a8;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_219;
      }

      uint64_t v44 = WORD2(v116);
      if (WORD1(v116) <= WORD2(v116))
      {
LABEL_219:
        uint64_t v90 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_221;
      }

      if (BYTE6(v116) != 2)
      {
        uint64_t v90 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_221:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5697, v90);
      }

      ++WORD2(v116);
      *(_BYTE *)(v115 + v44) = a9;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_223;
      }

      uint64_t v45 = WORD2(v116);
      if (WORD1(v116) <= WORD2(v116))
      {
LABEL_223:
        v91 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_225;
      }

      if (BYTE6(v116) != 2)
      {
        v91 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_225:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5698, v91);
      }

      ++WORD2(v116);
      *(_BYTE *)(v115 + v45) = a10;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_227;
      }

      if (WORD1(v116) - WORD2(v116) <= 1)
      {
LABEL_227:
        uint64_t v92 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_229;
      }

      if (BYTE6(v116) != 2)
      {
        uint64_t v92 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_229:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5699, v92);
      }

      *(_WORD *)(v115 + WORD2(v116)) = a11;
      __int16 v46 = WORD2(v116);
      unsigned __int16 v47 = WORD2(v116) + 2;
      WORD2(v116) += 2;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_231;
      }

      if (WORD1(v116) <= v47)
      {
LABEL_231:
        uint64_t v93 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_233;
      }

      if (BYTE6(v116) != 2)
      {
        uint64_t v93 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_233:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5700, v93);
      }

      WORD2(v116) = v46 + 3;
      *(_BYTE *)(v115 + v47) = a12;
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_235;
      }

      unsigned int v34 = WORD2(v116);
      if (WORD1(v116) <= WORD2(v116))
      {
LABEL_235:
        unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_236:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5701, v48);
      }

      if (BYTE6(v116) != 2)
      {
        unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_236;
      }

LABEL_149:
      WORD2(v116) = v34 + 1;
      *(_BYTE *)(v115 + v34) = a13;
      return sub_10018BD78(81, v115, BYTE4(v116), a14, (uint64_t)sub_10013A594, v23, v24, v25);
    case 2:
      return sub_10018BD78(81, v115, BYTE4(v116), a14, (uint64_t)sub_10013A594, v23, v24, v25);
    case 3:
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else if (WORD1(v116) - WORD2(v116) > 9)
      {
        if (BYTE6(v116) == 2)
        {
          uint64_t v49 = v115 + WORD2(v116);
          uint64_t v50 = *a6;
          *(_WORD *)(v49 + 8) = *((_WORD *)a6 + 4);
          *(void *)uint64_t v49 = v50;
          __int16 v51 = WORD2(v116);
          unsigned __int16 v52 = WORD2(v116) + 10;
          WORD2(v116) += 10;
          if (HIBYTE(v116))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v116) > v52)
          {
            if (BYTE6(v116) == 2)
            {
              WORD2(v116) = v51 + 11;
              *(_BYTE *)(v115 + v52) = a8;
              if (HIBYTE(v116))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else
              {
                uint64_t v53 = WORD2(v116);
                if (WORD1(v116) > WORD2(v116))
                {
                  if (BYTE6(v116) == 2)
                  {
                    ++WORD2(v116);
                    *(_BYTE *)(v115 + v53) = a9;
                    if (HIBYTE(v116))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else
                    {
                      uint64_t v54 = WORD2(v116);
                      if (WORD1(v116) > WORD2(v116))
                      {
                        if (BYTE6(v116) == 2)
                        {
                          ++WORD2(v116);
                          *(_BYTE *)(v115 + v54) = a10;
                          if (HIBYTE(v116))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v116) - WORD2(v116) > 1)
                          {
                            if (BYTE6(v116) == 2)
                            {
                              *(_WORD *)(v115 + WORD2(v116)) = a11;
                              __int16 v55 = WORD2(v116);
                              unsigned __int16 v56 = WORD2(v116) + 2;
                              WORD2(v116) += 2;
                              if (HIBYTE(v116))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else if (WORD1(v116) > v56)
                              {
                                if (BYTE6(v116) == 2)
                                {
                                  WORD2(v116) = v55 + 3;
                                  *(_BYTE *)(v115 + v56) = a12;
                                  if (HIBYTE(v116))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    unsigned int v34 = WORD2(v116);
                                    if (WORD1(v116) > WORD2(v116))
                                    {
                                      if (BYTE6(v116) == 2) {
                                        goto LABEL_149;
                                      }
                                      unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_263:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5711,  v57);
                                    }
                                  }

                                  unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_263;
                                }

                                uint64_t v99 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_260:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5710,  v99);
                              }

                              uint64_t v99 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_260;
                            }

                            int v98 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_256:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5709,  v98);
                          }

                          int v98 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_256;
                        }

                        unsigned int v97 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_252:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5708,  v97);
                      }
                    }

                    unsigned int v97 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_252;
                  }

                  uint64_t v96 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_248:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5707,  v96);
                }
              }

              uint64_t v96 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_248;
            }

            uint64_t v95 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_244:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5706,  v95);
          }

          uint64_t v95 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_244;
        }

        int v94 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_240:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5705, v94);
      }

      int v94 = "ByteStream_NumReadBytesAvail(bs) >= (10)";
      goto LABEL_240;
    case 4:
      if (HIBYTE(v116))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        uint64_t v58 = WORD2(v116);
        if (WORD1(v116) > WORD2(v116))
        {
          if (BYTE6(v116) == 2)
          {
            ++WORD2(v116);
            *(_BYTE *)(v115 + v58) = a3;
            if (HIBYTE(v116))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v59 = WORD2(v116);
              if (WORD1(v116) > WORD2(v116))
              {
                if (BYTE6(v116) == 2)
                {
                  ++WORD2(v116);
                  *(_BYTE *)(v115 + v59) = a4;
                  if (HIBYTE(v116))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v60 = WORD2(v116);
                    if (WORD1(v116) > WORD2(v116))
                    {
                      if (BYTE6(v116) == 2)
                      {
                        ++WORD2(v116);
                        *(_BYTE *)(v115 + v60) = a5;
                        if (HIBYTE(v116))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v61 = WORD2(v116);
                          if (WORD1(v116) > WORD2(v116))
                          {
                            if (BYTE6(v116) == 2)
                            {
                              ++WORD2(v116);
                              *(_BYTE *)(v115 + v61) = a8;
                              if (HIBYTE(v116))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v62 = WORD2(v116);
                                if (WORD1(v116) > WORD2(v116))
                                {
                                  if (BYTE6(v116) == 2)
                                  {
                                    ++WORD2(v116);
                                    *(_BYTE *)(v115 + v62) = a9;
                                    if (HIBYTE(v116))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v63 = WORD2(v116);
                                      if (WORD1(v116) > WORD2(v116))
                                      {
                                        if (BYTE6(v116) == 2)
                                        {
                                          ++WORD2(v116);
                                          *(_BYTE *)(v115 + v63) = a10;
                                          if (HIBYTE(v116))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else if (WORD1(v116) - WORD2(v116) > 1)
                                          {
                                            if (BYTE6(v116) == 2)
                                            {
                                              *(_WORD *)(v115 + WORD2(v116)) = a11;
                                              __int16 v64 = WORD2(v116);
                                              unsigned __int16 v65 = WORD2(v116) + 2;
                                              WORD2(v116) += 2;
                                              if (HIBYTE(v116))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else if (WORD1(v116) > v65)
                                              {
                                                if (BYTE6(v116) == 2)
                                                {
                                                  WORD2(v116) = v64 + 3;
                                                  *(_BYTE *)(v115 + v65) = a12;
                                                  if (HIBYTE(v116))
                                                  {
                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileB"
                                                                           "luetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                  }

                                                  else
                                                  {
                                                    unsigned int v34 = WORD2(v116);
                                                    if (WORD1(v116) > WORD2(v116))
                                                    {
                                                      if (BYTE6(v116) == 2) {
                                                        goto LABEL_149;
                                                      }
                                                      uint64_t v66 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_298:
                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack /vsc/bcm/bcm_vsc.c",  5723,  v66);
                                                    }
                                                  }

                                                  uint64_t v66 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                  goto LABEL_298;
                                                }

                                                uint64_t v107 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_295:
                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5722,  v107);
                                              }

                                              uint64_t v107 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_295;
                                            }

                                            unsigned __int16 v106 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_291:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5721,  v106);
                                          }

                                          unsigned __int16 v106 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                          goto LABEL_291;
                                        }

                                        unsigned __int16 v105 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_287:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5720,  v105);
                                      }
                                    }

                                    unsigned __int16 v105 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_287;
                                  }

                                  uint64_t v104 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_283:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5719,  v104);
                                }
                              }

                              uint64_t v104 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_283;
                            }

                            uint64_t v103 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_279:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5718,  v103);
                          }
                        }

                        uint64_t v103 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_279;
                      }

                      uint64_t v102 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_275:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5717,  v102);
                    }
                  }

                  uint64_t v102 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_275;
                }

                uint64_t v101 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_271:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5716,  v101);
              }
            }

            uint64_t v101 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_271;
          }

          uint64_t v100 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_267:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5715,  v100);
        }
      }

      uint64_t v100 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_267;
    default:
      switch(a2)
      {
        case 128:
          if (HIBYTE(v116))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v28 = WORD2(v116);
            if (WORD1(v116) > WORD2(v116))
            {
              if (BYTE6(v116) == 2)
              {
                ++WORD2(v116);
                *(_BYTE *)(v115 + v28) = a7;
                if (HIBYTE(v116))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v29 = WORD2(v116);
                  if (WORD1(v116) > WORD2(v116))
                  {
                    if (BYTE6(v116) == 2)
                    {
                      ++WORD2(v116);
                      *(_BYTE *)(v115 + v29) = a8;
                      if (HIBYTE(v116))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v30 = WORD2(v116);
                        if (WORD1(v116) > WORD2(v116))
                        {
                          if (BYTE6(v116) == 2)
                          {
                            ++WORD2(v116);
                            *(_BYTE *)(v115 + v30) = a9;
                            if (HIBYTE(v116))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v31 = WORD2(v116);
                              if (WORD1(v116) > WORD2(v116))
                              {
                                if (BYTE6(v116) == 2)
                                {
                                  ++WORD2(v116);
                                  *(_BYTE *)(v115 + v31) = a10;
                                  if (HIBYTE(v116))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else if (WORD1(v116) - WORD2(v116) > 1)
                                  {
                                    if (BYTE6(v116) == 2)
                                    {
                                      *(_WORD *)(v115 + WORD2(v116)) = a11;
                                      __int16 v32 = WORD2(v116);
                                      unsigned __int16 v33 = WORD2(v116) + 2;
                                      WORD2(v116) += 2;
                                      if (HIBYTE(v116))
                                      {
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }

                                      else if (WORD1(v116) > v33)
                                      {
                                        if (BYTE6(v116) == 2)
                                        {
                                          WORD2(v116) = v32 + 3;
                                          *(_BYTE *)(v115 + v33) = a12;
                                          if (HIBYTE(v116))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            unsigned int v34 = WORD2(v116);
                                            if (WORD1(v116) > WORD2(v116))
                                            {
                                              if (BYTE6(v116) == 2) {
                                                goto LABEL_149;
                                              }
                                              uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_186:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5733,  v35);
                                            }
                                          }

                                          uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_186;
                                        }

                                        v82 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_183:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5732,  v82);
                                      }

                                      v82 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                      goto LABEL_183;
                                    }

                                    v81 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_179:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5731,  v81);
                                  }

                                  v81 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_179;
                                }

                                v80 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_175:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5730,  v80);
                              }
                            }

                            v80 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_175;
                          }

                          BOOL v79 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_171:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5729,  v79);
                        }
                      }

                      BOOL v79 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_171;
                    }

                    v78 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_167:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5728,  v78);
                  }
                }

                v78 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_167;
              }

              char v77 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_163:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5727,  v77);
            }
          }

          char v77 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_163;
        case 129:
          if (HIBYTE(v116))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v67 = WORD2(v116);
            if (WORD1(v116) > WORD2(v116))
            {
              if (BYTE6(v116) == 2)
              {
                ++WORD2(v116);
                *(_BYTE *)(v115 + v67) = a7;
                if (HIBYTE(v116))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v68 = WORD2(v116);
                  if (WORD1(v116) > WORD2(v116))
                  {
                    if (BYTE6(v116) == 2)
                    {
                      ++WORD2(v116);
                      *(_BYTE *)(v115 + v68) = a3;
                      if (HIBYTE(v116))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v69 = WORD2(v116);
                        if (WORD1(v116) > WORD2(v116))
                        {
                          if (BYTE6(v116) == 2)
                          {
                            ++WORD2(v116);
                            *(_BYTE *)(v115 + v69) = a8;
                            if (HIBYTE(v116))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v70 = WORD2(v116);
                              if (WORD1(v116) > WORD2(v116))
                              {
                                if (BYTE6(v116) == 2)
                                {
                                  ++WORD2(v116);
                                  *(_BYTE *)(v115 + v70) = a9;
                                  if (HIBYTE(v116))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    uint64_t v71 = WORD2(v116);
                                    if (WORD1(v116) > WORD2(v116))
                                    {
                                      if (BYTE6(v116) == 2)
                                      {
                                        ++WORD2(v116);
                                        *(_BYTE *)(v115 + v71) = a10;
                                        if (HIBYTE(v116))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else if (WORD1(v116) - WORD2(v116) > 1)
                                        {
                                          if (BYTE6(v116) == 2)
                                          {
                                            *(_WORD *)(v115 + WORD2(v116)) = a11;
                                            __int16 v72 = WORD2(v116);
                                            unsigned __int16 v73 = WORD2(v116) + 2;
                                            WORD2(v116) += 2;
                                            if (HIBYTE(v116))
                                            {
                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetoo"
                                                                     "th_base/Stack/vsc/bcm/bcm_vsc.c");
                                            }

                                            else if (WORD1(v116) > v73)
                                            {
                                              if (BYTE6(v116) == 2)
                                              {
                                                WORD2(v116) = v72 + 3;
                                                *(_BYTE *)(v115 + v73) = a12;
                                                if (HIBYTE(v116))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  unsigned int v34 = WORD2(v116);
                                                  if (WORD1(v116) > WORD2(v116))
                                                  {
                                                    if (BYTE6(v116) == 2) {
                                                      goto LABEL_149;
                                                    }
                                                    uint64_t v74 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_329:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  5744,  v74);
                                                  }
                                                }

                                                uint64_t v74 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_329;
                                              }

                                              int v114 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_326:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5743,  v114);
                                            }

                                            int v114 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                            goto LABEL_326;
                                          }

                                          int v113 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_322:
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5742,  v113);
                                        }

                                        int v113 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                        goto LABEL_322;
                                      }

                                      int v112 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_318:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5741,  v112);
                                    }
                                  }

                                  int v112 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_318;
                                }

                                int v111 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_314:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5740,  v111);
                              }
                            }

                            int v111 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_314;
                          }

                          int v110 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_310:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5739,  v110);
                        }
                      }

                      int v110 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_310;
                    }

                    int v109 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_306:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5738,  v109);
                  }
                }

                int v109 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_306;
              }

              unsigned __int16 v108 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_302:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5737,  v108);
            }
          }

          unsigned __int16 v108 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_302;
        default:
          return sub_10018BD78(81, v115, BYTE4(v116), a14, (uint64_t)sub_10013A594, v23, v24, v25);
      }
  }

        *a8 = 0;
        goto LABEL_127;
      }

      (*(void (**)(uint64_t, uint64_t, id))(*(void *)v62 + 8LL))(v62, v19, v15);
      if (qword_1008D61A8 != -1) {
        dispatch_once(&qword_1008D61A8, &stru_10088BCE0);
      }
      sub_1004966BC(qword_1008D61A0, v67);
LABEL_126:
      char v19 = 0LL;
      goto LABEL_127;
    }

    if (qword_1008D6788 != -1) {
      dispatch_once(&qword_1008D6788, &stru_10088BAC0);
    }
    unsigned __int16 v33 = sub_1002075B4((uint64_t)off_1008D6780);
    if (v33)
    {
      if (!v63[179]) {
        goto LABEL_99;
      }
      unsigned int v34 = (os_log_s *)qword_1008F7628;
      if (!os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT)) {
        goto LABEL_98;
      }
      sub_100494958(v19, (uint64_t)__p);
      if (v71[9] >= 0) {
        uint64_t v35 = __p;
      }
      else {
        uint64_t v35 = *(_BYTE **)__p;
      }
      *(_DWORD *)buf = 136446210;
      *(void *)&buf[4] = v35;
      uint64_t v36 = "Bluetooth is in denylist mode - show LE_DENYLIST_ENABLED alert for %{public}s";
    }

    else
    {
      unsigned int v34 = (os_log_s *)qword_1008F7628;
      if (!os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
      {
LABEL_98:
        (*(void (**)(uint64_t, uint64_t, BOOL))(*(void *)v62 + 24LL))(v62, v19, v33 != 0);
        goto LABEL_99;
      }

      sub_100494958(v19, (uint64_t)__p);
      if (v71[9] >= 0) {
        uint64_t v44 = __p;
      }
      else {
        uint64_t v44 = *(_BYTE **)__p;
      }
      *(_DWORD *)buf = 136446210;
      *(void *)&buf[4] = v44;
      uint64_t v36 = "Bluetooth is powered off - notifying session %{public}s";
    }

    _os_log_impl((void *)&_mh_execute_header, v34, OS_LOG_TYPE_DEFAULT, v36, buf, 0xCu);
    if ((v71[9] & 0x80000000) != 0) {
      operator delete(*(void **)__p);
    }
    goto LABEL_98;
  }

  *(void *)&uint64_t v16 = 136446466LL;
  unsigned __int16 v57 = v16;
  while (1)
  {
    char v19 = v17[4];
    uint64_t v20 = v17[5];
    if ((*(unsigned int (**)(uint64_t))(*(void *)v20 + 16LL))(v20) == 3)
    {
      if (*(void *)(v20 + 216) == a2)
      {
        char v21 = (os_log_s *)qword_1008F7628;
        if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_FAULT))
        {
          sub_100494958(v19, (uint64_t)__p);
          uint64_t v24 = __p;
          if (v71[9] < 0) {
            uint64_t v24 = *(_BYTE **)__p;
          }
          *(_DWORD *)buf = v57;
          *(void *)&buf[4] = v24;
          v78 = 2114;
          BOOL v79 = v15;
          _os_log_fault_impl( (void *)&_mh_execute_header,  v21,  OS_LOG_TYPE_FAULT,  "Duplicate check-in message from session %{public}s in application %{public}@",  buf,  0x16u);
          if ((v71[9] & 0x80000000) != 0) {
            operator delete(*(void **)__p);
          }
        }
      }

      if (objc_msgSend(*(id *)(v20 + 88), "isEqualToString:", v15, v57, obj, v59))
      {
        if (!*(void *)(v20 + 216) && *(void *)(v20 + 96)) {
          sub_10027B07C((uint64_t)v63, *(void **)(v20 + 88), 15);
        }
        if ([*(id *)(v20 + 96) isEqualToString:v64]
          && (*(unsigned int (**)(uint64_t))(*(void *)v20 + 16LL))(v20) == a6)
        {
          break;
        }
      }
    }

    uint64_t v22 = (void *)v17[1];
    if (v22)
    {
      do
      {
        uint64_t v23 = v22;
        uint64_t v22 = (void *)*v22;
      }

      while (v22);
    }

    else
    {
      do
      {
        uint64_t v23 = (void *)v17[2];
        uint64_t v30 = *v23 == (void)v17;
        char v17 = v23;
      }

      while (!v30);
    }

    char v17 = v23;
    if (v23 == v18) {
      goto LABEL_23;
    }
  }

  uint64_t v37 = (os_log_s *)qword_1008F7628;
  if (*(void *)(v20 + 216))
  {
    if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_ERROR))
    {
      sub_100494958(v19, (uint64_t)buf);
      uint64_t v38 = v80 >= 0 ? buf : *(_BYTE **)buf;
      *(_DWORD *)__p = 138543874;
      *(void *)&__p[4] = v64;
      uint64_t v70 = 2082;
      *(void *)uint64_t v71 = v38;
      *(_WORD *)&v71[8] = 2114;
      __int16 v72 = (const char *)v15;
      _os_log_error_impl( (void *)&_mh_execute_header,  v37,  OS_LOG_TYPE_ERROR,  "(CBSR) Duplicate restore identifier %{public}@ from session %{public}s in application %{public}@",  __p,  0x20u);
      if (v80 < 0) {
        operator delete(*(void **)buf);
      }
    }

    goto LABEL_126;
  }

  if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
  {
    sub_100494958(v19, (uint64_t)buf);
    __int16 v39 = "unknown";
    if (a6 == 3) {
      __int16 v39 = "classic";
    }
    if (a6 == 1) {
      __int16 v39 = "peripheral";
    }
    if (!a6) {
      __int16 v39 = "central";
    }
    *(_DWORD *)__p = 136446722;
    *(void *)&__p[4] = v39;
    if (v80 >= 0) {
      unsigned __int16 v40 = buf;
    }
    else {
      unsigned __int16 v40 = *(_BYTE **)buf;
    }
    uint64_t v70 = 2082;
    *(void *)uint64_t v71 = v40;
    *(_WORD *)&v71[8] = 2114;
    __int16 v72 = (const char *)v15;
    _os_log_impl( (void *)&_mh_execute_header,  v37,  OS_LOG_TYPE_DEFAULT,  "(CBSR) Restoring zombie'd %{public}s session %{public}s for application %{public}@",  __p,  0x20u);
    if (v80 < 0) {
      operator delete(*(void **)buf);
    }
  }

  *(void *)(v20 + 216) = a2;
  sub_100494C98(v19, a5);
  (*(void (**)(_BYTE *, uint64_t))(*(void *)v63 + 16LL))(v63, v19);
  uint64_t v41 = (os_log_s *)qword_1008F7628;
  if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
  {
    *(_WORD *)__p = 0;
    _os_log_impl( (void *)&_mh_execute_header,  v41,  OS_LOG_TYPE_DEFAULT,  "Ignore needsRestrictedStateOperation since restorable sessions are always apps",  __p,  2u);
  }

  if (v63[179]) {
    goto LABEL_149;
  }
  if (qword_1008D6788 != -1) {
    dispatch_once(&qword_1008D6788, &stru_10088BAC0);
  }
  uint64_t v42 = sub_1002075B4((uint64_t)off_1008D6780);
  *a8 = v42;
  if (v42)
  {
    uint64_t v43 = sub_100404FE8();
    v68[0] = _NSConcreteStackBlock;
    v68[1] = 3221225472LL;
    v68[2] = sub_10027CB3C;
    v68[3] = &unk_100888050;
    v68[4] = v63;
    v68[5] = v19;
    v68[6] = v20;
    sub_100405384(v43, v68);
  }

      LOBYTE(__p[0]) = 0;
      sub_100242CA4(__p);
      char v77 = sub_1000EF578(*(unsigned __int16 *)(a2 + 4), 0LL);
      sub_100242CD0(__p);
      goto LABEL_210;
    }

uint64_t sub_100163784( uint64_t a1, __int16 a2, int a3, char a4, char a5, char a6, char a7, char a8, char a9, __int16 a10, uint64_t a11)
{
  uint64_t v42 = 0LL;
  uint64_t v43 = 0LL;
  uint64_t result = sub_10018BCDC(&v42);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v43))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v43) - WORD2(v43) > 5)
    {
      if (BYTE6(v43) == 2)
      {
        sub_1001F0050(v42 + WORD2(v43), a1, 6uLL);
        unsigned __int16 v23 = WORD2(v43) + 6;
        WORD2(v43) += 6;
        if (HIBYTE(v43))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v43) - v23 > 1)
        {
          if (BYTE6(v43) == 2)
          {
            *(_BYTE *)(v42 + v23) = a2;
            *(_BYTE *)(v42 + WORD2(v43) + 1) = HIBYTE(a2);
            __int16 v24 = WORD2(v43);
            unsigned __int16 v25 = WORD2(v43) + 2;
            WORD2(v43) += 2;
            if (a3)
            {
              if (HIBYTE(v43))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v43) > v25)
              {
                if (BYTE6(v43) == 2)
                {
                  char v26 = a5 | (a4 << 7);
                  goto LABEL_17;
                }

                uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5785,  v38);
              }

              uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_66;
            }

            if (HIBYTE(v43))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v43) > v25)
            {
              if (BYTE6(v43) == 2)
              {
                char v26 = 0;
LABEL_17:
                WORD2(v43) = v24 + 3;
                *(_BYTE *)(v42 + v25) = v26;
                if (HIBYTE(v43))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v27 = WORD2(v43);
                  if (WORD1(v43) > WORD2(v43))
                  {
                    if (BYTE6(v43) == 2)
                    {
                      ++WORD2(v43);
                      *(_BYTE *)(v42 + v27) = a6;
                      if (HIBYTE(v43))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v28 = WORD2(v43);
                        if (WORD1(v43) > WORD2(v43))
                        {
                          if (BYTE6(v43) == 2)
                          {
                            ++WORD2(v43);
                            *(_BYTE *)(v42 + v28) = a7;
                            if (HIBYTE(v43))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v29 = WORD2(v43);
                              if (WORD1(v43) > WORD2(v43))
                              {
                                if (BYTE6(v43) == 2)
                                {
                                  ++WORD2(v43);
                                  *(_BYTE *)(v42 + v29) = a9;
                                  if (HIBYTE(v43))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else if (WORD1(v43) - WORD2(v43) > 1)
                                  {
                                    if (BYTE6(v43) == 2)
                                    {
                                      *(_WORD *)(v42 + WORD2(v43)) = a10;
                                      __int16 v30 = WORD2(v43);
                                      LOWORD(v31) = WORD2(v43) + 2;
                                      WORD2(v43) += 2;
                                      if (a3) {
                                        return sub_10018BD78( 82,  v42,  v31,  a11,  (uint64_t)sub_10013A594,  v20,  v21,  v22);
                                      }
                                      if (HIBYTE(v43))
                                      {
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }

                                      else if (WORD1(v43) > (unsigned __int16)v31)
                                      {
                                        if (BYTE6(v43) == 2)
                                        {
                                          WORD2(v43) = v30 + 3;
                                          *(_BYTE *)(v42 + (unsigned __int16)v31) = a8;
                                          if (HIBYTE(v43))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v31 = WORD2(v43);
                                            if (WORD1(v43) > WORD2(v43))
                                            {
                                              if (BYTE6(v43) == 2)
                                              {
                                                ++WORD2(v43);
                                                *(_BYTE *)(v42 + v31) = a5 | (a4 << 7);
                                                LOBYTE(v31) = BYTE4(v43);
                                                return sub_10018BD78( 82,  v42,  v31,  a11,  (uint64_t)sub_10013A594,  v20,  v21,  v22);
                                              }

                                              uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5795,  v41);
                                            }
                                          }

                                          uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_78;
                                        }

                                        unsigned __int16 v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_74:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5794,  v40);
                                      }

                                      unsigned __int16 v40 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                      goto LABEL_74;
                                    }

                                    uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5792,  v37);
                                  }

                                  uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_62;
                                }

                                uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5791,  v36);
                              }
                            }

                            uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_58;
                          }

                          uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5790,  v35);
                        }
                      }

                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_54;
                    }

                    unsigned int v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5789,  v34);
                  }
                }

                unsigned int v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_50;
              }

              __int16 v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_70:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5787,  v39);
            }

            __int16 v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_70;
          }

          unsigned __int16 v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5783, v33);
        }

        unsigned __int16 v33 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_46;
      }

      __int16 v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5782, v32);
    }

    __int16 v32 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_42;
  }

  return result;
}

uint64_t sub_100163D10( int a1, int a2, char a3, char a4, char a5, char a6, char a7, char a8, char a9, char a10, char a11, char a12, uint64_t a13)
{
  uint64_t v81 = 0LL;
  uint64_t v82 = 0LL;
  uint64_t result = sub_10018BCDC(&v81);
  if (!(_DWORD)result)
  {
    if (a1)
    {
      if (HIBYTE(v82))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }

      else
      {
        uint64_t v25 = WORD2(v82);
        if (WORD1(v82) > WORD2(v82))
        {
          if (BYTE6(v82) == 2)
          {
            ++WORD2(v82);
            *(_BYTE *)(v81 + v25) = a2 | 0x80;
            uint64_t v26 = v81 + WORD2(v82);
            if (a2)
            {
              if (HIBYTE(v82))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v82) - WORD2(v82) > 5)
              {
                if (BYTE6(v82) == 2)
                {
                  *(_WORD *)(v26 + 4) = 0;
                  *(_DWORD *)uint64_t v26 = 0;
                  __int16 v27 = WORD2(v82);
                  unsigned __int16 v28 = WORD2(v82) + 6;
                  WORD2(v82) += 6;
                  if (HIBYTE(v82))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v82) > v28)
                  {
                    if (BYTE6(v82) == 2)
                    {
                      WORD2(v82) = v27 + 7;
                      *(_BYTE *)(v81 + v28) = a7;
                      if (HIBYTE(v82))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v29 = WORD2(v82);
                        if (WORD1(v82) > WORD2(v82))
                        {
                          if (BYTE6(v82) == 2)
                          {
                            ++WORD2(v82);
                            *(_BYTE *)(v81 + v29) = a8;
                            if (HIBYTE(v82))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v30 = WORD2(v82);
                              if (WORD1(v82) > WORD2(v82))
                              {
                                if (BYTE6(v82) == 2)
                                {
                                  ++WORD2(v82);
                                  *(_BYTE *)(v81 + v30) = a9;
                                  if (HIBYTE(v82))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    uint64_t v31 = WORD2(v82);
                                    if (WORD1(v82) - WORD2(v82) > 1)
                                    {
                                      if (BYTE6(v82) != 2)
                                      {
                                        __int16 v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                        goto LABEL_117;
                                      }

                                      goto LABEL_67;
                                    }
                                  }

                                  __int16 v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_117:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5816,  v32);
                                }

                                uint64_t v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_114:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5815,  v59);
                              }
                            }

                            uint64_t v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_114;
                          }

                          uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_110:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5814,  v58);
                        }
                      }

                      uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_110;
                    }

                    unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_106:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5813,  v57);
                  }

                  unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_106;
                }

                unsigned __int16 v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_102:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5812,  v56);
              }

              unsigned __int16 v56 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
              goto LABEL_102;
            }

            if (HIBYTE(v82))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v82) > WORD2(v82))
            {
              if (BYTE6(v82) == 2)
              {
                *(_BYTE *)uint64_t v26 = 0;
                __int16 v39 = WORD2(v82);
                unsigned __int16 v40 = ++WORD2(v82);
                if (HIBYTE(v82))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v82) > v40)
                {
                  if (BYTE6(v82) == 2)
                  {
                    WORD2(v82) = v39 + 2;
                    *(_BYTE *)(v81 + v40) = a3;
                    if (HIBYTE(v82))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else
                    {
                      uint64_t v41 = WORD2(v82);
                      if (WORD1(v82) > WORD2(v82))
                      {
                        if (BYTE6(v82) == 2)
                        {
                          ++WORD2(v82);
                          *(_BYTE *)(v81 + v41) = a4;
                          if (HIBYTE(v82))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else
                          {
                            uint64_t v42 = WORD2(v82);
                            if (WORD1(v82) > WORD2(v82))
                            {
                              if (BYTE6(v82) == 2)
                              {
                                ++WORD2(v82);
                                *(_BYTE *)(v81 + v42) = a5;
                                if (HIBYTE(v82))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else if (WORD1(v82) > WORD2(v82))
                                {
                                  if (BYTE6(v82) == 2)
                                  {
                                    *(_BYTE *)(v81 + WORD2(v82)) = 0;
                                    __int16 v43 = WORD2(v82);
                                    unsigned __int16 v44 = ++WORD2(v82);
                                    if (HIBYTE(v82))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v82) > v44)
                                    {
                                      if (BYTE6(v82) == 2)
                                      {
                                        WORD2(v82) = v43 + 2;
                                        *(_BYTE *)(v81 + v44) = a6;
                                        if (HIBYTE(v82))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v45 = WORD2(v82);
                                          if (WORD1(v82) > WORD2(v82))
                                          {
                                            if (BYTE6(v82) == 2)
                                            {
                                              ++WORD2(v82);
                                              *(_BYTE *)(v81 + v45) = a7;
                                              if (HIBYTE(v82))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else
                                              {
                                                uint64_t v46 = WORD2(v82);
                                                if (WORD1(v82) > WORD2(v82))
                                                {
                                                  if (BYTE6(v82) == 2)
                                                  {
                                                    ++WORD2(v82);
                                                    *(_BYTE *)(v81 + v46) = a8;
                                                    if (HIBYTE(v82))
                                                    {
                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }

                                                    else
                                                    {
                                                      uint64_t v47 = WORD2(v82);
                                                      if (WORD1(v82) > WORD2(v82))
                                                      {
                                                        if (BYTE6(v82) == 2)
                                                        {
                                                          ++WORD2(v82);
                                                          *(_BYTE *)(v81 + v47) = a9;
                                                          if (HIBYTE(v82))
                                                          {
                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }

                                                          else
                                                          {
                                                            uint64_t v31 = WORD2(v82);
                                                            if (WORD1(v82) - WORD2(v82) > 1)
                                                            {
                                                              if (BYTE6(v82) == 2)
                                                              {
LABEL_67:
                                                                *(_BYTE *)(v81 + v31) = a11;
                                                                *(_BYTE *)(v81 + WORD2(v82) + 1) = a12;
                                                                WORD2(v82) += 2;
                                                                return sub_10018BD78( 501,  v81,  BYTE4(v82),  a13,  (uint64_t)sub_10013A594,  v22,  v23,  v24);
                                                              }

                                                              __int16 v72 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_172:
                                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ba se/Stack/vsc/bcm/bcm_vsc.c",  5828,  v72);
                                                            }
                                                          }

                                                          __int16 v72 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                          goto LABEL_172;
                                                        }

                                                        uint64_t v71 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_168:
                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Sta ck/vsc/bcm/bcm_vsc.c",  5827,  v71);
                                                      }
                                                    }

                                                    uint64_t v71 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_168;
                                                  }

                                                  uint64_t v70 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_164:
                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5826,  v70);
                                                }
                                              }

                                              uint64_t v70 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_164;
                                            }

                                            uint64_t v69 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_160:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5825,  v69);
                                          }
                                        }

                                        uint64_t v69 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_160;
                                      }

                                      uint64_t v68 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_156:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5824,  v68);
                                    }

                                    uint64_t v68 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_156;
                                  }

                                  uint64_t v67 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_152:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5823,  v67);
                                }

                                uint64_t v67 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                goto LABEL_152;
                              }

                              uint64_t v66 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_148:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5822,  v66);
                            }
                          }

                          uint64_t v66 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_148;
                        }

                        unsigned __int16 v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_144:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5821,  v65);
                      }
                    }

                    unsigned __int16 v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_144;
                  }

                  __int16 v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_140:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5820,  v64);
                }

                __int16 v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_140;
              }

              uint64_t v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_136:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5819,  v63);
            }

            uint64_t v63 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
            goto LABEL_136;
          }

          __int16 v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_98:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5809, v55);
        }
      }

      __int16 v55 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_98;
    }

    if (HIBYTE(v82))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v33 = WORD2(v82);
      if (WORD1(v82) > WORD2(v82))
      {
        if (BYTE6(v82) == 2)
        {
          ++WORD2(v82);
          *(_BYTE *)(v81 + v33) = a2;
          if (a2)
          {
            if (HIBYTE(v82))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v82) - WORD2(v82) > 5)
            {
              if (BYTE6(v82) == 2)
              {
                uint64_t v34 = v81 + WORD2(v82);
                *(_WORD *)(v34 + 4) = 0;
                *(_DWORD *)uint64_t v34 = 0;
                __int16 v35 = WORD2(v82);
                unsigned __int16 v36 = WORD2(v82) + 6;
                WORD2(v82) += 6;
                if (HIBYTE(v82))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v82) > v36)
                {
                  if (BYTE6(v82) == 2)
                  {
                    WORD2(v82) = v35 + 7;
                    *(_BYTE *)(v81 + v36) = a7;
                    if (HIBYTE(v82))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else
                    {
                      uint64_t v37 = WORD2(v82);
                      if (WORD1(v82) > WORD2(v82))
                      {
                        if (BYTE6(v82) != 2)
                        {
                          uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                          goto LABEL_132;
                        }

uint64_t sub_100164AF0( __int16 a1, __int16 a2, char a3, char a4, char a5, __int16 a6, __int16 a7, __int16 a8, char a9, char a10, char a11, char a12, char a13, char a14, char a15, char a16, uint64_t a17)
{
  uint64_t v55 = 0LL;
  uint64_t v56 = 0LL;
  uint64_t result = sub_10018BCDC(&v55);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v56))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v56) - WORD2(v56) > 1)
    {
      if (BYTE6(v56) == 2)
      {
        *(_WORD *)(v55 + WORD2(v56)) = a1;
        unsigned __int16 v29 = WORD2(v56) + 2;
        WORD2(v56) += 2;
        if (HIBYTE(v56))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v56) - v29 > 1)
        {
          if (BYTE6(v56) == 2)
          {
            *(_BYTE *)(v55 + v29) = a2;
            *(_BYTE *)(v55 + WORD2(v56) + 1) = HIBYTE(a2);
            __int16 v30 = WORD2(v56);
            unsigned __int16 v31 = WORD2(v56) + 2;
            WORD2(v56) += 2;
            if (HIBYTE(v56))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v56) > v31)
            {
              if (BYTE6(v56) == 2)
              {
                WORD2(v56) = v30 + 3;
                *(_BYTE *)(v55 + v31) = a3;
                if (HIBYTE(v56))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v32 = WORD2(v56);
                  if (WORD1(v56) > WORD2(v56))
                  {
                    if (BYTE6(v56) == 2)
                    {
                      ++WORD2(v56);
                      *(_BYTE *)(v55 + v32) = a4;
                      if (HIBYTE(v56))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v33 = WORD2(v56);
                        if (WORD1(v56) > WORD2(v56))
                        {
                          if (BYTE6(v56) == 2)
                          {
                            ++WORD2(v56);
                            *(_BYTE *)(v55 + v33) = a5;
                            if (HIBYTE(v56))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v56) - WORD2(v56) > 1)
                            {
                              if (BYTE6(v56) == 2)
                              {
                                *(_WORD *)(v55 + WORD2(v56)) = a6;
                                unsigned __int16 v34 = WORD2(v56) + 2;
                                WORD2(v56) += 2;
                                if (HIBYTE(v56))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else if (WORD1(v56) - v34 > 1)
                                {
                                  if (BYTE6(v56) == 2)
                                  {
                                    *(_BYTE *)(v55 + v34) = a7;
                                    *(_BYTE *)(v55 + WORD2(v56) + 1) = HIBYTE(a7);
                                    unsigned __int16 v35 = WORD2(v56) + 2;
                                    WORD2(v56) += 2;
                                    if (HIBYTE(v56))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v56) - v35 > 1)
                                    {
                                      if (BYTE6(v56) == 2)
                                      {
                                        *(_BYTE *)(v55 + v35) = a8;
                                        *(_BYTE *)(v55 + WORD2(v56) + 1) = HIBYTE(a8);
                                        unsigned __int16 v36 = WORD2(v56) + 2;
                                        WORD2(v56) += 2;
                                        if (HIBYTE(v56))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else if (WORD1(v56) - v36 > 1)
                                        {
                                          if (BYTE6(v56) == 2)
                                          {
                                            *(_BYTE *)(v55 + v36) = a9;
                                            *(_BYTE *)(v55 + WORD2(v56) + 1) = a10;
                                            unsigned __int16 v37 = WORD2(v56) + 2;
                                            WORD2(v56) += 2;
                                            if (HIBYTE(v56))
                                            {
                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetoo"
                                                                     "th_base/Stack/vsc/bcm/bcm_vsc.c");
                                            }

                                            else if (WORD1(v56) - v37 > 1)
                                            {
                                              if (BYTE6(v56) == 2)
                                              {
                                                *(_BYTE *)(v55 + v37) = a11;
                                                *(_BYTE *)(v55 + WORD2(v56) + 1) = a12;
                                                unsigned __int16 v38 = WORD2(v56) + 2;
                                                WORD2(v56) += 2;
                                                if (HIBYTE(v56))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else if (WORD1(v56) - v38 > 1)
                                                {
                                                  if (BYTE6(v56) == 2)
                                                  {
                                                    *(_BYTE *)(v55 + v38) = a13;
                                                    *(_BYTE *)(v55 + WORD2(v56) + 1) = a14;
                                                    __int16 v39 = WORD2(v56);
                                                    unsigned __int16 v40 = WORD2(v56) + 2;
                                                    WORD2(v56) += 2;
                                                    if (HIBYTE(v56))
                                                    {
                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }

                                                    else if (WORD1(v56) > v40)
                                                    {
                                                      if (BYTE6(v56) == 2)
                                                      {
                                                        WORD2(v56) = v39 + 3;
                                                        *(_BYTE *)(v55 + v40) = a15;
                                                        if (HIBYTE(v56))
                                                        {
                                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/M"
                                                                                 "obileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                        }

                                                        else
                                                        {
                                                          uint64_t v41 = WORD2(v56);
                                                          if (WORD1(v56) > WORD2(v56))
                                                          {
                                                            if (BYTE6(v56) == 2)
                                                            {
                                                              ++WORD2(v56);
                                                              *(_BYTE *)(v55 + v41) = a16;
                                                              return sub_10018BD78( 48,  v55,  BYTE4(v56),  a17,  (uint64_t)sub_10013A594,  v26,  v27,  v28);
                                                            }

                                                            unsigned __int16 v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_94:
                                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base /Stack/vsc/bcm/bcm_vsc.c",  5872,  v54);
                                                          }
                                                        }

                                                        unsigned __int16 v54 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                        goto LABEL_94;
                                                      }

                                                      __int16 v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_90:
                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack /vsc/bcm/bcm_vsc.c",  5871,  v53);
                                                    }

                                                    __int16 v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_90;
                                                  }

                                                  uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_86:
                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5870,  v52);
                                                }

                                                uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                goto LABEL_86;
                                              }

                                              uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_82:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5869,  v51);
                                            }

                                            uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                            goto LABEL_82;
                                          }

                                          uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5868,  v50);
                                        }

                                        uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                        goto LABEL_78;
                                      }

                                      uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_74:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5867,  v49);
                                    }

                                    uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                    goto LABEL_74;
                                  }

                                  uint64_t v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_70:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5866,  v48);
                                }

                                uint64_t v48 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                goto LABEL_70;
                              }

                              uint64_t v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5865,  v47);
                            }

                            uint64_t v47 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                            goto LABEL_66;
                          }

                          uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5864,  v46);
                        }
                      }

                      uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_62;
                    }

                    uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5863,  v45);
                  }
                }

                uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_58;
              }

              unsigned __int16 v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5862,  v44);
            }

            unsigned __int16 v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_54;
          }

          __int16 v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5861, v43);
        }

        __int16 v43 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_50;
      }

      uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5860, v42);
    }

    uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_46;
  }

  return result;
}

uint64_t sub_100165280(__int16 a1, uint64_t a2)
{
  uint64_t v9 = 0LL;
  uint64_t v10 = 0LL;
  uint64_t result = sub_10018BCDC(&v9);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v10))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = a1;
        WORD2(v10) += 2;
        return sub_10018BD78(49, v9, BYTE4(v10), a2, (uint64_t)sub_10013A594, v5, v6, v7);
      }

      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5885, v8);
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100165368(__int16 a1, __int16 a2, __int16 a3, __int16 a4, char a5, __int16 a6, uint64_t a7)
{
  uint64_t v29 = 0LL;
  uint64_t v30 = 0LL;
  uint64_t result = sub_10018BCDC(&v29);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v30))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v30) - WORD2(v30) > 1)
    {
      if (BYTE6(v30) == 2)
      {
        *(_WORD *)(v29 + WORD2(v30)) = a1;
        unsigned __int16 v18 = WORD2(v30) + 2;
        WORD2(v30) += 2;
        if (HIBYTE(v30))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v30) - v18 > 1)
        {
          if (BYTE6(v30) == 2)
          {
            *(_BYTE *)(v29 + v18) = a2;
            *(_BYTE *)(v29 + WORD2(v30) + 1) = HIBYTE(a2);
            unsigned __int16 v19 = WORD2(v30) + 2;
            WORD2(v30) += 2;
            if (HIBYTE(v30))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v30) - v19 > 1)
            {
              if (BYTE6(v30) == 2)
              {
                *(_BYTE *)(v29 + v19) = a3;
                *(_BYTE *)(v29 + WORD2(v30) + 1) = HIBYTE(a3);
                unsigned __int16 v20 = WORD2(v30) + 2;
                WORD2(v30) += 2;
                if (HIBYTE(v30))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v30) - v20 > 1)
                {
                  if (BYTE6(v30) == 2)
                  {
                    *(_BYTE *)(v29 + v20) = a4;
                    *(_BYTE *)(v29 + WORD2(v30) + 1) = HIBYTE(a4);
                    __int16 v21 = WORD2(v30);
                    unsigned __int16 v22 = WORD2(v30) + 2;
                    WORD2(v30) += 2;
                    if (HIBYTE(v30))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v30) > v22)
                    {
                      if (BYTE6(v30) == 2)
                      {
                        WORD2(v30) = v21 + 3;
                        *(_BYTE *)(v29 + v22) = a5;
                        if (HIBYTE(v30))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v30) - WORD2(v30) > 1)
                        {
                          if (BYTE6(v30) == 2)
                          {
                            *(_WORD *)(v29 + WORD2(v30)) = a6;
                            WORD2(v30) += 2;
                            return sub_10018BD78(50, v29, BYTE4(v30), a7, (uint64_t)sub_10013A594, v15, v16, v17);
                          }

                          uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5903,  v28);
                        }

                        uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_45;
                      }

                      uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5902,  v27);
                    }

                    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_41;
                  }

                  uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5901,  v26);
                }

                uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_37;
              }

              uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5900,  v25);
            }

            uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }

          uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5899, v24);
        }

        uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_29;
      }

      uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5898, v23);
    }

    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_100165744(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(56, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5917, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5916, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_1001658B0(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(53, v14, BYTE4(v15), a3, (uint64_t)sub_10013CCF4, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5931, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5930, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100165A1C(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(51, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5946, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5945, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100165B88(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(52, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5960, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100165C54(__int16 a1, char a2, char a3, char a4, uint64_t a5)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v24);
      if (WORD1(v24) > WORD2(v24))
      {
        if (BYTE6(v24) == 2)
        {
          ++WORD2(v24);
          *(_BYTE *)(v23 + v14) = 93;
          if (HIBYTE(v24))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v24) - WORD2(v24) > 1)
          {
            if (BYTE6(v24) == 2)
            {
              *(_WORD *)(v23 + WORD2(v24)) = a1;
              __int16 v15 = WORD2(v24);
              unsigned __int16 v16 = WORD2(v24) + 2;
              WORD2(v24) += 2;
              if (HIBYTE(v24))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v24) > v16)
              {
                if (BYTE6(v24) == 2)
                {
                  WORD2(v24) = v15 + 3;
                  *(_BYTE *)(v23 + v16) = a2;
                  if (HIBYTE(v24))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v24) > WORD2(v24))
                  {
                    if (BYTE6(v24) == 2)
                    {
                      *(_BYTE *)(v23 + WORD2(v24)) = a3;
                      unsigned __int16 v17 = ++WORD2(v24);
                      if (HIBYTE(v24))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v24) > v17)
                      {
                        if (BYTE6(v24) == 2)
                        {
                          *(_BYTE *)(v23 + v17) = a4;
                          ++WORD2(v24);
                          return sub_10018BD78(233, v23, BYTE4(v24), a5, (uint64_t)sub_10013A594, v11, v12, v13);
                        }

                        unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5977,  v22);
                      }

                      unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                      goto LABEL_38;
                    }

                    __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5976,  v21);
                  }

                  __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                  goto LABEL_34;
                }

                unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5975,  v20);
              }

              unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_30;
            }

            unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5974,  v19);
          }

          unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_26;
        }

        unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5973, v18);
      }
    }

    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_100165F48(char a1, char a2, char a3, int a4, char a5, uint64_t a6)
{
  uint64_t v30 = 0LL;
  uint64_t v31 = 0LL;
  uint64_t result = sub_10018BCDC(&v30);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v31))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v16 = WORD2(v31);
      if (WORD1(v31) > WORD2(v31))
      {
        if (BYTE6(v31) == 2)
        {
          ++WORD2(v31);
          *(_BYTE *)(v30 + v16) = 94;
          if (HIBYTE(v31))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v17 = WORD2(v31);
            if (WORD1(v31) > WORD2(v31))
            {
              if (BYTE6(v31) == 2)
              {
                ++WORD2(v31);
                *(_BYTE *)(v30 + v17) = 2;
                if (HIBYTE(v31))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v18 = WORD2(v31);
                  if (WORD1(v31) > WORD2(v31))
                  {
                    if (BYTE6(v31) == 2)
                    {
                      ++WORD2(v31);
                      *(_BYTE *)(v30 + v18) = a1;
                      if (HIBYTE(v31))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v19 = WORD2(v31);
                        if (WORD1(v31) > WORD2(v31))
                        {
                          if (BYTE6(v31) == 2)
                          {
                            ++WORD2(v31);
                            *(_BYTE *)(v30 + v19) = a2;
                            if (HIBYTE(v31))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else
                            {
                              uint64_t v20 = WORD2(v31);
                              if (WORD1(v31) > WORD2(v31))
                              {
                                if (BYTE6(v31) == 2)
                                {
                                  ++WORD2(v31);
                                  *(_BYTE *)(v30 + v20) = a3;
                                  if (HIBYTE(v31))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else if (WORD1(v31) - WORD2(v31) > 3)
                                  {
                                    if (BYTE6(v31) == 2)
                                    {
                                      *(_WORD *)(v30 + WORD2(v31)) = a4;
                                      *(_BYTE *)(v30 + WORD2(v31) + 2) = BYTE2(a4);
                                      *(_BYTE *)(v30 + WORD2(v31) + 3) = HIBYTE(a4);
                                      __int16 v21 = WORD2(v31);
                                      unsigned __int16 v22 = WORD2(v31) + 4;
                                      WORD2(v31) += 4;
                                      if (HIBYTE(v31))
                                      {
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }

                                      else if (WORD1(v31) > v22)
                                      {
                                        if (BYTE6(v31) == 2)
                                        {
                                          WORD2(v31) = v21 + 5;
                                          *(_BYTE *)(v30 + v22) = a5;
                                          return sub_10018BD78( 233,  v30,  BYTE4(v31),  a6,  (uint64_t)sub_10013A594,  v13,  v14,  v15);
                                        }

                                        uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5998,  v29);
                                      }

                                      uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                      goto LABEL_52;
                                    }

                                    uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5997,  v28);
                                  }

                                  uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                  goto LABEL_48;
                                }

                                uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5996,  v27);
                              }
                            }

                            uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_44;
                          }

                          uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5995,  v26);
                        }
                      }

                      uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_40;
                    }

                    uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5994,  v25);
                  }
                }

                uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_36;
              }

              uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5993,  v24);
            }
          }

          uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }

        uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5992, v23);
      }
    }

    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }

  return result;
}

uint64_t sub_100166350(_WORD *a1, __int16 a2, char a3, uint64_t a4)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v19) - WORD2(v19) > 1)
    {
      if (BYTE6(v19) == 2)
      {
        *(_WORD *)(v18 + WORD2(v19)) = *a1;
        unsigned __int16 v12 = WORD2(v19) + 2;
        WORD2(v19) += 2;
        if (HIBYTE(v19))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v19) - v12 > 1)
        {
          if (BYTE6(v19) == 2)
          {
            *(_BYTE *)(v18 + v12) = a2;
            *(_BYTE *)(v18 + WORD2(v19) + 1) = HIBYTE(a2);
            __int16 v13 = WORD2(v19);
            unsigned __int16 v14 = WORD2(v19) + 2;
            WORD2(v19) += 2;
            if (HIBYTE(v19))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v19) > v14)
            {
              if (BYTE6(v19) == 2)
              {
                WORD2(v19) = v13 + 3;
                *(_BYTE *)(v18 + v14) = a3;
                return sub_10018BD78(512, v18, BYTE4(v19), a4, (uint64_t)sub_10013A594, v9, v10, v11);
              }

              uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6014,  v17);
            }

            uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6013, v16);
        }

        uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }

      uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6012, v15);
    }

    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100166558(char a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(_BYTE *)(v14 + WORD2(v15)) = 0;
        *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
        *(_BYTE *)(v14 + WORD2(v15) + 3) = 0;
        __int16 v8 = WORD2(v15);
        unsigned __int16 v9 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v9)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v8 + 5;
            *(_BYTE *)(v14 + v9) = a1;
            if (HIBYTE(v15))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v10 = WORD2(v15);
              if (WORD1(v15) > WORD2(v15))
              {
                if (BYTE6(v15) == 2)
                {
                  ++WORD2(v15);
                  *(_BYTE *)(v14 + v10) = 4;
                  return sub_10018BD78(520, v14, BYTE4(v15), a2, (uint64_t)sub_10013A594, v5, v6, v7);
                }

                __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6346,  v13);
              }
            }

            __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }

          unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6345, v12);
        }

        unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }

      uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6344, v11);
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_100166750(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t v8 = 0LL;
  uint64_t result = sub_10018BCDC(&v7);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v8))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(_BYTE *)(v7 + WORD2(v8)) = 1;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(_BYTE *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10018BD78(520, v7, BYTE4(v8), a1, (uint64_t)sub_10013C0FC, v3, v4, v5);
      }

      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6360, v6);
    }

    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_100166854(__int16 a1, char a2, char a3, char a4, char a5, uint64_t a6)
{
  uint64_t v71 = 0LL;
  uint64_t v72 = 0LL;
  uint64_t result = sub_10018BCDC(&v71);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v72))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v72) - WORD2(v72) > 1)
    {
      if (BYTE6(v72) == 2)
      {
        *(_WORD *)(v71 + WORD2(v72)) = a1;
        __int16 v16 = WORD2(v72);
        unsigned __int16 v17 = WORD2(v72) + 2;
        WORD2(v72) += 2;
        if (HIBYTE(v72))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v72) > v17)
        {
          if (BYTE6(v72) == 2)
          {
            WORD2(v72) = v16 + 3;
            *(_BYTE *)(v71 + v17) = a2;
            if (HIBYTE(v72))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else
            {
              uint64_t v18 = WORD2(v72);
              if (WORD1(v72) > WORD2(v72))
              {
                if (BYTE6(v72) == 2)
                {
                  ++WORD2(v72);
                  *(_BYTE *)(v71 + v18) = a3;
                  if (HIBYTE(v72))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v19 = WORD2(v72);
                    if (WORD1(v72) > WORD2(v72))
                    {
                      if (BYTE6(v72) == 2)
                      {
                        ++WORD2(v72);
                        *(_BYTE *)(v71 + v19) = a4;
                        if (HIBYTE(v72))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v20 = WORD2(v72);
                          if (WORD1(v72) > WORD2(v72))
                          {
                            if (BYTE6(v72) == 2)
                            {
                              ++WORD2(v72);
                              *(_BYTE *)(v71 + v20) = a4;
                              if (HIBYTE(v72))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v21 = WORD2(v72);
                                if (WORD1(v72) > WORD2(v72))
                                {
                                  if (BYTE6(v72) == 2)
                                  {
                                    ++WORD2(v72);
                                    *(_BYTE *)(v71 + v21) = a4;
                                    if (HIBYTE(v72))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v22 = WORD2(v72);
                                      if (WORD1(v72) > WORD2(v72))
                                      {
                                        if (BYTE6(v72) == 2)
                                        {
                                          ++WORD2(v72);
                                          *(_BYTE *)(v71 + v22) = a4;
                                          if (HIBYTE(v72))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v23 = WORD2(v72);
                                            if (WORD1(v72) > WORD2(v72))
                                            {
                                              if (BYTE6(v72) == 2)
                                              {
                                                ++WORD2(v72);
                                                *(_BYTE *)(v71 + v23) = a4;
                                                if (HIBYTE(v72))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  uint64_t v24 = WORD2(v72);
                                                  if (WORD1(v72) > WORD2(v72))
                                                  {
                                                    if (BYTE6(v72) == 2)
                                                    {
                                                      ++WORD2(v72);
                                                      *(_BYTE *)(v71 + v24) = a4;
                                                      if (HIBYTE(v72))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else
                                                      {
                                                        uint64_t v25 = WORD2(v72);
                                                        if (WORD1(v72) > WORD2(v72))
                                                        {
                                                          if (BYTE6(v72) == 2)
                                                          {
                                                            ++WORD2(v72);
                                                            *(_BYTE *)(v71 + v25) = a4;
                                                            if (HIBYTE(v72))
                                                            {
                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sourc"
                                                                                     "es/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                            }

                                                            else
                                                            {
                                                              uint64_t v26 = WORD2(v72);
                                                              if (WORD1(v72) > WORD2(v72))
                                                              {
                                                                if (BYTE6(v72) == 2)
                                                                {
                                                                  ++WORD2(v72);
                                                                  *(_BYTE *)(v71 + v26) = a4;
                                                                  if (HIBYTE(v72))
                                                                  {
                                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs"
                                                                                           "/Sources/MobileBluetooth_base"
                                                                                           "/Stack/vsc/bcm/bcm_vsc.c");
                                                                  }

                                                                  else
                                                                  {
                                                                    uint64_t v27 = WORD2(v72);
                                                                    if (WORD1(v72) > WORD2(v72))
                                                                    {
                                                                      if (BYTE6(v72) == 2)
                                                                      {
                                                                        ++WORD2(v72);
                                                                        *(_BYTE *)(v71 + v27) = a4;
                                                                        if (HIBYTE(v72))
                                                                        {
                                                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.app"
                                                                                                 "le.xbs/Sources/MobileBl"
                                                                                                 "uetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                        }

                                                                        else
                                                                        {
                                                                          uint64_t v28 = WORD2(v72);
                                                                          if (WORD1(v72) > WORD2(v72))
                                                                          {
                                                                            if (BYTE6(v72) == 2)
                                                                            {
                                                                              ++WORD2(v72);
                                                                              *(_BYTE *)(v71 + v28) = a4;
                                                                              if (HIBYTE(v72))
                                                                              {
                                                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                              }

                                                                              else
                                                                              {
                                                                                uint64_t v29 = WORD2(v72);
                                                                                if (WORD1(v72) > WORD2(v72))
                                                                                {
                                                                                  if (BYTE6(v72) == 2)
                                                                                  {
                                                                                    ++WORD2(v72);
                                                                                    *(_BYTE *)(v71 + v29) = a4;
                                                                                    if (HIBYTE(v72))
                                                                                    {
                                                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                    }

                                                                                    else
                                                                                    {
                                                                                      uint64_t v30 = WORD2(v72);
                                                                                      if (WORD1(v72) > WORD2(v72))
                                                                                      {
                                                                                        if (BYTE6(v72) == 2)
                                                                                        {
                                                                                          ++WORD2(v72);
                                                                                          *(_BYTE *)(v71 + v30) = a4;
                                                                                          if (HIBYTE(v72))
                                                                                          {
                                                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                          }

                                                                                          else
                                                                                          {
                                                                                            uint64_t v31 = WORD2(v72);
                                                                                            if (WORD1(v72) > WORD2(v72))
                                                                                            {
                                                                                              if (BYTE6(v72) == 2)
                                                                                              {
                                                                                                ++WORD2(v72);
                                                                                                *(_BYTE *)(v71 + v31) = a4;
                                                                                                if (HIBYTE(v72))
                                                                                                {
                                                                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                }

                                                                                                else
                                                                                                {
                                                                                                  uint64_t v32 = WORD2(v72);
                                                                                                  if (WORD1(v72) > WORD2(v72))
                                                                                                  {
                                                                                                    if (BYTE6(v72) == 2)
                                                                                                    {
                                                                                                      ++WORD2(v72);
                                                                                                      *(_BYTE *)(v71 + v32) = a4;
                                                                                                      if (HIBYTE(v72))
                                                                                                      {
                                                                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                      }

                                                                                                      else
                                                                                                      {
                                                                                                        uint64_t v33 = WORD2(v72);
                                                                                                        if (WORD1(v72) > WORD2(v72))
                                                                                                        {
                                                                                                          if (BYTE6(v72) == 2)
                                                                                                          {
                                                                                                            ++WORD2(v72);
                                                                                                            *(_BYTE *)(v71 + v33) = a4;
                                                                                                            if (HIBYTE(v72))
                                                                                                            {
                                                                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                            }

                                                                                                            else
                                                                                                            {
                                                                                                              uint64_t v34 = WORD2(v72);
                                                                                                              if (WORD1(v72) > WORD2(v72))
                                                                                                              {
                                                                                                                if (BYTE6(v72) == 2)
                                                                                                                {
                                                                                                                  ++WORD2(v72);
                                                                                                                  *(_BYTE *)(v71 + v34) = a4;
                                                                                                                  if (HIBYTE(v72))
                                                                                                                  {
                                                                                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                  }

                                                                                                                  else
                                                                                                                  {
                                                                                                                    uint64_t v35 = WORD2(v72);
                                                                                                                    if (WORD1(v72) > WORD2(v72))
                                                                                                                    {
                                                                                                                      if (BYTE6(v72) == 2)
                                                                                                                      {
                                                                                                                        ++WORD2(v72);
                                                                                                                        *(_BYTE *)(v71 + v35) = a4;
                                                                                                                        if (HIBYTE(v72))
                                                                                                                        {
                                                                                                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                        }

                                                                                                                        else
                                                                                                                        {
                                                                                                                          uint64_t v36 = WORD2(v72);
                                                                                                                          if (WORD1(v72) > WORD2(v72))
                                                                                                                          {
                                                                                                                            if (BYTE6(v72) == 2)
                                                                                                                            {
                                                                                                                              ++WORD2(v72);
                                                                                                                              *(_BYTE *)(v71 + v36) = a4;
                                                                                                                              if (HIBYTE(v72))
                                                                                                                              {
                                                                                                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                              }

                                                                                                                              else
                                                                                                                              {
                                                                                                                                uint64_t v37 = WORD2(v72);
                                                                                                                                if (WORD1(v72) > WORD2(v72))
                                                                                                                                {
                                                                                                                                  if (BYTE6(v72) == 2)
                                                                                                                                  {
                                                                                                                                    ++WORD2(v72);
                                                                                                                                    *(_BYTE *)(v71 + v37) = a4;
                                                                                                                                    if (HIBYTE(v72))
                                                                                                                                    {
                                                                                                                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                    }

                                                                                                                                    else
                                                                                                                                    {
                                                                                                                                      uint64_t v38 = WORD2(v72);
                                                                                                                                      if (WORD1(v72) > WORD2(v72))
                                                                                                                                      {
                                                                                                                                        if (BYTE6(v72) == 2)
                                                                                                                                        {
                                                                                                                                          ++WORD2(v72);
                                                                                                                                          *(_BYTE *)(v71 + v38) = a4;
                                                                                                                                          if (HIBYTE(v72))
                                                                                                                                          {
                                                                                                                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                          }

                                                                                                                                          else
                                                                                                                                          {
                                                                                                                                            uint64_t v39 = WORD2(v72);
                                                                                                                                            if (WORD1(v72) > WORD2(v72))
                                                                                                                                            {
                                                                                                                                              if (BYTE6(v72) == 2)
                                                                                                                                              {
                                                                                                                                                ++WORD2(v72);
                                                                                                                                                *(_BYTE *)(v71 + v39) = a4;
                                                                                                                                                if (HIBYTE(v72))
                                                                                                                                                {
                                                                                                                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                }

                                                                                                                                                else
                                                                                                                                                {
                                                                                                                                                  uint64_t v40 = WORD2(v72);
                                                                                                                                                  if (WORD1(v72) > WORD2(v72))
                                                                                                                                                  {
                                                                                                                                                    if (BYTE6(v72) == 2)
                                                                                                                                                    {
                                                                                                                                                      ++WORD2(v72);
                                                                                                                                                      *(_BYTE *)(v71 + v40) = a4;
                                                                                                                                                      if (HIBYTE(v72))
                                                                                                                                                      {
                                                                                                                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                      }

                                                                                                                                                      else
                                                                                                                                                      {
                                                                                                                                                        uint64_t v41 = WORD2(v72);
                                                                                                                                                        if (WORD1(v72) > WORD2(v72))
                                                                                                                                                        {
                                                                                                                                                          if (BYTE6(v72) == 2)
                                                                                                                                                          {
                                                                                                                                                            ++WORD2(v72);
                                                                                                                                                            *(_BYTE *)(v71 + v41) = a4;
                                                                                                                                                            if (HIBYTE(v72))
                                                                                                                                                            {
                                                                                                                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                            }

                                                                                                                                                            else
                                                                                                                                                            {
                                                                                                                                                              uint64_t v42 = WORD2(v72);
                                                                                                                                                              if (WORD1(v72) > WORD2(v72))
                                                                                                                                                              {
                                                                                                                                                                if (BYTE6(v72) == 2)
                                                                                                                                                                {
                                                                                                                                                                  ++WORD2(v72);
                                                                                                                                                                  *(_BYTE *)(v71 + v42) = a4;
                                                                                                                                                                  if (HIBYTE(v72))
                                                                                                                                                                  {
                                                                                                                                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                  }

                                                                                                                                                                  else if (WORD1(v72) > WORD2(v72))
                                                                                                                                                                  {
                                                                                                                                                                    if (BYTE6(v72) == 2)
                                                                                                                                                                    {
                                                                                                                                                                      *(_BYTE *)(v71 + WORD2(v72)) = a5;
                                                                                                                                                                      ++WORD2(v72);
                                                                                                                                                                      return sub_10018BD78(508, v71, BYTE4(v72), a6, (uint64_t)sub_10013A594, v13, v14, v15);
                                                                                                                                                                    }

                                                                                                                                                                    uint64_t v70 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_199:
                                                                                                                                                                    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5317, v70);
                                                                                                                                                                  }

                                                                                                                                                                  uint64_t v70 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                                                                                                                                                  goto LABEL_199;
                                                                                                                                                                }

                                                                                                                                                                uint64_t v69 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_195:
                                                                                                                                                                sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5316, v69);
                                                                                                                                                              }
                                                                                                                                                            }

                                                                                                                                                            uint64_t v69 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                                            goto LABEL_195;
                                                                                                                                                          }

                                                                                                                                                          uint64_t v68 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_191:
                                                                                                                                                          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5315, v68);
                                                                                                                                                        }
                                                                                                                                                      }

                                                                                                                                                      uint64_t v68 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                                      goto LABEL_191;
                                                                                                                                                    }

                                                                                                                                                    uint64_t v67 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_187:
                                                                                                                                                    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5314, v67);
                                                                                                                                                  }
                                                                                                                                                }

                                                                                                                                                uint64_t v67 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                                goto LABEL_187;
                                                                                                                                              }

                                                                                                                                              uint64_t v66 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_183:
                                                                                                                                              sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5313, v66);
                                                                                                                                            }
                                                                                                                                          }

                                                                                                                                          uint64_t v66 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                          goto LABEL_183;
                                                                                                                                        }

                                                                                                                                        unsigned __int16 v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_179:
                                                                                                                                        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5312, v65);
                                                                                                                                      }
                                                                                                                                    }

                                                                                                                                    unsigned __int16 v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                    goto LABEL_179;
                                                                                                                                  }

                                                                                                                                  __int16 v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_175:
                                                                                                                                  sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5311, v64);
                                                                                                                                }
                                                                                                                              }

                                                                                                                              __int16 v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                              goto LABEL_175;
                                                                                                                            }

                                                                                                                            uint64_t v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_171:
                                                                                                                            sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5310, v63);
                                                                                                                          }
                                                                                                                        }

                                                                                                                        uint64_t v63 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                        goto LABEL_171;
                                                                                                                      }

                                                                                                                      uint64_t v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_167:
                                                                                                                      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5309, v62);
                                                                                                                    }
                                                                                                                  }

                                                                                                                  uint64_t v62 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                  goto LABEL_167;
                                                                                                                }

                                                                                                                uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_163:
                                                                                                                sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5308, v61);
                                                                                                              }
                                                                                                            }

                                                                                                            uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                            goto LABEL_163;
                                                                                                          }

                                                                                                          uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_159:
                                                                                                          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5307, v60);
                                                                                                        }
                                                                                                      }

                                                                                                      uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                      goto LABEL_159;
                                                                                                    }

                                                                                                    uint64_t v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_155:
                                                                                                    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5306, v59);
                                                                                                  }
                                                                                                }

                                                                                                uint64_t v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                goto LABEL_155;
                                                                                              }

                                                                                              uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_151:
                                                                                              sub_1000E6B88( "/Library/Caches/com.appl e.xbs/Sources/MobileBlue tooth_base/Stack/vsc/bcm/bcm_vsc.c",  5305,  v58);
                                                                                            }
                                                                                          }

                                                                                          uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                          goto LABEL_151;
                                                                                        }

                                                                                        unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_147:
                                                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/ Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  5304,  v57);
                                                                                      }
                                                                                    }

                                                                                    unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                    goto LABEL_147;
                                                                                  }

                                                                                  uint64_t v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_143:
                                                                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Source s/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5303,  v56);
                                                                                }
                                                                              }

                                                                              uint64_t v56 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                              goto LABEL_143;
                                                                            }

                                                                            uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_139:
                                                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/Mobi leBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5302,  v55);
                                                                          }
                                                                        }

                                                                        uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                        goto LABEL_139;
                                                                      }

                                                                      unsigned __int16 v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_135:
                                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBlue tooth_base/Stack/vsc/bcm/bcm_vsc.c",  5301,  v54);
                                                                    }
                                                                  }

                                                                  unsigned __int16 v54 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                  goto LABEL_135;
                                                                }

                                                                __int16 v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_131:
                                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ base/Stack/vsc/bcm/bcm_vsc.c",  5300,  v53);
                                                              }
                                                            }

                                                            __int16 v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                            goto LABEL_131;
                                                          }

                                                          uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_127:
                                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  5299,  v52);
                                                        }
                                                      }

                                                      uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_127;
                                                    }

                                                    uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_123:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  5298,  v51);
                                                  }
                                                }

                                                uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_123;
                                              }

                                              uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_119:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5297,  v50);
                                            }
                                          }

                                          uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_119;
                                        }

                                        uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_115:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5296,  v49);
                                      }
                                    }

                                    uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_115;
                                  }

                                  uint64_t v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_111:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5295,  v48);
                                }
                              }

                              uint64_t v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_111;
                            }

                            uint64_t v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_107:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5294,  v47);
                          }
                        }

                        uint64_t v47 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_107;
                      }

                      uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_103:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5293,  v46);
                    }
                  }

                  uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_103;
                }

                uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_99:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  5292,  v45);
              }
            }

            uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_99;
          }

          unsigned __int16 v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_95:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5291, v44);
        }

        unsigned __int16 v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_95;
      }

      __int16 v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_91:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5290, v43);
    }

    __int16 v43 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_91;
  }

  return result;
}

uint64_t sub_10016760C(__int16 a1, uint64_t a2)
{
  uint64_t v9 = 0LL;
  uint64_t v10 = 0LL;
  uint64_t result = sub_10018BCDC(&v9);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v10))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = a1;
        WORD2(v10) += 2;
        return sub_10018BD78(519, v9, BYTE4(v10), a2, (uint64_t)sub_10013DC24, v5, v6, v7);
      }

      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3062, v8);
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_1001676F4(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v13 = 0LL;
  uint64_t v14 = 0LL;
  uint64_t result = sub_10018BCDC(&v13);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v14))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v14);
      if (WORD1(v14) > WORD2(v14))
      {
        if (BYTE6(v14) == 2)
        {
          ++WORD2(v14);
          *(_BYTE *)(v13 + v10) = a2;
          if (HIBYTE(v14))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v14) - WORD2(v14) > 1)
          {
            if (BYTE6(v14) == 2)
            {
              *(_WORD *)(v13 + WORD2(v14)) = a1;
              WORD2(v14) += 2;
              return sub_10018BD78(612, v13, BYTE4(v14), a3, (uint64_t)sub_10013DC24, v7, v8, v9);
            }

            unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3077,  v12);
          }

          unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }

        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3076, v11);
      }
    }

    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100167860(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 42;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6029, v11);
        }

        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6028, v10);
    }

    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_1001679E0(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_BYTE *)(v12 + WORD2(v13)) = 58;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(_BYTE *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(_BYTE *)(v12 + v9) = a1;
            return sub_10018BD78(226, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
          }

          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6043, v11);
        }

        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6042, v10);
    }

    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100167B60(int a1, int a2, __int16 a3, uint64_t a4)
{
  uint64_t v19 = 0LL;
  uint64_t v20 = 0LL;
  uint64_t result = sub_10018BCDC(&v19);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v20))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v20) - WORD2(v20) > 3)
    {
      if (BYTE6(v20) == 2)
      {
        *(_BYTE *)(v19 + WORD2(v20)) = 58;
        *(_WORD *)(v19 + WORD2(v20) + 1) = 0;
        *(_BYTE *)(v19 + WORD2(v20) + 3) = 0;
        unsigned __int16 v12 = WORD2(v20) + 4;
        WORD2(v20) += 4;
        if (HIBYTE(v20))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v20) - v12 > 3)
        {
          if (BYTE6(v20) == 2)
          {
            *(_BYTE *)(v19 + v12) = a1;
            *(_BYTE *)(v19 + WORD2(v20) + 1) = BYTE1(a1);
            *(_BYTE *)(v19 + WORD2(v20) + 2) = BYTE2(a1);
            *(_BYTE *)(v19 + WORD2(v20) + 3) = HIBYTE(a1);
            __int16 v13 = WORD2(v20);
            unsigned __int16 v14 = WORD2(v20) + 4;
            WORD2(v20) += 4;
            if (HIBYTE(v20))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }

            else if (WORD1(v20) > v14)
            {
              if (BYTE6(v20) == 2)
              {
                WORD2(v20) = v13 + 5;
                *(_BYTE *)(v19 + v14) = a2 != 0;
                if (HIBYTE(v20))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v20) - WORD2(v20) > 1)
                {
                  if (BYTE6(v20) == 2)
                  {
                    *(_WORD *)(v19 + WORD2(v20)) = a3;
                    WORD2(v20) += 2;
                    return sub_10018BD78(226, v19, BYTE4(v20), a4, (uint64_t)sub_10013A594, v9, v10, v11);
                  }

                  uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6059,  v18);
                }

                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_31;
              }

              unsigned __int16 v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6058,  v17);
            }

            unsigned __int16 v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_27;
          }

          __int16 v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6057, v16);
        }

        __int16 v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_23;
      }

      uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6056, v15);
    }

    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100167E48( char a1, _WORD *a2, _BYTE *a3, __int16 a4, __int16 a5, __int16 a6, __int16 a7, uint64_t a8)
{
  uint64_t v33 = 0LL;
  uint64_t v34 = 0LL;
  uint64_t result = sub_10018BCDC(&v33);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v34))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v20 = WORD2(v34);
      if (WORD1(v34) > WORD2(v34))
      {
        if (BYTE6(v34) == 2)
        {
          ++WORD2(v34);
          *(_BYTE *)(v33 + v20) = a1;
          if (HIBYTE(v34))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v34) - WORD2(v34) > 1)
          {
            if (BYTE6(v34) == 2)
            {
              *(_WORD *)(v33 + WORD2(v34)) = *a2;
              unsigned __int16 v21 = WORD2(v34) + 2;
              WORD2(v34) += 2;
              if (HIBYTE(v34))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v34) - v21 > 1)
              {
                if (BYTE6(v34) == 2)
                {
                  *(_BYTE *)(v33 + v21) = *a3;
                  *(_BYTE *)(v33 + WORD2(v34) + 1) = a3[1];
                  unsigned __int16 v22 = WORD2(v34) + 2;
                  WORD2(v34) += 2;
                  if (HIBYTE(v34))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v34) - v22 > 1)
                  {
                    if (BYTE6(v34) == 2)
                    {
                      *(_BYTE *)(v33 + v22) = a4;
                      *(_BYTE *)(v33 + WORD2(v34) + 1) = HIBYTE(a4);
                      unsigned __int16 v23 = WORD2(v34) + 2;
                      WORD2(v34) += 2;
                      if (HIBYTE(v34))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v34) - v23 > 1)
                      {
                        if (BYTE6(v34) == 2)
                        {
                          *(_BYTE *)(v33 + v23) = a5;
                          *(_BYTE *)(v33 + WORD2(v34) + 1) = HIBYTE(a5);
                          unsigned __int16 v24 = WORD2(v34) + 2;
                          WORD2(v34) += 2;
                          if (HIBYTE(v34))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v34) - v24 > 1)
                          {
                            if (BYTE6(v34) == 2)
                            {
                              *(_BYTE *)(v33 + v24) = a6;
                              *(_BYTE *)(v33 + WORD2(v34) + 1) = HIBYTE(a6);
                              unsigned __int16 v25 = WORD2(v34) + 2;
                              WORD2(v34) += 2;
                              if (HIBYTE(v34))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else if (WORD1(v34) - v25 > 1)
                              {
                                if (BYTE6(v34) == 2)
                                {
                                  *(_BYTE *)(v33 + v25) = a7;
                                  *(_BYTE *)(v33 + WORD2(v34) + 1) = HIBYTE(a7);
                                  WORD2(v34) += 2;
                                  return sub_10018BD78(513, v33, BYTE4(v34), a8, (uint64_t)sub_10013A594, v17, v18, v19);
                                }

                                uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3048,  v32);
                              }

                              uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                              goto LABEL_52;
                            }

                            uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3047,  v31);
                          }

                          uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_48;
                        }

                        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3046,  v30);
                      }

                      uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                      goto LABEL_44;
                    }

                    uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3045,  v29);
                  }

                  uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                  goto LABEL_40;
                }

                uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3044,  v28);
              }

              uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_36;
            }

            uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3043,  v27);
          }

          uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_32;
        }

        uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3042, v26);
      }
    }

    uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }

  return result;
}

uint64_t sub_1001682C4( __int16 a1, char a2, uint64_t a3, char a4, __int16 a5, char a6, char a7, char a8, uint64_t a9)
{
  uint64_t v39 = 0LL;
  uint64_t v40 = 0LL;
  uint64_t result = sub_10018BCDC(&v39);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v40))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v18 = WORD2(v40);
      if (WORD1(v40) > WORD2(v40))
      {
        if (BYTE6(v40) == 2)
        {
          ++WORD2(v40);
          *(_BYTE *)(v39 + v18) = 1;
          if (HIBYTE(v40))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v40) - WORD2(v40) > 1)
          {
            if (BYTE6(v40) == 2)
            {
              *(_WORD *)(v39 + WORD2(v40)) = a1;
              __int16 v19 = WORD2(v40);
              unsigned __int16 v20 = WORD2(v40) + 2;
              WORD2(v40) += 2;
              if (HIBYTE(v40))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v40) > v20)
              {
                if (BYTE6(v40) == 2)
                {
                  WORD2(v40) = v19 + 3;
                  *(_BYTE *)(v39 + v20) = a2;
                  if (HIBYTE(v40))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v40) - WORD2(v40) > 5)
                  {
                    if (BYTE6(v40) == 2)
                    {
                      sub_1001F0050(v39 + WORD2(v40), a3, 6uLL);
                      __int16 v24 = WORD2(v40);
                      unsigned __int16 v25 = WORD2(v40) + 6;
                      WORD2(v40) += 6;
                      if (HIBYTE(v40))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v40) > v25)
                      {
                        if (BYTE6(v40) == 2)
                        {
                          WORD2(v40) = v24 + 7;
                          *(_BYTE *)(v39 + v25) = a4;
                          if (HIBYTE(v40))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v40) - WORD2(v40) > 1)
                          {
                            if (BYTE6(v40) == 2)
                            {
                              *(_WORD *)(v39 + WORD2(v40)) = a5;
                              __int16 v26 = WORD2(v40);
                              unsigned __int16 v27 = WORD2(v40) + 2;
                              WORD2(v40) += 2;
                              if (HIBYTE(v40))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else if (WORD1(v40) > v27)
                              {
                                if (BYTE6(v40) == 2)
                                {
                                  WORD2(v40) = v26 + 3;
                                  *(_BYTE *)(v39 + v27) = a6;
                                  if (HIBYTE(v40))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else
                                  {
                                    uint64_t v28 = WORD2(v40);
                                    if (WORD1(v40) > WORD2(v40))
                                    {
                                      if (BYTE6(v40) == 2)
                                      {
                                        ++WORD2(v40);
                                        *(_BYTE *)(v39 + v28) = a7;
                                        if (HIBYTE(v40))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v29 = WORD2(v40);
                                          if (WORD1(v40) > WORD2(v40))
                                          {
                                            if (BYTE6(v40) == 2)
                                            {
                                              ++WORD2(v40);
                                              *(_BYTE *)(v39 + v29) = a8;
                                              return sub_10018BD78( 556,  v39,  BYTE4(v40),  a9,  (uint64_t)sub_10013C268,  v21,  v22,  v23);
                                            }

                                            uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6398,  v38);
                                          }
                                        }

                                        uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_66;
                                      }

                                      uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6397,  v37);
                                    }
                                  }

                                  uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_62;
                                }

                                uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6396,  v36);
                              }

                              uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_58;
                            }

                            uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6395,  v35);
                          }

                          uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_54;
                        }

                        uint64_t v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6394,  v34);
                      }

                      uint64_t v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_50;
                    }

                    uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6393,  v33);
                  }

                  uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                  goto LABEL_46;
                }

                uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6392,  v32);
              }

              uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_42;
            }

            uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6391,  v31);
          }

          uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_38;
        }

        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6390, v30);
      }
    }

    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }

  return result;
}

uint64_t sub_1001687D0(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 2;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10018BD78(556, v11, BYTE4(v12), a2, (uint64_t)sub_10013C5CC, v5, v6, v7);
            }

            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6412,  v10);
          }

          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6411, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_100168934(__int16 a1, char a2, char a3, __int16 a4, char a5, char a6, char a7, uint64_t a8)
{
  uint64_t v36 = 0LL;
  uint64_t v37 = 0LL;
  uint64_t result = sub_10018BCDC(&v36);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v37))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v20 = WORD2(v37);
      if (WORD1(v37) > WORD2(v37))
      {
        if (BYTE6(v37) == 2)
        {
          ++WORD2(v37);
          *(_BYTE *)(v36 + v20) = 3;
          if (HIBYTE(v37))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v37) - WORD2(v37) > 1)
          {
            if (BYTE6(v37) == 2)
            {
              *(_WORD *)(v36 + WORD2(v37)) = a1;
              __int16 v21 = WORD2(v37);
              unsigned __int16 v22 = WORD2(v37) + 2;
              WORD2(v37) += 2;
              if (HIBYTE(v37))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v37) > v22)
              {
                if (BYTE6(v37) == 2)
                {
                  WORD2(v37) = v21 + 3;
                  *(_BYTE *)(v36 + v22) = a2;
                  if (HIBYTE(v37))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v23 = WORD2(v37);
                    if (WORD1(v37) > WORD2(v37))
                    {
                      if (BYTE6(v37) == 2)
                      {
                        ++WORD2(v37);
                        *(_BYTE *)(v36 + v23) = a3;
                        if (HIBYTE(v37))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v37) - WORD2(v37) > 1)
                        {
                          if (BYTE6(v37) == 2)
                          {
                            *(_WORD *)(v36 + WORD2(v37)) = a4;
                            __int16 v24 = WORD2(v37);
                            unsigned __int16 v25 = WORD2(v37) + 2;
                            WORD2(v37) += 2;
                            if (HIBYTE(v37))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v37) > v25)
                            {
                              if (BYTE6(v37) == 2)
                              {
                                WORD2(v37) = v24 + 3;
                                *(_BYTE *)(v36 + v25) = a5;
                                if (HIBYTE(v37))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else
                                {
                                  uint64_t v26 = WORD2(v37);
                                  if (WORD1(v37) > WORD2(v37))
                                  {
                                    if (BYTE6(v37) == 2)
                                    {
                                      ++WORD2(v37);
                                      *(_BYTE *)(v36 + v26) = a6;
                                      if (HIBYTE(v37))
                                      {
                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }

                                      else
                                      {
                                        uint64_t v27 = WORD2(v37);
                                        if (WORD1(v37) > WORD2(v37))
                                        {
                                          if (BYTE6(v37) == 2)
                                          {
                                            ++WORD2(v37);
                                            *(_BYTE *)(v36 + v27) = a7;
                                            return sub_10018BD78( 556,  v36,  BYTE4(v37),  a8,  (uint64_t)sub_10013C7D8,  v17,  v18,  v19);
                                          }

                                          uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6435,  v35);
                                        }
                                      }

                                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                      goto LABEL_59;
                                    }

                                    uint64_t v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6434,  v34);
                                  }
                                }

                                uint64_t v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                goto LABEL_55;
                              }

                              uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6433,  v33);
                            }

                            uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_51;
                          }

                          uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6432,  v32);
                        }

                        uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_47;
                      }

                      uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6431,  v31);
                    }
                  }

                  uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_43;
                }

                uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6430,  v30);
              }

              uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_39;
            }

            uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6429,  v29);
          }

          uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_35;
        }

        uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6428, v28);
      }
    }

    uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_31;
  }

  return result;
}

uint64_t sub_100168DB4(__int16 a1, char a2, char a3, __int16 a4, __int16 a5, uint64_t a6)
{
  uint64_t v27 = 0LL;
  uint64_t v28 = 0LL;
  uint64_t result = sub_10018BCDC(&v27);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v28))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v16 = WORD2(v28);
      if (WORD1(v28) > WORD2(v28))
      {
        if (BYTE6(v28) == 2)
        {
          ++WORD2(v28);
          *(_BYTE *)(v27 + v16) = 12;
          if (HIBYTE(v28))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v28) - WORD2(v28) > 1)
          {
            if (BYTE6(v28) == 2)
            {
              *(_WORD *)(v27 + WORD2(v28)) = a1;
              __int16 v17 = WORD2(v28);
              unsigned __int16 v18 = WORD2(v28) + 2;
              WORD2(v28) += 2;
              if (HIBYTE(v28))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v28) > v18)
              {
                if (BYTE6(v28) == 2)
                {
                  WORD2(v28) = v17 + 3;
                  *(_BYTE *)(v27 + v18) = a2;
                  if (HIBYTE(v28))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v28) > WORD2(v28))
                  {
                    if (BYTE6(v28) == 2)
                    {
                      *(_BYTE *)(v27 + WORD2(v28)) = a3;
                      unsigned __int16 v19 = ++WORD2(v28);
                      if (HIBYTE(v28))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v28) - v19 > 1)
                      {
                        if (BYTE6(v28) == 2)
                        {
                          *(_BYTE *)(v27 + v19) = a4;
                          *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a4);
                          unsigned __int16 v20 = WORD2(v28) + 2;
                          WORD2(v28) += 2;
                          if (HIBYTE(v28))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v28) - v20 > 1)
                          {
                            if (BYTE6(v28) == 2)
                            {
                              *(_BYTE *)(v27 + v20) = a5;
                              *(_BYTE *)(v27 + WORD2(v28) + 1) = HIBYTE(a5);
                              WORD2(v28) += 2;
                              return sub_10018BD78(556, v27, BYTE4(v28), a6, (uint64_t)sub_10013C934, v13, v14, v15);
                            }

                            uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6455,  v26);
                          }

                          uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_45;
                        }

                        unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6454,  v25);
                      }

                      unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                      goto LABEL_41;
                    }

                    __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6453,  v24);
                  }

                  __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                  goto LABEL_37;
                }

                uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6452,  v23);
              }

              uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_33;
            }

            unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6451,  v22);
          }

          unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_29;
        }

        __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6450, v21);
      }
    }

    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_100169158( __int16 a1, char a2, char a3, __int16 a4, __int16 a5, uint64_t a6, unsigned int a7, uint64_t a8, uint64_t a9, unsigned __int8 a10, uint64_t a11)
{
  uint64_t v57 = 0LL;
  uint64_t v58 = 0LL;
  uint64_t result = sub_10018BCDC(&v57);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v58))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v23 = WORD2(v58);
      if (WORD1(v58) > WORD2(v58))
      {
        if (BYTE6(v58) == 2)
        {
          ++WORD2(v58);
          *(_BYTE *)(v57 + v23) = 14;
          if (HIBYTE(v58))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v58) - WORD2(v58) > 1)
          {
            if (BYTE6(v58) == 2)
            {
              *(_WORD *)(v57 + WORD2(v58)) = a1;
              __int16 v24 = WORD2(v58);
              unsigned __int16 v25 = WORD2(v58) + 2;
              WORD2(v58) += 2;
              if (HIBYTE(v58))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v58) > v25)
              {
                if (BYTE6(v58) == 2)
                {
                  WORD2(v58) = v24 + 3;
                  *(_BYTE *)(v57 + v25) = a2;
                  if (HIBYTE(v58))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v58) > WORD2(v58))
                  {
                    if (BYTE6(v58) == 2)
                    {
                      *(_BYTE *)(v57 + WORD2(v58)) = a3;
                      unsigned __int16 v26 = ++WORD2(v58);
                      if (HIBYTE(v58))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v58) - v26 > 1)
                      {
                        if (BYTE6(v58) == 2)
                        {
                          *(_BYTE *)(v57 + v26) = a4;
                          *(_BYTE *)(v57 + WORD2(v58) + 1) = HIBYTE(a4);
                          unsigned __int16 v27 = WORD2(v58) + 2;
                          WORD2(v58) += 2;
                          if (HIBYTE(v58))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v58) - v27 > 1)
                          {
                            if (BYTE6(v58) == 2)
                            {
                              *(_BYTE *)(v57 + v27) = a5;
                              *(_BYTE *)(v57 + WORD2(v58) + 1) = HIBYTE(a5);
                              WORD2(v58) += 2;
                              if (a7 != 2 && a7 != 16) {
                                sub_1001EE2A0();
                              }
                              if (a6)
                              {
                                if (a7)
                                {
                                  uint64_t v28 = a7;
                                  while (!HIBYTE(v58))
                                  {
                                    uint64_t v29 = WORD2(v58);
                                    if (BYTE6(v58) != 2)
                                    {
                                      uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                      goto LABEL_73;
                                    }

                                    char v30 = *(_BYTE *)(a6 - 1 + v28--);
                                    ++WORD2(v58);
                                    *(_BYTE *)(v57 + v29) = v30;
                                  }

                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
LABEL_71:
                                  uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_73:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6486,  v45);
                                }
                              }

                              else if (a7)
                              {
                                unsigned int v31 = a7 + 1;
                                while (!HIBYTE(v58))
                                {
                                  uint64_t v32 = WORD2(v58);
                                  if (BYTE6(v58) != 2)
                                  {
                                    uint64_t v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                    goto LABEL_85;
                                  }

                                  ++WORD2(v58);
                                  *(_BYTE *)(v57 + v32) = 0;
                                  if (--v31 <= 1) {
                                    goto LABEL_37;
                                  }
                                }

                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
LABEL_83:
                                uint64_t v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_85:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6481,  v48);
                              }

uint64_t sub_1001698C8(__int16 a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0LL;
  uint64_t v21 = 0LL;
  uint64_t result = sub_10018BCDC(&v20);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v21))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v12 = WORD2(v21);
      if (WORD1(v21) > WORD2(v21))
      {
        if (BYTE6(v21) == 2)
        {
          ++WORD2(v21);
          *(_BYTE *)(v20 + v12) = 7;
          if (HIBYTE(v21))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v21) - WORD2(v21) > 1)
          {
            if (BYTE6(v21) == 2)
            {
              *(_WORD *)(v20 + WORD2(v21)) = a1;
              __int16 v13 = WORD2(v21);
              unsigned __int16 v14 = WORD2(v21) + 2;
              WORD2(v21) += 2;
              if (HIBYTE(v21))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v21) > v14)
              {
                if (BYTE6(v21) == 2)
                {
                  WORD2(v21) = v13 + 3;
                  *(_BYTE *)(v20 + v14) = a2;
                  if (HIBYTE(v21))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v15 = WORD2(v21);
                    if (WORD1(v21) > WORD2(v21))
                    {
                      if (BYTE6(v21) == 2)
                      {
                        ++WORD2(v21);
                        *(_BYTE *)(v20 + v15) = a3;
                        return sub_10018BD78(556, v20, BYTE4(v21), a4, (uint64_t)sub_10013CA88, v9, v10, v11);
                      }

                      unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6523,  v19);
                    }
                  }

                  unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }

                unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6522,  v18);
              }

              unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_27;
            }

            __int16 v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6521,  v17);
          }

          __int16 v17 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_23;
        }

        uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6520, v16);
      }
    }

    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_100169B2C(__int16 a1, char a2, char a3, char a4, uint64_t a5)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v24);
      if (WORD1(v24) > WORD2(v24))
      {
        if (BYTE6(v24) == 2)
        {
          ++WORD2(v24);
          *(_BYTE *)(v23 + v14) = 10;
          if (HIBYTE(v24))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v24) - WORD2(v24) > 1)
          {
            if (BYTE6(v24) == 2)
            {
              *(_WORD *)(v23 + WORD2(v24)) = a1;
              unsigned __int16 v15 = WORD2(v24) + 2;
              WORD2(v24) += 2;
              if (HIBYTE(v24))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v24) > v15)
              {
                if (BYTE6(v24) == 2)
                {
                  *(_BYTE *)(v23 + v15) = a2;
                  unsigned __int16 v16 = ++WORD2(v24);
                  if (HIBYTE(v24))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v24) > v16)
                  {
                    if (BYTE6(v24) == 2)
                    {
                      *(_BYTE *)(v23 + v16) = a3;
                      unsigned __int16 v17 = ++WORD2(v24);
                      if (HIBYTE(v24))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v24) > v17)
                      {
                        if (BYTE6(v24) == 2)
                        {
                          *(_BYTE *)(v23 + v17) = a4;
                          ++WORD2(v24);
                          return sub_10018BD78(556, v23, BYTE4(v24), a5, (uint64_t)sub_10013CBE4, v11, v12, v13);
                        }

                        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6541,  v22);
                      }

                      uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                      goto LABEL_38;
                    }

                    uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6540,  v21);
                  }

                  uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                  goto LABEL_34;
                }

                uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6539,  v20);
              }

              uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
              goto LABEL_30;
            }

            unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6538,  v19);
          }

          unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_26;
        }

        unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6537, v18);
      }
    }

    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_100169E20( __int16 a1, char a2, char a3, uint64_t a4, char a5, __int16 a6, char a7, char a8, char a9, char a10, unsigned __int8 a11, const void *a12, const void *a13, uint64_t a14)
{
  if (a11)
  {
    if (!a12 || a13 == 0LL) {
      return 101LL;
    }
  }

  uint64_t v57 = 0LL;
  uint64_t v58 = 0LL;
  uint64_t result = sub_10018BCDC(&v57);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v58))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v24 = WORD2(v58);
      if (WORD1(v58) > WORD2(v58))
      {
        if (BYTE6(v58) == 2)
        {
          ++WORD2(v58);
          *(_BYTE *)(v57 + v24) = 13;
          if (HIBYTE(v58))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v25 = WORD2(v58);
            if (WORD1(v58) > WORD2(v58))
            {
              if (BYTE6(v58) == 2)
              {
                ++WORD2(v58);
                *(_BYTE *)(v57 + v25) = a2;
                if (HIBYTE(v58))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v58) - WORD2(v58) > 1)
                {
                  if (BYTE6(v58) == 2)
                  {
                    *(_WORD *)(v57 + WORD2(v58)) = a1;
                    __int16 v26 = WORD2(v58);
                    unsigned __int16 v27 = WORD2(v58) + 2;
                    WORD2(v58) += 2;
                    if (HIBYTE(v58))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }

                    else if (WORD1(v58) > v27)
                    {
                      if (BYTE6(v58) == 2)
                      {
                        WORD2(v58) = v26 + 3;
                        *(_BYTE *)(v57 + v27) = a3;
                        if (HIBYTE(v58))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else if (WORD1(v58) - WORD2(v58) > 5)
                        {
                          if (BYTE6(v58) == 2)
                          {
                            sub_1001F0050(v57 + WORD2(v58), a4, 6uLL);
                            __int16 v31 = WORD2(v58);
                            unsigned __int16 v32 = WORD2(v58) + 6;
                            WORD2(v58) += 6;
                            if (HIBYTE(v58))
                            {
                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }

                            else if (WORD1(v58) > v32)
                            {
                              if (BYTE6(v58) == 2)
                              {
                                WORD2(v58) = v31 + 7;
                                *(_BYTE *)(v57 + v32) = a5;
                                if (HIBYTE(v58))
                                {
                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }

                                else if (WORD1(v58) - WORD2(v58) > 1)
                                {
                                  if (BYTE6(v58) == 2)
                                  {
                                    *(_WORD *)(v57 + WORD2(v58)) = a6;
                                    __int16 v33 = WORD2(v58);
                                    unsigned __int16 v34 = WORD2(v58) + 2;
                                    WORD2(v58) += 2;
                                    if (HIBYTE(v58))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else if (WORD1(v58) > v34)
                                    {
                                      if (BYTE6(v58) == 2)
                                      {
                                        WORD2(v58) = v33 + 3;
                                        *(_BYTE *)(v57 + v34) = a7;
                                        if (HIBYTE(v58))
                                        {
                                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }

                                        else
                                        {
                                          uint64_t v35 = WORD2(v58);
                                          if (WORD1(v58) > WORD2(v58))
                                          {
                                            if (BYTE6(v58) == 2)
                                            {
                                              ++WORD2(v58);
                                              *(_BYTE *)(v57 + v35) = a8;
                                              if (HIBYTE(v58))
                                              {
                                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }

                                              else if (WORD1(v58) > WORD2(v58))
                                              {
                                                if (BYTE6(v58) == 2)
                                                {
                                                  *(_BYTE *)(v57 + WORD2(v58)) = a9;
                                                  unsigned __int16 v36 = ++WORD2(v58);
                                                  if (HIBYTE(v58))
                                                  {
                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileB"
                                                                           "luetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                  }

                                                  else if (WORD1(v58) > v36)
                                                  {
                                                    if (BYTE6(v58) == 2)
                                                    {
                                                      *(_BYTE *)(v57 + v36) = a10;
                                                      unsigned __int16 v37 = ++WORD2(v58);
                                                      if (HIBYTE(v58))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else if (WORD1(v58) - v37 > 1)
                                                      {
                                                        if (BYTE6(v58) == 2)
                                                        {
                                                          *(_BYTE *)(v57 + v37) = a11;
                                                          *(_BYTE *)(v57 + WORD2(v58) + 1) = 0;
                                                          unsigned __int16 v38 = WORD2(v58) + 2;
                                                          WORD2(v58) += 2;
                                                          if (a11)
                                                          {
                                                            uint64_t v39 = v57;
                                                            if (HIBYTE(v58))
                                                            {
                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sourc"
                                                                                     "es/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                              int v40 = 0;
                                                            }

                                                            else
                                                            {
                                                              int v40 = WORD1(v58) - v38;
                                                            }

                                                            if (v40 < a11)
                                                            {
                                                              uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= (blobLen)";
                                                            }

                                                            else
                                                            {
                                                              if (BYTE6(v58) == 2)
                                                              {
                                                                memmove((void *)(v39 + v38), a12, a11);
                                                                unsigned __int16 v38 = WORD2(v58) + a11;
                                                                WORD2(v58) = v38;
                                                                uint64_t v41 = v57;
                                                                if (HIBYTE(v58))
                                                                {
                                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/S"
                                                                                         "ources/MobileBluetooth_base/Sta"
                                                                                         "ck/vsc/bcm/bcm_vsc.c");
                                                                  int v42 = 0;
                                                                }

                                                                else
                                                                {
                                                                  int v42 = WORD1(v58) - v38;
                                                                }

                                                                if (v42 < a11)
                                                                {
                                                                  uint64_t v56 = "ByteStream_NumReadBytesAvail(bs) >= (blobLen)";
                                                                }

                                                                else
                                                                {
                                                                  if (BYTE6(v58) == 2)
                                                                  {
                                                                    memmove((void *)(v41 + v38), a13, a11);
                                                                    LOBYTE(v38) = BYTE4(v58) + a11;
                                                                    WORD2(v58) += a11;
                                                                    return sub_10018BD78( 556,  v57,  v38,  a14,  (uint64_t)sub_10013C3C4,  v28,  v29,  v30);
                                                                  }

                                                                  uint64_t v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                                                }

                                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ base/Stack/vsc/bcm/bcm_vsc.c",  6588,  v56);
                                                              }

                                                              uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                                            }

                                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base /Stack/vsc/bcm/bcm_vsc.c",  6587,  v55);
                                                          }

                                                          return sub_10018BD78( 556,  v57,  v38,  a14,  (uint64_t)sub_10013C3C4,  v28,  v29,  v30);
                                                        }

                                                        unsigned __int16 v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_106:
                                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Sta ck/vsc/bcm/bcm_vsc.c",  6585,  v54);
                                                      }

                                                      unsigned __int16 v54 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                      goto LABEL_106;
                                                    }

                                                    __int16 v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_102:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  6584,  v53);
                                                  }

                                                  __int16 v53 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                                  goto LABEL_102;
                                                }

                                                uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_98:
                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6583,  v52);
                                              }

                                              uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                              goto LABEL_98;
                                            }

                                            uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_94:
                                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6582,  v51);
                                          }
                                        }

                                        uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_94;
                                      }

                                      uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_90:
                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6581,  v50);
                                    }

                                    uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_90;
                                  }

                                  uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_86:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6580,  v49);
                                }

                                uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                goto LABEL_86;
                              }

                              uint64_t v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_82:
                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6579,  v48);
                            }

                            uint64_t v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_82;
                          }

                          uint64_t v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6578,  v47);
                        }

                        uint64_t v47 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                        goto LABEL_78;
                      }

                      uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_74:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6577,  v46);
                    }

                    uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_74;
                  }

                  uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_70:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6576,  v45);
                }

                uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_70;
              }

              int v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6575,  v44);
            }
          }

          int v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_66;
        }

        uint64_t v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6574, v43);
      }
    }

    uint64_t v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_62;
  }

  return result;
}

uint64_t sub_10016A610(__int16 a1, __int16 a2, uint64_t a3)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v10) = 11;
          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v16) - WORD2(v16) > 1)
          {
            if (BYTE6(v16) == 2)
            {
              *(_WORD *)(v15 + WORD2(v16)) = a1;
              unsigned __int16 v11 = WORD2(v16) + 2;
              WORD2(v16) += 2;
              if (HIBYTE(v16))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v16) - v11 > 1)
              {
                if (BYTE6(v16) == 2)
                {
                  *(_BYTE *)(v15 + v11) = a2;
                  *(_BYTE *)(v15 + WORD2(v16) + 1) = HIBYTE(a2);
                  WORD2(v16) += 2;
                  return sub_10018BD78(556, v15, BYTE4(v16), a3, (uint64_t)sub_10013CC6C, v7, v8, v9);
                }

                uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6557,  v14);
              }

              uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_24;
            }

            uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6556,  v13);
          }

          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_20;
        }

        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6555, v12);
      }
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016A814(__int16 a1, char a2, char a3, uint64_t a4, uint64_t a5)
{
  uint64_t v44 = 0LL;
  uint64_t v45 = 0LL;
  uint64_t result = sub_10018BCDC(&v44);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v45))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_69;
  }

  uint64_t v14 = WORD2(v45);
  if (WORD1(v45) <= WORD2(v45))
  {
LABEL_69:
    int v40 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_71;
  }

  if (BYTE6(v45) != 2)
  {
    int v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_71:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6605, v40);
  }

  ++WORD2(v45);
  *(_BYTE *)(v44 + v14) = 4;
  if (HIBYTE(v45))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_73;
  }

  if (WORD1(v45) - WORD2(v45) <= 1)
  {
LABEL_73:
    uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_75;
  }

  if (BYTE6(v45) != 2)
  {
    uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_75:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6606, v41);
  }

  *(_WORD *)(v44 + WORD2(v45)) = a1;
  __int16 v15 = WORD2(v45);
  unsigned __int16 v16 = WORD2(v45) + 2;
  WORD2(v45) += 2;
  if (HIBYTE(v45))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_77;
  }

  if (WORD1(v45) <= v16)
  {
LABEL_77:
    int v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_79;
  }

  if (BYTE6(v45) != 2)
  {
    int v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_79:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6607, v42);
  }

  WORD2(v45) = v15 + 3;
  *(_BYTE *)(v44 + v16) = a2;
  if (HIBYTE(v45))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_81;
  }

  uint64_t v17 = WORD2(v45);
  if (WORD1(v45) <= WORD2(v45))
  {
LABEL_81:
    uint64_t v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_83;
  }

  if (BYTE6(v45) != 2)
  {
    uint64_t v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_83:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6608, v43);
  }

  unsigned __int8 v18 = a3 - a2 + 1;
  ++WORD2(v45);
  *(_BYTE *)(v44 + v17) = a3;
  if (v18)
  {
    int v19 = 0;
    while (!HIBYTE(v45))
    {
      if (WORD1(v45) - WORD2(v45) <= 5) {
        goto LABEL_41;
      }
      if (BYTE6(v45) != 2)
      {
        __int16 v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_43;
      }

      sub_1001F0050(v44 + WORD2(v45), a4, 6uLL);
      __int16 v20 = WORD2(v45);
      unsigned __int16 v21 = WORD2(v45) + 6;
      WORD2(v45) += 6;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_45:
        unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_47:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6613, v34);
      }

      if (BYTE6(v45) != 2)
      {
        unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_47;
      }

      char v22 = *(_BYTE *)(a4 + 6);
      WORD2(v45) = v20 + 7;
      *(_BYTE *)(v44 + v21) = v22;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_49:
        uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_51:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6614, v35);
      }

      if (WORD1(v45) - WORD2(v45) <= 5) {
        goto LABEL_49;
      }
      if (BYTE6(v45) != 2)
      {
        uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_51;
      }

      uint64_t v23 = (_BYTE *)(a4 + 7);
      sub_1001F0050(v44 + WORD2(v45), (uint64_t)v23, 6uLL);
      __int16 v24 = WORD2(v45);
      unsigned __int16 v25 = WORD2(v45) + 6;
      WORD2(v45) += 6;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_53:
        unsigned __int16 v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_55:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6615, v36);
      }

      if (BYTE6(v45) != 2)
      {
        unsigned __int16 v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_55;
      }

      char v26 = v23[6];
      WORD2(v45) = v24 + 7;
      *(_BYTE *)(v44 + v25) = v26;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_57:
        unsigned __int16 v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_59:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6616, v37);
      }

      uint64_t v27 = WORD2(v45);
      if (BYTE6(v45) != 2)
      {
        unsigned __int16 v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_59;
      }

      char v28 = v23[7];
      ++WORD2(v45);
      *(_BYTE *)(v44 + v27) = v28;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_61:
        unsigned __int16 v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_63:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6617, v38);
      }

      uint64_t v29 = WORD2(v45);
      if (BYTE6(v45) != 2)
      {
        unsigned __int16 v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_63;
      }

      char v30 = v23[8];
      ++WORD2(v45);
      *(_BYTE *)(v44 + v29) = v30;
      if (HIBYTE(v45))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_65:
        uint64_t v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_67:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6618, v39);
      }

      uint64_t v31 = WORD2(v45);
      if (BYTE6(v45) != 2)
      {
        uint64_t v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_67;
      }

      char v32 = v23[9];
      ++WORD2(v45);
      *(_BYTE *)(v44 + v31) = v32;
      ++v19;
      a4 = (uint64_t)(v23 + 10);
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_41:
    __int16 v33 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_43:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6612, v33);
  }

  return sub_10018BD78(556, v44, BYTE4(v45), a5, (uint64_t)sub_10013CD7C, v11, v12, v13);
}

uint64_t sub_10016AE34(__int16 a1, char a2, char a3, char a4, char a5, uint64_t a6)
{
  uint64_t v28 = 0LL;
  uint64_t v29 = 0LL;
  uint64_t result = sub_10018BCDC(&v28);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v29))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v16 = WORD2(v29);
      if (WORD1(v29) > WORD2(v29))
      {
        if (BYTE6(v29) == 2)
        {
          ++WORD2(v29);
          *(_BYTE *)(v28 + v16) = 5;
          if (HIBYTE(v29))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v29) - WORD2(v29) > 1)
          {
            if (BYTE6(v29) == 2)
            {
              *(_WORD *)(v28 + WORD2(v29)) = a1;
              __int16 v17 = WORD2(v29);
              unsigned __int16 v18 = WORD2(v29) + 2;
              WORD2(v29) += 2;
              if (HIBYTE(v29))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v29) > v18)
              {
                if (BYTE6(v29) == 2)
                {
                  WORD2(v29) = v17 + 3;
                  *(_BYTE *)(v28 + v18) = a2;
                  if (HIBYTE(v29))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v19 = WORD2(v29);
                    if (WORD1(v29) > WORD2(v29))
                    {
                      if (BYTE6(v29) == 2)
                      {
                        ++WORD2(v29);
                        *(_BYTE *)(v28 + v19) = a3;
                        if (HIBYTE(v29))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v20 = WORD2(v29);
                          if (WORD1(v29) > WORD2(v29))
                          {
                            if (BYTE6(v29) == 2)
                            {
                              ++WORD2(v29);
                              *(_BYTE *)(v28 + v20) = a4;
                              if (HIBYTE(v29))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v21 = WORD2(v29);
                                if (WORD1(v29) > WORD2(v29))
                                {
                                  if (BYTE6(v29) == 2)
                                  {
                                    ++WORD2(v29);
                                    *(_BYTE *)(v28 + v21) = a5;
                                    return sub_10018BD78( 556,  v28,  BYTE4(v29),  a6,  (uint64_t)sub_10013CED8,  v13,  v14,  v15);
                                  }

                                  uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6640,  v27);
                                }
                              }

                              uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_45;
                            }

                            char v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6639,  v26);
                          }
                        }

                        char v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_41;
                      }

                      unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6638,  v25);
                    }
                  }

                  unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_37;
                }

                __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6637,  v24);
              }

              __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_33;
            }

            uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6636,  v23);
          }

          uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_29;
        }

        char v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6635, v22);
      }
    }

    char v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }

  return result;
}

uint64_t sub_10016B198(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 6;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10018BD78(556, v11, BYTE4(v12), a2, (uint64_t)sub_10013D034, v5, v6, v7);
            }

            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6655,  v10);
          }

          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6654, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016B2FC(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(1009, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6669, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10016B3C8(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(_BYTE *)(v16 + v10) = 1;
          if (HIBYTE(v17))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v17) - WORD2(v17) > 1)
          {
            if (BYTE6(v17) == 2)
            {
              *(_WORD *)(v16 + WORD2(v17)) = a1;
              __int16 v11 = WORD2(v17);
              unsigned __int16 v12 = WORD2(v17) + 2;
              WORD2(v17) += 2;
              if (HIBYTE(v17))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v17) > v12)
              {
                if (BYTE6(v17) == 2)
                {
                  WORD2(v17) = v11 + 3;
                  *(_BYTE *)(v16 + v12) = a2;
                  return sub_10018BD78(1010, v16, BYTE4(v17), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                }

                uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6685,  v15);
              }

              uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }

            uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6684,  v14);
          }

          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_20;
        }

        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6683, v13);
      }
    }

    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016B5B0(char a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0LL;
  uint64_t v17 = 0LL;
  uint64_t result = sub_10018BCDC(&v16);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v17))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(_BYTE *)(v16 + v10) = 2;
          if (HIBYTE(v17))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v11 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(_BYTE *)(v16 + v11) = a1;
                if (HIBYTE(v17))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v12 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(_BYTE *)(v16 + v12) = a2;
                      return sub_10018BD78(1010, v16, BYTE4(v17), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                    }

                    uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6701,  v15);
                  }
                }

                uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_24;
              }

              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6700,  v14);
            }
          }

          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6699, v13);
      }
    }

    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016B77C(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 4;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10018BD78(1010, v11, BYTE4(v12), a2, (uint64_t)sub_10013D1CC, v5, v6, v7);
            }

            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6716,  v10);
          }

          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6715, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016B8E0(__int16 a1, __int16 a2, char a3, char a4, uint64_t a5)
{
  uint64_t v24 = 0LL;
  uint64_t v25 = 0LL;
  uint64_t result = sub_10018BCDC(&v24);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v25))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v25);
      if (WORD1(v25) > WORD2(v25))
      {
        if (BYTE6(v25) == 2)
        {
          ++WORD2(v25);
          *(_BYTE *)(v24 + v14) = 3;
          if (HIBYTE(v25))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v25) - WORD2(v25) > 1)
          {
            if (BYTE6(v25) == 2)
            {
              *(_WORD *)(v24 + WORD2(v25)) = a1;
              unsigned __int16 v15 = WORD2(v25) + 2;
              WORD2(v25) += 2;
              if (HIBYTE(v25))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v25) - v15 > 1)
              {
                if (BYTE6(v25) == 2)
                {
                  *(_BYTE *)(v24 + v15) = a2;
                  *(_BYTE *)(v24 + WORD2(v25) + 1) = HIBYTE(a2);
                  __int16 v16 = WORD2(v25);
                  unsigned __int16 v17 = WORD2(v25) + 2;
                  WORD2(v25) += 2;
                  if (HIBYTE(v25))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else if (WORD1(v25) > v17)
                  {
                    if (BYTE6(v25) == 2)
                    {
                      WORD2(v25) = v16 + 3;
                      *(_BYTE *)(v24 + v17) = a3;
                      if (HIBYTE(v25))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else
                      {
                        uint64_t v18 = WORD2(v25);
                        if (WORD1(v25) > WORD2(v25))
                        {
                          if (BYTE6(v25) == 2)
                          {
                            ++WORD2(v25);
                            *(_BYTE *)(v24 + v18) = a4;
                            return sub_10018BD78(1010, v24, BYTE4(v25), a5, (uint64_t)sub_10013A594, v11, v12, v13);
                          }

                          uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6734,  v23);
                        }
                      }

                      uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_38;
                    }

                    char v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6733,  v22);
                  }

                  char v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_34;
                }

                uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6732,  v21);
              }

              uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_30;
            }

            uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6731,  v20);
          }

          uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_26;
        }

        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6730, v19);
      }
    }

    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }

  return result;
}

uint64_t sub_10016BBE4(char a1, uint64_t a2)
{
  uint64_t v12 = 0LL;
  uint64_t v13 = 0LL;
  uint64_t result = sub_10018BCDC(&v12);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v13))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v13);
      if (WORD1(v13) > WORD2(v13))
      {
        if (BYTE6(v13) == 2)
        {
          ++WORD2(v13);
          *(_BYTE *)(v12 + v8) = 5;
          if (HIBYTE(v13))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v9 = WORD2(v13);
            if (WORD1(v13) > WORD2(v13))
            {
              if (BYTE6(v13) == 2)
              {
                ++WORD2(v13);
                *(_BYTE *)(v12 + v9) = a1;
                return sub_10018BD78(1010, v12, BYTE4(v13), a2, (uint64_t)sub_10013A594, v5, v6, v7);
              }

              uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6749,  v11);
            }
          }

          uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }

        uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6748, v10);
      }
    }

    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016BD2C(uint64_t a1)
{
  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  uint64_t result = sub_10018BCDC(&v8);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v9))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(_BYTE *)(v8 + v6) = 0;
          return sub_10018BD78(630, v8, BYTE4(v9), a1, (uint64_t)sub_10013F5E0, v3, v4, v5);
        }

        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6763, v7);
      }
    }

    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10016BDF4(int a1, uint64_t a2)
{
  uint64_t v11 = 0LL;
  uint64_t v12 = 0LL;
  uint64_t result = sub_10018BCDC(&v11);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v12))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(_BYTE *)(v11 + v8) = 1;
          if (HIBYTE(v12))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v12) - WORD2(v12) > 3)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              *(_BYTE *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
              *(_BYTE *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
              WORD2(v12) += 4;
              return sub_10018BD78(630, v11, BYTE4(v12), a2, (uint64_t)sub_10013F5E0, v5, v6, v7);
            }

            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6777,  v10);
          }

          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_17;
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6776, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016BF80(int a1, _BYTE *a2, char *a3, uint64_t a4)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if ((_DWORD)result) {
    return result;
  }
  if (HIBYTE(v24))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_29;
  }

  uint64_t v12 = WORD2(v24);
  if (WORD1(v24) <= WORD2(v24))
  {
LABEL_29:
    uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_31;
  }

  if (BYTE6(v24) != 2)
  {
    uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6791, v21);
  }

  ++WORD2(v24);
  *(_BYTE *)(v23 + v12) = 1;
  if (HIBYTE(v24))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_33;
  }

  if (WORD1(v24) - WORD2(v24) <= 3)
  {
LABEL_33:
    char v22 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_35;
  }

  if (BYTE6(v24) != 2)
  {
    char v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6792, v22);
  }

  uint64_t v13 = 0LL;
  *(_WORD *)(v23 + WORD2(v24)) = a1;
  *(_BYTE *)(v23 + WORD2(v24) + 2) = BYTE2(a1);
  *(_BYTE *)(v23 + WORD2(v24) + 3) = HIBYTE(a1);
  WORD2(v24) += 4;
  do
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_21:
      uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_23:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6794, v19);
    }

    uint64_t v14 = WORD2(v24);
    if (BYTE6(v24) != 2)
    {
      uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
      goto LABEL_23;
    }

    char v15 = a2[v13];
    ++WORD2(v24);
    *(_BYTE *)(v23 + v14) = v15;
    ++v13;
  }

  while (v13 != 4);
  uint64_t v16 = *a2 & 0xF;
  if ((*a2 & 0xF) != 0)
  {
    while (!HIBYTE(v24))
    {
      uint64_t v17 = WORD2(v24);
      if (BYTE6(v24) != 2)
      {
        uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_27;
      }

      char v18 = *a3++;
      ++WORD2(v24);
      *(_BYTE *)(v23 + v17) = v18;
      if (!--v16) {
        return sub_10018BD78(615, v23, BYTE4(v24), a4, (uint64_t)sub_10013A594, v9, v10, v11);
      }
    }

    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_25:
    uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_27:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6798, v20);
  }

  return sub_10018BD78(615, v23, BYTE4(v24), a4, (uint64_t)sub_10013A594, v9, v10, v11);
}

uint64_t sub_10016C238(char a1, char a2, char a3, uint64_t a4)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v12 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(_BYTE *)(v18 + v12) = a1;
          if (HIBYTE(v19))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v13 = WORD2(v19);
            if (WORD1(v19) > WORD2(v19))
            {
              if (BYTE6(v19) == 2)
              {
                ++WORD2(v19);
                *(_BYTE *)(v18 + v13) = a2;
                if (HIBYTE(v19))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v14 = WORD2(v19);
                  if (WORD1(v19) > WORD2(v19))
                  {
                    if (BYTE6(v19) == 2)
                    {
                      ++WORD2(v19);
                      *(_BYTE *)(v18 + v14) = a3;
                      return sub_10018BD78(631, v18, BYTE4(v19), a4, (uint64_t)sub_10013A594, v9, v10, v11);
                    }

                    uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6813,  v17);
                  }
                }

                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_24;
              }

              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6812,  v16);
            }
          }

          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        char v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6811, v15);
      }
    }

    char v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016C404(char a1, char a2, uint64_t a3)
{
  uint64_t v19 = 0LL;
  uint64_t v20 = 0LL;
  uint64_t result = sub_10018BCDC(&v19);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v20))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v20);
      if (WORD1(v20) > WORD2(v20))
      {
        if (BYTE6(v20) == 2)
        {
          ++WORD2(v20);
          *(_BYTE *)(v19 + v10) = 4;
          if (HIBYTE(v20))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v20) - WORD2(v20) > 2)
          {
            if (BYTE6(v20) == 2)
            {
              uint64_t v11 = v19 + WORD2(v20);
              *(_BYTE *)(v11 + 2) = 0;
              *(_WORD *)uint64_t v11 = 0;
              __int16 v12 = WORD2(v20);
              unsigned __int16 v13 = WORD2(v20) + 3;
              WORD2(v20) += 3;
              if (HIBYTE(v20))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v20) > v13)
              {
                if (BYTE6(v20) == 2)
                {
                  WORD2(v20) = v12 + 4;
                  *(_BYTE *)(v19 + v13) = a1;
                  if (HIBYTE(v20))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v14 = WORD2(v20);
                    if (WORD1(v20) > WORD2(v20))
                    {
                      if (BYTE6(v20) == 2)
                      {
                        ++WORD2(v20);
                        *(_BYTE *)(v19 + v14) = a2;
                        return sub_10018BD78(383, v19, BYTE4(v20), a3, (uint64_t)sub_10013A594, v7, v8, v9);
                      }

                      uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6830,  v18);
                    }
                  }

                  uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }

                uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6829,  v17);
              }

              uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_27;
            }

            uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6828,  v16);
          }

          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
          goto LABEL_23;
        }

        char v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6827, v15);
      }
    }

    char v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }

  return result;
}

uint64_t sub_10016C658(char *a1, uint64_t a2)
{
  uint64_t v37 = 0LL;
  uint64_t v38 = 0LL;
  uint64_t result = sub_10018BCDC(&v37);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v38))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v38);
      if (WORD1(v38) > WORD2(v38))
      {
        if (BYTE6(v38) == 2)
        {
          ++WORD2(v38);
          *(_BYTE *)(v37 + v8) = 5;
          if (HIBYTE(v38))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v38) - WORD2(v38) > 2)
          {
            if (BYTE6(v38) == 2)
            {
              uint64_t v9 = v37 + WORD2(v38);
              *(_BYTE *)(v9 + 2) = 0;
              *(_WORD *)uint64_t v9 = 0;
              __int16 v10 = WORD2(v38);
              unsigned __int16 v11 = WORD2(v38) + 3;
              WORD2(v38) += 3;
              if (HIBYTE(v38))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v38) > v11)
              {
                if (BYTE6(v38) == 2)
                {
                  char v12 = *a1;
                  WORD2(v38) = v10 + 4;
                  *(_BYTE *)(v37 + v11) = v12;
                  if (HIBYTE(v38))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v13 = WORD2(v38);
                    if (WORD1(v38) > WORD2(v38))
                    {
                      if (BYTE6(v38) == 2)
                      {
                        char v14 = a1[1];
                        ++WORD2(v38);
                        *(_BYTE *)(v37 + v13) = v14;
                        if (HIBYTE(v38))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v15 = WORD2(v38);
                          if (WORD1(v38) > WORD2(v38))
                          {
                            if (BYTE6(v38) == 2)
                            {
                              char v16 = a1[2];
                              ++WORD2(v38);
                              *(_BYTE *)(v37 + v15) = v16;
                              if (HIBYTE(v38))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v17 = WORD2(v38);
                                if (WORD1(v38) > WORD2(v38))
                                {
                                  if (BYTE6(v38) == 2)
                                  {
                                    char v18 = a1[3];
                                    ++WORD2(v38);
                                    *(_BYTE *)(v37 + v17) = v18;
                                    if (HIBYTE(v38))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v19 = WORD2(v38);
                                      if (WORD1(v38) > WORD2(v38))
                                      {
                                        if (BYTE6(v38) == 2)
                                        {
                                          char v20 = a1[4];
                                          ++WORD2(v38);
                                          *(_BYTE *)(v37 + v19) = v20;
                                          if (HIBYTE(v38))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v21 = WORD2(v38);
                                            if (WORD1(v38) > WORD2(v38))
                                            {
                                              if (BYTE6(v38) == 2)
                                              {
                                                char v22 = a1[5];
                                                ++WORD2(v38);
                                                *(_BYTE *)(v37 + v21) = v22;
                                                if (HIBYTE(v38))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  uint64_t v23 = WORD2(v38);
                                                  if (WORD1(v38) > WORD2(v38))
                                                  {
                                                    if (BYTE6(v38) == 2)
                                                    {
                                                      char v24 = a1[6];
                                                      ++WORD2(v38);
                                                      *(_BYTE *)(v37 + v23) = v24;
                                                      if (HIBYTE(v38))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else
                                                      {
                                                        uint64_t v25 = WORD2(v38);
                                                        if (WORD1(v38) > WORD2(v38))
                                                        {
                                                          if (BYTE6(v38) == 2)
                                                          {
                                                            char v26 = a1[7];
                                                            ++WORD2(v38);
                                                            *(_BYTE *)(v37 + v25) = v26;
                                                            return sub_10018BD78( 383,  v37,  BYTE4(v38),  a2,  (uint64_t)sub_10013A594,  v5,  v6,  v7);
                                                          }

                                                          unsigned __int16 v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
                                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  6854,  v36);
                                                        }
                                                      }

                                                      unsigned __int16 v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_73;
                                                    }

                                                    uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  6853,  v35);
                                                  }
                                                }

                                                uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_69;
                                              }

                                              unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6852,  v34);
                                            }
                                          }

                                          unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_65;
                                        }

                                        __int16 v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6851,  v33);
                                      }
                                    }

                                    __int16 v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_61;
                                  }

                                  char v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6850,  v32);
                                }
                              }

                              char v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_57;
                            }

                            uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6849,  v31);
                          }
                        }

                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_53;
                      }

                      char v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6848,  v30);
                    }
                  }

                  char v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_49;
                }

                uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6847,  v29);
              }

              uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_45;
            }

            uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6846,  v28);
          }

          uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
          goto LABEL_41;
        }

        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6845, v27);
      }
    }

    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_37;
  }

  return result;
}

uint64_t sub_10016CB90(int a1, __int16 a2, int a3, char *a4, uint64_t a5)
{
  uint64_t v28 = 0LL;
  uint64_t v29 = 0LL;
  uint64_t result = sub_10018BCDC(&v28);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v29))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v14 = WORD2(v29);
      if (WORD1(v29) > WORD2(v29))
      {
        if (BYTE6(v29) == 2)
        {
          ++WORD2(v29);
          *(_BYTE *)(v28 + v14) = a1;
          if (HIBYTE(v29))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v29) - WORD2(v29) > 1)
          {
            if (BYTE6(v29) == 2)
            {
              *(_WORD *)(v28 + WORD2(v29)) = a2;
              __int16 v15 = WORD2(v29);
              unsigned __int16 v16 = WORD2(v29) + 2;
              WORD2(v29) += 2;
              if (HIBYTE(v29))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v29) > v16)
              {
                if (BYTE6(v29) == 2)
                {
                  char v18 = *a4;
                  uint64_t v17 = a4 + 1;
                  WORD2(v29) = v15 + 3;
                  *(_BYTE *)(v28 + v16) = v18;
                  unsigned __int8 v19 = BYTE4(v29);
                  if (a1 != 2)
                  {
                    uint64_t v20 = WORD2(v29);
                    uint64_t v21 = v28;
                    if (HIBYTE(v29))
                    {
                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v22 = 0;
                    }

                    else
                    {
                      int v22 = WORD1(v29) - WORD2(v29);
                    }

                    int v23 = a3 - 1;
                    if (v22 < v23)
                    {
                      uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= (length - 1)";
                    }

                    else
                    {
                      if (BYTE6(v29) == 2)
                      {
                        memmove((void *)(v21 + v20), v17, v23);
                        unsigned __int8 v19 = BYTE4(v29) + v23;
                        WORD2(v29) += v23;
                        return sub_10018BD78(557, v28, v19, a5, (uint64_t)sub_10013A594, v11, v12, v13);
                      }

                      uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }

                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6892,  v27);
                  }

                  return sub_10018BD78(557, v28, v19, a5, (uint64_t)sub_10013A594, v11, v12, v13);
                }

                char v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6887,  v26);
              }

              char v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_31;
            }

            uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6885,  v25);
          }

          uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_27;
        }

        char v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6884, v24);
      }
    }

    char v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_23;
  }

  return result;
}

uint64_t sub_10016CE2C(char a1, uint64_t a2)
{
  uint64_t v9 = 0LL;
  uint64_t v10 = 0LL;
  uint64_t result = sub_10018BCDC(&v9);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v10))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = 0xFFFF << (a1 - 1);
        WORD2(v10) += 2;
        return sub_10018BD78(22, v9, BYTE4(v10), a2, (uint64_t)sub_10013A594, v5, v6, v7);
      }

      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6314, v8);
    }

    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10016CF20(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(572, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6087, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10016CFEC(int a1, uint64_t a2, char a3, uint64_t a4)
{
  uint64_t v23 = 0LL;
  uint64_t v24 = 0LL;
  uint64_t result = sub_10018BCDC(&v23);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v24))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v9 = WORD2(v24);
      if (WORD1(v24) > WORD2(v24))
      {
        if (BYTE6(v24) == 2)
        {
          ++WORD2(v24);
          *(_BYTE *)(v23 + v9) = a1;
          if (HIBYTE(v24))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v24) - WORD2(v24) > 5)
          {
            if (BYTE6(v24) == 2)
            {
              sub_1001F0050(v23 + WORD2(v24), a2, 6uLL);
              __int16 v13 = WORD2(v24);
              unsigned __int16 v14 = WORD2(v24) + 6;
              WORD2(v24) += 6;
              if (a1 != 1)
              {
                if (a1 != 4 && a1 != 2) {
                  return sub_10018BD78(498, v23, BYTE4(v24), a4, (uint64_t)sub_10013A594, v10, v11, v12);
                }
                if (HIBYTE(v24))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else if (WORD1(v24) > v14)
                {
                  if (BYTE6(v24) == 2)
                  {
                    __int16 v15 = v13 + 7;
LABEL_25:
                    WORD2(v24) = v15;
                    *(_BYTE *)(v23 + v14) = a3;
                    return sub_10018BD78(498, v23, BYTE4(v24), a4, (uint64_t)sub_10013A594, v10, v11, v12);
                  }

                  unsigned __int8 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6910,  v19);
                }

                unsigned __int8 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_39;
              }

              if (HIBYTE(v24))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v24) > v14)
              {
                if (BYTE6(v24) == 2)
                {
                  WORD2(v24) = v13 + 7;
                  *(_BYTE *)(v23 + v14) = 0;
                  if (HIBYTE(v24))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v16 = WORD2(v24);
                    if (WORD1(v24) > WORD2(v24))
                    {
                      if (BYTE6(v24) == 2)
                      {
                        ++WORD2(v24);
                        *(_BYTE *)(v23 + v16) = a3;
                        if (HIBYTE(v24))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          unsigned __int16 v14 = WORD2(v24);
                          if (WORD1(v24) > WORD2(v24))
                          {
                            if (BYTE6(v24) == 2)
                            {
                              __int16 v15 = WORD2(v24) + 1;
                              goto LABEL_25;
                            }

                            int v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6915,  v22);
                          }
                        }

                        int v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_51;
                      }

                      uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6914,  v21);
                    }
                  }

                  uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_47;
                }

                uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6913,  v20);
              }

              uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_43;
            }

            char v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6907,  v18);
          }

          char v18 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_35;
        }

        uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6906, v17);
      }
    }

    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_31;
  }

  return result;
}

uint64_t sub_10016D344(int a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v10 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(_BYTE *)(v14 + v10) = a1;
          if (a1 != 1) {
            return sub_10018BD78(603, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }
          if (HIBYTE(v15))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v11 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                ++WORD2(v15);
                *(_BYTE *)(v14 + v11) = a2;
                return sub_10018BD78(603, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
              }

              __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6933,  v13);
            }
          }

          __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_19;
        }

        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_15:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6930, v12);
      }
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_15;
  }

  return result;
}

uint64_t sub_10016D49C(char a1, uint64_t a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 5)
    {
      if (BYTE6(v15) == 2)
      {
        sub_1001F0050(v14 + WORD2(v15), a2, 6uLL);
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 6;
        WORD2(v15) += 6;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 7;
            *(_BYTE *)(v14 + v11) = a1;
            return sub_10018BD78(620, v14, BYTE4(v15), a3, (uint64_t)sub_10013A594, v7, v8, v9);
          }

          __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6946, v13);
        }

        __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6945, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016D600(char a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  uint64_t v11 = 0LL;
  uint64_t result = sub_10018BCDC(&v10);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v11))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(_BYTE *)(v10 + v8) = a1;
          return sub_10018BD78(635, v10, BYTE4(v11), a2, (uint64_t)sub_10013A594, v5, v6, v7);
        }

        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6957, v9);
      }
    }

    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }

  return result;
}

uint64_t sub_10016D6CC(char a1, uint64_t a2)
{
  uint64_t v15 = 0LL;
  uint64_t v16 = 0LL;
  uint64_t result = sub_10018BCDC(&v15);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v16))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v8 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(_BYTE *)(v15 + v8) = 3;
          if (HIBYTE(v16))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v16) - WORD2(v16) > 2)
          {
            if (BYTE6(v16) == 2)
            {
              uint64_t v9 = v15 + WORD2(v16);
              *(_BYTE *)(v9 + 2) = 0;
              *(_WORD *)uint64_t v9 = 0;
              __int16 v10 = WORD2(v16);
              unsigned __int16 v11 = WORD2(v16) + 3;
              WORD2(v16) += 3;
              if (HIBYTE(v16))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v16) > v11)
              {
                if (BYTE6(v16) == 2)
                {
                  WORD2(v16) = v10 + 4;
                  *(_BYTE *)(v15 + v11) = a1;
                  return sub_10018BD78(383, v15, BYTE4(v16), a2, (uint64_t)sub_10013A594, v5, v6, v7);
                }

                uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6972,  v14);
              }

              uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }

            __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6971,  v13);
          }

          __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
          goto LABEL_20;
        }

        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6970, v12);
      }
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016D89C(char a1, char a2, char a3, uint64_t a4)
{
  uint64_t v18 = 0LL;
  uint64_t v19 = 0LL;
  uint64_t result = sub_10018BCDC(&v18);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v19))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v12 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(_BYTE *)(v18 + v12) = a1;
          if (HIBYTE(v19))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v13 = WORD2(v19);
            if (WORD1(v19) > WORD2(v19))
            {
              if (BYTE6(v19) == 2)
              {
                ++WORD2(v19);
                *(_BYTE *)(v18 + v13) = a2;
                if (HIBYTE(v19))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v14 = WORD2(v19);
                  if (WORD1(v19) > WORD2(v19))
                  {
                    if (BYTE6(v19) == 2)
                    {
                      ++WORD2(v19);
                      *(_BYTE *)(v18 + v14) = a3;
                      return sub_10018BD78(25, v18, BYTE4(v19), a4, (uint64_t)sub_10013A594, v9, v10, v11);
                    }

                    uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6870,  v17);
                  }
                }

                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_24;
              }

              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  6869,  v16);
            }
          }

          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }

        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6868, v15);
      }
    }

    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }

  return result;
}

uint64_t sub_10016DA68(uint64_t a1, char a2, char a3, char a4, char a5, char a6, char a7, char a8, uint64_t a9)
{
  uint64_t v42 = 0LL;
  uint64_t v43 = 0LL;
  uint64_t result = sub_10018BCDC(&v42);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v43))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v18 = WORD2(v43);
      if (WORD1(v43) > WORD2(v43))
      {
        if (BYTE6(v43) == 2)
        {
          ++WORD2(v43);
          *(_BYTE *)(v42 + v18) = 78;
          v41[0] = BYTE5(a1);
          v41[1] = BYTE4(a1);
          v41[2] = BYTE3(a1);
          v41[3] = BYTE2(a1);
          v41[4] = BYTE1(a1);
          v41[5] = a1;
          if (HIBYTE(v43))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v43) - WORD2(v43) > 5)
          {
            if (BYTE6(v43) == 2)
            {
              sub_1001F0050(v42 + WORD2(v43), (uint64_t)v41, 6uLL);
              __int16 v22 = WORD2(v43);
              unsigned __int16 v23 = WORD2(v43) + 6;
              WORD2(v43) += 6;
              if (HIBYTE(v43))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v43) > v23)
              {
                if (BYTE6(v43) == 2)
                {
                  WORD2(v43) = v22 + 7;
                  *(_BYTE *)(v42 + v23) = BYTE6(a1);
                  if (HIBYTE(v43))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v24 = WORD2(v43);
                    if (WORD1(v43) > WORD2(v43))
                    {
                      if (BYTE6(v43) == 2)
                      {
                        ++WORD2(v43);
                        *(_BYTE *)(v42 + v24) = a2;
                        if (HIBYTE(v43))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v25 = WORD2(v43);
                          if (WORD1(v43) > WORD2(v43))
                          {
                            if (BYTE6(v43) == 2)
                            {
                              ++WORD2(v43);
                              *(_BYTE *)(v42 + v25) = a3;
                              if (HIBYTE(v43))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v26 = WORD2(v43);
                                if (WORD1(v43) > WORD2(v43))
                                {
                                  if (BYTE6(v43) == 2)
                                  {
                                    ++WORD2(v43);
                                    *(_BYTE *)(v42 + v26) = a4;
                                    if (HIBYTE(v43))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v27 = WORD2(v43);
                                      if (WORD1(v43) > WORD2(v43))
                                      {
                                        if (BYTE6(v43) == 2)
                                        {
                                          ++WORD2(v43);
                                          *(_BYTE *)(v42 + v27) = a5;
                                          if (HIBYTE(v43))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v28 = WORD2(v43);
                                            if (WORD1(v43) > WORD2(v43))
                                            {
                                              if (BYTE6(v43) == 2)
                                              {
                                                ++WORD2(v43);
                                                *(_BYTE *)(v42 + v28) = a6;
                                                if (HIBYTE(v43))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  uint64_t v29 = WORD2(v43);
                                                  if (WORD1(v43) > WORD2(v43))
                                                  {
                                                    if (BYTE6(v43) == 2)
                                                    {
                                                      ++WORD2(v43);
                                                      *(_BYTE *)(v42 + v29) = a7;
                                                      if (HIBYTE(v43))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else
                                                      {
                                                        uint64_t v30 = WORD2(v43);
                                                        if (WORD1(v43) > WORD2(v43))
                                                        {
                                                          if (BYTE6(v43) == 2)
                                                          {
                                                            ++WORD2(v43);
                                                            *(_BYTE *)(v42 + v30) = a8;
                                                            return sub_10018BD78( 233,  v42,  BYTE4(v43),  a9,  (uint64_t)sub_10013E160,  v19,  v20,  v21);
                                                          }

                                                          int v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
                                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  3504,  v40);
                                                        }
                                                      }

                                                      int v40 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_73;
                                                    }

                                                    uint64_t v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  3503,  v39);
                                                  }
                                                }

                                                uint64_t v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_69;
                                              }

                                              uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3502,  v38);
                                            }
                                          }

                                          uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_65;
                                        }

                                        uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3501,  v37);
                                      }
                                    }

                                    uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_61;
                                  }

                                  unsigned __int16 v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3500,  v36);
                                }
                              }

                              unsigned __int16 v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_57;
                            }

                            uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3499,  v35);
                          }
                        }

                        uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_53;
                      }

                      unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3498,  v34);
                    }
                  }

                  unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_49;
                }

                __int16 v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3497,  v33);
              }

              __int16 v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_45;
            }

            char v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3496,  v32);
          }

          char v32 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_41;
        }

        uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3493, v31);
      }
    }

    uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_37;
  }

  return result;
}

uint64_t sub_10016DFE4( uint64_t a1, char a2, char a3, char a4, char a5, char a6, char a7, char a8, char a9, char a10, uint64_t a11)
{
  uint64_t v48 = 0LL;
  uint64_t v49 = 0LL;
  uint64_t result = sub_10018BCDC(&v48);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v49))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v20 = WORD2(v49);
      if (WORD1(v49) > WORD2(v49))
      {
        if (BYTE6(v49) == 2)
        {
          ++WORD2(v49);
          *(_BYTE *)(v48 + v20) = 88;
          v47[0] = BYTE5(a1);
          v47[1] = BYTE4(a1);
          v47[2] = BYTE3(a1);
          v47[3] = BYTE2(a1);
          v47[4] = BYTE1(a1);
          v47[5] = a1;
          if (HIBYTE(v49))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else if (WORD1(v49) - WORD2(v49) > 5)
          {
            if (BYTE6(v49) == 2)
            {
              sub_1001F0050(v48 + WORD2(v49), (uint64_t)v47, 6uLL);
              __int16 v24 = WORD2(v49);
              unsigned __int16 v25 = WORD2(v49) + 6;
              WORD2(v49) += 6;
              if (HIBYTE(v49))
              {
                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }

              else if (WORD1(v49) > v25)
              {
                if (BYTE6(v49) == 2)
                {
                  WORD2(v49) = v24 + 7;
                  *(_BYTE *)(v48 + v25) = BYTE6(a1);
                  if (HIBYTE(v49))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }

                  else
                  {
                    uint64_t v26 = WORD2(v49);
                    if (WORD1(v49) > WORD2(v49))
                    {
                      if (BYTE6(v49) == 2)
                      {
                        ++WORD2(v49);
                        *(_BYTE *)(v48 + v26) = a2;
                        if (HIBYTE(v49))
                        {
                          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }

                        else
                        {
                          uint64_t v27 = WORD2(v49);
                          if (WORD1(v49) > WORD2(v49))
                          {
                            if (BYTE6(v49) == 2)
                            {
                              ++WORD2(v49);
                              *(_BYTE *)(v48 + v27) = a3;
                              if (HIBYTE(v49))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else
                              {
                                uint64_t v28 = WORD2(v49);
                                if (WORD1(v49) > WORD2(v49))
                                {
                                  if (BYTE6(v49) == 2)
                                  {
                                    ++WORD2(v49);
                                    *(_BYTE *)(v48 + v28) = a4;
                                    if (HIBYTE(v49))
                                    {
                                      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }

                                    else
                                    {
                                      uint64_t v29 = WORD2(v49);
                                      if (WORD1(v49) > WORD2(v49))
                                      {
                                        if (BYTE6(v49) == 2)
                                        {
                                          ++WORD2(v49);
                                          *(_BYTE *)(v48 + v29) = a5;
                                          if (HIBYTE(v49))
                                          {
                                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }

                                          else
                                          {
                                            uint64_t v30 = WORD2(v49);
                                            if (WORD1(v49) > WORD2(v49))
                                            {
                                              if (BYTE6(v49) == 2)
                                              {
                                                ++WORD2(v49);
                                                *(_BYTE *)(v48 + v30) = a6;
                                                if (HIBYTE(v49))
                                                {
                                                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }

                                                else
                                                {
                                                  uint64_t v31 = WORD2(v49);
                                                  if (WORD1(v49) > WORD2(v49))
                                                  {
                                                    if (BYTE6(v49) == 2)
                                                    {
                                                      ++WORD2(v49);
                                                      *(_BYTE *)(v48 + v31) = a7;
                                                      if (HIBYTE(v49))
                                                      {
                                                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }

                                                      else
                                                      {
                                                        uint64_t v32 = WORD2(v49);
                                                        if (WORD1(v49) > WORD2(v49))
                                                        {
                                                          if (BYTE6(v49) == 2)
                                                          {
                                                            ++WORD2(v49);
                                                            *(_BYTE *)(v48 + v32) = a8;
                                                            if (HIBYTE(v49))
                                                            {
                                                              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sourc"
                                                                                     "es/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                            }

                                                            else
                                                            {
                                                              uint64_t v33 = WORD2(v49);
                                                              if (WORD1(v49) > WORD2(v49))
                                                              {
                                                                if (BYTE6(v49) == 2)
                                                                {
                                                                  ++WORD2(v49);
                                                                  *(_BYTE *)(v48 + v33) = a9;
                                                                  if (HIBYTE(v49))
                                                                  {
                                                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs"
                                                                                           "/Sources/MobileBluetooth_base"
                                                                                           "/Stack/vsc/bcm/bcm_vsc.c");
                                                                  }

                                                                  else
                                                                  {
                                                                    uint64_t v34 = WORD2(v49);
                                                                    if (WORD1(v49) > WORD2(v49))
                                                                    {
                                                                      if (BYTE6(v49) == 2)
                                                                      {
                                                                        ++WORD2(v49);
                                                                        *(_BYTE *)(v48 + v34) = a10;
                                                                        return sub_10018BD78( 233,  v48,  BYTE4(v49),  a11,  (uint64_t)sub_10013E160,  v21,  v22,  v23);
                                                                      }

                                                                      uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_87:
                                                                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBlue tooth_base/Stack/vsc/bcm/bcm_vsc.c",  3531,  v46);
                                                                    }
                                                                  }

                                                                  uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                  goto LABEL_87;
                                                                }

                                                                uint64_t v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_83:
                                                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_ base/Stack/vsc/bcm/bcm_vsc.c",  3530,  v45);
                                                              }
                                                            }

                                                            uint64_t v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                            goto LABEL_83;
                                                          }

                                                          uint64_t v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_79:
                                                          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/S tack/vsc/bcm/bcm_vsc.c",  3529,  v44);
                                                        }
                                                      }

                                                      uint64_t v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_79;
                                                    }

                                                    uint64_t v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_75:
                                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/v sc/bcm/bcm_vsc.c",  3528,  v43);
                                                  }
                                                }

                                                uint64_t v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_75;
                                              }

                                              uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_71:
                                              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3527,  v42);
                                            }
                                          }

                                          uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_71;
                                        }

                                        uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_67:
                                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3526,  v41);
                                      }
                                    }

                                    uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_67;
                                  }

                                  int v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_63:
                                  sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3525,  v40);
                                }
                              }

                              int v40 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_63;
                            }

                            uint64_t v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3524,  v39);
                          }
                        }

                        uint64_t v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_59;
                      }

                      uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3523,  v38);
                    }
                  }

                  uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_55;
                }

                uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3522,  v37);
              }

              uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_51;
            }

            unsigned __int16 v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3521,  v36);
          }

          unsigned __int16 v36 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_47;
        }

        uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3518, v35);
      }
    }

    uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_43;
  }

  return result;
}

uint64_t sub_10016E658(char a1, char a2, __int16 a3, __int16 a4, __int16 a5, __int16 a6, uint64_t a7)
{
  uint64_t v31 = 0LL;
  uint64_t v32 = 0LL;
  uint64_t result = sub_10018BCDC(&v31);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v32))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else
    {
      uint64_t v18 = WORD2(v32);
      if (WORD1(v32) > WORD2(v32))
      {
        if (BYTE6(v32) == 2)
        {
          ++WORD2(v32);
          *(_BYTE *)(v31 + v18) = 81;
          if (HIBYTE(v32))
          {
            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }

          else
          {
            uint64_t v19 = WORD2(v32);
            if (WORD1(v32) > WORD2(v32))
            {
              if (BYTE6(v32) == 2)
              {
                ++WORD2(v32);
                *(_BYTE *)(v31 + v19) = a1;
                if (HIBYTE(v32))
                {
                  sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }

                else
                {
                  uint64_t v20 = WORD2(v32);
                  if (WORD1(v32) > WORD2(v32))
                  {
                    if (BYTE6(v32) == 2)
                    {
                      ++WORD2(v32);
                      *(_BYTE *)(v31 + v20) = a2;
                      if (HIBYTE(v32))
                      {
                        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }

                      else if (WORD1(v32) - WORD2(v32) > 1)
                      {
                        if (BYTE6(v32) == 2)
                        {
                          *(_WORD *)(v31 + WORD2(v32)) = a3;
                          unsigned __int16 v21 = WORD2(v32) + 2;
                          WORD2(v32) += 2;
                          if (HIBYTE(v32))
                          {
                            sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }

                          else if (WORD1(v32) - v21 > 1)
                          {
                            if (BYTE6(v32) == 2)
                            {
                              *(_BYTE *)(v31 + v21) = a4;
                              *(_BYTE *)(v31 + WORD2(v32) + 1) = HIBYTE(a4);
                              unsigned __int16 v22 = WORD2(v32) + 2;
                              WORD2(v32) += 2;
                              if (HIBYTE(v32))
                              {
                                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }

                              else if (WORD1(v32) - v22 > 1)
                              {
                                if (BYTE6(v32) == 2)
                                {
                                  *(_BYTE *)(v31 + v22) = a5;
                                  *(_BYTE *)(v31 + WORD2(v32) + 1) = HIBYTE(a5);
                                  unsigned __int16 v23 = WORD2(v32) + 2;
                                  WORD2(v32) += 2;
                                  if (HIBYTE(v32))
                                  {
                                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }

                                  else if (WORD1(v32) - v23 > 1)
                                  {
                                    if (BYTE6(v32) == 2)
                                    {
                                      *(_BYTE *)(v31 + v23) = a6;
                                      *(_BYTE *)(v31 + WORD2(v32) + 1) = HIBYTE(a6);
                                      WORD2(v32) += 2;
                                      return sub_10018BD78( 233,  v31,  BYTE4(v32),  a7,  (uint64_t)sub_10013E298,  v15,  v16,  v17);
                                    }

                                    uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3550,  v30);
                                  }

                                  uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_52;
                                }

                                uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3549,  v29);
                              }

                              uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                              goto LABEL_48;
                            }

                            uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3548,  v28);
                          }

                          uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_44;
                        }

                        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3547,  v27);
                      }

                      uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                      goto LABEL_40;
                    }

                    uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3546,  v26);
                  }
                }

                uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_36;
              }

              unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c",  3545,  v25);
            }
          }

          unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }

        __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3544, v24);
      }
    }

    __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }

  return result;
}

uint64_t sub_10016EA94(int a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0LL;
  uint64_t v15 = 0LL;
  uint64_t result = sub_10018BCDC(&v14);
  if (!(_DWORD)result)
  {
    if (HIBYTE(v15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }

    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = a1;
        *(_BYTE *)(v14 + WORD2(v15) + 2) = BYTE2(a1);
        *(_BYTE *)(v14 + WORD2(v15) + 3) = HIBYTE(a1);
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }

        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 5;
            *(_BYTE *)(v14 + v11) = a2;
            return sub_10018BD78(77, v14, BYTE4(v15), a3, (uint64_t)sub_10013DC24, v7, v8, v9);
          }

          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3688, v13);
        }

        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }

      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3687, v12);
    }

    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }

  return result;
}

uint64_t sub_10016EC28(unsigned int *a1)
{
  return *(unsigned __int8 *)(*(void *)(sub_10017AB4C(a1) + 112) + 12LL);
}

uint64_t sub_10016EC44(unsigned int *a1, int a2)
{
  if (!*(void *)(sub_10017AB4C(a1) + 112))
  {
    uint64_t v4 = sub_1000B1814(0x20uLL);
    *(void *)(sub_10017AB4C(a1) + 112) = v4;
  }

  uint64_t v5 = *(void *)(sub_10017AB4C(a1) + 112);
  unsigned int v6 = *(unsigned __int16 *)(sub_10017AB4C(a1) + 32);
  *(_BYTE *)(v5 + 12) = v6 / *(unsigned __int16 *)(sub_10017AB4C(a1) + 60);
  unsigned int v7 = *(unsigned __int16 *)(sub_10017AB4C(a1) + 32);
  uint64_t v8 = sub_10017AB4C(a1);
  char v9 = *(_BYTE *)(v5 + 12);
  if ((v9 & 0xF0) != 0) {
    uint64_t result = 104LL;
  }
  else {
    uint64_t result = 0LL;
  }
  *(_DWORD *)uint64_t v5 = a2;
  return result;
}

uint64_t sub_10016ECFC(unsigned int *a1, int a2, __int16 a3)
{
  if (!*(void *)(sub_10017AB4C(a1) + 112))
  {
    unsigned int v6 = sub_1000B1814(0x20uLL);
    *(void *)(sub_10017AB4C(a1) + 112) = v6;
  }

  uint64_t v7 = *(void *)(sub_10017AB4C(a1) + 112);
  *(_DWORD *)(v7 + 4) = a2;
  *(_WORD *)(v7 + 10) = a3;
  return 0LL;
}

uint64_t sub_10016ED64(unsigned int *a1)
{
  return *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL);
}

uint64_t sub_10016ED80(unsigned int *a1)
{
  uint64_t result = sub_10017AB4C(a1);
  uint64_t v3 = *(void **)(result + 112);
  if (v3)
  {
    uint64_t v4 = (void *)v3[2];
    if (v4)
    {
      sub_1000B1838(v4);
      v3[2] = 0LL;
    }

    sub_1000B1838(v3);
    uint64_t result = sub_10017AB4C(a1);
    *(void *)(result + 112) = 0LL;
  }

  return result;
}

uint64_t sub_10016EDCC(unsigned int *a1)
{
  return **(unsigned __int16 **)(sub_10017AB4C(a1) + 112);
}

uint64_t sub_10016EDE8(uint64_t a1, int a2)
{
  uint64_t v4 = sub_10017AB4C((unsigned int *)a1);
  if (!a2)
  {
    sub_1001EE134( (uint64_t)"LE_L2CAP_IncreaseRemoteCredits credits cannot be 0. Disconnecting.\n",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v24);
    unsigned __int16 v22 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      goto LABEL_9;
    }
LABEL_8:
    sub_100657858();
LABEL_9:
    sub_100175D08(*(unsigned __int16 *)(a1 + 4));
    return 101LL;
  }

  uint64_t v5 = *(unsigned int **)(v4 + 112);
  unsigned int v6 = *v5 + a2;
  *uint64_t v5 = v6;
  if (v6 >= 0x10000)
  {
    sub_1001EE134( (uint64_t)"LE_L2CAP_IncreaseRemoteCredits credits exceed max allowed. Disconnecting.\n",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v24);
    uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      goto LABEL_9;
    }
    goto LABEL_8;
  }

  sub_100187C98(*(unsigned __int16 *)(a1 + 4));
  return 0LL;
}

uint64_t sub_10016EEC4(unsigned int *a1, unsigned int a2)
{
  uint64_t v3 = *(unsigned int **)(sub_10017AB4C(a1) + 112);
  if (*v3 < a2) {
    return 101LL;
  }
  uint64_t result = 0LL;
  *v3 -= a2;
  return result;
}

uint64_t sub_10016EF04(uint64_t a1, unsigned __int16 *a2, uint64_t a3, char a4, uint64_t a5)
{
  uint64_t v10 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  if (*(_DWORD *)(v10 + 4))
  {
    uint64_t v11 = sub_10016F04C(a1, a2, a3, a4, a5);
    if ((_DWORD)v11)
    {
      uint64_t v12 = v11;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"LE_L2CAP_Flow_DataIndication returned %!. Disconnecting L2CAP Channel\n",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v12);
        uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_100175D08(*(unsigned __int16 *)(a1 + 4));
    }

    else
    {
      unsigned __int16 v21 = *(_WORD *)(v10 + 8) + 1;
      *(_WORD *)(v10 + 8) = v21;
      --*(_DWORD *)(v10 + 4);
      if ((unsigned __int16)(*(_WORD *)(v10 + 10) - 1) >= v21)
      {
        return 0LL;
      }

      else
      {
        unsigned __int16 v22 = *(__int128 **)sub_10017AB4C((unsigned int *)a1);
        char v23 = sub_100196568();
        sub_1001CA9D0(v22, v23, *(_WORD *)(a1 + 4), *(_WORD *)(v10 + 8));
        uint64_t v12 = 0LL;
        *(_DWORD *)(v10 + 4) += *(unsigned __int16 *)(v10 + 8);
        *(_WORD *)(v10 + 8) = 0;
      }
    }
  }

  else
  {
    sub_100175D08(*(unsigned __int16 *)(a1 + 4));
    return 408LL;
  }

  return v12;
}

uint64_t sub_10016F04C(uint64_t a1, unsigned __int16 *a2, uint64_t a3, char a4, uint64_t a5)
{
  uint64_t v10 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  uint64_t v12 = (uint64_t *)(v10 + 16);
  uint64_t v11 = *(char **)(v10 + 16);
  if (v11)
  {
LABEL_2:
    uint64_t v13 = *(unsigned int *)(v10 + 24);
    if (v13 + (unsigned __int16)a3 <= *(_DWORD *)(v10 + 28))
    {
      memmove(&v11[v13], a2, (unsigned __int16)a3);
      int v32 = *(_DWORD *)(v10 + 28);
      int v33 = *(_DWORD *)(v10 + 24) + (unsigned __int16)a3;
      *(_DWORD *)(v10 + 24) = v33;
      char v34 = *(_BYTE *)(v10 + 13) | a4;
      *(_BYTE *)(v10 + 13) = v34;
      if (v33 != v32) {
        return 0LL;
      }
      sub_100176890(*(unsigned __int16 *)(a1 + 4), *v12, (unsigned __int16)v33, v34 != 0, a5);
      uint64_t v35 = 0LL;
      goto LABEL_17;
    }

    if (!sub_1000A86F0()
      || (sub_1001EE134( (uint64_t)"Too much data received (currentPos=%d, new data size=%d, totalSDU size=%d\n",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  *(unsigned int *)(v10 + 24)),  unsigned __int16 v21 = (os_log_s *)sub_100086554(0x2Fu),  !os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)))
    {
LABEL_16:
      uint64_t v35 = 472LL;
LABEL_17:
      if (*v12) {
        sub_1000B1838((void *)*v12);
      }
      *(_BYTE *)(v10 + 13) = 0;
      *uint64_t v12 = 0LL;
      *(void *)(v10 + 24) = 0LL;
      return v35;
    }

uint64_t sub_10016F2BC(unsigned int a1, unsigned int a2)
{
  uint64_t v30 = 0LL;
  uint64_t v4 = sub_100171EC4(a1, (uint64_t *)&v30);
  if ((_DWORD)v4)
  {
    uint64_t v5 = v4;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ChanMan_GetChannel failed: %!", v6, v7, v8, v9, v10, v11, v12, v5);
      uint64_t v13 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else if (sub_100185870(a1))
  {
    uint64_t v14 = *(void *)(sub_10017AB4C(v30) + 112);
    uint64_t v15 = *(__int128 **)sub_10017AB4C(v30);
    char v16 = sub_100196568();
    uint64_t v5 = sub_1001CA9D0(v15, v16, *((_WORD *)v30 + 2), a2);
    if (!(_DWORD)v5)
    {
      *(_DWORD *)(v14 + 4) += a2;
      unsigned int v17 = *(unsigned __int16 *)(v14 + 8);
      uint64_t v5 = 0LL;
      BOOL v18 = v17 >= a2;
      __int16 v19 = v17 - a2;
      if (v18) {
        *(_WORD *)(v14 + 8) = v19;
      }
      else {
        *(_WORD *)(v14 + 8) = 0;
      }
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"This channel is not LE Credit based", v20, v21, v22, v23, v24, v25, v26, v29);
      uint64_t v27 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 403LL;
  }

  return v5;
}

BOOL sub_10016F400()
{
  if (qword_1008E2B60) {
    BOOL v0 = off_1008F6DE8 == 0LL;
  }
  else {
    BOOL v0 = 1;
  }
  return !v0;
}

char *sub_10016F424(unsigned int a1)
{
  if (a1 >= 0x111) {
    sub_1001EE2A0();
  }
  return (char *)&unk_1008D7438 + 24 * a1;
}

unint64_t sub_10016F45C(int a1)
{
  unsigned int v1 = a1 - &unk_1008D7438;
  if (v1 >> 3 >= 0x333) {
    sub_1001EE2A0();
  }
  return v1 / 0x18uLL;
}

unsigned __int8 *sub_10016F4A0(uint64_t a1)
{
  if (a1 < 0x24)
  {
    unsigned __int8 v3 = a1 - 1;
    goto LABEL_12;
  }

  if (a1 < 0x37)
  {
    unsigned __int8 v3 = a1 - 9;
    goto LABEL_19;
  }

  if (a1 < 0x3A)
  {
    unsigned __int8 v3 = a1 - 10;
    goto LABEL_19;
  }

  if (a1 < 0x3F)
  {
    unsigned __int8 v3 = a1 - 11;
    goto LABEL_19;
  }

  if (a1 < 0x49)
  {
    unsigned __int8 v3 = a1 - 19;
    goto LABEL_19;
  }

  if (a1 < 0x58)
  {
    unsigned __int8 v3 = a1 - 33;
LABEL_19:
    uint64_t result = (unsigned __int8 *)&unk_100885610 + 24 * v3;
    if (*result == (_DWORD)a1) {
      return result;
    }
    goto LABEL_20;
  }

  else {
    char v2 = 58;
  }
  unsigned __int8 v3 = v2 + a1;
LABEL_12:
  if (v3 <= 0x39u) {
    goto LABEL_19;
  }
LABEL_20:
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Unrecognized Event (%d) index is %d\n", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = (os_log_s *)sub_100086554(0x2Eu);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100657FDC(v12);
    }
  }

  return 0LL;
}

uint64_t sub_10016F5B0(unsigned int a1)
{
  if (a1 > 0x42) {
    return 769LL;
  }
  else {
    return dword_1006BD10C[(char)a1];
  }
}

const char *sub_10016F5D4(int a1)
{
  if (a1 > 4096)
  {
    if (a1 <= 0x2000)
    {
      switch(a1)
      {
        case 5121:
          uint64_t result = "OI_DHCI_READ_FAILED_CON_CTR_OPCODE";
          break;
        case 5122:
          uint64_t result = "OI_DHCI_RESET_FAILED_CON_CTR_OPCODE";
          break;
        case 5123:
          uint64_t result = "OI_DHCI_GET_LINK_QUALITY_OPCODE";
          break;
        case 5124:
LABEL_251:
          char v2 = "Unknown";
          if ((a1 & 0xFC00) == 0xF800) {
            char v2 = "OI_DHCI_BLUETOOTH_LOGO_TEST_OPCODE";
          }
          else {
            uint64_t result = "OI_DHCI_VENDOR_OPCODE";
          }
          break;
        case 5125:
          uint64_t result = "OI_DHCI_READ_RSSI_OPCODE";
          break;
        case 5126:
          uint64_t result = "OI_DHCI_READ_AFH_CHAN_MAP_OPCODE";
          break;
        case 5127:
          uint64_t result = "OI_DHCI_READ_CLOCK_OPCODE";
          break;
        case 5128:
          uint64_t result = "OI_DHCI_CMD_ID_READ_ENCRYPTION_KEY_SIZE_OPCODE";
          break;
        case 5129:
          uint64_t result = "OI_DHCI_CMD_ID_READ_LOCAL_AMP_INFO_OPCODE";
          break;
        case 5130:
          uint64_t result = "OI_DHCI_CMD_ID_READ_LOCAL_AMP_ASSOC_INFO_OPCODE";
          break;
        case 5131:
          uint64_t result = "OI_DHCI_CMD_ID_WRITE_LOCAL_AMP_ASSOC_INFO_OPCODE";
          break;
        default:
          switch(a1)
          {
            case 4097:
              uint64_t result = "OI_DHCI_READ_LOCAL_VER_INFO_OPCODE";
              break;
            case 4098:
              uint64_t result = "OI_DHCI_READ_LOCAL_SUP_CMDS_OPCODE";
              break;
            case 4099:
              uint64_t result = "OI_DHCI_READ_LOCAL_FEATURES_OPCODE";
              break;
            case 4100:
              uint64_t result = "OI_DHCI_READ_LOCAL_EXT_FEATURES_OPCODE";
              break;
            case 4101:
              uint64_t result = "OI_DHCI_READ_BUFFER_SIZE_OPCODE";
              break;
            case 4102:
            case 4104:
              goto LABEL_251;
            case 4103:
              uint64_t result = "OI_DHCI_READ_COUNTRY_CODE_OPCODE";
              break;
            case 4105:
              uint64_t result = "OI_DHCI_READ_BD_ADDR_OPCODE";
              break;
            case 4106:
              uint64_t result = "OI_DHCI_CMD_ID_READ_DATA_BLOCK_SIZE_OPCODE";
              break;
            default:
              switch(a1)
              {
                case 6145:
                  uint64_t result = "OI_DHCI_READ_LOOPBACK_MODE_OPCODE";
                  break;
                case 6146:
                  uint64_t result = "OI_DHCI_WRITE_LOOPBACK_MODE_OPCODE";
                  break;
                case 6147:
                  uint64_t result = "OI_DHCI_ENABLE_DEV_TEST_MODE_OPCODE";
                  break;
                case 6151:
                  uint64_t result = "OI_DHCI_CMD_ID_ENABLE_AMP_RECEIVER_REPORTS_OPCODE";
                  break;
                case 6152:
                  uint64_t result = "OI_DHCI_CMD_ID_AMP_TEST_END_OPCODE";
                  break;
                case 6153:
                  uint64_t result = "OI_DHCI_CMD_ID_AMP_TEST_OPCODE";
                  break;
                default:
                  goto LABEL_251;
              }

              break;
          }

          break;
      }
    }

    else
    {
      switch(a1)
      {
        case 8193:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_EVENT_MASK_OPCODE";
          break;
        case 8194:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_BUFFER_SIZE_OPCODE";
          break;
        case 8195:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_LOCAL_SUPPORTED_FEATURES_OPCODE";
          break;
        case 8197:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_RANDOM_ADDRESS_OPCODE";
          break;
        case 8198:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_ADVERTISING_PARAMETERS_OPCODE";
          break;
        case 8199:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_ADVERTISING_CHANNEL_TX_POWER_OPCODE";
          break;
        case 8200:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_ADVERTISING_DATA_OPCODE";
          break;
        case 8201:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_SCAN_RESPONSE_DATA_OPCODE";
          break;
        case 8202:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_ADVERTISE_ENABLE_OPCODE";
          break;
        case 8203:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_SCAN_PARAMETERS_OPCODE";
          break;
        case 8204:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_SCAN_ENABLE_OPCODE";
          break;
        case 8205:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CREATE_CONNECTION_OPCODE";
          break;
        case 8206:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CREATE_CONNECTION_CANCEL_OPCODE";
          break;
        case 8207:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_FILTER_ACCEPT_LIST_SIZE_OPCODE";
          break;
        case 8208:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CLEAR_FILTER_ACCEPT_LIST_OPCODE";
          break;
        case 8209:
          uint64_t result = "OI_DHCI_CMD_ID_LE_ADD_DEVICE_TO_FILTER_ACCEPT_LIST_OPCODE";
          break;
        case 8210:
          uint64_t result = "OI_DHCI_CMD_ID_LE_REMOVE_DEVICE_FROM_FILTER_ACCEPT_LIST_OPCODE";
          break;
        case 8211:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CONNECTION_UPDATE_OPCODE";
          break;
        case 8212:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_HOST_CHANNEL_CLASSIFICATION_OPCODE";
          break;
        case 8213:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_CHANNEL_MAP_OPCODE";
          break;
        case 8214:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_REMOTE_USED_FEATURES_OPCODE";
          break;
        case 8215:
          uint64_t result = "OI_DHCI_CMD_ID_LE_ENCRYPT_OPCODE";
          break;
        case 8216:
          uint64_t result = "OI_DHCI_CMD_ID_LE_RAND_OPCODE";
          break;
        case 8217:
          uint64_t result = "OI_DHCI_CMD_ID_LE_START_ENCRYPTION_OPCODE";
          break;
        case 8218:
          uint64_t result = "OI_DHCI_CMD_ID_LE_LONG_TERM_KEY_REQUEST_REPLY_OPCODE";
          break;
        case 8219:
          uint64_t result = "OI_DHCI_CMD_ID_LE_LONG_TERM_KEY_REQUEST_NEG_REPLY_OPCODE";
          break;
        case 8220:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_SUPPORTED_STATES_OPCODE";
          break;
        case 8221:
          uint64_t result = "OI_DHCI_CMD_ID_LE_RECEIVER_TEST_OPCODE";
          break;
        case 8222:
          uint64_t result = "OI_DHCI_CMD_ID_LE_TRANSMITTER_TEST_OPCODE";
          break;
        case 8223:
          uint64_t result = "OI_DHCI_CMD_ID_LE_TEST_END_OPCODE";
          break;
        case 8224:
          uint64_t result = "OI_DHCI_CMD_ID_LE_REMOTE_CONNECTION_PARAM_REQ_REPLY_OPCODE";
          break;
        case 8225:
          uint64_t result = "OI_DHCI_CMD_ID_LE_REMOTE_CONNECTION_PARAM_REQ_NEG_REPLY_OPCODE";
          break;
        case 8226:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_DATA_LENGTH_OPCODE";
          break;
        case 8227:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_SUGGESTED_DEFAULT_DATA_LENGTH_OPCODE";
          break;
        case 8228:
          uint64_t result = "OI_DHCI_CMD_ID_LE_WRITE_SUGGESTED_DEFAULT_DATA_LENGTH_OPCODE";
          break;
        case 8239:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_MAXIMUM_DATA_LENGTH_OPCODE";
          break;
        case 8240:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_PHY_OPCODE";
          break;
        case 8241:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_DEFAULT_PHY_OPCODE";
          break;
        case 8242:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_PHY_OPCODE";
          break;
        case 8288:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_BUFFER_SIZE_V2_OPCODE";
          break;
        case 8310:
          uint64_t result = "OI_DHCI_CMD_ID_LE_ENHANCED_READ_TRANSMIT_POWER_LEVEL_OPCODE";
          break;
        case 8311:
          uint64_t result = "OI_DHCI_CMD_ID_LE_READ_REMOTE_TRANSMIT_POWER_LEVEL_OPCODE";
          break;
        case 8312:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_PATH_LOSS_REPORTING_PARAMETERS_OPCODE";
          break;
        case 8313:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_PATH_LOSS_REPORTING_ENABLE_OPCODE";
          break;
        case 8314:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_TRANSMIT_POWER_REPORTING_ENABLE_OPCODE";
          break;
        case 8317:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_DEFAULT_SUBRATE_OPCODE";
          break;
        case 8318:
          uint64_t result = "OI_DHCI_CMD_ID_LE_SET_HOST_SUBRATING_OPCODE";
          break;
        case 8329:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_READ_LOCAL_SUPPORTED_CAPABILITIES_OPCODE";
          break;
        case 8330:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_READ_REMOTE_SUPPORTED_CAPABILITIES_OPCODE";
          break;
        case 8331:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_WRITE_CACHED_REMOTE_SUPPORTED_CAPABILITIES_OPCODE";
          break;
        case 8332:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_SET_SECURITY_ENABLE_OPCODE";
          break;
        case 8333:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_SET_DEFAULT_SETTINGS_OPCODE";
          break;
        case 8334:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_READ_REMOTE_FAE_TABLE_OPCODE";
          break;
        case 8335:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_WRITE_REMOTE_FAE_TABLE_OPCODE";
          break;
        case 8336:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_CREATE_CONFIG_OPCODE";
          break;
        case 8337:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_REMOVE_CONFIG_OPCODE";
          break;
        case 8338:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_SET_AFH_OPCODE";
          break;
        case 8339:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_SET_PROCEDURE_PARAMETERS_OPCODE";
          break;
        case 8340:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_SET_PROCEDURE_ENABLE_OPCODE";
          break;
        case 8342:
          uint64_t result = "OI_DHCI_CMD_ID_LE_CS_READ_LOCAL_FAE_TABLE_OPCODE";
          break;
        default:
          goto LABEL_251;
      }
    }
  }

  else if (a1 <= 3072)
  {
    switch(a1)
    {
      case 1025:
        uint64_t result = "OI_DHCI_INQUIRY_OPCODE";
        break;
      case 1026:
        uint64_t result = "OI_DHCI_INQUIRY_CANCEL_OPCODE";
        break;
      case 1027:
        uint64_t result = "OI_DHCI_PERIODIC_INQ_MODE_OPCODE";
        break;
      case 1028:
        uint64_t result = "OI_DHCI_EXIT_PERIODIC_INQ_MODE_OPCODE";
        break;
      case 1029:
        uint64_t result = "OI_DHCI_CREATE_CNCT_OPCODE";
        break;
      case 1030:
        uint64_t result = "OI_DHCI_DISC_OPCODE";
        break;
      case 1031:
        uint64_t result = "OI_DHCI_ADD_SCO_CNCT_OPCODE";
        break;
      case 1032:
        uint64_t result = "OI_DHCI_CANCEL_CREATE_CNCT_OPCODE";
        break;
      case 1033:
        uint64_t result = "OI_DHCI_ACCEPT_CNCT_REQ_OPCODE";
        break;
      case 1034:
        uint64_t result = "OI_DHCI_REJ_CNCT_REQ_OPCODE";
        break;
      case 1035:
        uint64_t result = "OI_DHCI_LINK_KEY_REQ_REPLY_OPCODE";
        break;
      case 1036:
        uint64_t result = "OI_DHCI_LINK_KEY_REQ_NEG_REPLY_OPCODE";
        break;
      case 1037:
        uint64_t result = "OI_DHCI_PIN_CODE_REQ_REPLY_OPCODE";
        break;
      case 1038:
        uint64_t result = "OI_DHCI_PIN_CODE_REQ_NEG_REPLY_OPCODE";
        break;
      case 1039:
        uint64_t result = "OI_DHCI_CHANGE_CNCT_PKT_TYPE_OPCODE";
        break;
      case 1040:
      case 1042:
      case 1044:
      case 1046:
      case 1048:
      case 1054:
      case 1056:
      case 1057:
      case 1058:
      case 1059:
      case 1060:
      case 1061:
      case 1062:
      case 1063:
      case 1073:
      case 1074:
        goto LABEL_251;
      case 1041:
        uint64_t result = "OI_DHCI_AUTHENT_REQ_OPCODE";
        break;
      case 1043:
        uint64_t result = "OI_DHCI_SET_CNCT_ENCRYPTION_OPCODE";
        break;
      case 1045:
        uint64_t result = "OI_DHCI_CHANGE_CNCT_LINK_KEY_OPCODE";
        break;
      case 1047:
        uint64_t result = "OI_DHCI_MASTER_LINK_KEY_OPCODE";
        break;
      case 1049:
        uint64_t result = "OI_DHCI_REMOTE_NAME_REQ_OPCODE";
        break;
      case 1050:
        uint64_t result = "OI_DHCI_CANCEL_REMOTE_NAME_REQ_OPCODE";
        break;
      case 1051:
        uint64_t result = "OI_DHCI_READ_REMOTE_FEATURE_OPCODE";
        break;
      case 1052:
        uint64_t result = "OI_DHCI_READ_REMOTE_EXT_FEATURE_OPCODE";
        break;
      case 1053:
        uint64_t result = "OI_DHCI_READ_REMOTE_VER_INFO_OPCODE";
        break;
      case 1055:
        uint64_t result = "OI_DHCI_READ_CLOCK_OFFSET_OPCODE";
        break;
      case 1064:
        uint64_t result = "OI_DHCI_SETUP_SYNCHRONOUS_CNCT_OPCODE";
        break;
      case 1065:
        uint64_t result = "OI_DHCI_ACCEPT_SYNCHRONOUS_CNCT_OPCODE";
        break;
      case 1066:
        uint64_t result = "OI_DHCI_REJ_SYNCHRONOUS_CNCT_OPCODE";
        break;
      case 1067:
        uint64_t result = "OI_DHCI_IO_CAP_REQ_REPLY_OPCODE";
        break;
      case 1068:
        uint64_t result = "OI_DHCI_USER_CONFIRM_REQ_REPLY_OPCODE";
        break;
      case 1069:
        uint64_t result = "OI_DHCI_USER_CONFIRM_REQ_NEG_REPLY_OPCODE";
        break;
      case 1070:
        uint64_t result = "OI_DHCI_USER_PASSKEY_REQ_REPLY_OPCODE";
        break;
      case 1071:
        uint64_t result = "OI_DHCI_USER_PASSKEY_REQ_NEG_REPLY_OPCODE";
        break;
      case 1072:
        uint64_t result = "OI_DHCI_REMOTE_OOB_DATA_REQ_REPLY_OPCODE";
        break;
      case 1075:
        uint64_t result = "OI_DHCI_REMOTE_OOB_DATA_REQ_NEG_REPLY_OPCODE";
        break;
      case 1076:
        uint64_t result = "OI_DHCI_IO_CAP_REQ_NEG_REPLY_OPCODE";
        break;
      case 1077:
        uint64_t result = "OI_DHCI_CMD_ID_CREATE_PHYSICAL_LINK_OPCODE";
        break;
      case 1078:
        uint64_t result = "OI_DHCI_CMD_ID_ACCEPT_PHYSICAL_LINK_OPCODE";
        break;
      case 1079:
        uint64_t result = "OI_DHCI_CMD_ID_DISCONNECT_PHYSICAL_LINK_OPCODE";
        break;
      case 1080:
        uint64_t result = "OI_DHCI_CMD_ID_CREATE_LOGICAL_LINK_OPCODE";
        break;
      case 1081:
        uint64_t result = "OI_DHCI_CMD_ID_ACCEPT_LOGICAL_LINK_OPCODE";
        break;
      case 1082:
        uint64_t result = "OI_DHCI_CMD_ID_DISCONNECT_LOGICAL_LINK_OPCODE";
        break;
      case 1083:
        uint64_t result = "OI_DHCI_CMD_ID_LOGICAL_LINK_CANCEL_OPCODE";
        break;
      case 1084:
        uint64_t result = "OI_DHCI_CMD_ID_FLOW_SPEC_MODIFY_OPCODE";
        break;
      default:
        switch(a1)
        {
          case 2049:
            uint64_t result = "OI_DHCI_HOLD_MODE_OPCODE";
            break;
          case 2050:
          case 2056:
          case 2058:
            goto LABEL_251;
          case 2051:
            uint64_t result = "OI_DHCI_SNIFF_MODE_OPCODE";
            break;
          case 2052:
            uint64_t result = "OI_DHCI_EXIT_SNIFF_MODE_OPCODE";
            break;
          case 2053:
            uint64_t result = "OI_DHCI_PARK_MODE_OPCODE";
            break;
          case 2054:
            uint64_t result = "OI_DHCI_EXIT_PARK_MODE_OPCODE";
            break;
          case 2055:
            uint64_t result = "OI_DHCI_QOS_SETUP_OPCODE";
            break;
          case 2057:
            uint64_t result = "OI_DHCI_ROLE_DISCOVERY_OPCODE";
            break;
          case 2059:
            uint64_t result = "OI_DHCI_SWITCH_ROLE_OPCODE";
            break;
          case 2060:
            uint64_t result = "OI_DHCI_READ_LINKPOLICY_OPCODE";
            break;
          case 2061:
            uint64_t result = "OI_DHCI_WRITE_LINKPOLICY_OPCODE";
            break;
          case 2062:
            uint64_t result = "OI_DHCI_READ_DEFAULT_LINKPOLICY_OPCODE";
            break;
          case 2063:
            uint64_t result = "OI_DHCI_WRITE_DEFAULT_LINKPOLICY_OPCODE";
            break;
          case 2064:
            uint64_t result = "OI_DHCI_WRITE_FLOW_SPECIFICATION_OPCODE";
            break;
          case 2065:
            uint64_t result = "OI_DHCI_SNIFF_SUBRATING_OPCODE";
            break;
          default:
            if (a1) {
              goto LABEL_251;
            }
            uint64_t result = "OI_DHCI_NOP_OPCODE";
            break;
        }

        break;
    }
  }

  else
  {
    switch(a1)
    {
      case 3073:
        uint64_t result = "OI_DHCI_SET_EVT_MASK_OPCODE";
        break;
      case 3075:
        uint64_t result = "OI_DHCI_RESET_OPCODE";
        break;
      case 3077:
        uint64_t result = "OI_DHCI_SET_EVT_FILTER_OPCODE";
        break;
      case 3080:
        uint64_t result = "OI_DHCI_FLUSH_OPCODE";
        break;
      case 3081:
        uint64_t result = "OI_DHCI_READ_PIN_TYPE_OPCODE";
        break;
      case 3082:
        uint64_t result = "OI_DHCI_WRITE_PIN_TYPE_OPCODE";
        break;
      case 3083:
        uint64_t result = "OI_DHCI_CREATE_NEW_UNIT_KEY_OPCODE";
        break;
      case 3085:
        uint64_t result = "OI_DHCI_READ_STORED_LINK_KEY_OPCODE";
        break;
      case 3089:
        uint64_t result = "OI_DHCI_WRITE_STORED_LINK_KEY_OPCODE";
        break;
      case 3090:
        uint64_t result = "OI_DHCI_DELETE_STORED_LINK_KEY_OPCODE";
        break;
      case 3091:
        uint64_t result = "OI_DHCI_CHANGE_LOCAL_NAME_OPCODE";
        break;
      case 3092:
        uint64_t result = "OI_DHCI_READ_LOCAL_NAME_OPCODE";
        break;
      case 3093:
        uint64_t result = "OI_DHCI_READ_CNCT_ACCEPT_TO_OPCODE";
        break;
      case 3094:
        uint64_t result = "OI_DHCI_WRITE_CNCT_ACCEPT_TO_OPCODE";
        break;
      case 3095:
        uint64_t result = "OI_DHCI_READ_PAGE_TIMEOUT_OPCODE";
        break;
      case 3096:
        uint64_t result = "OI_DHCI_WRITE_PAGE_TIMEOUT_OPCODE";
        break;
      case 3097:
        uint64_t result = "OI_DHCI_READ_SCAN_ENABLE_OPCODE";
        break;
      case 3098:
        uint64_t result = "OI_DHCI_WRITE_SCAN_ENABLE_OPCODE";
        break;
      case 3099:
        uint64_t result = "OI_DHCI_READ_PAGESCAN_ACTIVITY_OPCODE";
        break;
      case 3100:
        uint64_t result = "OI_DHCI_WRITE_PAGESCAN_ACT_OPCODE";
        break;
      case 3101:
        uint64_t result = "OI_DHCI_READ_INQUIRYSCAN_ACT_OPCODE";
        break;
      case 3102:
        uint64_t result = "OI_DHCI_WRITE_INQUIRYSCAN_ACT_OPCODE";
        break;
      case 3103:
        uint64_t result = "OI_DHCI_READ_AUTHENT_ENABLE_OPCODE";
        break;
      case 3104:
        uint64_t result = "OI_DHCI_WRITE_AUTHENT_ENABLE_OPCODE";
        break;
      case 3105:
        uint64_t result = "OI_DHCI_READ_ENCRYPTION_MODE_OPCODE";
        break;
      case 3106:
        uint64_t result = "OI_DHCI_WRITE_ENCRYPTION_MODE_OPCODE";
        break;
      case 3107:
        uint64_t result = "OI_DHCI_READ_CLASS_OF_DEVICE_OPCODE";
        break;
      case 3108:
        uint64_t result = "OI_DHCI_WRITE_CLASS_OF_DEVICE_OPCODE";
        break;
      case 3109:
        uint64_t result = "OI_DHCI_READ_VOICE_SETTING_OPCODE";
        break;
      case 3110:
        uint64_t result = "OI_DHCI_WRITE_VOICE_SETTING_OPCODE";
        break;
      case 3111:
        uint64_t result = "OI_DHCI_READ_AUTO_FLUSH_TO_OPCODE";
        break;
      case 3112:
        uint64_t result = "OI_DHCI_WRITE_AUTO_FLUSH_TO_OPCODE";
        break;
      case 3113:
        uint64_t result = "OI_DHCI_READ_NUM_BC_RETRANS_OPCODE";
        break;
      case 3114:
        uint64_t result = "OI_DHCI_WRITE_NUM_BC_RETRANS_OPCODE";
        break;
      case 3115:
        uint64_t result = "OI_DHCI_READ_HOLD_MODE_ACT_OPCODE";
        break;
      case 3116:
        uint64_t result = "OI_DHCI_WRITE_HOLD_MODE_ACT_OPCODE";
        break;
      case 3117:
        uint64_t result = "OI_DHCI_READ_TX_POWER_LEVEL_OPCODE";
        break;
      case 3118:
        uint64_t result = "OI_DHCI_READ_SCO_FLOW_CTL_ENA_OPCODE";
        break;
      case 3119:
        uint64_t result = "OI_DHCI_WRITE_SCO_FLOW_CTL_ENA_OPCODE";
        break;
      case 3121:
        uint64_t result = "OI_DHCI_SET_CNTR_TO_HOST_FLOW_OPCODE";
        break;
      case 3123:
        uint64_t result = "OI_DHCI_HOST_BUFFER_SIZE_OPCODE";
        break;
      case 3125:
        uint64_t result = "OI_DHCI_HOST_NUM_COMPLETED_PKTS_OPCODE";
        break;
      case 3126:
        uint64_t result = "OI_DHCI_READ_LINK_SVISION_TO_OPCODE";
        break;
      case 3127:
        uint64_t result = "OI_DHCI_WRITE_LINK_SVISION_TO_OPCODE";
        break;
      case 3128:
        uint64_t result = "OI_DHCI_READ_NUM_SUPPORTED_IAC_OPCODE";
        break;
      case 3129:
        uint64_t result = "OI_DHCI_READ_CURRENT_IAC_LAP_OPCODE";
        break;
      case 3130:
        uint64_t result = "OI_DHCI_WRITE_CURRENT_IAC_LAP_OPCODE";
        break;
      case 3131:
        uint64_t result = "OI_DHCI_READ_PAGESCAN_PRD_MODE_OPCODE";
        break;
      case 3132:
        uint64_t result = "OI_DHCI_WRITE_PAGESCAN_PRD_MODE_OPCODE";
        break;
      case 3133:
        uint64_t result = "OI_DHCI_READ_PAGESCAN_MODE_OPCODE";
        break;
      case 3134:
        uint64_t result = "OI_DHCI_WRITE_PAGESCAN_MODE_OPCODE";
        break;
      case 3135:
        uint64_t result = "OI_DHCI_SET_AFH_CHAN_CLASS_OPCODE";
        break;
      case 3138:
        uint64_t result = "OI_DHCI_READ_INQUIRY_SCAN_TYPE_OPCODE";
        break;
      case 3139:
        uint64_t result = "OI_DHCI_WRITE_INQUIRY_SCAN_TYPE_OPCODE";
        break;
      case 3140:
        uint64_t result = "OI_DHCI_READ_INQUIRY_MODE_OPCODE";
        break;
      case 3141:
        uint64_t result = "OI_DHCI_WRITE_INQUIRY_MODE_OPCODE";
        break;
      case 3142:
        uint64_t result = "OI_DHCI_READ_PAGESCAN_TYPE_OPCODE";
        break;
      case 3143:
        uint64_t result = "OI_DHCI_WRITE_PAGESCAN_TYPE_OPCODE";
        break;
      case 3144:
        uint64_t result = "OI_DHCI_READ_AFH_CHAN_ASSESS_MODE_OPCODE";
        break;
      case 3145:
        uint64_t result = "OI_DHCI_WRITE_AFH_CHAN_ASSESS_MODE_OPCODE";
        break;
      case 3153:
        uint64_t result = "OI_DHCI_READ_EXT_INQ_RESP_OPCODE";
        break;
      case 3154:
        uint64_t result = "OI_DHCI_WRITE_EXT_INQ_RESP_OPCODE";
        break;
      case 3155:
        uint64_t result = "OI_DHCI_REFRESH_ENCRYPTION_KEY_OPCODE";
        break;
      case 3157:
        uint64_t result = "OI_DHCI_READ_SIMPLE_PAIRING_MODE_OPCODE";
        break;
      case 3158:
        uint64_t result = "OI_DHCI_WRITE_SIMPLE_PAIRING_MODE_OPCODE";
        break;
      case 3159:
        uint64_t result = "OI_DHCI_READ_LOCAL_OOB_DATA_OPCODE";
        break;
      case 3160:
        uint64_t result = "OI_DHCI_READ_INQ_RESP_TX_PWR_OPCODE";
        break;
      case 3161:
        uint64_t result = "OI_DHCI_WRITE_INQ_RESP_TX_PWR_OPCODE";
        break;
      case 3162:
        uint64_t result = "OI_DHCI_READ_DEF_ERR_DATA_REPORT_OPCODE";
        break;
      case 3163:
        uint64_t result = "OI_DHCI_WRITE_DEF_ERR_DATA_REPORT_OPCODE";
        break;
      case 3167:
        uint64_t result = "OI_DHCI_ENHANCED_FLUSH_OPCODE";
        break;
      case 3168:
        uint64_t result = "OI_DHCI_SEND_KEY_PRESS_NOTIFY_OPCODE";
        break;
      case 3169:
        uint64_t result = "OI_DHCI_CMD_ID_READ_LOGICAL_LINK_ACCEPT_TIMEOUT_OPCODE";
        break;
      case 3170:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_LOGICAL_LINK_ACCEPT_TIMEOUT_OPCODE";
        break;
      case 3171:
        uint64_t result = "OI_DHCI_CMD_ID_SET_EVENT_MASK_PAGE_2_OPCODE";
        break;
      case 3172:
        uint64_t result = "OI_DHCI_CMD_ID_READ_LOCATION_DATA_OPCODE";
        break;
      case 3173:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_LOCATION_DATA_OPCODE";
        break;
      case 3174:
        uint64_t result = "OI_DHCI_CMD_ID_READ_FLOW_CONTROL_MODE_OPCODE";
        break;
      case 3175:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_FLOW_CONTROL_MODE_OPCODE";
        break;
      case 3176:
        uint64_t result = "OI_DHCI_CMD_ID_READ_ENHANCED_TX_POWER_LEVEL_OPCODE";
        break;
      case 3177:
        uint64_t result = "OI_DHCI_CMD_ID_READ_BEST_EFFORT_FLUSH_TIMEOUT_OPCODE";
        break;
      case 3178:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_BEST_EFFORT_FLUSH_TIMEOUT_OPCODE";
        break;
      case 3179:
        uint64_t result = "OI_DHCI_CMD_ID_SHORT_RANGE_MODE_OPCODE";
        break;
      case 3180:
        uint64_t result = "OI_DHCI_CMD_ID_READ_LE_HOST_SUPPORTED_OPCODE";
        break;
      case 3181:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_LE_HOST_SUPPORTED_OPCODE";
        break;
      case 3182:
        uint64_t result = "OI_DHCI_CMD_ID_MWS_SET_CHANNEL_PARAMETERS_OPCODE";
        break;
      case 3183:
        uint64_t result = "OI_DHCI_CMD_ID_MWS_SET_EXTERNAL_FRAME_CONFIG_OPCODE";
        break;
      case 3184:
        uint64_t result = "OI_DHCI_CMD_ID_MWS_SIGNALING_OPCODE";
        break;
      case 3185:
        uint64_t result = "OI_DHCI_CMD_ID_MWS_SET_TRANSPORT_LAYER_OPCODE";
        break;
      case 3186:
        uint64_t result = "OI_DHCI_CMD_ID_MWS_SET_SCAN_FREQ_TABLE_OPCODE";
        break;
      case 3193:
        uint64_t result = "OI_DHCI_CMD_ID_READ_SECURE_CONNECTION_HOST_SUPPORT_OPCODE";
        break;
      case 3194:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_SECURE_CONNECTION_HOST_SUPPORT_OPCODE";
        break;
      case 3195:
        uint64_t result = "OI_DHCI_CMD_ID_READ_AUTHENTICATION_PAYLOAD_TIMEOUT_OPCODE";
        break;
      case 3196:
        uint64_t result = "OI_DHCI_CMD_ID_WRITE_AUTHENTICATION_PAYLOAD_TIMEOUT_OPCODE";
        break;
      case 3204:
        uint64_t result = "OI_DHCI_CMD_ID_SET_MIN_ENCRYPTION_KEY_SIZE_OPCODE";
        break;
      default:
        goto LABEL_251;
    }
  }

  return result;
}

uint64_t sub_10017025C()
{
  if (DWORD2(xmmword_1008F6F18)) {
    return 140LL;
  }
  unsigned int v1 = (unsigned int *)sub_1001EDBA0(6u);
  qword_1008E2B68 = (uint64_t)sub_1000B1814(0x10uLL);
  *(void *)qword_1008E2B68 = sub_1000B1814(504LL * *v1);
  char v2 = (_DWORD *)sub_1001EDBA0(6u);
  uint64_t result = 0LL;
  *(_DWORD *)(qword_1008E2B68 + 8) = *v2;
  DWORD2(xmmword_1008F6F18) = 1;
  return result;
}

uint64_t sub_1001702EC()
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 0LL;
  }
  unsigned int v0 = *(_DWORD *)(qword_1008E2B68 + 8);
  if (!v0) {
    return 0LL;
  }
  unsigned __int8 v1 = 0;
  uint64_t v2 = *(void *)qword_1008E2B68;
  while (*(_DWORD *)(v2 + 504LL * v1 + 12))
  {
    if (v0 <= ++v1) {
      return 0LL;
    }
  }

  ++*(_DWORD *)(qword_1008E2B68 + 12);
  return v2 + 504LL * v1;
}

void sub_100170354(uint64_t a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    sub_1001EE2A0();
  }
  *(void *)(a1 + 496) = 0LL;
  *(_OWORD *)(a1 + 464) = 0u;
  *(_OWORD *)(a1 + 480) = 0u;
  *(_OWORD *)(a1 + 432) = 0u;
  *(_OWORD *)(a1 + 448) = 0u;
  *(_OWORD *)(a1 + 400) = 0u;
  *(_OWORD *)(a1 + 416) = 0u;
  *(_OWORD *)(a1 + 368) = 0u;
  *(_OWORD *)(a1 + 384) = 0u;
  *(_OWORD *)(a1 + 336) = 0u;
  *(_OWORD *)(a1 + 352) = 0u;
  *(_OWORD *)(a1 + 304) = 0u;
  *(_OWORD *)(a1 + 320) = 0u;
  *(_OWORD *)(a1 + 272) = 0u;
  *(_OWORD *)(a1 + 288) = 0u;
  *(_OWORD *)(a1 + 240) = 0u;
  *(_OWORD *)(a1 + 256) = 0u;
  *(_OWORD *)(a1 + 208) = 0u;
  *(_OWORD *)(a1 + 224) = 0u;
  *(_OWORD *)(a1 + 176) = 0u;
  *(_OWORD *)(a1 + 192) = 0u;
  *(_OWORD *)(a1 + 144) = 0u;
  *(_OWORD *)(a1 + 160) = 0u;
  *(_OWORD *)(a1 + 112) = 0u;
  *(_OWORD *)(a1 + 128) = 0u;
  *(_OWORD *)(a1 + 80) = 0u;
  *(_OWORD *)(a1 + 96) = 0u;
  *(_OWORD *)(a1 + 48) = 0u;
  *(_OWORD *)(a1 + 64) = 0u;
  *(_OWORD *)(a1 + 16) = 0u;
  *(_OWORD *)(a1 + 32) = 0u;
  *(_OWORD *)a1 = 0u;
  *(_DWORD *)(a1 + 12) = 0;
  uint64_t v2 = (void **)qword_1008E2B68;
  int v3 = *(_DWORD *)(qword_1008E2B68 + 12) - 1;
  *(_DWORD *)(qword_1008E2B68 + 12) = v3;
  if (!v3 && DWORD2(xmmword_1008F6F18))
  {
    if (*v2)
    {
      sub_1000B1838(*v2);
      uint64_t v2 = (void **)qword_1008E2B68;
      *(void *)qword_1008E2B68 = 0LL;
    }

    sub_1000B1838(v2);
    qword_1008E2B68 = 0LL;
    DWORD2(xmmword_1008F6F18) = 0;
  }

uint64_t sub_100170414(_OWORD *a1, _WORD *a2)
{
  if (DWORD2(xmmword_1008F6F18) || (uint64_t v11 = sub_10017025C(), !(_DWORD)v11))
  {
    if (a1)
    {
      uint64_t v4 = sub_1001702EC();
      if (*(_DWORD *)(v4 + 12)) {
        sub_1001EE2A0();
      }
      *(_DWORD *)(v4 + 8) = 0;
      *(_OWORD *)(v4 + 32) = *a1;
      __int128 v5 = a1[1];
      __int128 v6 = a1[2];
      __int128 v7 = a1[4];
      *(_OWORD *)(v4 + 80) = a1[3];
      *(_OWORD *)(v4 + 96) = v7;
      *(_OWORD *)(v4 + 48) = v5;
      *(_OWORD *)(v4 + 64) = v6;
      __int128 v8 = a1[5];
      __int128 v9 = a1[6];
      __int128 v10 = a1[8];
      *(_OWORD *)(v4 + 144) = a1[7];
      *(_OWORD *)(v4 + 160) = v10;
      *(_OWORD *)(v4 + 112) = v8;
      *(_OWORD *)(v4 + 128) = v9;
      __int128 v21 = unk_100885BA8;
      uint64_t v11 = sub_1001F629C((uint64_t)&v21, (uint64_t)off_100885B80, 0, a2, (uint64_t)&unk_1006BD578, 0);
      if ((_DWORD)v11)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"OI_OBEXSRV_RegisterL2capServer failed with status %!",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
          __int16 v19 = (os_log_s *)sub_100086554(6u);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        sub_100170354(v4);
      }

      else
      {
        *(_DWORD *)(v4 + 12) = 1;
        *(_WORD *)(v4 + 22) = *a2;
      }
    }

    else
    {
      sub_1001EE2A0();
      return 101LL;
    }
  }

  return v11;
}

uint64_t sub_100170554(int a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 0LL;
  }
  unsigned int v1 = *(_DWORD *)(qword_1008E2B68 + 8);
  if (!v1) {
    return 0LL;
  }
  unsigned __int8 v2 = 0;
  uint64_t v3 = *(void *)qword_1008E2B68;
  while (*(unsigned __int8 *)(v3 + 504LL * v2 + 20) != a1)
  {
    if (v1 <= ++v2) {
      return 0LL;
    }
  }

  return v3 + 504LL * v2;
}

uint64_t sub_1001705B4(int a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 408LL;
  }
  uint64_t v2 = sub_10017066C(a1);
  if (!v2) {
    return 406LL;
  }
  uint64_t v3 = v2;
  uint64_t v4 = sub_1001F6614(a1);
  if ((_DWORD)v4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_BIPSRV_DeregisterAVRCPServer: %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(6u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  sub_100170354(v3);
  return v4;
}

uint64_t sub_10017066C(int a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 0LL;
  }
  unsigned int v1 = *(_DWORD *)(qword_1008E2B68 + 8);
  if (!v1) {
    return 0LL;
  }
  unsigned __int8 v2 = 0;
  uint64_t v3 = *(void *)qword_1008E2B68;
  while (*(unsigned __int16 *)(v3 + 504LL * v2 + 22) != a1)
  {
    if (v1 <= ++v2) {
      return 0LL;
    }
  }

  return v3 + 504LL * v2;
}

uint64_t sub_1001706CC(int a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 408LL;
  }
  uint64_t v1 = sub_100170714(a1);
  if (*(_DWORD *)(v1 + 12) >= 2u) {
    return sub_1000B8A34(*(unsigned __int16 *)(v1 + 30));
  }
  else {
    return 1709LL;
  }
}

uint64_t sub_100170714(int a1)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 0LL;
  }
  unsigned int v1 = *(_DWORD *)(qword_1008E2B68 + 8);
  if (!v1) {
    return 0LL;
  }
  unsigned __int8 v2 = 0;
  uint64_t v3 = *(void *)qword_1008E2B68;
  while (*(unsigned __int16 *)(v3 + 504LL * v2 + 30) != a1)
  {
    if (v1 <= ++v2) {
      return 0LL;
    }
  }

  return v3 + 504LL * v2;
}

uint64_t sub_100170774(unsigned int a1, int a2)
{
  uint64_t v4 = sub_100170714(a1);
  if (v4)
  {
    uint64_t v5 = v4;
    if (a2) {
      int v6 = 0;
    }
    else {
      int v6 = 3390;
    }
    uint64_t v7 = sub_1000B82E0(a1, a2, v6);
    if ((_DWORD)v7)
    {
      uint64_t v8 = v7;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"OI_OBEXSRV_AcceptConnect failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
        uint64_t v16 = (os_log_s *)sub_100086554(6u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      uint64_t v8 = 0LL;
      if (a2) {
        *(_DWORD *)(v5 + 12) = 2;
      }
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"No server registered on OBEX handle %d", v17, v18, v19, v20, v21, v22, v23, a1);
      uint64_t v24 = (os_log_s *)sub_100086554(6u);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1709LL;
  }

  return v8;
}

uint64_t sub_100170878(int a1, uint64_t a2)
{
  uint64_t v3 = sub_100170714(a1);
  __int16 v4 = *(_WORD *)(v3 + 28);
  *(_DWORD *)a2 = *(_DWORD *)(v3 + 24);
  *(_WORD *)(a2 + 4) = v4;
  return 0LL;
}

uint64_t sub_1001708AC(int a1, _OWORD *a2, _OWORD *a3, _DWORD *a4, _OWORD *a5, _OWORD *a6, int a7, int a8)
{
  if (!DWORD2(xmmword_1008F6F18)) {
    return 408LL;
  }
  uint64_t v15 = sub_100170714(a1);
  uint64_t v16 = v15;
  if (a8 && a8 != 1701)
  {
    *(_DWORD *)(v15 + 12) = 2;
    uint64_t v19 = *(void **)(v15 + 232);
    if (v19)
    {
      sub_1000B1838(v19);
      *(void *)(v16 + 232) = 0LL;
    }

    unsigned int v20 = *(unsigned __int16 *)(v16 + 30);
    uint64_t v21 = 0LL;
    return sub_1000B8024(v20, v21, a8);
  }

  if (!*(_DWORD *)(v15 + 16))
  {
    if (a2)
    {
      *(_BYTE *)(v15 + 360) = 48;
      *(_OWORD *)(v15 + 368) = *a2;
      unsigned int v17 = 1;
      if (!a3)
      {
LABEL_13:
        if (a4)
        {
          uint64_t v23 = v15 + 24LL * v17;
          *(_BYTE *)(v23 + 360) = -61;
          *(_DWORD *)(v23 + 368) = *a4;
          ++v17;
        }

        if (a5)
        {
          uint64_t v24 = v15 + 24LL * v17;
          *(_BYTE *)(v24 + 360) = 76;
          *(_OWORD *)(v24 + 368) = *a5;
          ++v17;
        }

        goto LABEL_17;
      }
    }

    else
    {
      unsigned int v17 = 0;
      if (!a3) {
        goto LABEL_13;
      }
    }

    uint64_t v22 = v15 + 24LL * v17;
    *(_BYTE *)(v22 + 360) = 113;
    *(_OWORD *)(v22 + 368) = *a3;
    ++v17;
    goto LABEL_13;
  }

  unsigned int v17 = 0;
LABEL_17:
  if (a6)
  {
    if (a7) {
      char v25 = 73;
    }
    else {
      char v25 = 72;
    }
    uint64_t v26 = v15 + 24LL * v17;
    *(_BYTE *)(v26 + 360) = v25;
    *(_OWORD *)(v26 + 368) = *a6;
    LOBYTE(v17) = v17 + 1;
  }

  uint64_t v21 = v15 + 480;
  *(void *)(v15 + 480) = v15 + 360;
  *(_BYTE *)(v15 + 488) = v17;
  unsigned int v20 = *(unsigned __int16 *)(v15 + 30);
  return sub_1000B8024(v20, v21, a8);
}

uint64_t sub_100170A30(int a1, uint64_t a2, int a3)
{
  return sub_1001708AC(a1, 0LL, 0LL, 0LL, 0LL, *(_OWORD **)(a2 + 8), *(unsigned __int8 *)(a2 + 16), a3);
}

uint64_t sub_100170A50(int a1, uint64_t a2, int a3)
{
  return sub_1001708AC(a1, 0LL, 0LL, (_DWORD *)(a2 + 16), 0LL, *(_OWORD **)(a2 + 24), *(unsigned __int8 *)(a2 + 32), a3);
}

uint64_t sub_100170A70(uint64_t a1, int a2)
{
  int v21 = 0;
  __int16 v20 = 0;
  int v19 = 0;
  if (v21 == 1)
  {
    unsigned __int16 v17 = 0;
    sub_1001F6638(a1, &v17);
    uint64_t v13 = sub_10017066C(v17);
  }

  else
  {
    if (v21) {
      goto LABEL_2;
    }
    unsigned __int8 v18 = 0;
    sub_1000FBF4C(a1, &v18);
    uint64_t v13 = sub_100170554(v18);
  }

  uint64_t v14 = v13;
  if (v13)
  {
    uint64_t result = sub_1000B898C(a1, (uint64_t)&v19);
    *(_DWORD *)(v14 + 24) = v19;
    *(_WORD *)(v14 + 28) = v20;
    *(_WORD *)(v14 + 30) = a1;
    unsigned int v15 = *(_DWORD *)(v14 + 8);
    if (a2)
    {
      if (v15 > 2) {
        return result;
      }
      uint64_t v16 = *(uint64_t (**)(uint64_t))(v14 + 48);
      if (!v16) {
        return sub_1000B8740(a1, 0LL, 0, 0LL, 0);
      }
    }

    else
    {
      if (v15 > 2) {
        return result;
      }
      uint64_t v16 = *(uint64_t (**)(uint64_t))(v14 + 32);
    }

    return v16(a1);
  }

void sub_100170BDC(uint64_t a1)
{
  uint64_t v2 = sub_100170714(a1);
  uint64_t v3 = v2;
  if (*(_DWORD *)(v2 + 8) <= 2u) {
    (*(void (**)(uint64_t))(v2 + 40))(a1);
  }
  uint64_t v4 = *(void **)(v3 + 232);
  if (v4)
  {
    sub_1000B1838(v4);
    *(void *)(v3 + 232) = 0LL;
  }

  *(void *)(v3 + 240) = 0LL;
  *(_DWORD *)(v3 + 12) = 1;
  *(_WORD *)(v3 + 30) = 0;
}

uint64_t sub_100170C38(int a1, uint64_t *a2, uint64_t a3)
{
  return sub_100170C58(a1, a2, a3, &off_100885BB8, 9);
}

uint64_t sub_100170C48(int a1, uint64_t *a2, uint64_t a3)
{
  return sub_100170C58(a1, a2, a3, &off_100885C48, 8);
}

uint64_t sub_100170C58(int a1, uint64_t *a2, uint64_t a3, _UNKNOWN **a4, int a5)
{
  LODWORD(v5) = a5;
  uint64_t v9 = sub_100170714(a1);
  unsigned int v10 = *(_DWORD *)(v9 + 12);
  if (v10 <= 1)
  {
    sub_1001EE2A0();
    return 408LL;
  }

  uint64_t v12 = v9;
  if (!(_DWORD)a3 || (_DWORD)a3 == 1752 || (_DWORD)a3 == 1701)
  {
    BOOL v13 = v10 == 2;
    if (a2)
    {
      BOOL v15 = (_DWORD)a3 != 1701 && a4 == &off_100885C48;
LABEL_15:
      sub_10009D008((int *)(v12 + 248), a2);
      if (v10 != 2)
      {
        if (*(_DWORD *)(v12 + 12) != 3) {
          sub_1001EE2A0();
        }
        int v27 = 1;
        goto LABEL_38;
      }

      uint64_t v16 = *(const void ***)(v12 + 256);
      if (v16)
      {
        *(void *)(v12 + 240) = 0LL;
        if ((_DWORD)v5)
        {
          size_t v17 = *(unsigned __int16 *)v16;
          uint64_t v5 = v5;
          while ((_DWORD)v17 != *(unsigned __int16 *)*a4 || memcmp(v16[1], *((const void **)*a4 + 1), v17))
          {
            a4 += 2;
            if (!--v5) {
              goto LABEL_22;
            }
          }

          *(void *)(v12 + 240) = a4;
          if (*((_DWORD *)a4 + 2) == 2)
          {
            if (v15 && !*(void *)(v12 + 304)) {
              a4 = &off_100885C68;
            }
            else {
              a4 = &off_100885C58;
            }
            *(void *)(v12 + 240) = a4;
          }

          int v38 = *((_DWORD *)a4 + 2);
          int v39 = *(_DWORD *)(v12 + 8);
          if (v39 != 2)
          {
            if (v39 == 1)
            {
              switch(v38)
              {
                case 1:
                  goto LABEL_61;
                case 4:
                  goto LABEL_62;
                case 8:
                case 14:
                  goto LABEL_59;
                case 9:
                  goto LABEL_63;
                case 10:
                  goto LABEL_64;
                case 11:
                  goto LABEL_65;
                case 12:
                  goto LABEL_66;
                default:
                  goto LABEL_72;
              }
            }

            if (!v39)
            {
              switch(v38)
              {
                case 1:
                  goto LABEL_61;
                case 3:
                case 14:
                  goto LABEL_59;
                case 4:
                  uint64_t v40 = (void *)(v12 + 136);
                  goto LABEL_67;
                case 5:
                  goto LABEL_63;
                case 6:
                  goto LABEL_64;
                case 7:
                  goto LABEL_65;
                case 8:
                  goto LABEL_66;
                case 9:
                  goto LABEL_62;
                case 10:
                  uint64_t v40 = (void *)(v12 + 112);
                  goto LABEL_67;
                case 11:
                  uint64_t v40 = (void *)(v12 + 120);
                  goto LABEL_67;
                case 12:
                  uint64_t v40 = (void *)(v12 + 128);
                  goto LABEL_67;
                case 13:
                  uint64_t v40 = (void *)(v12 + 144);
                  goto LABEL_67;
                case 15:
                  uint64_t v40 = (void *)(v12 + 152);
                  goto LABEL_67;
                case 16:
                  uint64_t v40 = (void *)(v12 + 168);
                  goto LABEL_67;
                case 17:
                  uint64_t v40 = (void *)(v12 + 160);
                  goto LABEL_67;
                default:
                  break;
              }
            }

uint64_t sub_100171094(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  if (*(_DWORD *)(a1 + 12) != 3) {
    sub_1001EE2A0();
  }
  uint64_t result = 1743LL;
  switch(*(_DWORD *)(*(void *)(a1 + 240) + 8LL))
  {
    case 1:
      if (*(_DWORD *)(a1 + 8) > 2u) {
        return 408LL;
      }
      uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 56);
      if (!v5)
      {
        sub_1001EE2A0();
        uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 56);
      }

      uint64_t v6 = *(unsigned __int16 *)(a1 + 30);
      uint64_t v7 = *(void *)(a1 + 232);
      uint64_t v8 = *(unsigned int *)(a1 + 16);
      goto LABEL_163;
    case 3:
      uint64_t v9 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v9)
      {
        if ((_DWORD)v9 == 2) {
          goto LABEL_131;
        }
        if ((_DWORD)v9 != 1) {
          goto LABEL_136;
        }
        uint64_t v10 = *(void *)(a1 + 232);
      }

      else
      {
        uint64_t v10 = *(void *)(a1 + 232);
        *(_OWORD *)uint64_t v10 = *(_OWORD *)(a1 + 264);
      }

      *(void *)(v10 + 16) = *(void *)(a1 + 304);
      *(_BYTE *)(v10 + 24) = *(_BYTE *)(a1 + 312);
LABEL_131:
      int v52 = *(_DWORD *)(a1 + 8);
      if (v52 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support PUT_IMAGE command.\n",  v194,  v195,  v196,  v197,  v198,  v199,  v200,  v243);
        uint64_t v201 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v201, OS_LOG_TYPE_ERROR)) {
          goto LABEL_233;
        }
      }

      else
      {
        if (v52 != 1)
        {
          if (v52) {
            goto LABEL_136;
          }
          char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 64);
          if (!v25)
          {
            sub_1001EE2A0();
            char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 64);
            goto LABEL_186;
          }

          goto LABEL_187;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support PUT_IMAGE command.\n",  v202,  v203,  v204,  v205,  v206,  v207,  v208,  v243);
        uint64_t v209 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v209, OS_LOG_TYPE_ERROR)) {
          goto LABEL_233;
        }
      }

      goto LABEL_232;
    case 4:
      uint64_t v8 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v8) {
        return 408LL;
      }
      **(void **)(a1 + 232) = *(void *)(a1 + 280);
LABEL_17:
      int v11 = *(_DWORD *)(a1 + 8);
      if (v11 == 2)
      {
        uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 104);
        if (v5) {
          goto LABEL_162;
        }
        sub_1001EE2A0();
        uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 104);
LABEL_161:
        uint64_t v8 = *(unsigned int *)(a1 + 16);
LABEL_162:
        uint64_t v6 = *(unsigned __int16 *)(a1 + 30);
        uint64_t v7 = *(void *)(a1 + 232);
LABEL_163:
        LODWORD(result) = v5(v6, v7, v8, a2);
        goto LABEL_253;
      }

      if (v11 != 1)
      {
        if (v11) {
          return 408LL;
        }
        uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 136);
        if (v5) {
          goto LABEL_162;
        }
        sub_1001EE2A0();
        uint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 136);
        goto LABEL_161;
      }

      sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support DELETE_IMAGE command.\n",  v71,  v72,  v73,  v74,  v75,  v76,  v77,  v243);
      v78 = (os_log_s *)sub_100086554(6u);
      if (!os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
        return 1743LL;
      }
LABEL_166:
      sub_100657858();
      return 1743LL;
    case 5:
      uint64_t v12 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v12)
      {
        if ((_DWORD)v12 == 2) {
          goto LABEL_139;
        }
        if ((_DWORD)v12 != 1) {
          goto LABEL_144;
        }
        BOOL v13 = *(int8x16_t **)(a1 + 232);
      }

      else
      {
        BOOL v13 = *(int8x16_t **)(a1 + 232);
        *BOOL v13 = vextq_s8(*(int8x16_t *)(a1 + 272), *(int8x16_t *)(a1 + 272), 8uLL);
      }

      v13[1].i64[0] = *(void *)(a1 + 304);
      v13[1].i8[8] = *(_BYTE *)(a1 + 312);
LABEL_139:
      int v53 = *(_DWORD *)(a1 + 8);
      if (v53 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support PUT_LINKED_ATTACHEMENT command.\n",  v210,  v211,  v212,  v213,  v214,  v215,  v216,  v243);
        unsigned __int16 v217 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v217, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
      }

      else
      {
        if (v53 != 1)
        {
          if (v53) {
            goto LABEL_144;
          }
          uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 72);
          if (!v30)
          {
            sub_1001EE2A0();
            uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 72);
            goto LABEL_196;
          }

          goto LABEL_197;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support PUT_LINKED_ATTACHEMENT command.\n",  v218,  v219,  v220,  v221,  v222,  v223,  v224,  v243);
        uint64_t v225 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v225, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
      }

      goto LABEL_240;
    case 6:
      uint64_t v14 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v14)
      {
        if ((_DWORD)v14 == 2) {
          goto LABEL_147;
        }
        if ((_DWORD)v14 != 1) {
          goto LABEL_152;
        }
        uint64_t v15 = *(void *)(a1 + 232);
      }

      else
      {
        uint64_t v15 = *(void *)(a1 + 232);
        *(void *)uint64_t v15 = *(void *)(a1 + 280);
      }

      *(void *)(v15 + 8) = *(void *)(a1 + 304);
      *(_BYTE *)(v15 + 16) = *(_BYTE *)(a1 + 312);
LABEL_147:
      int v54 = *(_DWORD *)(a1 + 8);
      if (v54 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support PUT_LINKED_THUMBNAIL command.\n",  v226,  v227,  v228,  v229,  v230,  v231,  v232,  v243);
        uint64_t v233 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v233, OS_LOG_TYPE_ERROR)) {
          goto LABEL_251;
        }
      }

      else
      {
        if (v54 != 1)
        {
          if (v54) {
            goto LABEL_152;
          }
          uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 80);
          if (!v23)
          {
            sub_1001EE2A0();
            uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 80);
            goto LABEL_179;
          }

          goto LABEL_180;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support PUT_LINKED_THUMBNAIL command.\n",  v234,  v235,  v236,  v237,  v238,  v239,  v240,  v243);
        uint64_t v241 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v241, OS_LOG_TYPE_ERROR)) {
          goto LABEL_251;
        }
      }

      goto LABEL_250;
    case 7:
      uint64_t v14 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v14) {
        goto LABEL_152;
      }
      uint64_t v16 = *(void *)(a1 + 232);
      *(void *)uint64_t v16 = *(void *)(a1 + 280);
      *(_BYTE *)(v16 + 8) = *(_BYTE *)(a1 + 333);
LABEL_33:
      int v17 = *(_DWORD *)(a1 + 8);
      if (v17 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support REMOTE_DISPLAY command.\n",  v79,  v80,  v81,  v82,  v83,  v84,  v85,  v243);
        int v86 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v86, OS_LOG_TYPE_ERROR)) {
          goto LABEL_251;
        }
      }

      else
      {
        if (v17 != 1)
        {
          if (v17) {
            goto LABEL_152;
          }
LABEL_123:
          uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 88);
          if (!v23)
          {
            sub_1001EE2A0();
            uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 88);
            goto LABEL_179;
          }

          goto LABEL_180;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support REMOTE_DISPLAY command.\n",  v87,  v88,  v89,  v90,  v91,  v92,  v93,  v243);
        int v94 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
          goto LABEL_251;
        }
      }

      goto LABEL_250;
    case 8:
      uint64_t v18 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v18) {
        goto LABEL_121;
      }
      uint64_t v19 = *(void *)(a1 + 232);
      *(_DWORD *)uint64_t v19 = *(_DWORD *)(a1 + 314);
      *(_BYTE *)(v19 + 4) = *(_BYTE *)(a1 + 318);
      *(void *)(v19 + 8) = *(void *)(a1 + 272);
LABEL_40:
      int v20 = *(_DWORD *)(a1 + 8);
      if (v20 == 2) {
        goto LABEL_125;
      }
      if (v20 != 1)
      {
        if (v20) {
          goto LABEL_121;
        }
        uint64_t v21 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 96);
        if (!v21)
        {
          sub_1001EE2A0();
          uint64_t v21 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 96);
          goto LABEL_127;
        }

        goto LABEL_128;
      }

      sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_IMAGES_LIST command.\n",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  v243);
      uint64_t v102 = (os_log_s *)sub_100086554(6u);
      if (!os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
        goto LABEL_211;
      }
      goto LABEL_210;
    case 9:
      uint64_t v14 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v14) {
        goto LABEL_152;
      }
      **(void **)(a1 + 232) = *(void *)(a1 + 280);
LABEL_48:
      int v22 = *(_DWORD *)(a1 + 8);
      if (v22 == 2)
      {
        uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 72);
        if (v23) {
          goto LABEL_180;
        }
        sub_1001EE2A0();
        uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 72);
        goto LABEL_179;
      }

      if (v22 != 1)
      {
        if (v22) {
          goto LABEL_152;
        }
        uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 104);
        if (!v23)
        {
          sub_1001EE2A0();
          uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 104);
          goto LABEL_179;
        }

        goto LABEL_180;
      }

      sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_IMAGE_PROPERTIES command.\n",  v103,  v104,  v105,  v106,  v107,  v108,  v109,  v243);
      int v110 = (os_log_s *)sub_100086554(6u);
      if (!os_log_type_enabled(v110, OS_LOG_TYPE_ERROR)) {
        goto LABEL_251;
      }
      goto LABEL_250;
    case 0xA:
      uint64_t v9 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v9) {
        goto LABEL_136;
      }
      *(int8x16_t *)*(void *)(a1 + 232) = vextq_s8(*(int8x16_t *)(a1 + 272), *(int8x16_t *)(a1 + 272), 8uLL);
LABEL_56:
      int v24 = *(_DWORD *)(a1 + 8);
      if (v24 == 2)
      {
        char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 80);
        if (v25)
        {
LABEL_187:
          LODWORD(result) = v25(*(unsigned __int16 *)(a1 + 30), *(void *)(a1 + 232), v9, a2);
          goto LABEL_234;
        }

        sub_1001EE2A0();
        char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 80);
LABEL_186:
        uint64_t v9 = *(unsigned int *)(a1 + 16);
        goto LABEL_187;
      }

      if (v24 != 1)
      {
        if (v24)
        {
LABEL_136:
          LODWORD(result) = 408;
          goto LABEL_234;
        }

        char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 112);
        if (v25) {
          goto LABEL_187;
        }
        sub_1001EE2A0();
        char v25 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 112);
        goto LABEL_186;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_IMAGE command.\n",  v111,  v112,  v113,  v114,  v115,  v116,  v117,  v243);
        int v118 = (os_log_s *)sub_100086554(6u);
        if (os_log_type_enabled(v118, OS_LOG_TYPE_ERROR)) {
LABEL_232:
        }
          sub_100657858();
      }

LABEL_233:
      LODWORD(result) = 1743;
LABEL_234:
      uint64_t v159 = *(void *)(a1 + 232);
      *(void *)(v159 + 32) = 0LL;
      goto LABEL_243;
    case 0xB:
      uint64_t v14 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v14) {
        goto LABEL_152;
      }
      **(void **)(a1 + 232) = *(void *)(a1 + 280);
LABEL_64:
      int v26 = *(_DWORD *)(a1 + 8);
      if (v26 == 2) {
        goto LABEL_123;
      }
      if (v26 == 1)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_LINKED_THUMBNAIL command.\n",  v119,  v120,  v121,  v122,  v123,  v124,  v125,  v243);
          uint64_t v126 = (os_log_s *)sub_100086554(6u);
          if (os_log_type_enabled(v126, OS_LOG_TYPE_ERROR)) {
LABEL_250:
          }
            sub_100657858();
        }

LABEL_251:
        LODWORD(result) = 1743;
      }

      else if (v26)
      {
LABEL_152:
        LODWORD(result) = 408;
      }

      else
      {
        uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 120);
        if (!v23)
        {
          sub_1001EE2A0();
          uint64_t v23 = *(uint64_t (**)(void, void, uint64_t, uint64_t))(a1 + 120);
LABEL_179:
          uint64_t v14 = *(unsigned int *)(a1 + 16);
        }

LABEL_180:
        LODWORD(result) = v23(*(unsigned __int16 *)(a1 + 30), *(void *)(a1 + 232), v14, a2);
      }

      uint64_t v242 = *(void **)(a1 + 232);
      *uint64_t v242 = 0LL;
      v242[1] = 0LL;
      v242[2] = 0LL;
      goto LABEL_253;
    case 0xC:
      uint64_t v12 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v12) {
        goto LABEL_144;
      }
      int v27 = *(void **)(a1 + 232);
      uint64_t v28 = *(void *)(a1 + 264);
      void *v27 = *(void *)(a1 + 280);
      v27[1] = v28;
LABEL_72:
      int v29 = *(_DWORD *)(a1 + 8);
      if (v29 == 2)
      {
        uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 96);
        if (v30) {
          goto LABEL_197;
        }
        sub_1001EE2A0();
        uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 96);
        goto LABEL_196;
      }

      if (v29 != 1)
      {
        if (v29) {
          goto LABEL_144;
        }
        uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 128);
        if (!v30)
        {
          sub_1001EE2A0();
          uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 128);
          goto LABEL_196;
        }

        goto LABEL_197;
      }

      sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support LINKED_ATTACHMENT command.\n",  v127,  v128,  v129,  v130,  v131,  v132,  v133,  v243);
      int v134 = (os_log_s *)sub_100086554(6u);
      if (!os_log_type_enabled(v134, OS_LOG_TYPE_ERROR)) {
        goto LABEL_241;
      }
      goto LABEL_240;
    case 0xD:
      int v31 = *(_DWORD *)(a1 + 16);
      if (v31 == 2) {
        goto LABEL_82;
      }
      if (v31 == 1) {
        goto LABEL_81;
      }
      if (v31) {
        goto LABEL_144;
      }
      *(_OWORD *)*(void *)(a1 + 232) = *(_OWORD *)(a1 + 336);
LABEL_81:
      uint64_t v32 = *(void *)(a1 + 232);
      *(void *)(v32 + 16) = *(void *)(a1 + 304);
      *(_BYTE *)(v32 + 24) = *(_BYTE *)(a1 + 312);
LABEL_82:
      int v33 = *(_DWORD *)(a1 + 8);
      if (v33 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support START_PRINT command.\n",  v135,  v136,  v137,  v138,  v139,  v140,  v141,  v243);
        uint64_t v142 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v142, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
      }

      else
      {
        if (v33 != 1)
        {
          if (v33) {
            goto LABEL_144;
          }
          uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 144);
          if (!v30)
          {
            sub_1001EE2A0();
            uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 144);
          }

          uint64_t v34 = *(unsigned __int16 *)(a1 + 30);
          uint64_t v35 = *(void *)(a1 + 232);
          uint64_t v12 = *(unsigned int *)(a1 + 16);
          goto LABEL_198;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support START_PRINT command.\n",  v143,  v144,  v145,  v146,  v147,  v148,  v149,  v243);
        int v150 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v150, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
      }

      goto LABEL_240;
    case 0xE:
      uint64_t v18 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v18) {
        goto LABEL_121;
      }
      uint64_t v36 = *(void **)(a1 + 232);
      *uint64_t v36 = *(void *)(a1 + 264);
      v36[1] = *(void *)(a1 + 320);
LABEL_91:
      int v37 = *(_DWORD *)(a1 + 8);
      if (v37 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support GET_PARTIAL_IMAGE command.\n",  v151,  v152,  v153,  v154,  v155,  v156,  v157,  v243);
        uint64_t v158 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v158, OS_LOG_TYPE_ERROR)) {
          goto LABEL_211;
        }
        goto LABEL_210;
      }

      if (v37 != 1)
      {
        if (v37)
        {
LABEL_121:
          LODWORD(result) = 408;
          goto LABEL_212;
        }

        sub_1001EE134( (uint64_t)"IMAGE_REPONDER server type does not support GET_PARTIAL_IMAGE command.\n",  v38,  v39,  v40,  v41,  v42,  v43,  v44,  v243);
        uint64_t v45 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          goto LABEL_211;
        }
LABEL_210:
        sub_100657858();
LABEL_211:
        LODWORD(result) = 1743;
        goto LABEL_212;
      }

        *(_BYTE *)(v261 + 29) = *(_BYTE *)(v261 + 29) & 0xFD | HIBYTE(v262) & 2;
        if ((v214 & 0x400) == 0)
        {
LABEL_154:
          if ((v214 & 0x800) == 0) {
            goto LABEL_155;
          }
          goto LABEL_182;
        }

LABEL_128:
      LODWORD(result) = v21(*(unsigned __int16 *)(a1 + 30), *(void *)(a1 + 232), v18, a2);
LABEL_212:
      uint64_t v159 = *(void *)(a1 + 232);
      __int128 v160 = 0uLL;
      *(_OWORD *)(v159 + 32) = 0u;
      goto LABEL_244;
    case 0xF:
      int v46 = *(_DWORD *)(a1 + 16);
      if (v46) {
        goto LABEL_122;
      }
      *(_OWORD *)*(void *)(a1 + 232) = *(_OWORD *)(a1 + 336);
LABEL_100:
      int v47 = *(_DWORD *)(a1 + 8);
      if (v47 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support START_ARCHIVE command.\n",  v161,  v162,  v163,  v164,  v165,  v166,  v167,  v243);
        v168 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v168, OS_LOG_TYPE_ERROR)) {
          goto LABEL_219;
        }
      }

      else
      {
        if (v47 != 1)
        {
          if (v47)
          {
LABEL_122:
            LODWORD(result) = 408;
          }

          else
          {
            uint64_t v48 = *(uint64_t (**)(void, void, void, uint64_t))(a1 + 152);
            if (!v48)
            {
              sub_1001EE2A0();
              uint64_t v48 = *(uint64_t (**)(void, void, void, uint64_t))(a1 + 152);
            }

            LODWORD(result) = v48(*(unsigned __int16 *)(a1 + 30), *(void *)(a1 + 232), *(unsigned int *)(a1 + 16), a2);
          }

    memset(v112, 0, 26);
    uuid_copy((unsigned __int8 *)v112 + 2, uu);
    BYTE2(v112[2]) = 0;
    HIDWORD(v112[2]) = 0;
    LOBYTE(v112[3]) = 0;
    uint64_t v107 = 0;
    sub_100242CA4(&v107);
    if (a11 == 1)
    {
      uint64_t v76 = sub_1003666D4(v108);
      v52[4] = v76 + v76 * (0x400 / v76);
      v52[5] = v76 + v76 * (0x400 / v76);
      goto LABEL_131;
    }

    if (a11)
    {
LABEL_131:
      uint64_t v77 = (os_log_s *)qword_1008F7610;
      if (os_log_type_enabled((os_log_t)qword_1008F7610, OS_LOG_TYPE_DEFAULT))
      {
        memset(buf, 0, 37);
        uuid_unparse_upper(uu, buf);
        sub_10002418C(__p, buf);
        v78 = v110 >= 0 ? __p : (void **)__p[0];
        uint64_t v79 = v52[4];
        uint64_t v80 = v52[5];
        *(_DWORD *)out = 67109890;
        *(_DWORD *)&out[4] = a5;
        *(_WORD *)&out[8] = 2082;
        *(void *)&out[10] = v78;
        *(_WORD *)&out[18] = 1024;
        *(_DWORD *)&out[20] = v79;
        *(_WORD *)&out[24] = 1024;
        *(_DWORD *)&out[26] = v80;
        _os_log_impl( (void *)&_mh_execute_header,  v77,  OS_LOG_TYPE_DEFAULT,  "Connecting LE PSM:0x%04x device %{public}s inMTU=%d inMPS=%d",  (uint8_t *)out,  0x1Eu);
        if (v110 < 0) {
          operator delete(__p[0]);
        }
      }

      uint64_t v81 = sub_10017478C( (uint64_t)sub_100366C50,  (uint64_t)sub_100366D50,  (uint64_t)sub_100366DB8,  a5,  v108,  (__int16 *)v52 + 4,  v112);
      goto LABEL_138;
    }

    uint64_t v89 = (os_log_s *)qword_1008F7610;
    if (os_log_type_enabled((os_log_t)qword_1008F7610, OS_LOG_TYPE_DEFAULT))
    {
      memset(buf, 0, 37);
      uuid_unparse_upper(uu, buf);
      sub_10002418C(__p, buf);
      uint64_t v90 = v110 >= 0 ? __p : (void **)__p[0];
      uint64_t v91 = v52[12];
      *(_DWORD *)out = 67109634;
      *(_DWORD *)&out[4] = a5;
      *(_WORD *)&out[8] = 2082;
      *(void *)&out[10] = v90;
      *(_WORD *)&out[18] = 1024;
      *(_DWORD *)&out[20] = v91;
      _os_log_impl( (void *)&_mh_execute_header,  v89,  OS_LOG_TYPE_DEFAULT,  "Connecting Classic PSM:0x%04x device %{public}s inMTU=%d",  (uint8_t *)out,  0x18u);
      if (v110 < 0) {
        operator delete(__p[0]);
      }
    }

    if (!v28)
    {
      uint64_t v100 = (os_log_s *)qword_1008F7610;
      if (os_log_type_enabled((os_log_t)qword_1008F7610, OS_LOG_TYPE_ERROR))
      {
        uint64_t v101 = sub_100241F94(uu);
        uint64_t v102 = (void *)objc_claimAutoreleasedReturnValue(v101);
        sub_100672174(v102, (uint64_t)buf, v100);
      }

      uint64_t v81 = 105;
      goto LABEL_138;
    }

    uint64_t v92 = sub_1003E36CC(v28, a5);
    uint64_t v93 = (void *)objc_claimAutoreleasedReturnValue(v92);
    if (!v93)
    {
      *(_WORD *)buf = -1;
      uint64_t v93 = (void *)objc_claimAutoreleasedReturnValue(+[NSData dataWithBytes:length:](&OBJC_CLASS___NSData, "dataWithBytes:length:", buf, 2LL));
      if (!v93)
      {
        if (os_log_type_enabled((os_log_t)qword_1008F7610, OS_LOG_TYPE_ERROR)) {
          sub_1006721C0();
        }
        uint64_t v81 = 482;
        goto LABEL_138;
      }
    }

    if ([v93 length] == (id)2)
    {
      int v94 = *(unsigned __int16 *)[v93 bytes];
      *((_BYTE *)v52 + 64) = 3;
      v52[33] = 2;
      uint64_t v95 = bswap32(v94) >> 16;
    }

    else
    {
      if ([v93 length] != (id)4)
      {
        *((_BYTE *)v52 + 64) = 3;
        v52[33] = 16;
        *((void *)v52 + 9) = [v93 bytes];
        goto LABEL_176;
      }

      uint64_t v103 = *(_DWORD *)[v93 bytes];
      *((_BYTE *)v52 + 64) = 3;
      v52[33] = 4;
      uint64_t v95 = bswap32(v103);
    }

    *((_DWORD *)v52 + 18) = v95;
LABEL_176:
    buf[0] = BYTE5(v104);
    buf[1] = BYTE4(v104);
    buf[2] = BYTE3(v104);
    buf[3] = BYTE2(v104);
    buf[4] = BYTE1(v104);
    buf[5] = v104;
    uint64_t v81 = sub_100174028( (uint64_t)sub_1003668D4,  (uint64_t)sub_100366A28,  (uint64_t)sub_100366B20,  a5,  (uint64_t)buf,  (uint64_t)(v52 + 12),  v112,  (uint64_t)(v52 + 32));

LABEL_138:
    sub_100242CD0(&v107);
    if (v81)
    {
      uint64_t v82 = (void (***)(void, void *, uint64_t, uint64_t, void, void, void))*v50;
      uint64_t v83 = sub_100241F94(uu);
      uint64_t v84 = (void *)objc_claimAutoreleasedReturnValue(v83);
      switch(v81)
      {
        case 104:
          uint64_t v85 = 1802LL;
          break;
        case 482:
          uint64_t v85 = 1800LL;
          break;
        case 402:
          uint64_t v85 = 1801LL;
          break;
        default:
          uint64_t v85 = 1LL;
          break;
      }

      (**v82)(v82, v84, v85, a5, 0LL, 0LL, 0LL);
    }

    else
    {
      int v86 = *((void *)v52 + 16);
      if (v86 >= *((void *)v52 + 17))
      {
        uint64_t v88 = sub_10036B63C((uint64_t *)v52 + 15, (uint64_t)v112);
      }

      else
      {
        *(_WORD *)int v86 = v112[0];
        uuid_copy((unsigned __int8 *)(v86 + 2), (const unsigned __int8 *)v112 + 2);
        uint64_t v87 = *(_DWORD *)((char *)&v112[2] + 2);
        *(_DWORD *)(v86 + 21) = *(_DWORD *)((char *)&v112[2] + 5);
        *(_DWORD *)(v86 + 18) = v87;
        uint64_t v88 = v86 + 26;
        *((void *)v52 + 16) = v86 + 26;
      }

      *((void *)v52 + 16) = v88;
    }

    sub_100242CD8(&v107);
    return;
  }

  if (qword_1008D5F30 != -1) {
    dispatch_once(&qword_1008D5F30, &stru_1008932F8);
  }
  int v29 = off_1008D5F28;
  uint64_t v30 = sub_100241F94(uu);
  int v31 = (void *)objc_claimAutoreleasedReturnValue(v30);
  uint64_t v104 = sub_1005CC198((uint64_t)v29, v31, 0);

  if (qword_1008D5F50 != -1) {
    dispatch_once(&qword_1008D5F50, &stru_100893318);
  }
  uint64_t v32 = sub_10040007C(off_1008D5F48, v104, 0);
  uint64_t v28 = (uint64_t)v32;
  if (v32 && v32[1332]) {
    goto LABEL_52;
  }
  uint64_t v60 = (os_log_s *)qword_1008F7610;
  if (os_log_type_enabled((os_log_t)qword_1008F7610, OS_LOG_TYPE_DEFAULT))
  {
    memset(buf, 0, 37);
    uuid_unparse_upper(uu, buf);
    sub_10002418C(out, buf);
    uint64_t v61 = out[23] >= 0 ? out : *(char **)out;
    *(_DWORD *)buf = 136446466;
    *(void *)&buf[4] = v61;
    *(_WORD *)&buf[12] = 1024;
    *(_DWORD *)&buf[14] = a5;
    _os_log_impl( (void *)&_mh_execute_header,  v60,  OS_LOG_TYPE_DEFAULT,  "could not connect to device %{public}s on PSM:0x%04x",  buf,  0x12u);
    if (out[23] < 0) {
      operator delete(*(void **)out);
    }
  }

  if (a3)
  {
    uint64_t v62 = sub_100241F94(uu);
    uint64_t v63 = (void *)objc_claimAutoreleasedReturnValue(v62);
    (**a3)(a3, v63, 1804LL, a5, 0LL, 0LL, 0LL);
  }

  uint64_t v95 = 0;
  uint64_t v67 = sub_1002E6E00();
  sub_10002418C(buf, "LeObserver");
  sub_10002418C(__p, "OverrideContactTracingLowDutyScanIntervalSeconds");
  uint64_t v68 = (*(uint64_t (**)(uint64_t, uint8_t *, void **, int *))(*(void *)v67 + 88LL))(v67, buf, __p, &v95);
  if (v95) {
    uint64_t v69 = v68;
  }
  else {
    uint64_t v69 = 0;
  }
  if (v110 < 0) {
    operator delete(__p[0]);
  }
  if (v113 < 0)
  {
    operator delete(*(void **)buf);
    if (!v69) {
      goto LABEL_140;
    }
  }

  else if (!v69)
  {
    goto LABEL_140;
  }

  *(_WORD *)(a1 + 268) = v95;
  uint64_t v70 = sub_1002E6E00();
  if ((*(unsigned int (**)(uint64_t))(*(void *)v70 + 176LL))(v70))
  {
    uint64_t v71 = (os_log_s *)qword_1008F76C8;
    if (os_log_type_enabled((os_log_t)qword_1008F76C8, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v72 = *(unsigned __int16 *)(a1 + 268);
      *(_DWORD *)buf = 67109120;
      *(_DWORD *)&buf[4] = v72;
      _os_log_impl( (void *)&_mh_execute_header,  v71,  OS_LOG_TYPE_DEFAULT,  "Overriding fLowDutyCycleScanIntervalWhileContactTracing with %d seconds",  buf,  8u);
    }
  }

    uint64_t v10 = 1;
  }

  sub_100608A2C(v108, v10);
}

LABEL_220:
          int v177 = *(void **)(a1 + 232);
          *int v177 = 0LL;
          v177[1] = 0LL;
          goto LABEL_253;
        }

        if (!sub_1000A86F0()
          || (sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support START_ARCHIVE command.\n",  v169,  v170,  v171,  v172,  v173,  v174,  v175,  v243),  int v176 = (os_log_s *)sub_100086554(6u),  !os_log_type_enabled(v176, OS_LOG_TYPE_ERROR)))
        {
LABEL_219:
          LODWORD(result) = 1743;
          goto LABEL_220;
        }
      }

      sub_100657858();
      goto LABEL_219;
    case 0x10:
      uint64_t v12 = *(unsigned int *)(a1 + 16);
      if ((_DWORD)v12) {
        goto LABEL_144;
      }
      **(_BYTE **)(a1 + 232) = *(_BYTE *)(a1 + 352) != 0;
LABEL_109:
      int v49 = *(_DWORD *)(a1 + 8);
      if (v49 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support GET_MONITORING_IMAGE command.\n",  v178,  v179,  v180,  v181,  v182,  v183,  v184,  v243);
        v185 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v185, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
LABEL_240:
        sub_100657858();
LABEL_241:
        LODWORD(result) = 1743;
        goto LABEL_242;
      }

      if (v49 == 1)
      {
        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_MONITORING_IMAGE command.\n",  v186,  v187,  v188,  v189,  v190,  v191,  v192,  v243);
        uint64_t v193 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v193, OS_LOG_TYPE_ERROR)) {
          goto LABEL_241;
        }
        goto LABEL_240;
      }

      if (v49)
      {
LABEL_144:
        LODWORD(result) = 408;
      }

      else
      {
        uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 168);
        if (!v30)
        {
          sub_1001EE2A0();
          uint64_t v30 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 168);
LABEL_196:
          uint64_t v12 = *(unsigned int *)(a1 + 16);
        }

LABEL_197:
        uint64_t v34 = *(unsigned __int16 *)(a1 + 30);
        uint64_t v35 = *(void *)(a1 + 232);
LABEL_198:
        LODWORD(result) = v30(v34, v35, v12, a2);
      }

  if (v242 || (v9 & 1) == 0)
  {
    uint64_t v142 = !v242;
    uint64_t v143 = v249;
    *unsigned int v249 = v142;
  }

  else
  {
    uint64_t v142 = 0;
    uint64_t v143 = v249;
  }

  v143[3] = v142;
  if ((v235 | v234) == 1 && (*((unsigned __int16 *)v143 + 3) == 0xFFFF || !*((_WORD *)v143 + 3)))
  {
    uint64_t v144 = sub_1005EE698(a1);
    uint64_t v143 = v249;
    if (v144) {
      *((_WORD *)v249 + 2) = 4800;
    }
  }

  uint64_t v145 = *((unsigned __int16 *)v143 + 3);
  uint64_t v146 = *((unsigned __int16 *)v143 + 2);
  if (*(_BYTE *)(a1 + 4384))
  {
    uint64_t v147 = (double)v145 * 100.0 / (double)v146;
    uint64_t v148 = (os_log_s *)qword_1008F75B8;
    if (os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v264 = 67110144;
      *(_DWORD *)&v264[4] = v145;
      *(_WORD *)&v264[8] = 1024;
      *(_DWORD *)&v264[10] = v146;
      *(_WORD *)&v264[14] = 2048;
      *(double *)&v264[16] = (double)v145 * 100.0 / (double)v146;
      *(_WORD *)&v264[24] = 2048;
      *(void *)&v264[26] = 0x4008DAB7EC1DD343LL;
      *(_WORD *)&v264[34] = 1024;
      *(_DWORD *)&v264[36] = v147 > 3.10679612;
      _os_log_impl( (void *)&_mh_execute_header,  v148,  OS_LOG_TYPE_DEFAULT,  "Checking if throttling down our scan during SDP is needed window:%d interval:%d dutyCycle:%f throttledDutyCycle: %f needToThrottle:%d",  v264,  0x28u);
    }

    if (v147 <= 3.10679612)
    {
      uint64_t v145 = *((unsigned __int16 *)v249 + 3);
      uint64_t v146 = *((unsigned __int16 *)v249 + 2);
    }

    else
    {
      uint64_t v149 = (os_log_s *)qword_1008F75B8;
      if (os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEFAULT))
      {
        *(_WORD *)uint64_t v264 = 0;
        _os_log_impl( (void *)&_mh_execute_header,  v149,  OS_LOG_TYPE_DEFAULT,  "Throttling down our scan during SDP",  v264,  2u);
      }

      *((_DWORD *)v249 + 1) = 3147273;
      if ((v233 & 1) != 0)
      {
        LODWORD(__p.__r_.__value_.__l.__data_) = 72745216;
        uint64_t v132 = 1;
      }

      uint64_t v145 = 48;
      uint64_t v146 = 1545;
    }
  }

  if (100 * v145 / v146 < 0x1E)
  {
    if (((v243 | v237) & 1) != 0)
    {
      uint64_t v151 = (os_log_s *)qword_1008F75B8;
      uint64_t v152 = os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEFAULT);
      int v150 = v249;
      if (v152)
      {
        uint64_t v153 = "No";
        if ((v243 & 1) != 0) {
          uint64_t v154 = "Yes";
        }
        else {
          uint64_t v154 = "No";
        }
        *(_DWORD *)uint64_t v264 = 136315650;
        *(void *)&v264[4] = v154;
        if ((v237 & 1) != 0) {
          uint64_t v153 = "Yes";
        }
        *(_WORD *)&v264[12] = 2080;
        *(void *)&v264[14] = v153;
        *(_WORD *)&v264[22] = 1024;
        *(_DWORD *)&v264[24] = 100 * v145 / v146;
        _os_log_impl( (void *)&_mh_execute_header,  v151,  OS_LOG_TYPE_DEFAULT,  "Do not prioritize scanning over BT %s WiFi %s for scan duty cycle %u.",  v264,  0x1Cu);
        int v150 = v249;
        uint64_t v145 = *((unsigned __int16 *)v249 + 3);
        uint64_t v146 = *((unsigned __int16 *)v249 + 2);
      }
    }

    else
    {
      int v150 = v249;
    }
  }

  else
  {
    v249[24] = v243 & 1;
    v249[25] = v237 & 1;
    int v150 = v249;
  }

  if (v146 != 48 && v146 && v145 && v145 == v146)
  {
    if (os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEBUG)) {
      sub_10069DE00(v146);
    }
    *((_DWORD *)v249 + 1) = 3145776;
    int v150 = v249;
  }

  if (*v150) {
    uint64_t v155 = v132;
  }
  else {
    uint64_t v155 = 0;
  }
  if (!v155)
  {
    __p.__r_.__value_.__s.__data_[0] = 0;
    *(_WORD *)&__p.__r_.__value_.__s.__data_[2] = 0;
  }

  sub_100601254(a1, v249, v235, v234, v241 & 1, v253 & v240, (uint64_t)&__p, 0);
  uint64_t v156 = sub_1002E6E9C();
  if ((*(unsigned int (**)(uint64_t, void, void))(*(void *)v156 + 2664LL))( v156,  *((unsigned __int16 *)v249 + 2),  *((unsigned __int16 *)v249 + 3)))
  {
    v249[25] = 1;
  }

  if (*(_BYTE *)(a1 + 2246)) {
    *unsigned int v249 = *(_BYTE *)(a1 + 2247);
  }
  uint64_t v157 = (os_log_s *)qword_1008F75B8;
  if (os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEFAULT))
  {
    uint64_t v158 = *((unsigned __int16 *)v249 + 3);
    uint64_t v159 = *((unsigned __int16 *)v249 + 2);
    __int128 v160 = *((unsigned __int16 *)v249 + 4);
    uint64_t v161 = *((unsigned __int16 *)v249 + 6);
    uint64_t v162 = *((unsigned __int16 *)v249 + 5);
    uint64_t v163 = v249[14];
    if (qword_1008D6198 != -1) {
      dispatch_once(&qword_1008D6198, &stru_1008A4058);
    }
    uint64_t v164 = *((unsigned __int8 *)off_1008D6190 + 204);
    uint64_t v165 = sub_100449204(off_1008D6190);
    uint64_t v166 = "unspported";
    uint64_t v167 = "supported";
    if (v234) {
      uint64_t v166 = "supported";
    }
    v168 = *(unsigned __int8 *)(a1 + 144);
    uint64_t v169 = "concurrent";
    uint64_t v170 = *v249;
    *(_DWORD *)uint64_t v264 = 134223106;
    if (!v163) {
      uint64_t v169 = "non-concurrent";
    }
    uint64_t v171 = v249[3];
    uint64_t v172 = *(void *)(a1 + 2344);
    uint64_t v173 = v249[24];
    if (!v235) {
      uint64_t v167 = "unsupported";
    }
    uint64_t v174 = v249[25];
    *(double *)&v264[4] = (double)v158 * 0.625;
    *(_WORD *)&v264[12] = 2048;
    uint64_t v85 = v170 == 0;
    *(double *)&v264[14] = (double)v159 * 0.625;
    uint64_t v175 = "passive";
    *(_WORD *)&v264[22] = 2048;
    if (v85) {
      uint64_t v175 = "active";
    }
    *(double *)&v264[24] = (double)v160 * 0.625;
    uint64_t v85 = v171 == 0;
    *(_WORD *)&v264[32] = 2048;
    int v176 = "Disabled";
    *(double *)&v264[34] = (double)v159 * 0.625;
    if (!v85) {
      int v176 = "Enabled";
    }
    *(void *)&v264[44] = v167;
    int v177 = "Y";
    *(_WORD *)&v264[42] = 2080;
    *(_WORD *)&v264[52] = 2048;
    if (!v172) {
      int v177 = "N";
    }
    *(double *)&v264[54] = (double)v161 * 0.625;
    *(_WORD *)&v264[62] = 2048;
    *(double *)&v264[64] = (double)v162 * 0.625;
    *(_WORD *)&v264[72] = 2080;
    *(void *)&v264[74] = v169;
    *(_WORD *)&v264[82] = 2080;
    *(void *)&v264[84] = v166;
    *(_WORD *)&v264[92] = 1024;
    *(_DWORD *)&v264[94] = v251;
    *(_WORD *)&v264[98] = 1024;
    *(_DWORD *)&v264[100] = v239;
    *(_WORD *)uint64_t v265 = 1024;
    *(_DWORD *)&v265[2] = v164;
    *(_WORD *)uint64_t v266 = 1024;
    *(_DWORD *)&v266[2] = v165;
    uint64_t v267 = 1024;
    uint64_t v268 = BYTE4(v237) & 1;
    uint64_t v269 = 1024;
    v270 = v168;
    unsigned __int16 v271 = 2082;
    uint64_t v272 = v175;
    unint64_t v273 = 2080;
    BOOL v274 = v176;
    uint64_t v275 = 1024;
    unint64_t v276 = v238;
    v277 = 2080;
    v278 = v177;
    int v279 = 1024;
    uint64_t v280 = v173;
    unsigned __int16 v281 = 1024;
    uint64_t v282 = v174;
    _os_log_impl( (void *)&_mh_execute_header,  v157,  OS_LOG_TYPE_DEFAULT,  "Returning scan parameters: Main:%.2fms/%.2fms LP:%.2fms/%.2fms(%s) SC:%.2fms/%.2fms/%s(%s) Dm:(m:%d/%d) Cond:%d:%d :%d Sc:%d (%{public}s) Dupfilter:%s minScanLevel:%d ENAssertion:%s Pri:%d/%d",  v264,  0xB0u);
  }

  if (*(_BYTE *)(a1 + 2222))
  {
    uint64_t v178 = *(unsigned __int16 *)(a1 + 2224);
    *((_WORD *)v249 + 2) = v178;
    uint64_t v179 = *(unsigned __int16 *)(a1 + 2226);
    *((_WORD *)v249 + 3) = v179;
    uint64_t v180 = *(unsigned __int16 *)(a1 + 2228);
    *((_WORD *)v249 + 4) = v180;
    uint64_t v181 = *(_BYTE *)(a1 + 2230) ? *(_WORD *)(a1 + 2232) : 0;
    uint64_t v182 = *(_BYTE *)(a1 + 2230) ? 0 : *(_WORD *)(a1 + 2232);
    *((_WORD *)v249 + 6) = v181;
    *((_WORD *)v249 + 5) = v182;
    uint64_t v183 = *(unsigned __int8 *)(a1 + 2234);
    v249[14] = v183;
    uint64_t v184 = *(_BYTE *)(a1 + 2235) && *(_BYTE *)(a1 + 2238) != 0;
    v249[18] = v184;
    v185 = *(_BYTE *)(a1 + 2236) ? *(unsigned __int16 *)(a1 + 2240) : 0;
    *((_WORD *)v249 + 10) = v185;
    uint64_t v186 = *(_BYTE *)(a1 + 2237) ? *(unsigned __int16 *)(a1 + 2242) : 0;
    *((_WORD *)v249 + 11) = v186;
    uint64_t v187 = (os_log_s *)qword_1008F75B8;
    if (os_log_type_enabled((os_log_t)qword_1008F75B8, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v264 = 67112450;
      uint64_t v188 = "Yes";
      *(_DWORD *)&v264[4] = v178;
      *(_WORD *)&v264[8] = 2048;
      if (v183) {
        uint64_t v189 = "Yes";
      }
      else {
        uint64_t v189 = "No";
      }
      *(double *)&v264[10] = (double)v178 * 0.625;
      *(_WORD *)&v264[18] = 1024;
      *(_DWORD *)&v264[20] = v179;
      if (!v184) {
        uint64_t v188 = "No";
      }
      *(_WORD *)&v264[24] = 1024;
      *(_DWORD *)&v264[26] = v180;
      *(_WORD *)&v264[30] = 1024;
      *(_DWORD *)&v264[32] = v181;
      *(_WORD *)&v264[36] = 1024;
      *(_DWORD *)&v264[38] = v182;
      *(_WORD *)&v264[42] = 2048;
      *(double *)&v264[44] = (double)v179 * 0.625;
      *(_WORD *)&v264[52] = 2048;
      *(double *)&v264[54] = (double)v180 * 0.625;
      *(_WORD *)&v264[62] = 2048;
      *(double *)&v264[64] = (double)v181 * 0.625;
      *(_WORD *)&v264[72] = 2048;
      *(double *)&v264[74] = (double)v182 * 0.625;
      *(_WORD *)&v264[82] = 2080;
      *(void *)&v264[84] = v189;
      *(_WORD *)&v264[92] = 2080;
      *(void *)&v264[94] = v188;
      *(_WORD *)&v264[102] = 1024;
      *(_DWORD *)uint64_t v265 = v185;
      *(_WORD *)&v265[4] = 1024;
      *(_DWORD *)uint64_t v266 = v186;
      _os_log_impl( (void *)&_mh_execute_header,  v187,  OS_LOG_TYPE_DEFAULT,  "Returning scan parameters (overridden with ScanCore) Interval %d(%.2fms) Window %d/%d/%d/%d(%.2fms/%.2fms/%.2fms /%.2fms) Concurrent %s Compensation %s percent %d query %d",  v264,  0x72u);
    }
  }

  uint64_t v190 = *((unsigned __int16 *)v249 + 3);
  uint64_t v191 = *((unsigned __int16 *)v249 + 2);
  uint64_t v192 = (void *)objc_claimAutoreleasedReturnValue(+[NSMutableDictionary dictionary](&OBJC_CLASS___NSMutableDictionary, "dictionary"));
  uint64_t v193 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", *v249));
  [v192 setObject:v193 forKeyedSubscript:@"scanParams.passive"];

  uint64_t v194 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v249[1]));
  [v192 setObject:v194 forKeyedSubscript:@"scanParams.limited"];

  uint64_t v195 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v249[3]));
  [v192 setObject:v195 forKeyedSubscript:@"scanParams.filterDups"];

  LOWORD(v196) = *((_WORD *)v249 + 2);
  uint64_t v197 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithDouble:](&OBJC_CLASS___NSNumber, "numberWithDouble:", (double)v196 * 0.625));
  [v192 setObject:v197 forKeyedSubscript:@"scanParams.interval"];

  LOWORD(v198) = *((_WORD *)v249 + 3);
  uint64_t v199 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithDouble:](&OBJC_CLASS___NSNumber, "numberWithDouble:", (double)v198 * 0.625));
  [v192 setObject:v199 forKeyedSubscript:@"scanParams.window"];

  LOWORD(v200) = *((_WORD *)v249 + 4);
  uint64_t v201 = (void *)[NSNumber numberWithDouble:v200 * 0.625];
  [v192 setObject:v201 forKeyedSubscript:@"scanParams.windowLPCore"];

  LOWORD(v202) = *((_WORD *)v249 + 5);
  uint64_t v203 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithDouble:](&OBJC_CLASS___NSNumber, "numberWithDouble:", (double)v202 * 0.625));
  [v192 setObject:v203 forKeyedSubscript:@"scanParams.windowScanCoreELNABypass"];

  LOWORD(v204) = *((_WORD *)v249 + 6);
  uint64_t v205 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithDouble:](&OBJC_CLASS___NSNumber, "numberWithDouble:", (double)v204 * 0.625));
  [v192 setObject:v205 forKeyedSubscript:@"scanParams.windowScanCoreELNAOn"];

  uint64_t v206 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v249[14]));
  [v192 setObject:v206 forKeyedSubscript:@"scanParams.concurrencyMode"];

  uint64_t v207 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithUnsignedChar:](&OBJC_CLASS___NSNumber, "numberWithUnsignedChar:", v249[15]));
  [v192 setObject:v207 forKeyedSubscript:@"scanParams.scanningPhys"];

  uint64_t v208 = (void *)[NSNumber numberWithBool:v249[16]];
  [v192 setObject:v208 forKeyedSubscript:@"scanParams.retainDuplicates"];

  uint64_t v209 = (void *)[NSNumber numberWithUnsignedChar:v249[17]];
  [v192 setObject:v209 forKeyedSubscript:@"scanParams.priorityConfig"];

  uint64_t v210 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v249[18]));
  [v192 setObject:v210 forKeyedSubscript:@"scanParams.isScanCoreCompensated"];

  uint64_t v211 = (void *)objc_claimAutoreleasedReturnValue( +[NSNumber numberWithUnsignedShort:]( &OBJC_CLASS___NSNumber,  "numberWithUnsignedShort:",  *((unsigned __int16 *)v249 + 10)));
  [v192 setObject:v211 forKeyedSubscript:@"scanParams.scanCoreCompensationPercent"];

  uint64_t v212 = (void *)objc_claimAutoreleasedReturnValue( +[NSNumber numberWithUnsignedShort:]( &OBJC_CLASS___NSNumber,  "numberWithUnsignedShort:",  *((unsigned __int16 *)v249 + 11)));
  [v192 setObject:v212 forKeyedSubscript:@"scanParams.scanCoreCoexQueryPeriod"];

  uint64_t v213 = (void *)[NSNumber numberWithBool:v249[24]];
  [v192 setObject:v213 forKeyedSubscript:@"scanParams.isPrioritizedOverBT"];

  uint64_t v214 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v249[25]));
  [v192 setObject:v214 forKeyedSubscript:@"scanParams.isPrioritizedOverWiFi"];

  uint64_t v215 = (void *)objc_claimAutoreleasedReturnValue( +[NSNumber numberWithBool:]( &OBJC_CLASS___NSNumber,  "numberWithBool:",  *(unsigned __int8 *)(a1 + 144)));
  [v192 setObject:v215 forKeyedSubscript:@"fScreenState"];

  uint64_t v216 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithInt:](&OBJC_CLASS___NSNumber, "numberWithInt:", v239));
  [v192 setObject:v216 forKeyedSubscript:@"daemonInterval"];

  unsigned __int16 v217 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithInt:](&OBJC_CLASS___NSNumber, "numberWithInt:", v251));
  [v192 setObject:v217 forKeyedSubscript:@"daemonWindow"];

  uint64_t v218 = (void *)[NSNumber numberWithInt:v238];
  [v192 setObject:v218 forKeyedSubscript:@"minScanLevel"];

  uint64_t v219 = (void *)objc_claimAutoreleasedReturnValue( +[NSNumber numberWithUnsignedInt:]( &OBJC_CLASS___NSNumber,  "numberWithUnsignedInt:",  100 * v190 / v191));
  [v192 setObject:v219 forKeyedSubscript:@"scanPercentage"];

  uint64_t v220 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", BYTE4(v237) & 1));
  [v192 setObject:v220 forKeyedSubscript:@"allowInPause"];

  uint64_t v221 = (void *)[NSNumber numberWithBool:v235];
  [v192 setObject:v221 forKeyedSubscript:@"scanLPCoreEnable"];

  uint64_t v222 = (void *)[NSNumber numberWithBool:v234];
  [v192 setObject:v222 forKeyedSubscript:@"isScanCoreEnabled"];

  uint64_t v223 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v253 & v240));
  [v192 setObject:v223 forKeyedSubscript:@"isRangeScan"];

  uint64_t v224 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v241 & 1));
  [v192 setObject:v224 forKeyedSubscript:@"isPriorityCritical"];

  uint64_t v225 = (void *)[NSNumber numberWithBool:v243 & 1];
  [v192 setObject:v225 forKeyedSubscript:@"isPrioritizedOverBT"];

  uint64_t v226 = (void *)objc_claimAutoreleasedReturnValue(+[NSNumber numberWithBool:](&OBJC_CLASS___NSNumber, "numberWithBool:", v237 & 1));
  [v192 setObject:v226 forKeyedSubscript:@"isPrioritizedOverWiFi"];

  uint64_t v227 = (void *)objc_claimAutoreleasedReturnValue( +[NSNumber numberWithUnsignedInt:]( &OBJC_CLASS___NSNumber,  "numberWithUnsignedInt:",  *(unsigned int *)(a1 + 1964)));
  [v192 setObject:v227 forKeyedSubscript:@"fObserverState"];

  [v246 setObject:v192 forKeyedSubscript:@"Controller"];
  v256[0] = _NSConcreteStackBlock;
  v256[1] = 3221225472LL;
  v256[2] = sub_100607AD0;
  v256[3] = &unk_1008A3D98;
  uint64_t v228 = v246;
  unsigned __int16 v257 = v228;
  sub_1005EBB90((os_unfair_lock_s *)(a1 + 1872), v256);

  return 1LL;
}

LABEL_242:
      uint64_t v159 = *(void *)(a1 + 232);
LABEL_243:
      __int128 v160 = 0uLL;
LABEL_244:
      *(_OWORD *)uint64_t v159 = v160;
      *(_OWORD *)(v159 + 16) = v160;
LABEL_253:
      if ((_DWORD)result == 1701) {
        return 0LL;
      }
      else {
        return result;
      }
    case 0x11:
      int v50 = *(_DWORD *)(a1 + 8);
      if (v50 == 2)
      {
        sub_1001EE134( (uint64_t)"ARCHIVED_OBJECTS server type does not support GET_STATUS command.\n",  v55,  v56,  v57,  v58,  v59,  v60,  v61,  v243);
        uint64_t v62 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v62, OS_LOG_TYPE_ERROR)) {
          return 1743LL;
        }
      }

      else
      {
        if (v50 != 1)
        {
          if (v50) {
            return 408LL;
          }
          uint64_t v51 = *(uint64_t (**)(void, uint64_t))(a1 + 160);
          if (!v51)
          {
            sub_1001EE2A0();
            uint64_t v51 = *(uint64_t (**)(void, uint64_t))(a1 + 160);
          }

          LODWORD(result) = v51(*(unsigned __int16 *)(a1 + 30), a2);
          goto LABEL_253;
        }

        sub_1001EE134( (uint64_t)"REFERENCED_OBJECTS server type does not support GET_STATUS command.\n",  v63,  v64,  v65,  v66,  v67,  v68,  v69,  v243);
        uint64_t v70 = (os_log_s *)sub_100086554(6u);
        if (!os_log_type_enabled(v70, OS_LOG_TYPE_ERROR)) {
          return 1743LL;
        }
      }

      goto LABEL_166;
    default:
      return result;
  }

  uint64_t v112 = sub_1002E6E00();
  sub_10002418C(buf, "LE");
  sub_10002418C(__p, "ConnRSSIStageOneMagnet");
  uint64_t v113 = (*(uint64_t (**)(uint64_t, _BYTE *, void **, int *))(*(void *)v112 + 88LL))(v112, buf, __p, &v163);
  if (v171 < 0) {
    operator delete(__p[0]);
  }
  if (v175 < 0)
  {
    operator delete(*(void **)buf);
    if (!v113) {
      goto LABEL_250;
    }
  }

  else if (!v113)
  {
    goto LABEL_250;
  }

  uint64_t v114 = v163;
  *(_BYTE *)(a1 + 1345) = v163;
  uint64_t v115 = (os_log_s *)qword_1008F7620;
  if (os_log_type_enabled((os_log_t)qword_1008F7620, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)buf = 67109120;
    *(_DWORD *)&buf[4] = v114;
    _os_log_impl( (void *)&_mh_execute_header,  v115,  OS_LOG_TYPE_DEFAULT,  "ConnRSSIStageOneMagnet %d overridden",  buf,  8u);
  }

uint64_t sub_100171DAC()
{
  return qword_1008E2B70;
}

uint64_t sub_100171DB8()
{
  word_1008E2B78 = *(_WORD *)(sub_1001EDBA0(0x2Fu) + 2);
  unsigned int v0 = (unsigned __int16)word_1008E2B78;
  if ((unsigned __int16)word_1008E2B78 >= 0x101u)
  {
    sub_1001EE2A0();
    unsigned int v0 = (unsigned __int16)word_1008E2B78;
  }

  qword_1008E2B70 = (uint64_t)sub_1000B1814(144LL * v0);
  if (!qword_1008E2B70) {
    return 106LL;
  }
  uint64_t result = 0LL;
  word_1008E2B7A = 1;
  return result;
}

uint64_t sub_100171E24(unsigned int a1, uint64_t a2)
{
  uint64_t v14 = 0LL;
  if (sub_100171EC4(a1, &v14))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid CID %d", v4, v5, v6, v7, v8, v9, v10, a1);
      int v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F08();
      }
    }

    return 403LL;
  }

  else
  {
    uint64_t v13 = v14;
    if (*(void *)(v14 + 136)) {
      sub_1001EE2A0();
    }
    uint64_t result = 0LL;
    *(void *)(v13 + 136) = a2;
  }

  return result;
}

uint64_t sub_100171EC4(unsigned int a1, uint64_t *a2)
{
  if (a1 > 0x3F)
  {
    unsigned __int16 v4 = a1;
    if (a1 <= 0xFF) {
      unsigned __int16 v4 = a1 - 64;
    }
    if ((unsigned __int16)word_1008E2B78 > v4)
    {
      unsigned int v5 = v4;
      uint64_t i = qword_1008E2B70 + 144LL * v4;
      if (*(_DWORD *)i)
      {
        if (*(unsigned __int16 *)(qword_1008E2B70 + 144LL * v5 + 4) == a1)
        {
LABEL_13:
          uint64_t result = 0LL;
          *a2 = i;
          return result;
        }
      }
    }
  }

  else
  {
    uint64_t v2 = (unsigned __int16)word_1008E2B78;
    if (word_1008E2B78)
    {
      for (uint64_t i = qword_1008E2B70; !*(_DWORD *)i || *(unsigned __int16 *)(i + 4) != a1; i += 144LL)
      {
        if (!--v2) {
          return 404LL;
        }
      }

      goto LABEL_13;
    }
  }

  return 404LL;
}

BOOL sub_100171F68(unsigned int *a1)
{
  return *(_WORD *)(sub_10017AB4C(a1) + 38) && *(__int16 *)(sub_10017AB4C(a1) + 38) != -1;
}

void sub_100171FAC()
{
  if (HIDWORD(xmmword_1008F6FB8))
  {
    sub_1001EE0E4("L2CAP data dump:\n");
    uint64_t v0 = qword_1008E2B70;
    if (word_1008E2B78) {
      BOOL v1 = qword_1008E2B70 == 0;
    }
    else {
      BOOL v1 = 1;
    }
    if (v1)
    {
      unsigned __int16 v3 = 0;
    }

    else
    {
      uint64_t v2 = 0LL;
      unsigned __int16 v3 = 0;
      unint64_t v4 = 1LL;
      do
      {
        unsigned int v5 = (unsigned int *)(v0 + v2);
        int v6 = *(_DWORD *)(v0 + v2);
        switch(v6)
        {
          case 1:
            sub_1001EE0E4("CL ");
            sub_1001EE0E4("cid=0x%x ", *(unsigned __int16 *)(v0 + v2 + 4));
            sub_1001EE0E4("psm=0x%x ");
            goto LABEL_16;
          case 2:
          case 4:
            BOOL v1 = v6 == 2;
            uint64_t v7 = "MAG";
            if (v1) {
              uint64_t v7 = "CO ";
            }
            sub_1001EE0E4("%s", v7);
            uint64_t v8 = v0 + v2;
            sub_1001EE0E4("localCID=0x%x ", *(unsigned __int16 *)(v8 + 4));
            uint64_t v9 = sub_10017AB4C(v5);
            sub_1001EE0E4("remoteCID=0x%x ", *(unsigned __int16 *)(v9 + 8));
            sub_1001EE0E4("psm=0x%x ", *(unsigned __int16 *)(v8 + 6));
            uint64_t v10 = sub_10017AB4C(v5);
            sub_1001EE0E4("addr=%: ", v10 + 10);
            uint64_t v11 = sub_10017AB4C(v5);
            sub_1001EE0E4("inMTU=%d ", *(unsigned __int16 *)(v11 + 36));
            uint64_t v12 = sub_10017AB4C(v5);
            sub_1001EE0E4("outMTU=%d ", *(unsigned __int16 *)(v12 + 32));
            uint64_t v13 = sub_10017AB4C(v5);
            sub_1001EE0E4("outFlushTO=%d ", *(unsigned __int16 *)(v13 + 38));
            uint64_t v14 = sub_10017AB4C(v5);
            sub_1001EE0E4("linkTO=%d ", *(unsigned __int16 *)(v14 + 40));
            sub_1001EE0E4("\n");
            sub_100186924(v5);
            goto LABEL_16;
          case 3:
            sub_1001EE0E4("FX ");
            sub_1001EE0E4("cid=0x%x ", *(unsigned __int16 *)(v0 + v2 + 4));
            uint64_t v15 = (unsigned __int16 *)sub_10017AF44((unsigned int *)(v0 + v2));
            sub_1001EE0E4("mtu=%d ", *v15);
            uint64_t v16 = sub_10017AF44((unsigned int *)(v0 + v2));
            sub_1001EE0E4("flushTO=%d ", *(unsigned __int16 *)(v16 + 2));
            unint64_t v17 = *(char *)(sub_10017AF44((unsigned int *)(v0 + v2)) + 5);
            if (v17 <= 4) {
              sub_1001EE0E4(off_100885CC8[v17], v22);
            }
LABEL_16:
            ++v3;
            sub_1001EE0E4("\n");
            break;
          default:
            break;
        }

        uint64_t v0 = qword_1008E2B70;
        v2 += 144LL;
      }

      while (v4++ < (unsigned __int16)word_1008E2B78 && qword_1008E2B70 != 0);
    }

    uint64_t v20 = sub_1001EE0E4("%d channels in use\n", v3);
    nullsub_63(v20, v21);
  }

uint64_t sub_100172290(int a1, uint64_t a2, void *a3)
{
  if (!sub_10012D5EC(a2))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid HCI handle provided - cannot retrieve channel",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v18);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 406LL;
  }

  if (!word_1008E2B78) {
    return 406LL;
  }
  uint64_t v6 = 0LL;
  unint64_t v7 = 0LL;
  while (1)
  {
    uint64_t v8 = qword_1008E2B70;
    if (*(_DWORD *)(qword_1008E2B70 + v6) == 2
      && *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v6)) + 8) == a1
      && *(void *)sub_10017AB4C((unsigned int *)(v8 + v6)) == a2)
    {
      break;
    }

    ++v7;
    v6 += 144LL;
  }

  uint64_t result = 0LL;
  *a3 = v8 + v6;
  return result;
}

uint64_t sub_1001723A0(unsigned int a1, void *a2)
{
  uint64_t v6 = 0LL;
  uint64_t v3 = sub_100171EC4(a1, (uint64_t *)&v6);
  if (!(_DWORD)v3)
  {
    unint64_t v4 = v6;
    if (sub_10017AB4C(v6)) {
      *a2 = *(void *)sub_10017AB4C(v4);
    }
  }

  return v3;
}

uint64_t sub_100172404(uint64_t a1, int a2, void *a3)
{
  if (!sub_10012D514(a1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid HCI handle provided - cannot retrieve channel",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v22);
      uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 406LL;
  }

  if (!word_1008E2B78) {
    return 406LL;
  }
  uint64_t v6 = 0LL;
  unint64_t v7 = 0LL;
  while (1)
  {
    uint64_t v8 = qword_1008E2B70;
    int v9 = *(_DWORD *)(qword_1008E2B70 + v6);
    BOOL v10 = v9 == 4 || v9 == 2;
    if (v10 && *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v6)) + 28) == a2)
    {
      uint64_t v11 = sub_10017AB4C((unsigned int *)(v8 + v6));
      if (*(_DWORD *)(a1 + 48) == *(_DWORD *)(v11 + 10)
        && *(unsigned __int16 *)(a1 + 52) == *(unsigned __int16 *)(v11 + 14))
      {
        break;
      }
    }

    ++v7;
    v6 += 144LL;
  }

  uint64_t result = 0LL;
  *a3 = v8 + v6;
  return result;
}

uint64_t sub_100172524(uint64_t a1, int a2, void *a3)
{
  if (!sub_10012D5EC(a1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid HCI handle provided - cannot retrieve channel",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v22);
      uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 406LL;
  }

  if (!word_1008E2B78) {
    return 406LL;
  }
  uint64_t v6 = 0LL;
  unint64_t v7 = 0LL;
  while (1)
  {
    uint64_t v8 = qword_1008E2B70;
    int v9 = *(_DWORD *)(qword_1008E2B70 + v6);
    BOOL v10 = v9 == 4 || v9 == 2;
    if (v10 && *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v6)) + 28) == a2)
    {
      uint64_t v11 = sub_10017AB4C((unsigned int *)(v8 + v6));
      if (*(_DWORD *)(a1 + 49) == *(_DWORD *)(v11 + 10)
        && *(unsigned __int16 *)(a1 + 53) == *(unsigned __int16 *)(v11 + 14))
      {
        break;
      }
    }

    ++v7;
    v6 += 144LL;
  }

  uint64_t result = 0LL;
  *a3 = v8 + v6;
  return result;
}

uint64_t sub_100172644(uint64_t a1, int a2)
{
  if (a1 && word_1008E2B78)
  {
    unint64_t v4 = (unsigned __int16)word_1008E2B78 + 1LL;
    uint64_t v5 = 144LL * (unsigned __int16)word_1008E2B78 - 144;
    unsigned int v6 = 48;
    while (1)
    {
      unint64_t v7 = (unsigned int *)(qword_1008E2B70 + v5);
      int v8 = *(_DWORD *)(qword_1008E2B70 + v5);
      switch(v8)
      {
        case 4:
          goto LABEL_9;
        case 3:
          break;
        case 2:
LABEL_9:
          if (*(unsigned __int8 *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v5)) + 16) >= 3u
            && !*(_BYTE *)(sub_10017AB4C(v7) + 17)
            && *(void *)sub_10017AB4C(v7) == a1)
          {
            uint64_t v9 = sub_10017AB4C(v7);
            if (a2)
            {
            }

            else if (v6 < *(unsigned __int16 *)(v9 + 32))
            {
              unsigned int v6 = *(unsigned __int16 *)(sub_10017AB4C(v7) + 32);
            }
          }

          break;
      }

      --v4;
      v5 -= 144LL;
      if (v4 <= 1) {
        return (unsigned __int16)v6;
      }
    }
  }

  LOWORD(v6) = 48;
  return (unsigned __int16)v6;
}

uint64_t sub_100172780(uint64_t a1, void *a2)
{
  if (!word_1008E2B78) {
    return 406LL;
  }
  uint64_t v4 = 0LL;
  unint64_t v5 = 0LL;
  while (1)
  {
    int v6 = *(_DWORD *)(qword_1008E2B70 + v4);
    if (v6 == 4 || v6 == 2)
    {
      uint64_t v8 = sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v4));
      BOOL v9 = *(_DWORD *)a1 == *(_DWORD *)(v8 + 10) && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(v8 + 14);
      if (v9
        && !*(_BYTE *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v4)) + 16)
        && *(_BYTE *)(sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v4)) + 25) == 1)
      {
        break;
      }
    }

    ++v5;
    v4 += 144LL;
  }

  uint64_t result = 0LL;
  *a2 = qword_1008E2B70 + v4;
  return result;
}

uint64_t sub_100172858()
{
  uint64_t v0 = (unsigned __int16)word_1008E2B78;
  if (!word_1008E2B78) {
    return 0LL;
  }
  uint64_t result = 0LL;
  uint64_t v2 = qword_1008E2B70;
  uint64_t v3 = (int *)qword_1008E2B70;
  do
  {
    int v4 = *v3;
    v3 += 36;
    if (v4 == 4) {
      uint64_t result = (*(_DWORD *)(v2 + 84) + result);
    }
    uint64_t v2 = (uint64_t)v3;
    --v0;
  }

  while (v0);
  return result;
}

uint64_t sub_1001728A0()
{
  uint64_t v0 = (unsigned __int16)word_1008E2B78;
  if (!word_1008E2B78) {
    return 0LL;
  }
  uint64_t result = 0LL;
  uint64_t v2 = qword_1008E2B70;
  uint64_t v3 = (int *)qword_1008E2B70;
  do
  {
    int v4 = *v3;
    v3 += 36;
    if (v4 == 4) {
      uint64_t result = (*(_DWORD *)(v2 + 80) + result);
    }
    uint64_t v2 = (uint64_t)v3;
    --v0;
  }

  while (v0);
  return result;
}

_DWORD *sub_1001728E8(int a1)
{
  if (!a1) {
    return 0LL;
  }
  uint64_t v1 = (unsigned __int16)word_1008E2B78;
  if (!word_1008E2B78) {
    return 0LL;
  }
  for (uint64_t i = (_DWORD *)qword_1008E2B70; !qword_1008E2B70 || !*i || i[18] != a1; i += 36)
  {
    if (!--v1) {
      return 0LL;
    }
  }

  return i;
}

uint64_t sub_100172934(void *a1)
{
  *a1 = 0LL;
  *(_BYTE *)a1 = 6;
  uint64_t v1 = (unsigned __int16)word_1008E2B78;
  if (word_1008E2B78)
  {
    uint64_t v2 = (unsigned __int16 *)(qword_1008E2B70 + 4);
    do
    {
      if (*((_DWORD *)v2 - 1) == 3)
      {
        unint64_t v3 = *v2;
      }

      v2 += 72;
      --v1;
    }

    while (v1);
  }

  return 0LL;
}

uint64_t sub_1001729A0(uint64_t a1)
{
  uint64_t v7 = 0LL;
  uint64_t result = sub_100171EC4(a1, &v7);
  if (!(_DWORD)result)
  {
    uint64_t v3 = v7;
    unint64_t v5 = *(uint64_t (**)(uint64_t, uint64_t))(v7 + 8);
    uint64_t v4 = *(void *)(v7 + 16);
    int v6 = *(unsigned __int16 *)(v7 + 24);
    *(void *)(v7 + 8) = 0LL;
    *(void *)(v3 + 16) = 0LL;
    *(_WORD *)(v3 + 24) = 0;
    *(_DWORD *)(v3 + 80) += v6;
    if (v5) {
      return v5(a1, v4);
    }
  }

  return result;
}

void sub_100172A10(unsigned int a1)
{
  uint64_t v11 = 0LL;
  if (sub_100171EC4(a1, &v11))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid CID %d", v2, v3, v4, v5, v6, v7, v8, a1);
      BOOL v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657F08();
      }
    }
  }

  else
  {
    uint64_t v10 = v11;
    *(void *)(v11 + 8) = 0LL;
    *(void *)(v10 + 16) = 0LL;
    *(_WORD *)(v10 + 24) = 0;
  }

uint64_t sub_100172A98(uint64_t a1, uint64_t a2, __int128 *a3, uint64_t a4, char a5)
{
  __int16 v46 = a2;
  uint64_t v45 = 0LL;
  uint64_t v10 = sub_100171EC4(a2, &v45);
  if ((_DWORD)v10)
  {
    uint64_t v11 = v10;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ChanMan_GetChannel failed: %!", v12, v13, v14, v15, v16, v17, v18, v11);
      uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return v11;
  }

  uint64_t v20 = v45;
  if (!v45) {
    sub_1001EE2A0();
  }
  unsigned int v21 = *(_DWORD *)v20;
  if ((*(_DWORD *)v20 - 1) >= 4)
  {
    sub_1001EE2A0();
    unsigned int v21 = *(_DWORD *)v20;
  }

  BOOL v22 = v21 == 4 || v21 == 2;
  if (!v22
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v20) + 16) == 4
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v20) + 16) == 3
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v20) + 16) == 5)
  {
    if (*(void *)(v20 + 8))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Write in progress", v23, v24, v25, v26, v27, v28, v29, v43);
        uint64_t v30 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 410LL;
    }

    switch(*(_DWORD *)v20)
    {
      case 1:
        uint64_t v31 = sub_10017A0F8(v20, a3, a4);
        goto LABEL_34;
      case 2:
      case 4:
        if (sub_10018581C(a2))
        {
          uint64_t v31 = sub_10017627C(v20, a4);
        }

        else if (sub_100185870(a2))
        {
          uint64_t v31 = sub_100175EB4(v20, a4);
        }

        else
        {
          uint64_t v31 = sub_100176678(v20, a4);
        }

        goto LABEL_34;
      case 3:
        *(void *)(a4 + 8) = 0LL;
        uint64_t v31 = sub_100179B50(a3, a2, a4);
LABEL_34:
        uint64_t v11 = v31;
        if ((a5 & 1) == 0 && (_DWORD)v31 == 412)
        {
          v44[0] = 0LL;
          if (a1)
          {
            *(void *)(v20 + 8) = a1;
            *(void *)(v20 + 16) = a4;
            *(_WORD *)(v20 + 24) = *(_WORD *)(a4 + 4);
          }

          v44[1] = &v46;
          LOWORD(v44[0]) = 2;
          sub_1001EE6E8((uint64_t)sub_100172D8C, v44, 0, 0LL);
          return 0LL;
        }

        if ((_DWORD)v31)
        {
          *(void *)(v20 + 8) = 0LL;
          *(void *)(v20 + 16) = 0LL;
          *(_WORD *)(v20 + 24) = 0;
        }

        else
        {
          if (!a1) {
            return 0LL;
          }
          uint64_t v11 = 0LL;
          *(void *)(v20 + 8) = a1;
          *(void *)(v20 + 16) = a4;
          *(_WORD *)(v20 + 24) = *(_WORD *)(a4 + 4);
        }

        break;
      default:
        sub_1000AFE20(105LL);
        return sub_100172D8C(v42);
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      uint64_t v32 = sub_10017AB4C((unsigned int *)v20);
      sub_1001EE134( (uint64_t)"OI_L2CAP_WriteMBUF, channel is not OPEN (%d)",  v33,  v34,  v35,  v36,  v37,  v38,  v39,  *(unsigned __int8 *)(v32 + 16));
      uint64_t v40 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 404LL;
  }

  return v11;
}

uint64_t sub_100172D8C(uint64_t result)
{
  if (result) {
    return sub_1001729A0(**(unsigned __int16 **)(result + 8));
  }
  return result;
}

uint64_t sub_100172DA0(uint64_t a1, uint64_t a2, __int128 *a3, char *a4, size_t a5)
{
  if (a1 && a4 && (_DWORD)a5)
  {
    uint64_t v21 = 0LL;
    memset(v20, 0, sizeof(v20));
    uint64_t result = sub_100171EC4(a2, &v21);
    if (!(_DWORD)result)
    {
      if (a3 && (a3 = (__int128 *)sub_10012D890((uint64_t)a3)) == 0LL)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Invalid address.", v12, v13, v14, v15, v16, v17, v18, *(uint64_t *)&v20[0]);
          uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        return 122LL;
      }

      else
      {
        sub_1001EF520((uint64_t)v20, 1u);
        sub_1001EFB10((unsigned __int8 *)v20, a4, a5, 2u);
        uint64_t v11 = v21;
        *((void *)&v20[0] + 1) = v21;
        uint64_t result = sub_100172A98(0LL, a2, a3, (uint64_t)v20, 0);
        if (!(_DWORD)result)
        {
          *(void *)(v11 + 8) = a1;
          *(void *)(v11 + 16) = a4;
          *(_WORD *)(v11 + 24) = a5;
        }
      }
    }
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

  return result;
}

uint64_t sub_100172ECC(unsigned int a1, uint64_t *a2, char a3)
{
  if (a1 > 4 || ((1 << a1) & 0x16) == 0) {
    sub_1001EE2A0();
  }
  if (word_1008E2B78)
  {
    uint64_t v6 = 0LL;
    uint64_t v7 = qword_1008E2B70;
    while (*(_DWORD *)v7)
    {
      ++v6;
      v7 += 144LL;
    }

    if (*(void *)(v7 + 112)) {
      sub_1001EE2A0();
    }
    if (*(void *)(v7 + 104)) {
      sub_1001EE2A0();
    }
    if (*(void *)(v7 + 120)) {
      sub_1001EE2A0();
    }
    *(_OWORD *)(v7 + 112) = 0u;
    *(_OWORD *)(v7 + 128) = 0u;
    *(_OWORD *)(v7 + 80) = 0u;
    *(_OWORD *)(v7 + 96) = 0u;
    *(_OWORD *)(v7 + 48) = 0u;
    *(_OWORD *)(v7 + 64) = 0u;
    *(_OWORD *)(v7 + 16) = 0u;
    *(_OWORD *)(v7 + 32) = 0u;
    *(_OWORD *)uint64_t v7 = 0u;
    if ((a3 & 1) != 0)
    {
      *(_WORD *)(v7 + 4) = v6 + 64;
    }

    else
    {
      if (!word_1008E2B7A) {
        sub_1001EE2A0();
      }
      if ((unsigned __int16)word_1008E2B78 <= (unsigned __int16)v6) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/chanman.c",  541,  "index < maxChannels");
      }
      int v17 = (unsigned __int16)word_1008E2B7A;
      *(_WORD *)(v7 + 4) = v6 | (word_1008E2B7A << 8);
      if (v17 == 255) {
        __int16 v18 = 1;
      }
      else {
        __int16 v18 = v17 + 1;
      }
      word_1008E2B7A = v18;
      if (!v18) {
        sub_1001EE2A0();
      }
    }

    *(_DWORD *)uint64_t v7 = a1;
    switch(a1)
    {
      case 1u:
        uint64_t v20 = sub_1000B17F4(0x18uLL);
        *(void *)(v7 + 104) = v20;
        v20[1] = 0LL;
        v20[2] = 0LL;
        *uint64_t v20 = 0LL;
        break;
      case 2u:
        uint64_t v21 = sub_1000B17F4(0x78uLL);
        *(void *)(v7 + 112) = v21;
        *uint64_t v21 = 0u;
        v21[1] = 0u;
        v21[2] = 0u;
        v21[3] = 0u;
        v21[4] = 0u;
        v21[5] = 0u;
        v21[6] = 0u;
        *((void *)v21 + 14) = 0LL;
        *(_BYTE *)(sub_10017AB4C((unsigned int *)v7) + 16) = 0;
        *(_WORD *)(sub_10017AB4C((unsigned int *)v7) + 36) = 1024;
        *(_WORD *)(sub_10017AB4C((unsigned int *)v7) + 32) = 672;
        *(_WORD *)(sub_10017AB4C((unsigned int *)v7) + 34) = -1;
        *(_WORD *)(sub_10017AB4C((unsigned int *)v7) + 38) = -1;
        *(_WORD *)(sub_10017AB4C((unsigned int *)v7) + 40) = 5000;
        *(_DWORD *)(v7 + 72) = 0;
        *(_BYTE *)(sub_10017AB4C((unsigned int *)v7) + 30) = 0;
        *(_BYTE *)(sub_10017AB4C((unsigned int *)v7) + 17) = 0;
        *(_BYTE *)(sub_10017AB4C((unsigned int *)v7) + 77) = 0;
        break;
      case 4u:
        uint64_t v19 = sub_1000B17F4(0x78uLL);
        *(void *)(v7 + 112) = v19;
        *uint64_t v19 = 0u;
        v19[1] = 0u;
        v19[2] = 0u;
        v19[3] = 0u;
        v19[4] = 0u;
        v19[5] = 0u;
        v19[6] = 0u;
        *((void *)v19 + 14) = 0LL;
        break;
    }

    uint64_t result = 0LL;
    *(void *)(v7 + 128) = 0LL;
    *(_DWORD *)(v7 + 76) = -1;
    *a2 = v7;
  }

  else
  {
LABEL_8:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"No free channels found\n", v8, v9, v10, v11, v12, v13, v14, v22);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 104LL;
  }

  return result;
}

uint64_t sub_100173164(uint64_t a1, _DWORD *a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  if (word_1008E2B78)
  {
    uint64_t v4 = 0LL;
    unint64_t v5 = 0LL;
    int v6 = 0;
    unsigned __int8 v7 = 0;
    do
    {
      uint64_t v8 = qword_1008E2B70 + v4;
      if (*(_DWORD *)(qword_1008E2B70 + v4))
      {
        uint64_t v9 = *(void *)(v8 + 96);
        if (v9)
        {
          if (*(unsigned __int8 *)(v9 + 27) >= 0xBu)
          {
            uint64_t v10 = (void *)sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v4));
            if (a1 && *v10)
            {
            }

            else if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"L2CAP reserved priority channel does not contain valid ACL",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v20);
              __int16 v18 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
                sub_100657EA4(v21, &v22, v18);
              }
            }
          }
        }
      }

      ++v5;
      v4 += 144LL;
    }

    while (v5 < (unsigned __int16)word_1008E2B78);
  }

  else
  {
    unsigned __int8 v7 = 0;
    int v6 = 0;
  }

  *a2 = v6;
  return v7;
}

uint64_t sub_1001732EC(unsigned int a1, int a2, char a3, unsigned int a4, void *a5, uint64_t a6)
{
  if (a2)
  {
    if (word_1008E2B78)
    {
      char v10 = a2;
      uint64_t v12 = (unsigned __int16 *)(qword_1008E2B70 + 4);
      uint64_t v13 = (unsigned __int16)word_1008E2B78;
      do
      {
        if (*((_DWORD *)v12 - 1) && *v12 == a1)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"CID %d already regitered", v17, v18, v19, v20, v21, v22, v23, a1);
            uint64_t v24 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          return 402LL;
        }

        v12 += 72;
        --v13;
      }

      while (v13);
      uint64_t v14 = 0LL;
      uint64_t v15 = qword_1008E2B70;
      while (*(_DWORD *)(qword_1008E2B70 + v14))
      {
        v14 += 144LL;
      }

      uint64_t v25 = qword_1008E2B70 + v14;
      if (*(void *)(qword_1008E2B70 + v14 + 112)) {
        sub_1001EE2A0();
      }
      if (*(void *)(v25 + 104)) {
        sub_1001EE2A0();
      }
      uint64_t v26 = v15 + v14;
      if (*(void *)(v26 + 120)) {
        sub_1001EE2A0();
      }
      *(_OWORD *)(v25 + 112) = 0u;
      *(_OWORD *)(v25 + 128) = 0u;
      *(_OWORD *)(v25 + 80) = 0u;
      *(_OWORD *)(v25 + 96) = 0u;
      *(_OWORD *)(v25 + 48) = 0u;
      *(_OWORD *)(v25 + 64) = 0u;
      *(_OWORD *)(v25 + 16) = 0u;
      *(_OWORD *)(v25 + 32) = 0u;
      *(_OWORD *)uint64_t v25 = 0u;
      uint64_t v27 = sub_1000B17F4(0x20uLL);
      *(void *)(v26 + 120) = v27;
      _OWORD *v27 = 0u;
      v27[1] = 0u;
      *(void *)(v26 + 128) = 0LL;
      *(_WORD *)(v26 + 4) = a1;
      *(_DWORD *)uint64_t v26 = 3;
      *(_DWORD *)(v26 + 76) = -1;
      *(void *)(sub_10017AF44((unsigned int *)v25) + 24) = a6;
      *(_WORD *)sub_10017AF44((unsigned int *)v25) = 672;
      *(_WORD *)(sub_10017AF44((unsigned int *)v25) + 2) = -1;
      *(_BYTE *)(sub_10017AF44((unsigned int *)v25) + 4) = v10;
      *a5 = v25;
      sub_100187CD4(*(unsigned __int16 *)(v26 + 4), a3, a4, 0LL, (uint64_t *)(v26 + 96), *(_DWORD *)(v26 + 76));
      return 0LL;
    }

    else
    {
      return 104LL;
    }
  }

  else
  {
    sub_1001EE2A0();
    return 718LL;
  }

uint64_t sub_1001734D8(uint64_t a1)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  if (*(_DWORD *)a1 == 4 || *(_DWORD *)a1 == 2)
  {
    sub_100186624((unsigned int *)a1);
    if (!*(void *)(a1 + 112)) {
      sub_1001EE2A0();
    }
    sub_1001967B8((unsigned int *)a1);
  }

  sub_1001883E0((void *)*(unsigned __int16 *)(a1 + 4));
  uint64_t v3 = *(void **)(a1 + 48);
  if (v3) {
    sub_1000B1838(v3);
  }
  *(void *)(a1 + 48) = 0LL;
  unsigned int v4 = *(_DWORD *)a1;
  *(_DWORD *)a1 = 0;
  if (v4 == 1)
  {
    uint64_t v11 = *(void **)(a1 + 104);
    uint64_t v7 = a1 + 104;
    char v10 = v11;
    if (!v11)
    {
      sub_1001EE2A0();
      char v10 = *(void **)v7;
    }

    if (*v10)
    {
      sub_1001EE2A0();
      char v10 = *(void **)v7;
    }

    sub_1000B1838(v10);
    uint64_t v5 = 0LL;
    goto LABEL_31;
  }

  if (v4 == 4 || (uint64_t v5 = 0LL, v4 == 2))
  {
    sub_1001EEB14(*(unsigned int *)(*(void *)(a1 + 112) + 80LL));
    sub_1001EEB14(*(unsigned int *)(*(void *)(a1 + 112) + 84LL));
    if (sub_10012D514(**(void **)(a1 + 112))) {
      uint64_t v5 = sub_10018A690(**(void **)(a1 + 112));
    }
    else {
      uint64_t v5 = 0LL;
    }
  }

  switch(v4)
  {
    case 2u:
      goto LABEL_22;
    case 3u:
      uint64_t v12 = *(void **)(a1 + 120);
      uint64_t v7 = a1 + 120;
      int v6 = v12;
LABEL_30:
      sub_1000B1838(v6);
LABEL_31:
      *(void *)uint64_t v7 = 0LL;
      return v5;
    case 4u:
LABEL_22:
      uint64_t v8 = *(void **)(a1 + 112);
      uint64_t v7 = a1 + 112;
      int v6 = v8;
      uint64_t v9 = (void *)v8[14];
      if (v9)
      {
        sub_1000B1838(v9);
        int v6 = *(void **)v7;
        *(void *)(*(void *)v7 + 112LL) = 0LL;
      }

      goto LABEL_30;
  }

  return v5;
}

void *sub_100173630(uint64_t a1, unsigned int a2)
{
  if (a2) {
    uint64_t v3 = a2;
  }
  else {
    uint64_t v3 = 430LL;
  }
  if (word_1008E2B78)
  {
    uint64_t v4 = 0LL;
    unint64_t v5 = 0LL;
    do
    {
      uint64_t v6 = qword_1008E2B70;
      uint64_t v7 = (int *)(qword_1008E2B70 + v4);
      int v8 = *(_DWORD *)(qword_1008E2B70 + v4);
      if (v8 == 4 || v8 == 2)
      {
        if (*(void *)sub_10017AB4C((unsigned int *)(qword_1008E2B70 + v4)) == a1)
        {
          sub_10018A8D8(*(unsigned __int16 *)(v6 + v4 + 4));
          if (*(_BYTE *)(sub_10017AB4C((unsigned int *)(v6 + v4)) + 16) != 1
            || *(_BYTE *)(sub_10017AB4C((unsigned int *)(v6 + v4)) + 30)
            || sub_10012D5EC(a1))
          {
            goto LABEL_18;
          }

          uint64_t v10 = sub_10017AB4C((unsigned int *)(v6 + v4));
          ++*(_BYTE *)(v10 + 30);
          uint64_t v11 = sub_10017AB4C((unsigned int *)(v6 + v4));
          sub_1001EEB14(*(unsigned int *)(v11 + 80));
          uint64_t v12 = sub_10017AB4C((unsigned int *)(v6 + v4));
          sub_1001EEB14(*(unsigned int *)(v12 + 84));
          uint64_t v13 = *(unsigned int *)(v6 + v4 + 72);
          if ((_DWORD)v13)
          {
            sub_1001F08BC(v13);
            *(_DWORD *)(v6 + v4 + 72) = 0;
          }

          *(_BYTE *)(sub_10017AB4C((unsigned int *)(v6 + v4)) + 16) = 0;
          *(_BYTE *)(sub_10017AB4C((unsigned int *)(v6 + v4)) + 25) = 1;
          *(void *)sub_10017AB4C((unsigned int *)(v6 + v4)) = 0LL;
          uint64_t v14 = sub_10017AB4C((unsigned int *)(v6 + v4));
          if (sub_10010C710((uint64_t)sub_100174378, v14 + 10)) {
LABEL_18:
          }
            sub_100173C90(v6 + v4, v3);
          else {
            sub_10010CAA4(a1, 0x13u);
          }
        }

        int v8 = *v7;
      }

      if (v8 == 3)
      {
        sub_100186CB8(v6 + v4, a1);
        int v8 = *v7;
      }

      if (v8 == 1)
      {
        int v17 = *(_DWORD *)(a1 + 48);
        __int16 v18 = *(_WORD *)(a1 + 52);
        if (sub_10017A01C(*(unsigned __int16 *)(v6 + v4 + 4), (uint64_t)&v17) != 434)
        {
          uint64_t v15 = sub_10017AEA0((unsigned int *)(v6 + v4));
          (*(void (**)(int *))(v15 + 16))(&v17);
        }
      }

      ++v5;
      v4 += 144LL;
    }

    while (v5 < (unsigned __int16)word_1008E2B78);
  }

  sub_100186F64(a1);
  return sub_100186F74(a1);
}

uint64_t sub_100173838( __int16 a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, _WORD *a7, uint64_t a8)
{
  uint64_t v45 = 0LL;
  uint64_t v16 = sub_100172ECC(2u, (uint64_t *)&v45, 0);
  if (!(_DWORD)v16)
  {
    uint64_t v44 = a8;
    uint64_t v17 = sub_10012D890(a3);
    if (!v17)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"OI_L2CAP_createChannelForFastConnect NULL Handle",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  a8);
        uint64_t v25 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    uint64_t v26 = v45;
    uint64_t v27 = sub_10017AB4C(v45);
    __int16 v28 = *(_WORD *)(a3 + 4);
    *(_DWORD *)(v27 + 10) = *(_DWORD *)a3;
    *(_WORD *)(v27 + 14) = v28;
    *(void *)sub_10017AB4C(v26) = v17;
    *(_BYTE *)(sub_10017AB4C(v26) + 25) = 0;
    *(_BYTE *)(sub_10017AB4C(v26) + 28) = 0;
    __int16 v29 = *(_WORD *)a2;
    *(_WORD *)(sub_10017AB4C(v26) + 36) = v29;
    *((_WORD *)v26 + 3) = a1;
    *(_BYTE *)(sub_10017AB4C(v26) + 16) = 0;
    *(_BYTE *)(sub_10017AB4C(v26) + 24) = 1;
    *(_BYTE *)(sub_10017AB4C(v26) + 27) = 3;
    *(_BYTE *)(sub_10017AB4C(v26) + 26) = 3;
    *(_BYTE *)(sub_10017AB4C(v26) + 28) = 0;
    *(_BYTE *)(sub_10017AB4C(v26) + 52) = 0;
    *(void *)(sub_10017AB4C(v26) + 88) = a5;
    *(void *)(sub_10017AB4C(v26) + 96) = a4;
    *((void *)v26 + 4) = a6;
    *(_WORD *)(sub_10017AB4C(v26) + 48) = 0;
    *(_BYTE *)(sub_10017AB4C(v26) + 78) = 0;
    uint64_t v30 = sub_100186230(v26, 0, 0);
    if ((_DWORD)v30)
    {
      uint64_t v16 = v30;
      sub_1001734D8((uint64_t)v26);
    }

    else
    {
      int v32 = *(_DWORD *)(a2 + 8);
      if (!v32) {
        int v32 = -1;
      }
      v26[19] = v32;
      char v33 = *(_BYTE *)(a2 + 6);
      if (!v33) {
        char v33 = 4;
      }
      *(_BYTE *)(a2 + 6) = v33;
      char v34 = *(_BYTE *)(a2 + 7);
      if (!v34) {
        char v34 = 5;
      }
      *(_BYTE *)(a2 + 7) = v34;
      sub_10010C9D4(v17);
      sub_100187CD4( *((unsigned __int16 *)v26 + 2),  *(_BYTE *)(a2 + 6),  *(unsigned __int8 *)(a2 + 7),  0LL,  (uint64_t *)v26 + 12,  v26[19]);
      uint64_t v35 = (uint64_t *)sub_10017AB4C(v26);
      sub_10018A690(*v35);
      *a7 = *((_WORD *)v26 + 2);
      *((void *)v26 + 8) = v44;
      uint64_t v16 = sub_100173E68(v26, (__int16 *)a2);
      if ((_DWORD)v16)
      {
        sub_1001734D8((uint64_t)v26);
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"OI_L2CAP_createChannelForFastConnect Failed to set channel params",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v44);
          uint64_t v43 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }
  }

  return v16;
}

uint64_t sub_100173ADC(unsigned int a1, _WORD *a2, _WORD *a3, _BYTE *a4)
{
  uint64_t v19 = 0LL;
  uint64_t v7 = sub_100171EC4(a1, &v19);
  if ((_DWORD)v7)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_L2CAP_getL2CAPChannelInfo Get Channel failed", v8, v9, v10, v11, v12, v13, v14, v18);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    uint64_t v16 = v19;
    *a2 = *(_WORD *)(v19 + 6);
    *a3 = *(_WORD *)(*(void *)(v16 + 112) + 36LL);
    *a4 = *(_BYTE *)(sub_10017AB4C((unsigned int *)v16) + 52);
  }

  return v7;
}

uint64_t sub_100173B8C(uint64_t a1)
{
  uint64_t v2 = (unsigned int *)sub_100171DAC();
  if (*(_WORD *)(sub_1001EDBA0(0x2Fu) + 2))
  {
    unsigned int v3 = 0;
    unsigned int v4 = 0xFFFF;
    do
    {
      BOOL v5 = *v2 == 4 || *v2 == 2;
      ++v3;
      v2 += 36;
    }

    while (v3 < *(unsigned __int16 *)(sub_1001EDBA0(0x2Fu) + 2));
    unsigned int v6 = 8 * v4 / 5;
    if (v4 == 65534) {
      LOWORD(v6) = 0;
    }
    if (v4 == 0xFFFF) {
      unsigned __int16 v7 = 32000;
    }
    else {
      unsigned __int16 v7 = v6;
    }
  }

  else
  {
    unsigned __int16 v7 = 32000;
  }

  else {
    return sub_100118658(a1, v7);
  }
}

void sub_100173C90(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  uint64_t v22 = *(void (**)(uint64_t, uint64_t))(sub_10017AB4C((unsigned int *)a1) + 88);
  uint64_t v4 = *(unsigned __int16 *)(a1 + 4);
  unsigned int v5 = *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)a1) + 16);
  sub_10017AB4C((unsigned int *)a1);
  uint64_t v21 = *(void (**)(void, void, void, uint64_t))(sub_10017AB4C((unsigned int *)a1) + 96);
  int v6 = *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)a1) + 24);
  uint64_t v7 = *(void *)sub_10017AB4C((unsigned int *)a1);
  if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 17))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Disconnect notification for PSM: %x already pending on dispatcher",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  *(unsigned __int16 *)(a1 + 6));
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    *(_DWORD *)(sub_10017AB4C((unsigned int *)a1) + 20) = a2;
    *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 17) = 1;
    *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 16) = 0;
    sub_10018A8D8(v4);
    sub_1001734D8(a1);
    if (sub_10012D514(v7))
    {
      sub_10010CAA4(v7, 0x13u);
      if (sub_10012D514(v7)) {
        sub_100173B8C(v7);
      }
    }

    uint64_t v16 = *(unsigned int *)(a1 + 72);
    if ((_DWORD)v16) {
      sub_1001F08BC(v16);
    }
    BOOL v18 = (_DWORD)a2 != 464 && v5 > 3;
    if (v5 == 2 || v18)
    {
      if (v22) {
        v22(v4, a2);
      }
    }

    else
    {
      if (v6) {
        BOOL v19 = v5 == 3;
      }
      else {
        BOOL v19 = 1;
      }
      int v20 = v19;
      if (v21 && v20) {
        v21(*(unsigned __int16 *)(a1 + 4), 0LL, 0LL, a2);
      }
    }
  }

uint64_t sub_100173E68(unsigned int *a1, __int16 *a2)
{
  if (a1)
  {
    if (a2) {
      goto LABEL_3;
    }
  }

  else
  {
    sub_1001EE2A0();
    if (a2) {
      goto LABEL_3;
    }
  }

  sub_1001EE2A0();
LABEL_3:
  if (!a2[1]
    || (unsigned __int16)a2[1] == 0xFFFF && (byte_1008F6D2A & 0x40) != 0
    || (uint64_t v4 = (unsigned int *)sub_100171DAC(), !*(_WORD *)(sub_1001EDBA0(0x2Fu) + 2)))
  {
LABEL_26:
    if (a2[2]) {
      __int16 v20 = a2[2];
    }
    else {
      __int16 v20 = -2;
    }
    *(_WORD *)(sub_10017AB4C(a1) + 40) = v20;
    __int16 v21 = *a2;
    *(_WORD *)(sub_10017AB4C(a1) + 36) = v21;
    __int16 v22 = a2[1];
    uint64_t v23 = sub_10017AB4C(a1);
    uint64_t result = 0LL;
    *(_WORD *)(v23 + 38) = v22;
  }

  else
  {
    unsigned int v5 = 0;
    while (1)
    {
      if (v4 != a1 && *v4 && *v4 != 3)
      {
        uint64_t v7 = sub_10017AB4C(a1);
        uint64_t v8 = sub_10017AB4C(v4);
        if (*(_DWORD *)(v7 + 10) == *(_DWORD *)(v8 + 10)
          && *(unsigned __int16 *)(v7 + 14) == *(unsigned __int16 *)(v8 + 14))
        {
          if (*(_WORD *)(sub_10017AB4C(v4) + 38))
          {
            if (*(__int16 *)(sub_10017AB4C(v4) + 38) != -1)
            {
              int v10 = (unsigned __int16)a2[1];
            }
          }
        }
      }

      ++v5;
      v4 += 36;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"OI_L2CAP_Accept: conflicting flush timeout, cannot accept connection",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v24);
      BOOL v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_10065BD2C();
      }
    }

    sub_1001734D8((uint64_t)a1);
    return 101LL;
  }

  return result;
}

uint64_t sub_100174028( uint64_t a1, uint64_t a2, uint64_t a3, int a4, uint64_t a5, uint64_t a6, _WORD *a7, uint64_t a8)
{
  uint64_t v44 = 0LL;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"OI_L2CAP_Connect %: PSM = 0x%x, Cb 0x%x", v16, v17, v18, v19, v20, v21, v22, a5);
    uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)buf = 136446210;
      __int16 v46 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (a1 && a8 && a2 && a3 && (a4 & 0x1010101) == 1 && a7)
  {
    uint64_t v24 = sub_100174508((unsigned __int16 *)a6);
    if (!(_DWORD)v24)
    {
      uint64_t v24 = sub_100172ECC(2u, (uint64_t *)&v44, 0);
      if (!(_DWORD)v24)
      {
        *(_BYTE *)(sub_10017AB4C(v44) + 24) = 0;
        uint64_t v25 = sub_10017AB4C(v44);
        __int16 v26 = *(_WORD *)(a5 + 4);
        *(_DWORD *)(v25 + 10) = *(_DWORD *)a5;
        *(_WORD *)(v25 + 14) = v26;
        uint64_t v27 = v44;
        *((_WORD *)v44 + 3) = a4;
        *(_BYTE *)(sub_10017AB4C(v27) + 16) = 0;
        *(void *)(sub_10017AB4C(v44) + 88) = a2;
        *(void *)(sub_10017AB4C(v44) + 96) = a1;
        __int16 v28 = v44;
        *((void *)v44 + 4) = a3;
        *((void *)v28 + 8) = a8;
        if (a6)
        {
          uint64_t v29 = *(void *)(a6 + 16);
          uint64_t v30 = sub_10017AB4C(v28);
          if (v29)
          {
            uint64_t v31 = *(uint64_t **)(a6 + 16);
            uint64_t v32 = *v31;
            *(_WORD *)(v30 + 50) = *((_WORD *)v31 + 4);
            *(void *)(v30 + 42) = v32;
          }

          else
          {
            *(_WORD *)(v30 + 48) = 0;
          }

          char v38 = *(_BYTE *)(a6 + 24);
          *(_BYTE *)(sub_10017AB4C(v44) + 78) = v38;
          uint64_t v24 = sub_100186230(v44, *(unsigned __int8 *)(a6 + 12), *(_BYTE *)(a6 + 13));
          if ((_DWORD)v24) {
            goto LABEL_21;
          }
          if (*(_DWORD *)(a6 + 8)) {
            unsigned int v35 = *(_DWORD *)(a6 + 8);
          }
          else {
            unsigned int v35 = -1;
          }
          char v34 = v44;
          v44[19] = v35;
          if (*(_BYTE *)(a6 + 6)) {
            char v37 = *(_BYTE *)(a6 + 6);
          }
          else {
            char v37 = 4;
          }
          if (*(_BYTE *)(a6 + 7)) {
            unsigned int v36 = *(unsigned __int8 *)(a6 + 7);
          }
          else {
            unsigned int v36 = 5;
          }
        }

        else
        {
          *(_WORD *)(sub_10017AB4C(v28) + 48) = 0;
          *(_BYTE *)(sub_10017AB4C(v44) + 78) = 0;
          uint64_t v24 = sub_100186230(v44, 0, 0);
          if ((_DWORD)v24) {
            goto LABEL_21;
          }
          char v34 = v44;
          unsigned int v35 = -1;
          v44[19] = -1;
          unsigned int v36 = 5;
          char v37 = 4;
        }

        uint64_t v24 = sub_100187CD4(*((unsigned __int16 *)v34 + 2), v37, v36, 0LL, (uint64_t *)v34 + 12, v35);
        uint64_t v39 = v44;
        if ((_DWORD)v24) {
          goto LABEL_32;
        }
        *a7 = *((_WORD *)v44 + 2);
        if (!a6 || (uint64_t v40 = sub_100173E68(v39, (__int16 *)a6), !(_DWORD)v40))
        {
          unsigned int v41 = *(unsigned __int16 *)(sub_1001EDBA0(0x28u) + 8);
          else {
            uint64_t v42 = (__int16 *)(sub_10017AB4C(v44) + 36);
          }
          __int16 v43 = *v42;
          *(_WORD *)(sub_10017AB4C(v44) + 36) = v43;
          uint64_t v24 = sub_10010C710((uint64_t)sub_100174378, a5);
          uint64_t v39 = v44;
          if (!(_DWORD)v24)
          {
            *(_BYTE *)(sub_10017AB4C(v44) + 25) = 1;
            return v24;
          }

          goto LABEL_32;
        }

        uint64_t v24 = v40;
LABEL_21:
        uint64_t v39 = v44;
LABEL_32:
        sub_1001734D8((uint64_t)v39);
      }
    }
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

  return v24;
}

void sub_100174378(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v25 = 0LL;
  if (!sub_100172780(a2, &v25))
  {
    if (*(_BYTE *)(sub_10017AB4C(v25) + 16) || *(_BYTE *)(sub_10017AB4C(v25) + 25) != 1) {
      sub_1001EE2A0();
    }
    if (!(_DWORD)a1)
    {
      *(void *)sub_10017AB4C(v25) = a3;
      if (!a3) {
        sub_1001EE2A0();
      }
      if (*(_BYTE *)(a3 + 228))
      {
        *(_BYTE *)(sub_10017AB4C(v25) + 25) = 2;
        uint64_t v14 = sub_10017AB4C(v25);
      }

      else
      {
        *(_BYTE *)(a3 + 228) = 1;
        uint64_t v15 = sub_100198780((uint64_t)sub_100176BBC, 1LL, a2, 2);
        if (!(_DWORD)v15) {
          return;
        }
        uint64_t v16 = v15;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not ask device for extended features, result is %!",  v17,  v18,  v19,  v20,  v21,  v22,  v23,  v16);
          uint64_t v24 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    sub_100176DE8((uint64_t)v25, a1);
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"no waiting channel found for completed ACL link %: with %!",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  a2);
    uint64_t v13 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_100174508(unsigned __int16 *a1)
{
  if (!a1) {
    return 0LL;
  }
  unsigned int v2 = *a1;
  if (v2 < 0x80) {
    return 483LL;
  }
  if (v2 <= *(unsigned __int16 *)(sub_1001EDBA0(0x28u) + 8))
  {
    return 0LL;
  }

  if (sub_1000A86F0())
  {
    uint64_t v4 = sub_1001EDBA0(0x28u);
    sub_1001EE134( (uint64_t)"Could not validate connect parameters: no resources, max %d, in %d",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  *(unsigned __int16 *)(v4 + 8));
    uint64_t v12 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return 104LL;
}

void sub_1001745D4(uint64_t a1, uint64_t a2)
{
  if (sub_10012D5EC(a1))
  {
    uint64_t v4 = *(void *)(a1 + 224);
    if (v4)
    {
      uint64_t v5 = sub_1001EC324(v4, 0);
      if (v5)
      {
        uint64_t v6 = (unsigned __int16 *)v5;
        do
        {
          uint64_t v16 = 0LL;
          if (!sub_100171EC4(*v6, (uint64_t *)&v16))
          {
            uint64_t v7 = sub_10017AB4C(v16);
            if ((_DWORD)a2)
            {
              if (*(void *)(v7 + 96))
              {
                uint64_t v8 = sub_10017AB4C(v16);
                (*(void (**)(void, void, void, uint64_t))(v8 + 96))( *((unsigned __int16 *)v16 + 2),  0LL,  0LL,  a2);
              }

              sub_1001734D8((uint64_t)v16);
            }

            else
            {
              uint64_t v9 = *(__int128 **)v7;
              char v10 = *(_BYTE *)(sub_10017AB4C(v16) + 28);
              __int16 v11 = *((_WORD *)v16 + 3);
              __int16 v12 = *((_WORD *)v16 + 2);
              __int16 v13 = *(_WORD *)(sub_10017AB4C(v16) + 36);
              __int16 v14 = *(_WORD *)(sub_10017AB4C(v16) + 72);
              __int16 v15 = sub_10016ED64(v16);
              sub_1001CA808(v9, v10, v11, v12, v13, v14, v15);
            }
          }

          sub_1000B1838(v6);
          uint64_t v6 = (unsigned __int16 *)sub_1001EC324(*(void *)(a1 + 224), 0);
        }

        while (v6);
      }

      sub_1001EC070(*(void **)(a1 + 224));
      *(void *)(a1 + 224) = 0LL;
    }
  }

void sub_100174714(uint64_t a1, uint64_t a2)
{
  if ((sub_1001CBEB4(a1) & 1) == 0) {
    sub_1001745D4(a1, a2);
  }
}

void sub_100174750(_DWORD *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4 = sub_10012D98C(a1);
  sub_1001745D4(v4, a3);
}

double sub_100174774()
{
  *(void *)&double result = sub_1001C87BC((__n128 *)off_1008D8DE0).n128_u64[0];
  return result;
}

uint64_t sub_100174780()
{
  return sub_1001C8874(off_1008D8DE0);
}

uint64_t sub_10017478C(uint64_t a1, uint64_t a2, uint64_t a3, int a4, uint64_t a5, __int16 *a6, _WORD *a7)
{
  if (a1 && a2 && a3 && ((__int16 v12 = a4, (a4 - 1) < 0x7F) || (a4 & 0xFF80) == 0x80) && a7)
  {
    if (sub_10012D5EC(a5))
    {
      uint64_t v14 = sub_100174A3C((uint64_t)a6);
      if (!(_DWORD)v14)
      {
        __int16 v43 = 0LL;
        uint64_t v14 = sub_100172ECC(2u, (uint64_t *)&v43, 1);
        if (!(_DWORD)v14)
        {
          __int16 v15 = v43;
          *a7 = *((_WORD *)v43 + 2);
          *(_BYTE *)(sub_10017AB4C(v15) + 24) = 0;
          *(void *)sub_10017AB4C(v43) = a5;
          uint64_t v16 = sub_10017AB4C(v43);
          __int16 v17 = *(_WORD *)(a5 + 53);
          *(_DWORD *)(v16 + 10) = *(_DWORD *)(a5 + 49);
          *(_WORD *)(v16 + 14) = v17;
          uint64_t v18 = v43;
          *((_WORD *)v43 + 3) = v12;
          *(_BYTE *)(sub_10017AB4C(v18) + 16) = 1;
          *(void *)(sub_10017AB4C(v43) + 88) = a2;
          *(void *)(sub_10017AB4C(v43) + 96) = a1;
          uint64_t v19 = v43;
          *((void *)v43 + 4) = a3;
          *(_WORD *)(sub_10017AB4C(v19) + 48) = 0;
          *(_BYTE *)(sub_10017AB4C(v43) + 78) = 0;
          char v20 = sub_100196568();
          *(_BYTE *)(sub_10017AB4C(v43) + 28) = v20;
          __int16 v21 = *a6;
          *(_WORD *)(sub_10017AB4C(v43) + 36) = v21;
          unsigned int v22 = *(unsigned __int16 *)(sub_1001EDBA0(0x28u) + 8);
          else {
            uint64_t v23 = (__int16 *)(sub_10017AB4C(v43) + 36);
          }
          __int16 v25 = *v23;
          *(_WORD *)(sub_10017AB4C(v43) + 36) = v25;
          __int16 v26 = a6[1];
          *(_WORD *)(sub_10017AB4C(v43) + 72) = v26;
          uint64_t v27 = sub_10016ECFC(v43, (unsigned __int16)a6[4], a6[3]);
          if ((_DWORD)v27)
          {
            uint64_t v14 = v27;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"LE_L2CAP_InitLocalParams returned %!. Failed to initiate parameters. Aborting.\n",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v14);
              unsigned int v35 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            sub_1001734D8((uint64_t)v43);
          }

          else
          {
            *(_BYTE *)(sub_10017AB4C(v43) + 25) = 1;
            unsigned int v36 = *(__int128 **)sub_10017AB4C(v43);
            char v37 = *(_BYTE *)(sub_10017AB4C(v43) + 28);
            __int16 v38 = *((_WORD *)v43 + 3);
            __int16 v39 = *((_WORD *)v43 + 2);
            __int16 v40 = *(_WORD *)(sub_10017AB4C(v43) + 36);
            __int16 v41 = *(_WORD *)(sub_10017AB4C(v43) + 72);
            __int16 v42 = sub_10016ED64(v43);
            sub_1001CA808(v36, v37, v38, v39, v40, v41, v42);
            return 0LL;
          }
        }
      }
    }

    else
    {
      return 414LL;
    }
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

  return v14;
}

uint64_t sub_100174A3C(uint64_t result)
{
  if (result)
  {
    uint64_t v1 = (unsigned __int16 *)result;
    unsigned int v2 = *(unsigned __int16 *)result;
    if (v2 <= *(unsigned __int16 *)(sub_1001EDBA0(0x28u) + 8))
    {
      if (v1[1] <= *v1)
      {
        return 0LL;
      }

      else
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"MTU must be equal or greater than MPS (MPS=%d, MTU=%d)\n",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v1[1]);
          uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        return 101LL;
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Could not validate connect parameters: no resources", v3, v4, v5, v6, v7, v8, v9, v19);
        char v10 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 104LL;
    }
  }

  return result;
}

uint64_t sub_100174B2C(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4, uint64_t a5, int a6, uint64_t a7)
{
  uint64_t v109 = 0LL;
  uint64_t v13 = sub_100171EC4(a4, (uint64_t *)&v109);
  if (!(_DWORD)v13)
  {
    if (*(_BYTE *)(sub_10017AB4C(v109) + 16) != 2)
    {
      if (sub_1000A86F0())
      {
        uint64_t v32 = sub_10017AB4C(v109);
        sub_1001EE134((uint64_t)"Invalid State: %d", v33, v34, v35, v36, v37, v38, v39, *(unsigned __int8 *)(v32 + 16));
        __int16 v40 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 408LL;
    }

    if (!a6)
    {
      sub_1001750A4((uint64_t)v109, 530LL, 0);
      return 0LL;
    }

    if (!a1 || !a2 || !a3 || !a7)
    {
      sub_1001EE2A0();
      return 101LL;
    }

    uint64_t v23 = sub_100174508((unsigned __int16 *)a5);
    if ((_DWORD)v23)
    {
      uint64_t v14 = v23;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Invalid Connect Params: %!", v24, v25, v26, v27, v28, v29, v30, v14);
        uint64_t v31 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
          goto LABEL_50;
        }
      }

      return v14;
    }

    *(void *)(sub_10017AB4C(v109) + 96) = a1;
    *(void *)(sub_10017AB4C(v109) + 88) = a2;
    __int16 v42 = v109;
    *((void *)v109 + 4) = a3;
    *((void *)v42 + 8) = a7;
    if (a5)
    {
      uint64_t v43 = *(void *)(a5 + 16);
      uint64_t v44 = sub_10017AB4C(v42);
      if (v43)
      {
        uint64_t v45 = *(uint64_t **)(a5 + 16);
        uint64_t v46 = *v45;
        *(_WORD *)(v44 + 50) = *((_WORD *)v45 + 4);
        *(void *)(v44 + 42) = v46;
      }

      else
      {
        *(_WORD *)(v44 + 48) = 0;
      }

      char v48 = *(_BYTE *)(a5 + 24);
      *(_BYTE *)(sub_10017AB4C(v109) + 78) = v48;
      uint64_t v14 = sub_100186230(v109, *(unsigned __int8 *)(a5 + 12), *(_BYTE *)(a5 + 13));
      if ((_DWORD)v14)
      {
LABEL_30:
        sub_1001EE134((uint64_t)"Flow init failed with %!, rejecting connection", v49, v50, v51, v52, v53, v54, v55, v14);
        uint64_t v56 = (os_log_s *)sub_100086554(0x2Fu);
        if (!os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
        goto LABEL_45;
      }

      if (*(_DWORD *)(a5 + 8)) {
        unsigned int v57 = *(_DWORD *)(a5 + 8);
      }
      else {
        unsigned int v57 = -1;
      }
      uint64_t v58 = v109;
      v109[19] = v57;
      if (*(_BYTE *)(a5 + 6)) {
        char v59 = *(_BYTE *)(a5 + 6);
      }
      else {
        char v59 = 4;
      }
      if (*(_BYTE *)(a5 + 7)) {
        unsigned int v60 = *(unsigned __int8 *)(a5 + 7);
      }
      else {
        unsigned int v60 = 5;
      }
      uint64_t v14 = sub_100187CD4(*((unsigned __int16 *)v58 + 2), v59, v60, 0LL, (uint64_t *)v58 + 12, v57);
      if ((_DWORD)v14) {
        goto LABEL_43;
      }
      uint64_t v69 = sub_100173E68(v109, (__int16 *)a5);
      if ((_DWORD)v69)
      {
        uint64_t v14 = v69;
        sub_1001734D8((uint64_t)v109);
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"OI_ConnectMan_handleChannelParamConflicts failed: %!",  v70,  v71,  v72,  v73,  v74,  v75,  v76,  v14);
          uint64_t v77 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v77, OS_LOG_TYPE_ERROR)) {
            goto LABEL_50;
          }
        }

        return v14;
      }
    }

    else
    {
      *(_WORD *)(sub_10017AB4C(v42) + 48) = 0;
      *(_BYTE *)(sub_10017AB4C(v109) + 78) = 0;
      uint64_t v14 = sub_100186230(v109, 0, 0);
      if ((_DWORD)v14) {
        goto LABEL_30;
      }
      int v47 = v109;
      v109[19] = -1;
      uint64_t v14 = sub_100187CD4(*((unsigned __int16 *)v47 + 2), 4, 5u, 0LL, (uint64_t *)v47 + 12, 0xFFFFFFFF);
      if ((_DWORD)v14)
      {
LABEL_43:
        sub_1001EE134( (uint64_t)"Queue register failed with %!, rejecting connection",  v61,  v62,  v63,  v64,  v65,  v66,  v67,  v14);
        uint64_t v68 = (os_log_s *)sub_100086554(0x2Fu);
        if (!os_log_type_enabled(v68, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
        goto LABEL_45;
      }
    }

    unsigned int v78 = *(unsigned __int16 *)(sub_1001EDBA0(0x28u) + 8);
    else {
      uint64_t v79 = (__int16 *)(sub_10017AB4C(v109) + 36);
    }
    __int16 v80 = *v79;
    *(_WORD *)(sub_10017AB4C(v109) + 36) = v80;
    uint64_t v81 = v109;
    if (*((void *)v109 + 8))
    {
      uint64_t v82 = (uint64_t *)sub_10017AB4C(v109);
      int v84 = sub_1001E668C(*v82, **((void **)v109 + 8), *(void *)(*((void *)v109 + 8) + 8LL), v83);
      uint64_t v81 = v109;
      if (v84)
      {
        uint64_t v85 = *(_BYTE **)sub_10017AB4C(v109);
        char v86 = *(_BYTE *)(sub_10017AB4C(v109) + 29);
        uint64_t v87 = *((unsigned __int16 *)v109 + 2);
        sub_10017AB4C(v109);
        uint64_t v91 = sub_1001967F4("aaaa", 3u, 0LL, v85, v86, v88, v89, v90, v87);
        if ((_DWORD)v91)
        {
          uint64_t v14 = v91;
          sub_1001EE134((uint64_t)"Sending Pending response failed %!", v92, v93, v94, v95, v96, v97, v98, v14);
          uint64_t v99 = (os_log_s *)sub_100086554(0x2Fu);
          if (!os_log_type_enabled(v99, OS_LOG_TYPE_ERROR)) {
            goto LABEL_46;
          }
          goto LABEL_45;
        }

        uint64_t v81 = v109;
      }
    }

    uint64_t v100 = sub_10017AB4C(v81);
    uint64_t v14 = sub_1001F0324((uint64_t)sub_100175328, v100 + 10, *((__int128 **)v109 + 8), (int *)v109 + 18, 1);
    if (!(_DWORD)v14)
    {
      *(_BYTE *)(sub_10017AB4C(v109) + 25) = 2;
      return v14;
    }

    sub_1001EE134((uint64_t)"Policy Mgr for new connection failed %!", v101, v102, v103, v104, v105, v106, v107, v14);
    uint64_t v108 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v108, OS_LOG_TYPE_ERROR)) {
      goto LABEL_46;
    }
LABEL_45:
    sub_100657858();
LABEL_46:
    sub_1001750A4((uint64_t)v109, v14, 0);
    return v14;
  }

  uint64_t v14 = v13;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"OI_ChanMan_GetChannel failed: %!", v15, v16, v17, v18, v19, v20, v21, v14);
    unsigned int v22 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
LABEL_50:
    }
      sub_100657858();
  }

  return v14;
}

void sub_1001750A4(uint64_t a1, uint64_t a2, int a3)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  uint64_t v6 = *(_BYTE **)sub_10017AB4C((unsigned int *)a1);
  char v7 = *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 29);
  if ((_DWORD)a2) {
    goto LABEL_4;
  }
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 25) = 3;
  uint64_t v33 = *(unsigned __int16 *)(a1 + 4);
  sub_10017AB4C((unsigned int *)a1);
  uint64_t v37 = sub_1001967F4("aaaa", 3u, 0LL, v6, v7, v34, v35, v36, v33);
  if ((_DWORD)v37)
  {
    uint64_t v38 = v37;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to complete incoming connection %!", v39, v40, v41, v42, v43, v44, v45, v38);
      uint64_t v46 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

void sub_100175328(int a1, uint64_t a2, int a3)
{
  uint64_t v5 = sub_1001728E8(a1);
  if (v5)
  {
    uint64_t v6 = v5;
    if ((_DWORD)a2)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Policy enforcement failed %! - cid 0x%x, handle %d securityFailed %d",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  a2);
        uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      if (!*(_BYTE *)(sub_10017AB4C(v6) + 24))
      {
        sub_100173C90((uint64_t)v6, a2);
        return;
      }
    }

    else if (!*(_BYTE *)(sub_10017AB4C(v5) + 24))
    {
      sub_100176DE8((uint64_t)v6, 0LL);
      return;
    }

    sub_1001750A4((uint64_t)v6, a2, a3);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Channel not found in PolicyCB!", v15, v16, v17, v18, v19, v20, v21, v23);
    uint64_t v22 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_100175458(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4, uint64_t a5, int a6)
{
  uint64_t v85 = 0LL;
  uint64_t v11 = sub_100171EC4(a4, (uint64_t *)&v85);
  if ((_DWORD)v11 || !sub_10017AB4C(v85))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ChanMan_GetChannel failed: %!", v12, v13, v14, v15, v16, v17, v18, v11);
      uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return v11;
  }

  uint64_t v20 = *(void *)sub_10017AB4C(v85);
  if (*(_BYTE *)(sub_10017AB4C(v85) + 16) != 2)
  {
    if (sub_1000A86F0())
    {
      uint64_t v25 = sub_10017AB4C(v85);
      sub_1001EE134((uint64_t)"Invalid State: %d", v26, v27, v28, v29, v30, v31, v32, *(unsigned __int8 *)(v25 + 16));
      uint64_t v33 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 408LL;
  }

  int v21 = sub_1001C8ECC(v20);
  int v22 = sub_1001C902C(v20);
  unsigned __int8 v84 = 0;
  if (v22) {
    sub_1001C90B0(v20, &v84);
  }
  if (!*(_BYTE *)(a5 + 4))
  {
    if (*(_BYTE *)(a5 + 5))
    {
      int v34 = sub_1001C8F50(v20);
      if (v34) {
        int v24 = 4;
      }
      else {
        int v24 = 6;
      }
      if (!v34 || (a6 & 1) == 0) {
        goto LABEL_40;
      }
      goto LABEL_30;
    }

uint64_t sub_100175954(unsigned int a1, uint64_t a2)
{
  uint64_t v15 = 0LL;
  uint64_t v4 = sub_100171EC4(a1, (uint64_t *)&v15);
  if ((_DWORD)v4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"GetChannel with cid %d failed with status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    uint64_t v13 = v15;
    if (!v15)
    {
      sub_1001EE2A0();
      uint64_t v13 = v15;
    }

    *(void *)(sub_10017AB4C(v13) + 88) = a2;
  }

  return v4;
}

uint64_t sub_1001759FC(unsigned int a1, uint64_t a2)
{
  uint64_t v33 = 0LL;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"L2CAP Disconnect cid=%d(0x%x) , reason=%!", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)buf = 136446210;
      uint64_t v35 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (*(_BYTE *)(sub_10017AB4C(v33) + 17)) {
    return 0LL;
  }
  if (*(_BYTE *)(sub_10017AB4C(v33) + 16) != 4 && *(_BYTE *)(sub_10017AB4C(v33) + 16) != 5) {
    return 408LL;
  }
  uint64_t v13 = v33;
  unsigned int v14 = *v33;
  if (*v33 == 2)
  {
    sub_100189534(a1);
    uint64_t v13 = v33;
    return sub_100175C0C(v13, a2);
  }

  if (v14 != 4)
  {
    if (v14 == 3)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Can't disconnect fixed of Magnet channels using the signal manager.",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v32);
        int v22 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 403LL;
    }

    return sub_100175C0C(v13, a2);
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Magnet got messed up", v23, v24, v25, v26, v27, v28, v29, v32);
    uint64_t v30 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  sub_1001EE348(5006LL);
  uint64_t v31 = (unsigned __int16 **)sub_10017AB4C(v33);
  return sub_100100BD4(*v31);
}

uint64_t sub_100175C0C(unsigned int *a1, uint64_t a2)
{
  if (!*(void *)sub_10017AB4C(a1)) {
    sub_1001EE2A0();
  }
  *(_BYTE *)(sub_10017AB4C(a1) + 16) = 6;
  *(_DWORD *)(sub_10017AB4C(a1) + 20) = a2;
  uint64_t v4 = *(_BYTE **)sub_10017AB4C(a1);
  char v5 = sub_100196568();
  uint64_t v6 = sub_10017AB4C(a1);
  uint64_t v10 = sub_1001967F4("aa", 6u, a1, v4, v5, v7, v8, v9, *(unsigned __int16 *)(v6 + 8));
  if ((_DWORD)v10)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send disconnect, closing channel", v11, v12, v13, v14, v15, v16, v17, v20);
      uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_10065B898();
      }
    }

    sub_100173C90((uint64_t)a1, a2);
  }

  return v10;
}

uint64_t sub_100175D08(unsigned int a1)
{
  uint64_t v26 = 0LL;
  if (*v26 - 3 > 1)
  {
    if (*(_BYTE *)(sub_10017AB4C(v26) + 17))
    {
      return 0LL;
    }

    else if (*(_BYTE *)(sub_10017AB4C(v26) + 16) == 4)
    {
      uint64_t v10 = v26;
      if (!*(void *)sub_10017AB4C(v26)) {
        sub_1001EE2A0();
      }
      *(_BYTE *)(sub_10017AB4C(v10) + 16) = 6;
      *(_DWORD *)(sub_10017AB4C(v10) + 20) = 436;
      char v11 = sub_100196568();
      *(_BYTE *)(sub_10017AB4C(v10) + 28) = v11;
      uint64_t v12 = *(__int128 **)sub_10017AB4C(v10);
      char v13 = *(_BYTE *)(sub_10017AB4C(v10) + 28);
      __int16 v14 = *((_WORD *)v10 + 2);
      uint64_t v15 = sub_10017AB4C(v10);
      uint64_t v1 = sub_1001CAD64(v12, v13, v14, *(_WORD *)(v15 + 8));
      if ((_DWORD)v1)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to send disconnect, closing channel", v16, v17, v18, v19, v20, v21, v22, v25);
          uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            sub_10065B898();
          }
        }

        sub_100173C90((uint64_t)v10, 436LL);
      }
    }

    else
    {
      return 408LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Can't disconnect fixed of Magnet channels using the signal manager.",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v25);
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 403LL;
  }

  return v1;
}

uint64_t sub_100175EB4(uint64_t a1, uint64_t a2)
{
  unsigned int v4 = *(unsigned __int16 *)(a2 + 4);
  sub_10017AB4C((unsigned int *)a1);
  __int16 v49 = &v48;
  uint64_t v60 = 0LL;
  __int128 v59 = 0u;
  __int128 v57 = 0u;
  __int128 v58 = 0u;
  __int128 v55 = 0u;
  __int128 v56 = 0u;
  __int128 v53 = 0u;
  __int128 v54 = 0u;
  memset(v52, 0, sizeof(v52));
  int v51 = 0;
  __int16 v50 = 0;
  __chkstk_darwin();
  uint64_t v6 = (char *)&v48 - v5;
  bzero((char *)&v48 - v5, v7);
  if (v4 <= *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)a1) + 32))
  {
    if (v4)
    {
      int v18 = 0;
      *(void *)&__int128 v8 = 136446466LL;
      __int128 v48 = v8;
      while (1)
      {
        __int16 v19 = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 60);
        if (v18) {
          __int16 v20 = -4;
        }
        else {
          __int16 v20 = -6;
        }
        unsigned __int16 v21 = v20 + v19;
        else {
          unsigned __int16 v22 = v4 - v18;
        }
        int v23 = sub_1001EFCEC(v6, a2, v22);
        if (v22 != v23)
        {
          unsigned __int16 v24 = v23;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Failed to get the full payload size (%d), only got %d bytes",  v25,  v26,  v27,  v28,  v29,  v30,  v31,  v22);
            uint64_t v32 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
            {
              uint64_t v38 = sub_1001EDDCC();
              int buf = v48;
              unsigned int v62 = v38;
              __int16 v63 = 1024;
              int v64 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v32,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  (uint8_t *)&buf,  0x12u);
            }
          }

          unsigned __int16 v22 = v24;
        }

        LOWORD(v51) = 2 * (v18 == 0) + v22;
        HIWORD(v51) = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 8);
        if (v18)
        {
          sub_1001EF520((uint64_t)&v53 + 8, 2u);
          uint64_t v33 = (char *)&v51;
          size_t v34 = 4LL;
        }

        else
        {
          __int16 v50 = v4;
          sub_1001EF520((uint64_t)&v53 + 8, 3u);
          sub_1001EFB10((unsigned __int8 *)&v53 + 8, (char *)&v51, 4uLL, 0);
          uint64_t v33 = (char *)&v50;
          size_t v34 = 2LL;
        }

        sub_1001EFB10((unsigned __int8 *)&v53 + 8, v33, v34, 0);
        sub_1001EFB10((unsigned __int8 *)&v53 + 8, v6, v22, 2u);
        v52[0] = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
        uint64_t v35 = *(void *)(a1 + 128);
        *(void *)&__int128 v54 = a1;
        *(void *)&__int128 v53 = v35;
        *(void *)(a1 + 128) = 0LL;
        uint64_t v36 = (_BYTE **)sub_10017AB4C((unsigned int *)a1);
        uint64_t v37 = sub_10018A8DC((uint64_t)v52, *v36, 0, *(_WORD *)(a1 + 4));
        uint64_t v17 = v37;
        if ((_DWORD)v37 != 412)
        {
          if ((_DWORD)v37) {
            break;
          }
        }

        int v18 = (unsigned __int16)(v22 + v18);
        if (v18 == v4) {
          return v17;
        }
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"LE_L2CAP_FragmentWriteMBUF %!", v39, v40, v41, v42, v43, v44, v45, v17);
        char v46 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      return 531LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Error, packet too large", v9, v10, v11, v12, v13, v14, v15, v48);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 472LL;
  }

  return v17;
}

uint64_t sub_10017627C(uint64_t a1, uint64_t a2)
{
  uint64_t v53 = a2;
  unsigned int v3 = *(unsigned __int16 *)(a2 + 4);
  __int16 v4 = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 72);
  __chkstk_darwin();
  uint64_t v6 = (char *)&v51 - v5;
  bzero((char *)&v51 - v5, v7);
  int v8 = *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)a1) + 77);
  __int128 v62 = 0u;
  __int128 v63 = 0u;
  __int128 v60 = 0u;
  __int128 v61 = 0u;
  __int128 v58 = 0u;
  __int128 v59 = 0u;
  __int128 v57 = 0u;
  __int128 v55 = 0u;
  memset(v56, 0, 120);
  __int128 v54 = 0u;
  int v9 = *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)a1) + 72);
  if (*(unsigned __int8 *)(sub_10017AB4C((unsigned int *)a1) + 66) * v9 >= v3
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 64) == 3)
  {
    uint64_t v10 = sub_10017AB4C((unsigned int *)a1);
    if (!v3) {
      return 531LL;
    }
    int v12 = 0;
    if (*(_BYTE *)(v10 + 78)) {
      unsigned __int16 v13 = v4 - 8;
    }
    else {
      unsigned __int16 v13 = v4 - 6;
    }
    signed int v14 = v13;
    unsigned int v52 = v8 & 0xFFFFFFFD;
    *(void *)&__int128 v11 = 136446466LL;
    __int128 v51 = v11;
    while (1)
    {
      else {
        unsigned __int16 v15 = v3 - v12;
      }
      if (v52) {
        goto LABEL_12;
      }
      if (!v12 && v3 == v15)
      {
        *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 77) = 0;
        unsigned __int16 v15 = v3;
        goto LABEL_23;
      }

      if (v12)
      {
LABEL_12:
        unsigned int v16 = v12 + v15;
        if (v16 >= v3)
        {
          if (v16 != v3)
          {
            sub_1001EE2A0();
            *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 77) = 0;
            goto LABEL_23;
          }

          uint64_t v17 = sub_10017AB4C((unsigned int *)a1);
          char v18 = 2;
        }

        else
        {
          uint64_t v17 = sub_10017AB4C((unsigned int *)a1);
          char v18 = 3;
        }

        *(_BYTE *)(v17 + 77) = v18;
      }

      else
      {
        *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 77) = 1;
        v15 -= 2;
      }

uint64_t sub_100176678(uint64_t a1, uint64_t a2)
{
  if (a2)
  {
    if (a1) {
      goto LABEL_3;
    }
  }

  else
  {
    sub_1001EE2A0();
    if (a1) {
      goto LABEL_3;
    }
  }

  sub_1001EE2A0();
LABEL_3:
  if (*(_DWORD *)a1 != 2 && *(_DWORD *)a1 != 4) {
    sub_1001EE2A0();
  }
  uint64_t v36 = 0LL;
  __int128 v34 = 0u;
  __int128 v35 = 0u;
  __int128 v32 = 0u;
  __int128 v33 = 0u;
  __int128 v30 = 0u;
  __int128 v31 = 0u;
  __int128 v29 = 0u;
  memset(v28, 0, sizeof(v28));
  unsigned int v5 = *(unsigned __int16 *)(a2 + 4);
  if (v5 <= *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)a1) + 32))
  {
    __int16 v37 = v5 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0);
    char v38 = *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 8);
    char v39 = *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 9);
    sub_1001EF520((uint64_t)&v29 + 8, 2u);
    sub_1001EFB10((unsigned __int8 *)&v29 + 8, (char *)&v37, 4uLL, 0);
    sub_1001EFC20((unsigned __int8 *)&v29 + 8, a2);
    LOBYTE(v28[0]) = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
    uint64_t v16 = *(void *)(a1 + 128);
    *(void *)&__int128 v30 = a1;
    *(void *)&__int128 v29 = v16;
    *(void *)(a1 + 128) = 0LL;
    BYTE1(v28[0]) = *(_DWORD *)(a2 + 8) == 626;
    uint64_t v17 = (_BYTE **)sub_10017AB4C((unsigned int *)a1);
    uint64_t v18 = sub_10018A8DC((uint64_t)v28, *v17, 0, *(_WORD *)(a1 + 4));
    uint64_t v15 = v18;
    if ((_DWORD)v18)
    {
      if ((_DWORD)v18 != 412)
      {
        if (sub_1000A86F0())
        {
          sub_10017AB4C((unsigned int *)a1);
          sub_1001EE134((uint64_t)"OI_ConnectMan_WriteMBUF %! to %p", v19, v20, v21, v22, v23, v24, v25, v15);
          uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      sub_1001EF5E4((uint64_t)&v29 + 8);
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      uint64_t v6 = sub_10017AB4C((unsigned int *)a1);
      sub_1001EE134( (uint64_t)"MTU size (%d) exceeded! - data length = %d",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  *(unsigned __int16 *)(v6 + 32));
      signed int v14 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 472LL;
  }

  return v15;
}

void sub_100176890(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  __int16 v37 = 0LL;
  if (sub_100171EC4(a1, (uint64_t *)&v37))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Data received for invalid CID %d, ignoring packet",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  a1);
      uint64_t v17 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (!sub_10017AB4C(v37))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v20, v21, v22, v23, v24, v25, v26, v36);
    uint64_t v27 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_12:
    sub_100657858();
    return;
  }

  if (*(_BYTE *)(sub_10017AB4C(v37) + 16) == 4)
  {
    uint64_t v18 = v37;
    v37[21] += a3;
    uint64_t v19 = (void (*)(uint64_t, uint64_t, uint64_t, void, uint64_t))*((void *)v18 + 5);
    if (v19) {
      v19(a1, a2, a3, 0LL, a4);
    }
    else {
      (*((void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))v18 + 4))(a1, a2, a3, a4, a5);
    }
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Data received for connection not in OPEN state, ignoring packet with cid %d",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  a1);
    __int128 v35 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
      goto LABEL_12;
    }
  }

void sub_100176A28(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  char v39 = 0LL;
  if (sub_100171EC4(a1, (uint64_t *)&v39))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Data received for invalid CID %d, ignoring packet",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  a1);
      uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (!sub_10017AB4C(v39))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v22, v23, v24, v25, v26, v27, v28, v38);
    uint64_t v29 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_12:
    sub_100657858();
    return;
  }

  if (*(_BYTE *)(sub_10017AB4C(v39) + 16) == 4)
  {
    uint64_t v20 = v39;
    v39[21] += a3;
    uint64_t v21 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))*((void *)v20 + 5);
    if (v21) {
      v21(a1, a2, a3, a4, a5);
    }
    else {
      (*((void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))v20 + 4))(a1, a2, a3, a5, a6);
    }
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Data received for connection not in OPEN state, ignoring packet",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  v38);
    __int16 v37 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
      goto LABEL_12;
    }
  }

void sub_100176BBC(uint64_t a1, uint64_t a2, int a3, _DWORD *a4, int a5, int a6)
{
  uint64_t v34 = 0LL;
  uint64_t v12 = sub_10012D890(a1);
  uint64_t v13 = v12;
  if (v12)
  {
    if (!a6)
    {
      if (a3 == 2 && a5 == 4)
      {
        *(_DWORD *)(v12 + 229) = *a4;
      }

      else if (a3 == 3 && a5 == 8)
      {
        *(void *)(v12 + 233) = *(void *)a4;
      }
    }

    for (uint64_t i = 0LL; i != 6; i += 2LL)
    {
      uint64_t v15 = (void (*)(uint64_t))qword_1008E2B80[i];
      if (v15
        && ((*(unsigned __int8 *)(v13 + ((unint64_t)LOWORD(qword_1008E2B80[i + 1]) >> 3) + 233) >> (qword_1008E2B80[i + 1] & 7)) & 1) != 0)
      {
        v15(a1);
      }
    }

    goto LABEL_11;
  }

  sub_1001EE2A0();
  if (!sub_1000A86F0()
    || (sub_1001EE134( (uint64_t)"Received infoResponseCallback from %:, but it appears this device is no longer connected",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  a1),  uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu),  !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_11:
    if (!a2) {
      return;
    }
    goto LABEL_12;
  }

  sub_100657858();
  if (!a2) {
    return;
  }
LABEL_12:
  if (sub_100172780(a1, &v34))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"no waiting channel found for completed ACL link %: %!",  v24,  v25,  v26,  v27,  v28,  v29,  v30,  a1);
      uint64_t v31 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    if (*(_BYTE *)(sub_10017AB4C(v34) + 16) || *(_BYTE *)(sub_10017AB4C(v34) + 25) != 1) {
      sub_1001EE2A0();
    }
    *(void *)sub_10017AB4C(v34) = v13;
    *(_BYTE *)(sub_10017AB4C(v34) + 25) = 2;
    uint64_t v32 = sub_10017AB4C(v34);
    uint64_t v33 = sub_1001F0324((uint64_t)sub_100175328, v32 + 10, *((__int128 **)v34 + 8), (int *)v34 + 18, 0);
    if ((_DWORD)v33) {
      sub_100176DE8((uint64_t)v34, v33);
    }
  }

void sub_100176DE8(uint64_t a1, uint64_t a2)
{
  if (a1)
  {
    if ((_DWORD)a2)
    {
LABEL_3:
      sub_100173C90(a1, a2);
      return;
    }
  }

  else
  {
    sub_1001EE2A0();
    if ((_DWORD)a2) {
      goto LABEL_3;
    }
  }

  if (*(_DWORD *)a1 == 3)
  {
    __int16 v4 = *(_BYTE **)sub_10017AB4C((unsigned int *)a1);
    char v5 = sub_100196568();
    uint64_t v6 = *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)a1) + 8);
    int v10 = sub_1001967F4("aac", 0xCu, (unsigned int *)a1, v4, v5, v7, v8, v9, v6);
    goto LABEL_10;
  }

  if (!sub_100185C6C((unsigned int *)a1) || sub_100185B88((unsigned int *)a1))
  {
    uint64_t v11 = *(_BYTE **)sub_10017AB4C((unsigned int *)a1);
    char v12 = sub_100196568();
    int v10 = sub_1001967F4("aa", 2u, (unsigned int *)a1, v11, v12, v13, v14, v15, *(unsigned __int16 *)(a1 + 6));
LABEL_10:
    if (!v10)
    {
      *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 16) = 1;
      *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 25) = 0;
    }
  }

void sub_100176F04(uint64_t a1, int a2, uint64_t a3, char a4)
{
  uint64_t v68 = 0LL;
  if (byte_1008E2BB0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Rejecting connect attempt, PTS error code is overriden to %d",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  byte_1008E2BB0);
      uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

uint64_t sub_1001772F0( _BYTE *a1, uint64_t a2, uint64_t a3, char a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10010CAA4((uint64_t)a1, 0x13u);
}

void sub_100177348(uint64_t a1, int a2, __int16 a3, unsigned int a4, uint64_t a5, unsigned int a6)
{
  uint64_t v63 = 0LL;
  memset(v62, 0, 44);
  if (sub_100172404(a1, a6, &v63))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"RecvConnectRsp, unknown identifier 0x%x, ignoring", v11, v12, v13, v14, v15, v16, v17, a6);
      uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (!sub_10017AB4C(v63))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v27, v28, v29, v30, v31, v32, v33, v61);
    uint64_t v34 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_13;
  }

  if (*(void *)sub_10017AB4C(v63) == a1)
  {
    if (*(_BYTE *)(sub_10017AB4C(v63) + 16) == 1)
    {
      if (a4 <= 1 && *((unsigned __int16 *)v63 + 2) != a2)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"RecvConnectRsp, wrong source CID (s/b %d, rcvd %d).  Dropping connection",  v43,  v44,  v45,  v46,  v47,  v48,  v49,  *((unsigned __int16 *)v63 + 2));
          __int16 v50 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        uint64_t v51 = v63;
        uint64_t v52 = 454LL;
        goto LABEL_35;
      }

      *(_WORD *)(sub_10017AB4C(v63) + 8) = a3;
      *(_BYTE *)(sub_10017AB4C(v63) + 25) = 3;
      if (a4 == 1)
      {
        uint64_t v53 = v63;
        uint64_t v54 = sub_1001EDBA0(0x2Fu);
        sub_10019658C(v53, *(unsigned __int16 *)(v54 + 8));
        return;
      }

      if (!a4)
      {
        uint64_t v55 = v62;
        int v56 = sub_100185AF0(v63, 1LL, (uint64_t)v62);
        if (v56 != 1)
        {
          if (v56 == 2)
          {
            uint64_t v51 = v63;
            uint64_t v52 = 461LL;
            goto LABEL_35;
          }

          uint64_t v55 = 0LL;
        }

        sub_10017764C(v63);
        __int128 v57 = v63;
        __int16 v58 = *(_WORD *)(sub_10017AB4C(v63) + 36);
        int v59 = *(unsigned __int16 *)(sub_10017AB4C(v63) + 38);
        uint64_t v60 = sub_10017AB4C(v63);
        sub_1001776FC(v57, v58, v59, *(unsigned __int16 *)(v60 + 40), (uint64_t)v55);
        return;
      }

      uint64_t v51 = v63;
      uint64_t v52 = a4 + 450;
LABEL_35:
      sub_100173C90((uint64_t)v51, v52);
      return;
    }

    sub_1001EE134((uint64_t)"RecvConnectRsp, unexpected connect RSP, ignoring", v35, v36, v37, v38, v39, v40, v41, v61);
    uint64_t v42 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_13:
    sub_100657858();
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"RecvConnectRsp not excpected for this ACL handle", v19, v20, v21, v22, v23, v24, v25, v61);
    uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_10065C570();
    }
  }

uint64_t sub_10017764C(unsigned int *a1)
{
  uint64_t v9 = a1;
  if (!a1) {
    sub_1001EE2A0();
  }
  int v2 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 16);
  uint64_t v3 = sub_10017AB4C(a1);
  if (v2 == 4) {
    char v4 = 5;
  }
  else {
    char v4 = 3;
  }
  *(_BYTE *)(v3 + 16) = v4;
  v8[0] = 0LL;
  *(_BYTE *)(sub_10017AB4C(a1) + 26) = 0;
  *(_BYTE *)(sub_10017AB4C(a1) + 27) = 0;
  v8[1] = &v9;
  LOWORD(v8[0]) = 8;
  int v5 = *(unsigned __int16 *)(sub_1001EDBA0(0x2Fu) + 10);
  uint64_t v6 = sub_10017AB4C(v9);
  return sub_1001EE6E8((uint64_t)sub_10017989C, v8, v5, (int *)(v6 + 80));
}

uint64_t sub_1001776FC(unsigned int *a1, __int16 a2, int a3, int a4, uint64_t a5)
{
  if (*(_BYTE *)(sub_10017AB4C(a1) + 16) != 4
    && *(_BYTE *)(sub_10017AB4C(a1) + 16) != 3
    && *(_BYTE *)(sub_10017AB4C(a1) + 16) != 5)
  {
    if (sub_1000A86F0())
    {
      uint64_t v40 = sub_10017AB4C(a1);
      sub_1001EE134( (uint64_t)"invalid state for config (%d)",  v41,  v42,  v43,  v44,  v45,  v46,  v47,  *(unsigned __int8 *)(v40 + 16));
      uint64_t v48 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 408LL;
  }

  sub_10017AB4C(a1);
  sub_10017AB4C(a1);
  *(_WORD *)(sub_10017AB4C(a1) + 36) = a2;
  *(_WORD *)(sub_10017AB4C(a1) + 38) = a3;
  uint64_t v10 = (uint64_t *)sub_10017AB4C(a1);
  uint64_t v11 = sub_10018A690(*v10);
  if (!(_DWORD)v11)
  {
    if ((a3 - 1) <= 0xFFFD)
    {
      uint64_t v22 = (uint64_t *)sub_10017AB4C(a1);
      uint64_t v29 = sub_1001214B4(85, (uint64_t)sub_100179AAC, v23, v24, v25, v26, v27, v28, *v22);
      if ((_DWORD)v29)
      {
        uint64_t v12 = v29;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Write flushTO failed %!", v30, v31, v32, v33, v34, v35, v36, v12);
          uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
            goto LABEL_7;
          }
        }

        return v12;
      }
    }

    if (a4 != 0xFFFF)
    {
      uint64_t v38 = (uint64_t *)sub_10017AB4C(a1);
      uint64_t v12 = sub_100173B8C(*v38);
      if ((_DWORD)v12) {
        return v12;
      }
    }

    if (*(_BYTE *)(sub_10017AB4C(a1) + 25) != 3)
    {
      if (!a5) {
        goto LABEL_42;
      }
      goto LABEL_44;
    }

    if (*a1 != 4 && *a1 != 2) {
      goto LABEL_41;
    }
    uint64_t v39 = a1;
    if (!*(_WORD *)(sub_10017AB4C(a1) + 38))
    {
      uint64_t v39 = (unsigned int *)sub_100171DAC();
      if (!*(_WORD *)(sub_1001EDBA0(0x2Fu) + 2)) {
        goto LABEL_41;
      }
      unsigned int v49 = 0;
      while (1)
      {
        if (v39 != a1 && (*v39 == 4 || *v39 == 2))
        {
          uint64_t v51 = *(void *)sub_10017AB4C(a1);
          if (v51 != *(void *)sub_10017AB4C(v39)
            && *(_WORD *)(sub_10017AB4C(v39) + 38)
            && (*(__int16 *)(sub_10017AB4C(v39) + 38) != -1 || (byte_1008F6D2A & 0x40) == 0))
          {
            break;
          }
        }

        ++v49;
        v39 += 36;
      }
    }

    if (*(_WORD *)(sub_10017AB4C(v39) + 38) != 0xFFFF)
    {
      if (!a5)
      {
LABEL_42:
        if (*(_BYTE *)(sub_10017AB4C(a1) + 52))
        {
          sub_10017AB4C(a1);
          sub_10017AB4C(a1);
          sub_10017AB4C(a1);
          sub_10017AB4C(a1);
        }
      }

void sub_100177B78(uint64_t a1, char a2, unsigned int a3, int a4, uint64_t a5)
{
  uint64_t v116 = 0LL;
  __int16 v115 = *(_WORD *)(sub_1001EDBA0(0x28u) + 8);
  __int16 v114 = -1;
  char v113 = 1;
  memset(v112, 0, 44);
  if (sub_100171EC4(a3, (uint64_t *)&v116))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"cid %d not found %!", v10, v11, v12, v13, v14, v15, v16, a3);
      uint64_t v17 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
      {
LABEL_16:
        sub_100657858();
        return;
      }
    }

    return;
  }

  if (*v116 != 2)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Ignoring configuration request on non-connection channel %d",  v26,  v27,  v28,  v29,  v30,  v31,  v32,  a3);
      uint64_t v33 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
        goto LABEL_16;
      }
    }

    return;
  }

  if (!sub_10017AB4C(v116))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid packets.", v34, v35, v36, v37, v38, v39, v40, v110);
      uint64_t v41 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
        goto LABEL_16;
      }
    }

    return;
  }

  if (*(void *)sub_10017AB4C(v116) != a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ConnectMan_RecvConfigReq unexpected CID", v18, v19, v20, v21, v22, v23, v24, v110);
      uint64_t v25 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_10065C5D8();
      }
    }

    return;
  }

  uint64_t v42 = v116;
  if (*v116 == 2)
  {
    int v43 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 16);
    uint64_t v42 = v116;
    if (v43 == 3)
    {
      int v44 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 26);
      uint64_t v42 = v116;
      if (!v44)
      {
        int v45 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 27);
        uint64_t v42 = v116;
        if (!v45)
        {
          int v46 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 24);
          uint64_t v42 = v116;
          if (v46)
          {
            uint64_t v47 = sub_10017AB4C(v116);
            sub_1001EEB14(*(unsigned int *)(v47 + 80));
            sub_10017764C(v116);
            uint64_t v42 = v116;
          }
        }
      }
    }
  }

  if (*(_BYTE *)(sub_10017AB4C(v42) + 16) == 4) {
    sub_10017764C(v116);
  }
  if ((*(_BYTE *)(sub_10017AB4C(v116) + 16) == 3 || *(_BYTE *)(sub_10017AB4C(v116) + 16) == 5)
    && !*(_BYTE *)(sub_10017AB4C(v116) + 27))
  {
    int v48 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 16);
    if ((*(_BYTE *)a5 & 1) != 0)
    {
      if (*(unsigned __int16 *)(a5 + 4) < 0x30u
        || *(_BYTE *)(sub_10017AB4C(v116) + 16) == 5
        && (unsigned int v50 = *(unsigned __int16 *)(a5 + 4), v50 < *(unsigned __int16 *)(sub_10017AB4C(v116) + 32)))
      {
        uint64_t v111 = &v115;
        int v49 = 1;
      }

      else
      {
        __int16 v51 = *(_WORD *)(a5 + 4);
        *(_WORD *)(sub_10017AB4C(v116) + 32) = v51;
        int v49 = 0;
        uint64_t v111 = (__int16 *)(sub_10017AB4C(v116) + 32);
      }
    }

    else
    {
      int v49 = 0;
      uint64_t v111 = 0LL;
    }

    int v52 = *(_DWORD *)a5;
    if ((*(_DWORD *)a5 & 2) != 0)
    {
      if (*(_WORD *)(a5 + 6))
      {
        __int16 v53 = *(_WORD *)(a5 + 6);
        *(_WORD *)(sub_10017AB4C(v116) + 34) = v53;
        int v52 = *(_DWORD *)a5;
      }

      else
      {
        int v49 = 1;
      }
    }

    int v54 = sub_100185D48();
    if ((v52 & 0x10) == 0)
    {
      if (!v54 || (*(_BYTE *)(a1 + 229) & 0x20) == 0)
      {
LABEL_55:
        if ((*(_DWORD *)a5 & 8) != 0)
        {
          int v65 = sub_100185D64(v116, a5, 1LL, (uint64_t)v112);
          int v49 = v65;
          if ((*(_BYTE *)a5 & 0x10) != 0)
          {
            if (v65 == 2)
            {
              uint64_t v64 = 0LL;
            }

            else if (BYTE10(v112[0]) - 3 <= 1 && sub_100185D48())
            {
              char v67 = *(_BYTE *)(a1 + 229);
              uint64_t v64 = v112;
              if ((v67 & 0x20) != 0) {
                goto LABEL_75;
              }
            }

            else
            {
              uint64_t v64 = v112;
            }

            goto LABEL_74;
          }

          if (v65 == 2)
          {
            uint64_t v64 = 0LL;
          }

          else if (BYTE10(v112[0]) - 3 <= 1 && sub_100185D48())
          {
            char v66 = *(_BYTE *)(a1 + 229);
            uint64_t v64 = v112;
            if ((v66 & 0x20) != 0) {
              goto LABEL_75;
            }
          }

          else
          {
            uint64_t v64 = v112;
          }
        }

        else
        {
          uint64_t v64 = 0LL;
          if ((*(_DWORD *)a5 & 0x10) != 0)
          {
LABEL_74:
            *(_BYTE *)(sub_10017AB4C(v116) + 78) = 0;
            sub_10017AB4C(v116);
            goto LABEL_75;
          }
        }

        *(_BYTE *)(sub_10017AB4C(v116) + 78) = 0;
LABEL_75:
        if ((*(_BYTE *)a5 & 0x20) != 0 && *(unsigned __int8 *)(a5 + 25) > 1u)
        {
          int v78 = v48;
          int v79 = 0;
          BOOL v80 = 0;
          int v49 = 1;
        }

        else
        {
          if (v49 == 2)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"Critical negotiation : disconnecting.", v68, v69, v70, v71, v72, v73, v74, v110);
              uint64_t v75 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v75, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v76 = v116;
            uint64_t v77 = 452LL;
LABEL_82:
            sub_100175C0C(v76, v77);
            return;
          }

          int v78 = v48;
          int v79 = 0;
          BOOL v80 = v49 == 0;
          if (!v49 && !a4)
          {
            int v49 = 0;
            int v79 = 1;
            *(_BYTE *)(sub_10017AB4C(v116) + 27) = 1;
            BOOL v80 = 1;
          }
        }

        *(_BYTE *)(sub_10017AB4C(v116) + 29) = a2;
        if (v111) {
          *(_BYTE *)(sub_10017AB4C(v116) + 31) = 1;
        }
        if ((a4 & 1) == 0)
        {
          int v81 = *(unsigned __int8 *)(sub_10017AB4C(v116) + 31);
          uint64_t v82 = sub_10017AB4C(v116);
          if (v81) {
            *(_BYTE *)(v82 + 31) = 0;
          }
        }

        if (!v64)
        {
          uint64_t v64 = v112;
          int v97 = sub_100185AF0(v116, 1LL, (uint64_t)v112);
          if (v97 != 1)
          {
            if (v97 == 2)
            {
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Critical negotiation : disconnecting.",  v98,  v99,  v100,  v101,  v102,  v103,  v104,  v110);
                uint64_t v105 = (os_log_s *)sub_100086554(0x2Fu);
                if (os_log_type_enabled(v105, OS_LOG_TYPE_ERROR)) {
                  sub_100657858();
                }
              }

              uint64_t v76 = v116;
              if (v80) {
                uint64_t v77 = 0LL;
              }
              else {
                uint64_t v77 = (v49 + 450);
              }
              goto LABEL_82;
            }

            uint64_t v64 = 0LL;
          }
        }

        sub_100178354(v116, v49, a4);
        if (v79)
        {
          if (*(_BYTE *)(sub_10017AB4C(v116) + 26) == 3)
          {
            if (v78 != 5)
            {
              uint64_t v83 = *(unsigned __int16 *)(sub_10017AB4C(v116) + 32);
              uint64_t v84 = sub_100189724(*((unsigned __int16 *)v116 + 2));
              if ((_DWORD)v84)
              {
                uint64_t v85 = v84;
                if (sub_1000A86F0())
                {
                  sub_1001EE134( (uint64_t)"Queue Tag serviced failed with status %!",  v86,  v87,  v88,  v89,  v90,  v91,  v92,  v85);
                  uint64_t v93 = (os_log_s *)sub_100086554(0x2Fu);
                  if (os_log_type_enabled(v93, OS_LOG_TYPE_ERROR)) {
                    sub_100657858();
                  }
                }
              }

              uint64_t v94 = *(void (**)(uint64_t, void, uint64_t, void))(sub_10017AB4C(v116) + 96);
              uint64_t v95 = *((unsigned __int16 *)v116 + 2);
              uint64_t v96 = sub_10017AB4C(v116);
              v94(v95, *(unsigned __int16 *)(v96 + 36), v83, 0LL);
            }
          }

          else if (!*(_BYTE *)(sub_10017AB4C(v116) + 26))
          {
            uint64_t v106 = v116;
            __int16 v107 = *(_WORD *)(sub_10017AB4C(v116) + 36);
            int v108 = *(unsigned __int16 *)(sub_10017AB4C(v116) + 38);
            uint64_t v109 = sub_10017AB4C(v116);
            sub_1001776FC(v106, v107, v108, *(unsigned __int16 *)(v109 + 40), (uint64_t)v64);
          }
        }

        return;
      }

      *(_BYTE *)(sub_10017AB4C(v116) + 78) = 1;
LABEL_54:
      sub_10017AB4C(v116);
      goto LABEL_55;
    }

    if ((v54 & 1) != 0)
    {
      unsigned int v55 = *(unsigned __int8 *)(a5 + 20);
      if (v55 <= 1)
      {
        *(_BYTE *)(sub_10017AB4C(v116) + 78) = v55;
        goto LABEL_54;
      }
    }

    else if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"We don't support FCS.", v56, v57, v58, v59, v60, v61, v62, v110);
      uint64_t v63 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    int v49 = 1;
    goto LABEL_55;
  }

uint64_t sub_100178354(unsigned int *a1, int a2, char a3)
{
  uint64_t v6 = *(_BYTE **)sub_10017AB4C(a1);
  char v7 = *(_BYTE *)(sub_10017AB4C(a1) + 29);
  uint64_t v8 = sub_10017AB4C(a1);
  uint64_t result = sub_1001967F4("aaamsfro", 5u, 0LL, v6, v7, v9, v10, v11, *(unsigned __int16 *)(v8 + 8));
  if (!a2 && (a3 & 1) == 0)
  {
    *(_BYTE *)(sub_10017AB4C(a1) + 27) = 3;
    uint64_t result = sub_10017AB4C(a1);
    if (*(_BYTE *)(result + 26) == 3)
    {
      uint64_t v13 = sub_10017AB4C(a1);
      sub_1001EEB14(*(unsigned int *)(v13 + 80));
      *(_BYTE *)(sub_10017AB4C(a1) + 16) = 4;
      *(_BYTE *)(sub_10017AB4C(a1) + 25) = 0;
      uint64_t result = sub_10017AB4C(a1);
      *(_BYTE *)(result + 28) = 0;
    }
  }

  return result;
}

void sub_100178498( uint64_t a1, uint64_t a2, unsigned int a3, char a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, char *a9, __int16 a10)
{
  uint64_t v69 = 0LL;
  memset(v68, 0, 44);
  if (sub_100171EC4(a3, (uint64_t *)&v69))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"cid %d not found %!", v14, v15, v16, v17, v18, v19, v20, a3);
      uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (!sub_10017AB4C(v69))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v30, v31, v32, v33, v34, v35, v36, v67);
    uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_13:
    sub_100657858();
    return;
  }

  if (*(void *)sub_10017AB4C(v69) != a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ConnectMan_RecvConfigRsp unexpected CID", v22, v23, v24, v25, v26, v27, v28, v67);
      uint64_t v29 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_10065C5D8();
      }
    }

    return;
  }

  if (*(_BYTE *)(sub_10017AB4C(v69) + 16) != 3 && *(_BYTE *)(sub_10017AB4C(v69) + 16) != 5
    || *(_BYTE *)(sub_10017AB4C(v69) + 26) != 2)
  {
    sub_1001EE134((uint64_t)"Invalid state for configuration", v39, v40, v41, v42, v43, v44, v45, v67);
    int v46 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_13;
  }

  if (a10)
  {
    if (a8) {
      LODWORD(a8) = sub_100185D64(v69, a8, 0LL, (uint64_t)v68);
    }
    if (a9) {
      char v38 = *a9;
    }
    else {
      char v38 = 0;
    }
    *(_BYTE *)(sub_10017AB4C(v69) + 78) = v38;
    if ((_DWORD)a8 != 2)
    {
      uint64_t v57 = v69;
      __int16 v58 = *(_WORD *)(sub_10017AB4C(v69) + 36);
      int v59 = *(unsigned __int16 *)(sub_10017AB4C(v69) + 38);
      uint64_t v60 = sub_10017AB4C(v69);
      sub_1001776FC(v57, v58, v59, *(unsigned __int16 *)(v60 + 40), (uint64_t)v68);
      return;
    }

    int v47 = 2;
  }

  else
  {
    int v47 = 0;
  }

  uint64_t v48 = sub_10017AB4C(v69);
  if (a10)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"config rsp = %!\n", v49, v50, v51, v52, v53, v54, v55, v47 | 0x1CCu);
      uint64_t v56 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_100175C0C(v69, (v47 + 450));
  }

  else
  {
    int v61 = *(unsigned __int8 *)(v48 + 16);
    if ((a4 & 1) == 0)
    {
      *(_BYTE *)(sub_10017AB4C(v69) + 26) = 3;
      if (*(_BYTE *)(sub_10017AB4C(v69) + 27) == 3)
      {
        *(_BYTE *)(sub_10017AB4C(v69) + 16) = 4;
        *(_BYTE *)(sub_10017AB4C(v69) + 25) = 0;
        uint64_t v62 = sub_10017AB4C(v69);
        sub_1001EEB14(*(unsigned int *)(v62 + 80));
        *(_BYTE *)(sub_10017AB4C(v69) + 28) = 0;
      }
    }

    if (*(_BYTE *)(sub_10017AB4C(v69) + 26) == 3 && *(_BYTE *)(sub_10017AB4C(v69) + 27) == 3 && v61 != 5)
    {
      uint64_t v63 = *(unsigned __int16 *)(sub_10017AB4C(v69) + 32);
      uint64_t v64 = *(void (**)(uint64_t, void, uint64_t, void))(sub_10017AB4C(v69) + 96);
      uint64_t v65 = *((unsigned __int16 *)v69 + 2);
      uint64_t v66 = sub_10017AB4C(v69);
      v64(v65, *(unsigned __int16 *)(v66 + 36), v63, 0LL);
    }
  }

void sub_10017883C(_BYTE *a1, unsigned int a2, uint64_t a3, uint64_t a4)
{
  int v47 = 0LL;
  if (sub_100171EC4(a2, (uint64_t *)&v47))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"No channel exists for CID %d (%!)", v8, v9, v10, v11, v12, v13, v14, a2);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_100198178(a1, 2u, 0, a2, a3, a4, v13, v14);
    return;
  }

  if (!sub_10017AB4C(v47))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v24, v25, v26, v27, v28, v29, v30, v46);
    uint64_t v31 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_15:
    sub_100657858();
    return;
  }

  if (*(unsigned __int16 *)(sub_10017AB4C(v47) + 8) != (_DWORD)a3)
  {
    sub_1001EE134((uint64_t)"Invalid source CID %d", v32, v33, v34, v35, v36, v37, v38, a3);
    uint64_t v39 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_15;
  }

  if (*(_BYTE **)sub_10017AB4C(v47) == a1)
  {
    *(_BYTE *)(sub_10017AB4C(v47) + 29) = a4;
    uint64_t v40 = *(_BYTE **)sub_10017AB4C(v47);
    char v41 = *(_BYTE *)(sub_10017AB4C(v47) + 29);
    uint64_t v42 = *((unsigned __int16 *)v47 + 2);
    sub_10017AB4C(v47);
    sub_1001967F4("aa", 7u, 0LL, v40, v41, v43, v44, v45, v42);
    sub_100173C90((uint64_t)v47, 431LL);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"OI_ConnectMan_RecvDisconnectReq unexpected CID", v16, v17, v18, v19, v20, v21, v22, v46);
    uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      sub_10065C5D8();
    }
  }

void sub_100178A54(__int128 *a1, unsigned int a2, uint64_t a3, char a4)
{
  uint64_t v45 = 0LL;
  if (sub_100171EC4(a2, (uint64_t *)&v45))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"No channel exists for CID %d (%!)", v8, v9, v10, v11, v12, v13, v14, a2);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001CAB70(a1, 2, 0, a2, a3, a4);
    return;
  }

  if (!sub_10017AB4C(v45))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v24, v25, v26, v27, v28, v29, v30, v44);
    uint64_t v31 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_15:
    sub_100657858();
    return;
  }

  if (*(unsigned __int16 *)(sub_10017AB4C(v45) + 8) != (_DWORD)a3)
  {
    sub_1001EE134((uint64_t)"Invalid source CID %d", v32, v33, v34, v35, v36, v37, v38, a3);
    uint64_t v39 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_15;
  }

  if (*(__int128 **)sub_10017AB4C(v45) == a1)
  {
    *(_BYTE *)(sub_10017AB4C(v45) + 29) = a4;
    uint64_t v40 = *(__int128 **)sub_10017AB4C(v45);
    char v41 = *(_BYTE *)(sub_10017AB4C(v45) + 29);
    __int16 v42 = *((_WORD *)v45 + 2);
    uint64_t v43 = sub_10017AB4C(v45);
    sub_1001CAF04(v40, v41, v42, *(_WORD *)(v43 + 8));
    sub_100173C90((uint64_t)v45, 431LL);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"OI_ConnectMan_RecvDisconnectReq unexpected CID", v16, v17, v18, v19, v20, v21, v22, v44);
    uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      sub_10065C5D8();
    }
  }

void sub_100178C5C(uint64_t a1, int a2, unsigned int a3)
{
  uint64_t v25 = 0LL;
  if (!sub_100171EC4(a3, (uint64_t *)&v25)
    && sub_10017AB4C(v25)
    && *(_BYTE *)(sub_10017AB4C(v25) + 16) == 6
    && *(unsigned __int16 *)(sub_10017AB4C(v25) + 8) == a2
    && *((unsigned __int16 *)v25 + 2) == a3)
  {
    if (*(void *)sub_10017AB4C(v25) == a1)
    {
      *(_BYTE *)(sub_10017AB4C(v25) + 28) = 0;
      uint64_t v22 = v25;
      uint64_t v23 = sub_10017AB4C(v25);
      sub_100173C90((uint64_t)v22, *(unsigned int *)(v23 + 20));
    }

    else if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ConnectMan_RecvDisconnectRsp unexpected CID", v14, v15, v16, v17, v18, v19, v20, v24);
      uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_10065C5D8();
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Invalid packet", v6, v7, v8, v9, v10, v11, v12, v24);
    uint64_t v13 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

void sub_100178DA0(uint64_t a1, unsigned int a2, int a3)
{
  uint64_t v23 = 0LL;
  if (!sub_100171EC4(a2, (uint64_t *)&v23)
    && sub_10017AB4C(v23)
    && *(_BYTE *)(sub_10017AB4C(v23) + 16) == 6
    && *(unsigned __int16 *)(sub_10017AB4C(v23) + 8) == a3
    && *((unsigned __int16 *)v23 + 2) == a2)
  {
    if (*(void *)sub_10017AB4C(v23) == a1)
    {
      sub_100173C90((uint64_t)v23, 436LL);
    }

    else if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE_ConnectMan_RecvDisconnectRsp unexpected CID", v14, v15, v16, v17, v18, v19, v20, v22);
      uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_10065C5D8();
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Invalid packet", v6, v7, v8, v9, v10, v11, v12, v22);
    uint64_t v13 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_100178ECC( uint64_t a1, int a2, __int16 a3, unsigned int a4, int a5, int a6, uint64_t a7, uint64_t a8)
{
  uint64_t v84 = 0LL;
  if (byte_1008E2BB0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Rejecting connect attempt, PTS error code is overriden to %d",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  byte_1008E2BB0);
      uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    __int16 v19 = byte_1008E2BB0;
    uint64_t v20 = (__int128 *)a1;
    char v21 = a7;
    __int16 v22 = a3;
    return sub_1001CA640(v20, v21, v22, 0, 0, 0, v19);
  }

  __int16 v27 = a2;
  if ((a2 - 1) >= 0x7F && (a2 & 0xFF80) != 0x80)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"%! - rejecting connect attempt due to invalid PSM %d",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  582LL);
      uint64_t v35 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

void sub_100179314(uint64_t a1, __int16 a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7)
{
  uint64_t v104 = 0LL;
  if (sub_100172524(a1, a7, &v104))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"RecvLeConnectRsp, unknown identifier 0x%x, ignoring",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  a7);
      char v21 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (!sub_10017AB4C(v104))
  {
    sub_1001EE134((uint64_t)"Invalid packets.", v30, v31, v32, v33, v34, v35, v36, v103);
    uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_13:
    sub_100657858();
    return;
  }

  if (*(void *)sub_10017AB4C(v104) != a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"RecvLeConnectRsp not excpected for this ACL handle",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  v103);
      uint64_t v29 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_10065C570();
      }
    }

    return;
  }

  if (*(_BYTE *)(sub_10017AB4C(v104) + 16) != 1)
  {
    sub_1001EE134( (uint64_t)"RecvLeConnectRsp, unexpected connect RSP, ignoring",  v50,  v51,  v52,  v53,  v54,  v55,  v56,  v103);
    uint64_t v57 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_13;
  }

  if ((a6 - 7) >= 2 && a6 != 5)
  {
    if (a6)
    {
      uint64_t v69 = v104;
      uint64_t v70 = (a6 + 580);
    }

    else
    {
      if ((a2 & 0xFFC0) == 0x40)
      {
        *(_WORD *)(sub_10017AB4C(v104) + 8) = a2;
        if (14 * a4 >= a3) {
          __int16 v38 = a3;
        }
        else {
          __int16 v38 = 14 * a4;
        }
        *(_WORD *)(sub_10017AB4C(v104) + 32) = v38;
        *(_WORD *)(sub_10017AB4C(v104) + 60) = a4;
        unsigned __int16 v39 = sub_10016EC44(v104, a5);
        uint64_t v40 = v39;
        if (v39)
        {
          unsigned __int16 v41 = v39;
          sub_1001EE134((uint64_t)"LE_L2CAP_InitRemoteParams returned %d\n", v42, v43, v44, v45, v46, v47, v48, v40);
          uint64_t v49 = (os_log_s *)sub_100086554(0x2Fu);
          if (!os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
            goto LABEL_51;
          }
        }

        else
        {
          unsigned __int16 v79 = sub_100186230(v104, 5, 0);
          uint64_t v80 = v79;
          if (v79)
          {
            unsigned __int16 v41 = v79;
            sub_1001EE134((uint64_t)"BT_L2CAP_Flow_InitChannel returned %d\n", v81, v82, v83, v84, v85, v86, v87, v80);
            uint64_t v88 = (os_log_s *)sub_100086554(0x2Fu);
            if (!os_log_type_enabled(v88, OS_LOG_TYPE_ERROR)) {
              goto LABEL_51;
            }
          }

          else
          {
            unsigned __int16 v41 = sub_100187CD4(*((unsigned __int16 *)v104 + 2), 15, 5u, 0LL, (uint64_t *)v104 + 12, v104[19]);
            if (!v41) {
              goto LABEL_52;
            }
            if (!sub_1000A86F0()
              || (sub_1001EE134( (uint64_t)"BT_L2CAP_Queue_Register returned %d\n",  v89,  v90,  v91,  v92,  v93,  v94,  v95,  v41),  uint64_t v96 = (os_log_s *)sub_100086554(0x2Fu),  !os_log_type_enabled(v96, OS_LOG_TYPE_ERROR)))
            {
LABEL_51:
              sub_100173C90((uint64_t)v104, 4LL);
LABEL_52:
              if (!v41)
              {
                int v97 = (uint64_t *)sub_10017AB4C(v104);
                uint64_t v98 = sub_10018A690(*v97);
                *(_BYTE *)(sub_10017AB4C(v104) + 16) = 4;
                uint64_t v99 = *(void (**)(uint64_t, uint64_t, void, uint64_t))(sub_10017AB4C(v104) + 96);
                uint64_t v100 = *((unsigned __int16 *)v104 + 2);
                uint64_t v101 = *(unsigned __int16 *)(sub_10017AB4C(v104) + 36);
                uint64_t v102 = sub_10017AB4C(v104);
                v99(v100, v101, *(unsigned __int16 *)(v102 + 32), v98);
              }

              return;
            }
          }
        }

        sub_100657858();
        goto LABEL_51;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"destination CID out of range", v71, v72, v73, v74, v75, v76, v77, v103);
        uint64_t v78 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      uint64_t v69 = v104;
      uint64_t v70 = 9LL;
    }

    sub_100173C90((uint64_t)v69, v70);
    return;
  }

  uint64_t v58 = sub_1000B17F4(2uLL);
  if (!v58)
  {
    sub_1001734D8((uint64_t)v104);
    sub_100173C90((uint64_t)v104, 1164LL);
  }

  *uint64_t v58 = *((_WORD *)v104 + 2);
  int v59 = *(void **)(a1 + 224);
  if (!v59)
  {
    int v59 = sub_1001EC038(0LL, 0LL);
    *(void *)(a1 + 224) = v59;
  }

  sub_1001EC1DC((uint64_t)v59, (uint64_t)v58, 0LL);
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Start Pairing", v60, v61, v62, v63, v64, v65, v66, v103);
    uint64_t v67 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v67, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v68 = sub_1001EDDCC();
      *(_DWORD *)int buf = 136446210;
      uint64_t v106 = v68;
      _os_log_impl((void *)&_mh_execute_header, v67, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1001D377C(a1, 1);
}

uint64_t sub_100179804(uint64_t a1, __int16 a2)
{
  uint64_t v2 = 0LL;
  while (qword_1008E2B80[v2] != a1)
  {
    v2 += 2LL;
    if (v2 == 6) {
      goto LABEL_6;
    }
  }

  qword_1008E2B80[v2] = 0LL;
LABEL_6:
  uint64_t v3 = 0LL;
  while (1)
  {
    uint64_t v4 = qword_1008E2B80[v3];
    if (!v4) {
      break;
    }
    v3 += 2LL;
    if (v3 == 6) {
      return 104LL;
    }
  }

  int v5 = &qword_1008E2B80[v3];
  *int v5 = a1;
  *((_WORD *)v5 + 4) = a2;
  return v4;
}

uint64_t sub_100179864(uint64_t a1)
{
  uint64_t v1 = 0LL;
  while (qword_1008E2B80[v1] != a1)
  {
    v1 += 2LL;
    if (v1 == 6) {
      return 404LL;
    }
  }

  uint64_t result = 0LL;
  qword_1008E2B80[v1] = 0LL;
  return result;
}

uint64_t sub_10017989C(uint64_t a1)
{
  uint64_t v1 = **(void **)(a1 + 8);
  if (v1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"L2CAP Config Timeout on cid %d, psm %d",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  *(unsigned __int16 *)(v1 + 4));
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    sub_1001EE2A0();
  }

  if (*(_DWORD *)v1 != 2
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v1) + 16) != 3
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v1) + 26)
    || *(_BYTE *)(sub_10017AB4C((unsigned int *)v1) + 27)
    || !*(_BYTE *)(sub_10017AB4C((unsigned int *)v1) + 24))
  {
    if (sub_1000A86F0())
    {
      if (*(_DWORD *)v1 == 2)
      {
        uint64_t v17 = sub_10017AB4C((unsigned int *)v1);
        uint64_t v25 = (const char *)sub_1001EDE10(v17 + 10, v18, v19, v20, v21, v22, v23, v24);
      }

      else
      {
        uint64_t v25 = "group";
      }

      sub_1001EE134( (uint64_t)"Configuration process timed out, remote device %s",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  (uint64_t)v25);
      uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    uint64_t v27 = 464LL;
    return sub_100175C0C((unsigned int *)v1, v27);
  }

  sub_10017764C(v1);
  __int16 v29 = *(_WORD *)(sub_10017AB4C((unsigned int *)v1) + 36);
  int v30 = *(unsigned __int16 *)(sub_10017AB4C((unsigned int *)v1) + 38);
  uint64_t v31 = sub_10017AB4C((unsigned int *)v1);
  uint64_t result = sub_1001776FC((unsigned int *)v1, v29, v30, *(unsigned __int16 *)(v31 + 40), 0LL);
  if ((_DWORD)result)
  {
    uint64_t v27 = result;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"ConfigReqHelper failed %!", v32, v33, v34, v35, v36, v37, v38, v27);
      unsigned __int16 v39 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return sub_100175C0C((unsigned int *)v1, v27);
  }

  return result;
}

void sub_100179AAC(uint64_t a1)
{
  if ((_DWORD)a1 && sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Failed to write FlushTO %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_100179B50(_BYTE *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v48 = 0LL;
  if (!a3) {
    sub_1001EE2A0();
  }
  int v49 = 0;
  memset(v39, 0, sizeof(v39));
  __int128 v40 = 0u;
  __int128 v41 = 0u;
  __int128 v42 = 0u;
  __int128 v43 = 0u;
  __int128 v44 = 0u;
  __int128 v45 = 0u;
  __int128 v46 = 0u;
  uint64_t v47 = 0LL;
  if ((_DWORD)a2 == 2)
  {
    unsigned int v6 = *(unsigned __int16 *)(a3 + 4);
    sub_1001EF520((uint64_t)&v40 + 8, 2u);
    char v7 = v6;
    unsigned int v8 = v6 >> 8;
    goto LABEL_5;
  }

  uint64_t v9 = sub_100171EC4(a2, (uint64_t *)&v48);
  if ((_DWORD)v9) {
    return v9;
  }
  if (*v48 == 3)
  {
    unsigned int v10 = *(unsigned __int16 *)(a3 + 4);
    if (v10 <= *(unsigned __int16 *)sub_10017AF44(v48))
    {
      sub_1001EF520((uint64_t)&v40 + 8, 2u);
      if ((_DWORD)a2 == 43)
      {
        LOBYTE(v39[0]) = a1[129] == 0;
LABEL_17:
        sub_1001EFC20((unsigned __int8 *)&v40 + 8, a3);
        if (v48)
        {
          uint64_t v20 = *((void *)v48 + 16);
          *((void *)v48 + 16) = 0LL;
        }

        else
        {
          uint64_t v20 = 0LL;
        }

        *(void *)&__int128 v40 = v20;
        uint64_t v21 = sub_10018A8DC((uint64_t)v39, a1, 0, a2);
        uint64_t v9 = v21;
        if ((_DWORD)v21)
        {
          if ((_DWORD)v21 != 412)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"OI_ConnectMan_WriteMBUF %!", v22, v23, v24, v25, v26, v27, v28, v9);
              __int16 v29 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }
          }

          sub_1001EF5E4((uint64_t)&v40 + 8);
        }

        return v9;
      }

      char v7 = v10;
      unsigned int v8 = v10 >> 8;
LABEL_5:
      LOBYTE(v49) = v7;
      BYTE1(v49) = v8;
      HIWORD(v49) = a2;
      sub_1001EFB10((unsigned __int8 *)&v40 + 8, (char *)&v49, 4uLL, 0);
      if ((_DWORD)a2 == 2)
      {
        LOBYTE(v39[0]) = 1;
        *(void *)&__int128 v41 = 0LL;
        if (v48)
        {
          *(void *)&__int128 v40 = *((void *)v48 + 16);
          *((void *)v48 + 16) = 0LL;
        }

        else
        {
          *(void *)&__int128 v40 = 0LL;
        }
      }

      else
      {
        LOBYTE(v39[0]) = *(__int16 *)(sub_10017AF44(v48) + 2) == -1;
        *(void *)&__int128 v41 = v48;
      }

      goto LABEL_17;
    }

    if (sub_1000A86F0())
    {
      uint64_t v11 = (unsigned __int16 *)sub_10017AF44(v48);
      sub_1001EE134((uint64_t)"MTU size (%d) exceeded! - data length = %d", v12, v13, v14, v15, v16, v17, v18, *v11);
      uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 472LL;
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"CID %d is not a fixed channel", v30, v31, v32, v33, v34, v35, v36, a2);
      uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 532LL;
  }

void sub_100179E18(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  __int128 v46 = 0LL;
  if (sub_100171EC4(a2, (uint64_t *)&v46))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Can't find channel %d, dropping packet.", v10, v11, v12, v13, v14, v15, v16, a2);
      uint64_t v17 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    uint64_t v18 = v46;
    v46[21] += a4;
    if ((*(_BYTE *)(sub_10017AF44(v18) + 4) & 1) != 0 && !*(_BYTE *)(a1 + 2)
      || (*(_BYTE *)(sub_10017AF44(v46) + 4) & 2) != 0 && *(_BYTE *)(a1 + 2) == 4)
    {
      uint64_t v19 = sub_10017AF44(v46);
      (*(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v19 + 24))(a1, a3, a4, a5);
    }

    else
    {
      sub_1001EE2A0();
      if (sub_1000A86F0())
      {
        sub_10017AF44(v46);
        sub_1001EE134( (uint64_t)"Fixed Channel 0x%x on wrong physical link 0x%x, should be 0x%x",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  a2);
        uint64_t v34 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
          sub_100657F08();
        }
      }

      uint64_t v35 = sub_100128D24(5u, v20, v21, v22, v23, v24, v25, v26, a1);
      uint64_t v36 = sub_100136C78(a1, v35);
      if ((_DWORD)v36)
      {
        uint64_t v37 = v36;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Disconnect failed with status %!", v38, v39, v40, v41, v42, v43, v44, v37);
          __int128 v45 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
            sub_100657F08();
          }
        }
      }
    }
  }

uint64_t sub_100179FE4()
{
  uint64_t v0 = (unsigned __int16 *)sub_1001EDBA0(0x2Fu);
  qword_1008E2BB8 = (uint64_t)sub_1000B1814(16LL * *v0);
  if (qword_1008E2BB8) {
    return 0LL;
  }
  else {
    return 106LL;
  }
}

uint64_t sub_10017A01C(unsigned int a1, uint64_t a2)
{
  uint64_t v10 = 0LL;
  if (a2)
  {
    uint64_t v4 = *(void **)sub_10017AEA0(v10);
    if (!v4) {
      return 434LL;
    }
    if (*(_DWORD *)v4 != *(_DWORD *)a2 || *((unsigned __int16 *)v4 + 2) != *(unsigned __int16 *)(a2 + 4))
    {
      while (1)
      {
        unsigned int v6 = v4;
        uint64_t v4 = (void *)v4[2];
        if (!v4) {
          return 434LL;
        }
      }
    }

    unsigned int v6 = 0LL;
LABEL_18:
    uint64_t v8 = v4[2];
    if (v6) {
      uint64_t v9 = v6 + 2;
    }
    else {
      uint64_t v9 = (void *)sub_10017AEA0(v10);
    }
    void *v9 = v8;
    sub_10010CAA4(v4[1], 0x13u);
    sub_1000B1838(v4);
    return 0LL;
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

uint64_t sub_10017A0F8(uint64_t a1, __int128 *a2, uint64_t a3)
{
  if (!a3) {
    sub_1001EE2A0();
  }
  uint64_t v18 = 0LL;
  __int128 v16 = 0u;
  __int128 v17 = 0u;
  __int128 v14 = 0u;
  __int128 v15 = 0u;
  __int128 v12 = 0u;
  __int128 v13 = 0u;
  __int128 v11 = 0u;
  memset(v10, 0, sizeof(v10));
  if (a2)
  {
    int v6 = 0;
  }

  else
  {
    int v6 = 2;
  }

  v19[0] = *(_WORD *)(a3 + 4) + 2;
  v19[1] = 2;
  v19[2] = *(_WORD *)(a1 + 6);
  sub_1001EF520((uint64_t)&v11 + 8, 2u);
  sub_1001EFB10((unsigned __int8 *)&v11 + 8, (char *)v19, 6uLL, 0);
  sub_1001EFC20((unsigned __int8 *)&v11 + 8, a3);
  LOBYTE(v10[0]) = 0;
  *(void *)&__int128 v11 = 0LL;
  *(void *)&__int128 v12 = a1;
  if (a2) {
    char v7 = a2;
  }
  else {
    char v7 = &xmmword_1008E2428;
  }
  uint64_t v8 = sub_10018A8DC((uint64_t)v10, v7, v6, *(_WORD *)(a1 + 4));
  if ((_DWORD)v8) {
    sub_1001EF5E4((uint64_t)&v11 + 8);
  }
  return v8;
}

void sub_10017A21C(uint64_t a1, _WORD *a2, unsigned int a3)
{
  if (a3 >= 6)
  {
    if (!a2) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/group.c",  509,  "buf");
    }
    __int16 v4 = a3;
    uint64_t v5 = (unsigned __int16)*a2;
    if (!*a2)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"psm should be non-zero", v6, v7, v8, v9, v10, v11, v12, v19);
        __int128 v13 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
          sub_100657FDC(v13);
        }
      }
    }

    if (*(_WORD *)sub_1001EDBA0(0x2Fu))
    {
      uint64_t v14 = 0LL;
      unint64_t v15 = 0LL;
      __int128 v16 = a2 + 1;
      uint64_t v17 = (unsigned __int16)(v4 - 2);
      do
      {
        if ((_DWORD)v5 == *(unsigned __int16 *)(qword_1008E2BB8 + v14))
        {
          uint64_t v18 = *(void (**)(uint64_t, _WORD *, uint64_t))(qword_1008E2BB8 + v14 + 8);
          if (v18) {
            v18(v5, v16, v17);
          }
        }

        ++v15;
        v14 += 16LL;
      }

      while (v15 < *(unsigned __int16 *)sub_1001EDBA0(0x2Fu));
    }
  }

uint64_t sub_10017A328(uint64_t a1)
{
  if (a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_L2CAP_Init: configuration parameter is deprecated", v2, v3, v4, v5, v6, v7, v8, v67);
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EDBE4(a1, 47LL);
  }

  if (HIDWORD(xmmword_1008F6FB8)) {
    return 0LL;
  }
  if (!sub_1001EDBA0(0x2Fu)) {
    sub_1001EE2A0();
  }
  if (!sub_1001EDBA0(0x2Fu)) {
    return 127LL;
  }
  uint64_t v12 = (unsigned __int16 *)sub_1001EDBA0(0x2Fu);
  qword_1008E2BC0 = (uint64_t)sub_1000B1814(32LL * *v12);
  if (!qword_1008E2BC0) {
    return 106LL;
  }
  uint64_t v13 = sub_100171DB8();
  if ((_DWORD)v13)
  {
    uint64_t v10 = v13;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_ChanMan_Init failed %!", v14, v15, v16, v17, v18, v19, v20, v10);
      uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
LABEL_39:
      }
        sub_100657858();
    }
  }

  else
  {
    uint64_t v22 = sub_100179FE4();
    if ((_DWORD)v22)
    {
      uint64_t v10 = v22;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"OI_GroupMan_Init failed %!", v23, v24, v25, v26, v27, v28, v29, v10);
        uint64_t v30 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
          goto LABEL_39;
        }
      }
    }

    else
    {
      uint64_t v31 = sub_1001964A4();
      if ((_DWORD)v31)
      {
        uint64_t v10 = v31;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"OI_SignalMan_Init failed %!", v32, v33, v34, v35, v36, v37, v38, v10);
          uint64_t v39 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
            goto LABEL_39;
          }
        }
      }

      else
      {
        uint64_t v40 = sub_10018A454();
        if ((_DWORD)v40)
        {
          uint64_t v10 = v40;
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Sar_Init failed %!", v41, v42, v43, v44, v45, v46, v47, v10);
            uint64_t v48 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
              goto LABEL_39;
            }
          }
        }

        else
        {
          uint64_t v49 = sub_1001897A0();
          if ((_DWORD)v49)
          {
            uint64_t v10 = v49;
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"Queue_Init failed %!", v50, v51, v52, v53, v54, v55, v56, v10);
              uint64_t v57 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
                goto LABEL_39;
              }
            }
          }

          else
          {
            if (!BYTE9(xmmword_1008F6D58) || (sub_100174774(), !(_DWORD)v58))
            {
              uint64_t v10 = 0LL;
              HIDWORD(xmmword_1008F6FB8) = 1;
              return v10;
            }

            uint64_t v10 = v58;
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"LE_SecurityCbInit failed %!", v59, v60, v61, v62, v63, v64, v65, v10);
              uint64_t v66 = (os_log_s *)sub_100086554(0x2Fu);
              if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
                goto LABEL_39;
              }
            }
          }
        }
      }
    }
  }

  return v10;
}

uint64_t sub_10017A614(unsigned __int16 *a1)
{
  for (unsigned __int16 i = 192; ; ++i)
  {
    unsigned int v3 = i;
    if ((sub_10017A668(i) & 1) == 0) {
      break;
    }
    if (v3 >= 0xFF) {
      return 104LL;
    }
  }

  uint64_t result = 0LL;
  *a1 = i;
  return result;
}

uint64_t sub_10017A668(int a1)
{
  if (!*(_WORD *)sub_1001EDBA0(0x2Fu)) {
    return 0LL;
  }
  uint64_t v2 = 0LL;
  unint64_t v3 = 0LL;
  while (*(unsigned __int16 *)(qword_1008E2BC0 + v2) != a1 || *(_BYTE *)(qword_1008E2BC0 + v2 + 24) != 1)
  {
    ++v3;
    v2 += 32LL;
  }

  return 1LL;
}

uint64_t sub_10017A6F0(int a1, uint64_t a2)
{
  if (!HIDWORD(xmmword_1008F6FB8)) {
    sub_1001EE2A0();
  }
  if ((a1 & 0x1010101) == 1) {
    return sub_10017A750(a1, 0, a2, 0LL);
  }
  else {
    return 482LL;
  }
}

uint64_t sub_10017A750(int a1, char a2, uint64_t a3, uint64_t a4)
{
  if ((sub_10017AAC8(a1) & 1) != 0 || (sub_10017A668(a1) & 1) != 0) {
    return 402LL;
  }
  if (*(_WORD *)sub_1001EDBA0(0x2Fu))
  {
    uint64_t v9 = 0LL;
    unint64_t v10 = 0LL;
    while (*(_WORD *)(qword_1008E2BC0 + v9))
    {
      ++v10;
      v9 += 32LL;
    }

    uint64_t result = 0LL;
    uint64_t v19 = qword_1008E2BC0 + v9;
    *(_WORD *)uint64_t v19 = a1;
    *(void *)(v19 + 8) = a3;
    *(void *)(v19 + 16) = a4;
    *(_BYTE *)(v19 + 24) = a2;
  }

  else
  {
LABEL_8:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not register L2CAP: no resources.", v11, v12, v13, v14, v15, v16, v17, v20);
      uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 104LL;
  }

  return result;
}

uint64_t sub_10017A84C(int a1, uint64_t a2)
{
  if (!HIDWORD(xmmword_1008F6FB8)) {
    sub_1001EE2A0();
  }
  else {
    return 482LL;
  }
}

uint64_t sub_10017A8B8(int a1)
{
  return sub_10017A8C0(a1, 0);
}

uint64_t sub_10017A8C0(int a1, int a2)
{
  uint64_t v4 = sub_100171DAC();
  if (!*(_WORD *)sub_1001EDBA0(0x2Fu)) {
    return 120LL;
  }
  uint64_t v5 = 0LL;
  unint64_t v6 = 0LL;
  while (*(unsigned __int16 *)(qword_1008E2BC0 + v5) != a1 || *(unsigned __int8 *)(qword_1008E2BC0 + v5 + 24) != a2)
  {
    ++v6;
    v5 += 32LL;
  }

  if (*(_WORD *)(sub_1001EDBA0(0x2Fu) + 2))
  {
    int v8 = 0;
    while (*(_DWORD *)v4 != 2
         || !*(_BYTE *)(sub_10017AB4C((unsigned int *)v4) + 16)
         || !*(_BYTE *)(sub_10017AB4C((unsigned int *)v4) + 24)
         || *(unsigned __int16 *)(v4 + 6) != a1)
    {
      v4 += 144LL;
    }

    return 141LL;
  }

  else
  {
LABEL_14:
    uint64_t result = 0LL;
    uint64_t v9 = qword_1008E2BC0 + v5;
    *(_WORD *)uint64_t v9 = 0;
    *(void *)(v9 + 8) = 0LL;
    *(void *)(v9 + 16) = 0LL;
    *(_BYTE *)(v9 + 24) = 0;
  }

  return result;
}

uint64_t sub_10017A9E0(int a1)
{
  return sub_10017A8C0(a1, 1);
}

uint64_t sub_10017A9E8(_WORD *a1)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  char v2 = 0;
  int v3 = 61435;
  int v4 = 4101;
  do
  {
    if ((v2 & 1) != 0) {
      return 0LL;
    }
    if ((v4 & 0x101) != 1) {
      sub_1001EE2A0();
    }
    char v5 = sub_10017AAC8((unsigned __int16)v4);
    if ((v5 & 1) == 0) {
      *a1 = v4;
    }
    char v2 = v5 ^ 1;
    unsigned __int16 v6 = v4 + 2;
    if (((v4 + 2) & 0x100) != 0) {
      unsigned __int16 v6 = v4 + 258;
    }
    if (v6 <= 0x1005u) {
      int v4 = 4101;
    }
    else {
      int v4 = v6;
    }
    --v3;
  }

  while (v3);
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Failed to allocate PSM: no resources.", v7, v8, v9, v10, v11, v12, v13, v16);
    uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return 104LL;
}

uint64_t sub_10017AAC8(int a1)
{
  if (!*(_WORD *)sub_1001EDBA0(0x2Fu)) {
    return 0LL;
  }
  uint64_t v2 = 0LL;
  unint64_t v3 = 0LL;
  while (*(unsigned __int16 *)(qword_1008E2BC0 + v2) != a1 || *(_BYTE *)(qword_1008E2BC0 + v2 + 24))
  {
    ++v3;
    v2 += 32LL;
  }

  return 1LL;
}

uint64_t sub_10017AB4C(unsigned int *a1)
{
  int v2 = *a1;
  if (*a1 != 2 && v2 != 4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid access: type %d, cid %d, psm %d", v4, v5, v6, v7, v8, v9, v10, *a1);
      uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    int v2 = *a1;
  }

  if (v2 != 2 && v2 != 4) {
    sub_1001EE2A0();
  }
  uint64_t result = *((void *)a1 + 14);
  if (!result)
  {
    sub_1001EE2A0();
    return *((void *)a1 + 14);
  }

  return result;
}

uint64_t sub_10017ABF8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (*(_WORD *)sub_1001EDBA0(0x2Fu))
  {
    uint64_t v6 = 0LL;
    unint64_t v7 = 0LL;
    while (*(unsigned __int16 *)(qword_1008E2BC0 + v6) != (_DWORD)a3 || *(_BYTE *)(qword_1008E2BC0 + v6 + 24))
    {
      ++v7;
      v6 += 32LL;
    }

    (*(void (**)(uint64_t, uint64_t, uint64_t))(qword_1008E2BC0 + v6 + 8))(a3, a1, a2);
    return 0LL;
  }

  else
  {
LABEL_6:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"%! (%d over %d", v8, v9, v10, v11, v12, v13, v14, 407LL);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"addr %:", v16, v17, v18, v19, v20, v21, v22, a1);
      uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return 407LL;
  }

uint64_t sub_10017AD3C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (*(_WORD *)sub_1001EDBA0(0x2Fu))
  {
    uint64_t v9 = 0LL;
    unint64_t v10 = 0LL;
    while (*(unsigned __int16 *)(qword_1008E2BC0 + v9) != (_DWORD)a3 || *(_BYTE *)(qword_1008E2BC0 + v9 + 24) != 1)
    {
      ++v10;
      v9 += 32LL;
    }

    v28[0] = 0LL;
    v28[1] = 0LL;
    (*(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, void *))(qword_1008E2BC0 + v9 + 16))( a3,  a1,  a2,  a5,  v28);
    return 0LL;
  }

  else
  {
LABEL_6:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"%! (%d over %d)", v11, v12, v13, v14, v15, v16, v17, 407LL);
      uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"addr %:", v19, v20, v21, v22, v23, v24, v25, a1);
      uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return 407LL;
  }

uint64_t sub_10017AEA0(unsigned int *a1)
{
  if (*a1 != 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid access: type %d, cid %d, psm %d", v2, v3, v4, v5, v6, v7, v8, *a1);
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    if (*a1 != 1) {
      sub_1001EE2A0();
    }
  }

  uint64_t result = *((void *)a1 + 13);
  if (!result)
  {
    sub_1001EE2A0();
    return *((void *)a1 + 13);
  }

  return result;
}

uint64_t sub_10017AF44(unsigned int *a1)
{
  if (*a1 != 3)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid access: type %d, cid %d, psm %d", v2, v3, v4, v5, v6, v7, v8, *a1);
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    if (*a1 != 3) {
      sub_1001EE2A0();
    }
  }

  uint64_t result = *((void *)a1 + 15);
  if (!result)
  {
    sub_1001EE2A0();
    return *((void *)a1 + 15);
  }

  return result;
}

uint64_t sub_10017AFE8()
{
  return byte_1008E2BC8;
}

uint64_t sub_10017AFF4(uint64_t result)
{
  byte_1008E2BC8 = result;
  return result;
}

uint64_t sub_10017B000(uint64_t *a1, void *a2)
{
  uint64_t v4 = getenv("BT_HCI_TRANSPORT");
  if (v4)
  {
    __int128 v30 = 0u;
    __int128 v31 = 0u;
    __int128 v28 = 0u;
    __int128 v29 = 0u;
    __int128 v26 = 0u;
    __int128 v27 = 0u;
    __int128 v24 = 0u;
    __int128 v25 = 0u;
    __int128 v22 = 0u;
    __int128 v23 = 0u;
    __int128 v20 = 0u;
    __int128 v21 = 0u;
    __int128 v18 = 0u;
    __int128 v19 = 0u;
    *(_OWORD *)__str = 0u;
    __int128 v17 = 0u;
    __strlcpy_chk(__str, v4, 256LL, 256LL);
    uint64_t v5 = strtok(__str, ":");
    if (v5)
    {
      uint64_t v6 = v5;
      sub_1001EE0E4("Searching for transport: %s\n", v5);
      uint64_t v7 = (uint64_t *)&off_100885CF0;
      do
      {
        uint64_t v8 = *v7;
        if (!*v7)
        {
          sub_1001EE0E4("FATAL ERROR - HCI Transport\t%s could not be matched.\n", v6);
          return 1065LL;
        }

        ++v7;
      }

      while (strcmp(*(const char **)(v8 + 8), v6));
      uint64_t v9 = strtok(0LL, ":");
      if (v9)
      {
        uint64_t v10 = sub_10017B2D8(v9);
        if (!v10) {
          return 1065LL;
        }
        uint64_t v11 = v10;
        uint64_t v12 = strtok(0LL, ":");
        if (v12) {
          *(void *)(v11 + 16) = strdup(v12);
        }
        goto LABEL_15;
      }

      uint64_t v11 = sub_10017B2D8(*(const char **)(v8 + 8));
      if (v11)
      {
LABEL_15:
        uint64_t result = 0LL;
        *a1 = v11;
        *a2 = v8;
        return result;
      }
    }

    return 1065LL;
  }

  sub_1001EE0E4("BT_HCI_TRANSPORT not set - Attempting to read from plist.\n");
  switch(sub_1000FCD0C())
  {
    case 0u:
      sub_1001EE0E4("HCI Transport is set to USB\n");
      goto LABEL_25;
    case 1u:
      sub_1001EE0E4("HCI Transport is set to H4\n");
      uint64_t result = 0LL;
      uint64_t v14 = &unk_1008D6D88;
      goto LABEL_20;
    case 2u:
      sub_1001EE0E4("HCI Transport is set to H4DS\n");
      uint64_t result = 0LL;
      uint64_t v14 = &unk_1008D6ED0;
      goto LABEL_20;
    case 3u:
      sub_1001EE0E4("HCI Transport is set to H4BC\n");
      uint64_t result = 0LL;
      uint64_t v14 = &unk_1008D6E28;
      goto LABEL_20;
    case 4u:
      sub_1001EE0E4("HCI Transport is set to H5\n");
      uint64_t result = 0LL;
      uint64_t v14 = &unk_1008D6F70;
LABEL_20:
      *a2 = v14;
      uint64_t v15 = &unk_1008D6C88;
      goto LABEL_27;
    case 5u:
      sub_1001EE0E4("BCSP Transport not supported - Setting to USB\n");
      goto LABEL_25;
    case 6u:
      sub_1001EE0E4("HCI Transport is set to APPLEBT\n");
      uint64_t result = 0LL;
      *a2 = &unk_1008D6BE0;
      uint64_t v15 = &unk_1008D6B60;
      goto LABEL_27;
    case 7u:
      sub_1001EE0E4("HCI Transport is set to PCIE Skywalk\n");
      uint64_t result = 0LL;
      *a2 = &unk_1008D6AC0;
      uint64_t v15 = &unk_1008D6A40;
      goto LABEL_27;
    case 0xAu:
      sub_1001EE0E4("HCI Transport is set to virtual\n");
      uint64_t result = 0LL;
      *a2 = &unk_1008D8F58;
      uint64_t v15 = &unk_1008D8ED8;
      goto LABEL_27;
    default:
      sub_1001EE0E4("HCI Transport is unknown - Setting to USB\n");
LABEL_25:
      uint64_t result = 0LL;
      *a2 = &unk_1008D7090;
      uint64_t v15 = &unk_1008D7010;
LABEL_27:
      *a1 = (uint64_t)v15;
      break;
  }

  return result;
}

uint64_t sub_10017B2D8(const char *a1)
{
  for (unsigned __int16 i = (uint64_t *)&off_100885D48; ; ++i)
  {
    uint64_t v3 = *i;
    if (!*i) {
      break;
    }
  }

  sub_1001EE0E4("FATAL ERROR - HCI Driver\t %s could not be matched.\n", a1);
  return v3;
}

uint64_t sub_10017B350(uint64_t a1, uint64_t a2)
{
  uint64_t v2 = *(unsigned __int16 *)(a1 + 36);
  __int128 v27 = 0LL;
  if ((_DWORD)v2 == *(unsigned __int16 *)(a2 + 36))
  {
    __int16 v3 = *(_WORD *)(a1 + 38);
    __int16 v4 = *(_WORD *)(a2 + 38);
    if (!sub_100171EC4(v2, (uint64_t *)&v27))
    {
      unsigned int v22 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(v27) + 112) + 4LL);
      if (v3 <= v22 || v4 <= v22)
      {
      }

      return v3 - v4;
    }

    uint64_t result = sub_1000A86F0();
    if ((_DWORD)result)
    {
      sub_1001EE134((uint64_t)"Can't get channel (0x%x), this is bad.", v6, v7, v8, v9, v10, v11, v12, v2);
      uint64_t v13 = (os_log_s *)sub_100086554(0x2Fu);
      uint64_t result = os_log_type_enabled(v13, OS_LOG_TYPE_ERROR);
      if ((_DWORD)result)
      {
        sub_100657858();
        return 0LL;
      }
    }
  }

  else
  {
    uint64_t result = sub_1000A86F0();
    if ((_DWORD)result)
    {
      sub_1001EE134( (uint64_t)"WTF ?? Can't compare 2 packets with different CID",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  v26);
      __int128 v21 = (os_log_s *)sub_100086554(0x2Fu);
      uint64_t result = os_log_type_enabled(v21, OS_LOG_TYPE_ERROR);
      if ((_DWORD)result)
      {
        sub_100657858();
        return 0LL;
      }
    }
  }

  return result;
}

uint64_t sub_10017B47C(unsigned __int16 *a1)
{
  unint64_t v2 = *((char *)a1 + 3);
  __int16 v3 = "???";
  __int16 v4 = "???";
  if (v2 <= 2) {
    __int16 v4 = off_100885D88[v2];
  }
  if (*((_BYTE *)a1 + 2) == 1) {
    __int16 v3 = "E_RETRANSMIT_TX_XMIT";
  }
  if (*((_BYTE *)a1 + 2)) {
    uint64_t v5 = v3;
  }
  else {
    uint64_t v5 = "E_RETRANSMIT_TX_WAIT_F";
  }
  sub_1001EE0E4( "cid=0x%x, txState=%s, rxState=%s, nextTxSeq=%d, expectedACKSeq=%d, expectedTxSeq=%d, bufferSeq=%d, remoteBusy=%d, localbusy=%d",  *a1,  v5,  v4,  a1[2],  a1[3],  a1[4],  a1[5],  *((unsigned __int8 *)a1 + 15),  *((unsigned __int8 *)a1 + 16));
  sub_1001EE0E4( "sRejListSize=%d, retryCount=%d, rnrSent=%d, rejActioned=%d, srejActioned=%d, sRejSaveReqSeq=%d, sendRej=%d, bufferSe qSrej=%d, framesSent=%d\n",  a1[72],  *((unsigned __int8 *)a1 + 146),  *((unsigned __int8 *)a1 + 147),  *((unsigned __int8 *)a1 + 148),  *((unsigned __int8 *)a1 + 149),  *((unsigned __int8 *)a1 + 150),  *((unsigned __int8 *)a1 + 151),  a1[76],  a1[77]);
  uint64_t v6 = "YES";
  if (*((_DWORD *)a1 + 40)) {
    uint64_t v7 = "YES";
  }
  else {
    uint64_t v7 = "NO";
  }
  if (!*((_DWORD *)a1 + 41)) {
    uint64_t v6 = "NO";
  }
  return sub_1001EE0E4("retransmissionTimer=%s, monitorTimer=%s\n", v7, v6);
}

uint64_t sub_10017B59C(unsigned int *a1)
{
  *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL) = 0;
  int v2 = *(unsigned __int8 *)(*(void *)(sub_10017AB4C(a1) + 112) + 16LL);
  uint64_t v3 = *(void *)(sub_10017AB4C(a1) + 112);
  int v4 = *(unsigned __int8 *)(v3 + 14);
  *(_BYTE *)(v3 + 14) = 0;
  char v5 = v4 != 0;
  if (v2) {
    return sub_10017B608((uint64_t)a1, 1, v5);
  }
  else {
    return sub_10017B860((uint64_t)a1, 1, v5);
  }
}

uint64_t sub_10017B608(uint64_t a1, char a2, char a3)
{
  uint64_t v22 = 0LL;
  memset(v21, 0, sizeof(v21));
  __int128 v19 = 0u;
  __int128 v20 = 0u;
  uint64_t v23 = 0LL;
  __int16 v18 = 0;
  LOBYTE(v19) = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
  *((void *)&v19 + 1) = *(void *)sub_10017AB4C((unsigned int *)a1);
  LODWORD(v20) = 0;
  WORD2(v20) = *(_WORD *)(a1 + 4);
  WORD3(v20) = 256;
  BYTE8(v20) = 0;
  uint64_t v6 = sub_10017AB4C((unsigned int *)a1);
  size_t v7 = (sub_100186728( (unsigned int *)a1,  2,  a2,  a3,  *(_BYTE *)(*(void *)(v6 + 112) + 10LL),  (_WORD *)&v23 + 2)
                       + 4);
  WORD5(v20) = 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0) + v7;
  LOBYTE(v23) = v7 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0);
  BYTE1(v23) = (unsigned __int16)(v7 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0)) >> 8;
  WORD1(v23) = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 8);
  sub_1001EF520((uint64_t)v21 + 8, 2u);
  sub_1001EFB10((unsigned __int8 *)v21 + 8, (char *)&v23, v7, 2u);
  if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78))
  {
    sub_100185704((uint64_t)v21 + 8, &v18);
    sub_1001EFB10((unsigned __int8 *)v21 + 8, (char *)&v18, 2uLL, 2u);
  }

  uint64_t v8 = sub_10018904C((uint64_t)&v19);
  if ((_DWORD)v8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send S-Frame %!.", v9, v10, v11, v12, v13, v14, v15, v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 147LL) = 1;
  }

  return v8;
}

uint64_t sub_10017B840(unsigned int *a1)
{
  uint64_t v1 = *(void *)(sub_10017AB4C(a1) + 112);
  uint64_t result = *(unsigned __int8 *)(v1 + 14);
  *(_BYTE *)(v1 + 14) = 0;
  return result;
}

uint64_t sub_10017B860(uint64_t a1, char a2, char a3)
{
  uint64_t v22 = 0LL;
  memset(v21, 0, sizeof(v21));
  __int128 v19 = 0u;
  __int128 v20 = 0u;
  uint64_t v23 = 0LL;
  __int16 v18 = 0;
  LOBYTE(v19) = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
  *((void *)&v19 + 1) = *(void *)sub_10017AB4C((unsigned int *)a1);
  LODWORD(v20) = 0;
  WORD2(v20) = *(_WORD *)(a1 + 4);
  WORD3(v20) = 256;
  BYTE8(v20) = 0;
  uint64_t v6 = sub_10017AB4C((unsigned int *)a1);
  size_t v7 = (sub_100186728( (unsigned int *)a1,  0,  a2,  a3,  *(_BYTE *)(*(void *)(v6 + 112) + 10LL),  (_WORD *)&v23 + 2)
                       + 4);
  WORD5(v20) = 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0) + v7;
  LOBYTE(v23) = v7 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0);
  BYTE1(v23) = (unsigned __int16)(v7 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0)) >> 8;
  WORD1(v23) = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 8);
  sub_1001EF520((uint64_t)v21 + 8, 2u);
  sub_1001EFB10((unsigned __int8 *)v21 + 8, (char *)&v23, v7, 2u);
  if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78))
  {
    sub_100185704((uint64_t)v21 + 8, &v18);
    sub_1001EFB10((unsigned __int8 *)v21 + 8, (char *)&v18, 2uLL, 2u);
  }

  uint64_t v8 = sub_10018904C((uint64_t)&v19);
  if ((_DWORD)v8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send S-Frame %!.", v9, v10, v11, v12, v13, v14, v15, v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v8;
}

uint64_t sub_10017BA84(unsigned int *a1, char a2)
{
  uint64_t result = sub_10017AB4C(a1);
  *(_BYTE *)(*(void *)(result + 112) + 156LL) = a2;
  return result;
}

uint64_t sub_10017BAAC(unsigned int *a1, unsigned int a2)
{
  uint64_t v3 = sub_10017AB4C(a1);
  uint64_t v4 = sub_1001EC43C(*(void *)(*(void *)(v3 + 112) + 176LL));
  uint64_t v15 = v4;
  if (v4)
  {
    while (1)
    {
      uint64_t v5 = sub_1001EC460(v4);
      sub_1001EC444((uint64_t)&v15);
      uint64_t v4 = v15;
      if (!v15) {
        goto LABEL_4;
      }
    }
  }

  else
  {
LABEL_4:
    uint64_t result = sub_1000A86F0();
    if ((_DWORD)result)
    {
      sub_1001EE134((uint64_t)"Could not find frame %d in retransmission list", v7, v8, v9, v10, v11, v12, v13, a2);
      uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
      uint64_t result = os_log_type_enabled(v14, OS_LOG_TYPE_ERROR);
      if ((_DWORD)result)
      {
        sub_100657858();
        return 0LL;
      }
    }
  }

  return result;
}

void sub_10017BB58(uint64_t a1, _BYTE *a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (!a2 || a3 <= 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Received bad packet with length %d", v20, v21, v22, v23, v24, v25, v26, a3);
      __int128 v27 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    goto LABEL_14;
  }

  if ((*a2 & 1) != 0)
  {
    if ((_DWORD)a3 != 2 && (_DWORD)a3 != 4)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Received bad S-Frame packet with length %d", v43, v44, v45, v46, v47, v48, v49, a3);
        uint64_t v50 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      goto LABEL_14;
    }

    int v29 = *(unsigned __int16 *)a2;
    if ((_DWORD)a4)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"AP wakeup by SFrame bundleID=com.apple.bluetoothd, dataLen=%d",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  a3);
        uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v73 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }

    if (!*(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 3LL))
    {
      sub_10017DDE8(a1, v29);
      return;
    }

    if (*(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 3LL) == 1) {
      __asm { BR              X10 }
    }

    if (*(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 3LL) == 2) {
      __asm { BR              X10 }
    }

void sub_10017DDE8(uint64_t a1, int a2)
{
  __asm { BR              X10 }

uint64_t sub_10017DE2C()
{
  if (!(v1 & 0x80 | (v1 >> 4) & 1))
  {
    unsigned int v6 = (v1 >> 8) & 0x3F;
    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL) <= v6
      && v6 <= *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 4LL))
    {
      goto LABEL_13;
    }

    unsigned int v7 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
    int v8 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
    if (v7 <= v6)
    {
      if (v6 - v8 <= *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL) + 32LL))
      {
LABEL_13:
        sub_100181EEC(v0, (v1 >> 8) & 0x3F, 0);
        if (*(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 15LL))
        {
          uint64_t v9 = sub_10017AB4C((unsigned int *)v0);
          if (sub_1001EC434(*(void *)(*(void *)(v9 + 112) + 176LL)))
          {
            uint64_t v10 = sub_100181CF4((unsigned int *)v0);
            if ((_DWORD)v10)
            {
              uint64_t v11 = v10;
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Failed to start retransmission timer %!.",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
                __int128 v19 = (os_log_s *)sub_100086554(0x2Fu);
                if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
                  sub_100657858();
                }
              }
            }
          }
        }

        *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 15LL) = 0;
        goto LABEL_20;
      }
    }

    else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL) {
                                           + 32LL)
    }
              + (_BYTE)v8) & 0x3Fu) >= v6)
    {
      goto LABEL_13;
    }

    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL) <= v6
      && v6 <= *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 4LL))
    {
      BOOL v32 = 1;
    }

    else
    {
      unsigned int v30 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
      int v31 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
      BOOL v32 = v30 <= v6
          ? v6 - v31 <= *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL) + 32LL)
          : ((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL)
                                         + 32LL)
            + (_BYTE)v31) & 0x3Fu) >= v6;
    }

    sub_1001EE134( (uint64_t)"S-Frame Receiver Ready Error: ValidReqSeq %d, ValidF-bit %d",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v32);
    uint64_t v64 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v64, OS_LOG_TYPE_ERROR)) {
      goto LABEL_63;
    }
    goto LABEL_62;
  }

  if ((v1 & 0x80) != 0)
  {
    unsigned int v20 = (v1 >> 8) & 0x3F;
    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL) > v20
      || v20 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 4LL))
    {
      unsigned int v21 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
      int v22 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
      if (v21 <= v20)
      {
        if (v20 - v22 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL) + 32LL))
        {
LABEL_34:
          if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL) <= v20
            && v20 <= *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 4LL))
          {
            BOOL v35 = 1;
          }

          else
          {
            unsigned int v33 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
            int v34 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 6LL);
            BOOL v35 = v33 <= v20
                ? v20 - v34 <= *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL)
                                         + 32LL)
                : ((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL)
                                               + 32LL)
                  + (_BYTE)v34) & 0x3Fu) >= v20;
          }

          sub_10017AB4C((unsigned int *)v0);
          sub_1001EE134( (uint64_t)"S-Frame Receiver Ready Error: ValidReqSeq %d, ValidF-bit %d",  v46,  v47,  v48,  v49,  v50,  v51,  v52,  v35);
          uint64_t v53 = (os_log_s *)sub_100086554(0x2Fu);
          if (!os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
            goto LABEL_63;
          }
          goto LABEL_62;
        }
      }

      else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 176LL) {
                                             + 32LL)
      }
                + (_BYTE)v22) & 0x3Fu) < v20)
      {
        goto LABEL_34;
      }
    }

    *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 15LL) = 0;
    sub_100181EEC(v0, (v1 >> 8) & 0x3F, 1);
    if (*(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 148LL))
    {
      uint64_t v5 = 0LL;
      *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)v0) + 112) + 148LL) = 0;
      return v5;
    }

    uint64_t v54 = sub_10018209C(v0, (v1 >> 8) & 0x3F, (v1 & 0x10) != 0);
    if ((_DWORD)v54)
    {
      uint64_t v55 = v54;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to retransmit I-Frames %!.", v56, v57, v58, v59, v60, v61, v62, v55);
        uint64_t v63 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

uint64_t sub_10017F7AC(unsigned int *a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  unsigned int v10 = a2 >> 7;
  int v11 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
  unsigned int v12 = (a2 >> 1) & 0x3F;
  if ((v10 & 1) == 0)
  {
    if (v11 != v12) {
      goto LABEL_21;
    }
    unsigned int v13 = (a2 >> 8) & 0x3F;
    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) > v13
      || v13 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
    {
      unsigned int v14 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      int v15 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      if (v14 <= v13)
      {
        if (v13 - v15 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
          goto LABEL_21;
        }
      }

      else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) {
                + (_BYTE)v15) & 0x3Fu) < v13)
      }
      {
        goto LABEL_21;
      }
    }

    if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 16LL)) {
      goto LABEL_21;
    }
    __int16 v19 = (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) + 1) & 0x3F;
    *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) = v19;
    sub_100181EEC((uint64_t)a1, (a2 >> 8) & 0x3F, 0);
    sub_100182C98(a1, a3, a4, a5);
LABEL_17:
    sub_10018278C((uint64_t)a1);
    return 0LL;
  }

  if (v11 != v12) {
    goto LABEL_21;
  }
  unsigned int v16 = (a2 >> 8) & 0x3F;
  if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) > v16
    || v16 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
  {
    unsigned int v17 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
    int v18 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
    if (v17 <= v16)
    {
      if (v16 - v18 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
        goto LABEL_21;
      }
    }

    else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) {
              + (_BYTE)v18) & 0x3Fu) < v16)
    }
    {
      goto LABEL_21;
    }
  }

  if (!*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL)
    && !*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 16LL))
  {
    __int16 v90 = (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) + 1) & 0x3F;
    *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) = v90;
    sub_100181EEC((uint64_t)a1, (a2 >> 8) & 0x3F, 1);
    sub_100182C98(a1, a3, a4, a5);
    if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 148LL))
    {
      *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 148LL) = 0;
    }

    else
    {
      uint64_t v91 = sub_10018209C((uint64_t)a1, (a2 >> 8) & 0x3F, 0);
      if ((_DWORD)v91)
      {
        uint64_t v92 = v91;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to retransmit I-Frames %!.", v93, v94, v95, v96, v97, v98, v99, v92);
          uint64_t v100 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v100, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      sub_100182058((uint64_t)a1, 0);
    }

    goto LABEL_17;
  }

uint64_t sub_100180368(unsigned int *a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  unsigned int v10 = a2 >> 7;
  int v11 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
  unsigned int v12 = (a2 >> 1) & 0x3F;
  if ((v10 & 1) == 0)
  {
    if (v11 != v12) {
      goto LABEL_19;
    }
    unsigned int v13 = (a2 >> 8) & 0x3F;
    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) > v13
      || v13 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
    {
      unsigned int v14 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      int v15 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      if (v14 <= v13)
      {
        if (v13 - v15 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
          goto LABEL_19;
        }
      }

      else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) {
                + (_BYTE)v15) & 0x3Fu) < v13)
      }
      {
        goto LABEL_19;
      }
    }

    __int16 v19 = (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) + 1) & 0x3F;
    *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) = v19;
    sub_100181EEC((uint64_t)a1, v13, 0);
    sub_100182C98(a1, a3, a4, a5);
LABEL_16:
    sub_10018278C((uint64_t)a1);
    uint64_t v20 = sub_10017AB4C(a1);
    uint64_t result = 0LL;
    *(_BYTE *)(*(void *)(v20 + 112) + 3LL) = 0;
    return result;
  }

  if (v11 != v12) {
    goto LABEL_19;
  }
  unsigned int v16 = (a2 >> 8) & 0x3F;
  if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) <= v16
    && v16 <= *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
  {
    goto LABEL_18;
  }

  unsigned int v17 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
  int v18 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
  if (v17 <= v16)
  {
    if (v16 - v18 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
      goto LABEL_19;
    }
    goto LABEL_18;
  }

  if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) + (_BYTE)v18) & 0x3Fu) >= v16)
  {
LABEL_18:
    if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL)) {
      goto LABEL_19;
    }
    __int16 v36 = (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) + 1) & 0x3F;
    *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) = v36;
    sub_100181EEC((uint64_t)a1, v16, 1);
    sub_100182C98(a1, a3, a4, a5);
    if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 148LL))
    {
      *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 148LL) = 0;
    }

    else
    {
      uint64_t v37 = sub_10018209C((uint64_t)a1, v16, 0);
      if ((_DWORD)v37)
      {
        uint64_t v38 = v37;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to retransmit I-Frames %!.", v39, v40, v41, v42, v43, v44, v45, v38);
          int v46 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      sub_100182058((uint64_t)a1, 0);
    }

    goto LABEL_16;
  }

uint64_t sub_100180890(unsigned int *a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v10 = (a2 >> 1) & 0x3F;
  if (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 144LL)
    && *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 18LL) == (_DWORD)v10)
  {
    unsigned int v11 = (a2 >> 8) & 0x3F;
    if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) > v11
      || v11 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
    {
      unsigned int v12 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      int v13 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
      if (v12 <= v11)
      {
        if (v11 - v13 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
          goto LABEL_14;
        }
      }

      else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) {
                + (_BYTE)v13) & 0x3Fu) < v11)
      }
      {
        goto LABEL_14;
      }
    }

    if ((((a2 >> 7) & 1) == 0 || !*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL))
      && !*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 151LL)
      && *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 144LL) == 1)
    {
      sub_100182D14(a1, a3);
      sub_10018332C(a1);
      sub_100181EEC((uint64_t)a1, (a2 >> 8) & 0x3F, (a2 >> 7) & 1);
      sub_100183428(a1, a3, a4, a5);
      __int16 v14 = *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 152LL);
      *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL) = v14;
      sub_10018278C((uint64_t)a1);
      uint64_t v15 = 0LL;
      *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 3LL) = 0;
      return v15;
    }
  }

LABEL_73:
  int v53 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL);
  unsigned int v54 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 54) + v53;
  unsigned int v55 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL);
  if (v54 > 0x3F)
  {
    if (v10 < v55)
    {
      __int16 v57 = *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL);
    }
  }

  else
  {
    int v56 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL);
  }

  int v58 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL);
  unsigned int v59 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 54) + v58;
  unsigned int v60 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
  if (v59 > 0x3F)
  {
    if (v10 <= v60)
    {
      int v61 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
    }
  }

  else if (v10 <= v60)
  {
    goto LABEL_94;
  }

  unsigned int v62 = (a2 >> 8) & 0x3F;
  if (*(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL) > v62
    || v62 > *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 4LL))
  {
    unsigned int v63 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
    int v64 = *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 6LL);
    if (v63 <= v62)
    {
      if (v62 - v64 > *(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL)) {
        goto LABEL_94;
      }
    }

    else if (((*(_DWORD *)(*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 176LL) + 32LL) {
              + (_BYTE)v64) & 0x3Fu) < v62)
    }
    {
      goto LABEL_94;
    }
  }

  if ((((a2 >> 7) & 1) == 0 || !*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL))
    && *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 151LL))
  {
    int v48 = (a2 >> 7) & 1;
    uint64_t v46 = (uint64_t)a1;
    unsigned int v47 = (a2 >> 8) & 0x3F;
    goto LABEL_125;
  }

          *(_BYTE *)(*a1 + v9) = *((_DWORD *)v2 + 2);
          *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 1) = BYTE1(*((_DWORD *)v2 + 2));
          *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 2) = *((_WORD *)v2 + 5);
          *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 3) = v2[11];
          __int16 v14 = *((_WORD *)a1 + 6) + 4;
          goto LABEL_74;
        }

        unsigned int v31 = "ByteStream_NumReadBytesAvail(*pByteStream) >= 4";
LABEL_111:
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/sdp/sdpdb.c",  1546,  v31);
      }

      if (*((_BYTE *)a1 + 15))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/sdp/sdpdb.c");
      }

      else if (*((unsigned __int16 *)a1 + 5) - (unint64_t)v9 > 0xF)
      {
        if (*((_BYTE *)a1 + 14) != 2)
        {
          unsigned int v30 = "(*pByteStream).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_108;
        }

    if ((id)++v24 == v22)
    {
      int v64 = [obj countByEnumeratingWithState:&v90 objects:v101 count:16];
      uint64_t v22 = v64;
      if (v64) {
        goto LABEL_34;
      }
      goto LABEL_118;
    }
  }

  if (v85 != v84)
  {
    unsigned int v30 = v86;
    unsigned int v31 = (void *)*v86;
    if (!*v86) {
      goto LABEL_59;
    }
    int v32 = __p[2];
    unsigned int v33 = v86;
    do
    {
      unsigned int v34 = v31[4];
      int v35 = v34 >= (unint64_t)v32;
      else {
        int v36 = v31 + 1;
      }
      if (v35) {
        unsigned int v33 = v31;
      }
      unsigned int v31 = (void *)*v36;
    }

    while (*v36);
    unsigned int v30 = v86;
    if (v33 == v86 || (unint64_t)v32 < v33[4]) {
LABEL_59:
    }
      unsigned int v33 = v30;
    for (unsigned __int16 i = v33[5]; i != v33[6]; i += 18LL)
    {
      unsigned int v38 = sub_100241F94((const unsigned __int8 *)i);
      int v39 = (void *)objc_claimAutoreleasedReturnValue(v38);
      __int16 v40 = [v39 isEqual:v25];

      if ((v40 & 1) != 0)
      {
        if (*(_WORD *)(i + 16) == 2) {
          goto LABEL_75;
        }
        if (*(_WORD *)(i + 16))
        {
          int v48 = 1;
          goto LABEL_82;
        }

        break;
      }
    }

          int v48 = 0;
          sub_100242CA4(&v48);
          if (!v7) {
            goto LABEL_78;
          }
          unsigned int v43 = sub_1000EA7A0(*(void *)(a1 + 56) + 128LL, *(unsigned __int8 *)(a1 + 65), v7, (uint64_t)v5);
          break;
        default:
          __int16 v14 = (os_log_s *)qword_1008F75D0;
          if (os_log_type_enabled((os_log_t)qword_1008F75D0, OS_LOG_TYPE_ERROR))
          {
            *(_DWORD *)int buf = 67109120;
            *(_DWORD *)&uint8_t buf[4] = v8;
            _os_log_error_impl( (void *)&_mh_execute_header,  v14,  OS_LOG_TYPE_ERROR,  "Request for unknown attribute attributeID %d",  buf,  8u);
          }

          goto LABEL_73;
      }

      break;
    }
  }

  else
  {
    int v48 = 0;
    sub_100242CA4(&v48);
LABEL_78:
    unsigned int v43 = sub_1000E93E8(*(void *)(a1 + 56) + 128LL, *(unsigned __int8 *)(a1 + 65), 32, 3306);
  }

  if (!(_DWORD)v43) {
    goto LABEL_86;
  }
  if ((_DWORD)v43 != 3304)
  {
    unsigned int v43 = os_log_type_enabled((os_log_t)qword_1008F75D0, OS_LOG_TYPE_ERROR);
    if ((_DWORD)v43)
    {
      sub_1003CF00C(*(void *)(a1 + 56), buf);
      sub_10068F1EC();
    }

  unsigned int v38 = sub_1002E6E00();
  sub_10002418C(buf, "CONNECTION");
  sub_10002418C(__p, "LeConnectionMagnetDisabledToStageOneValue");
  int v39 = (*(uint64_t (**)(uint64_t, uint8_t *, void **, int *))(*(void *)v38 + 88LL))(v38, buf, __p, &v81);
  if (v84 < 0) {
    operator delete(__p[0]);
  }
  if (v94 < 0)
  {
    operator delete(*(void **)buf);
    if (!v39) {
      goto LABEL_81;
    }
  }

  else if (!v39)
  {
    goto LABEL_81;
  }

  __int16 v40 = (os_log_s *)qword_1008F7620;
  if (os_log_type_enabled((os_log_t)qword_1008F7620, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)int buf = 67109120;
    *(_DWORD *)&uint8_t buf[4] = v81;
    _os_log_impl( (void *)&_mh_execute_header,  v40,  OS_LOG_TYPE_DEFAULT,  "LeConnectionMagnetDisabledToStageOneValue =%d (override)",  buf,  8u);
  }

uint64_t sub_100181800(unsigned int *a1)
{
  uint64_t result = sub_10017AB4C(a1);
  if (*(_DWORD *)(*(void *)(result + 112) + 160LL))
  {
    uint64_t v3 = sub_10017AB4C(a1);
    sub_1001EEB14(*(unsigned int *)(*(void *)(v3 + 112) + 160LL));
    uint64_t result = sub_10017AB4C(a1);
    *(_DWORD *)(*(void *)(result + 112) + 160LL) = 0;
  }

  return result;
}

uint64_t sub_100181850(unsigned int *a1)
{
  if (!*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 156LL) || !*(_WORD *)(sub_10017AB4C(a1) + 70)) {
    return 0LL;
  }
  if (*(_DWORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 164LL))
  {
    unsigned int v2 = *(_DWORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 164LL);
    uint64_t v3 = sub_10017AB4C(a1);
    uint64_t v4 = sub_1001EE978(v2, (5243 * (*(unsigned __int16 *)(v3 + 70) >> 2)) >> 17);
  }

  else
  {
    v17[1] = a1 + 1;
    v17[0] = (const void *)2;
    unsigned int v7 = (5243 * (*(unsigned __int16 *)(sub_10017AB4C(a1) + 70) >> 2)) >> 17;
    uint64_t v8 = sub_10017AB4C(a1);
    uint64_t v4 = sub_1001EE6E8((uint64_t)sub_1001834B8, v17, v7, (int *)(*(void *)(v8 + 112) + 164LL));
  }

  uint64_t v5 = v4;
  if ((_DWORD)v4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not register timer %!", v9, v10, v11, v12, v13, v14, v15, v5);
      unsigned int v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v5;
}

double sub_100181984(uint64_t a1)
{
  if (*(void *)(sub_10017AB4C((unsigned int *)a1) + 112))
  {
    unsigned int v2 = *(char **)(sub_10017AB4C((unsigned int *)a1) + 112);
    sub_1001EC070(*((void **)v2 + 22));
  }

  else
  {
    unsigned int v2 = (char *)sub_1000B17F4(0x2C8uLL);
    *(void *)(sub_10017AB4C((unsigned int *)a1) + 112) = v2;
  }

  *(_WORD *)unsigned int v2 = *(_WORD *)(a1 + 4);
  v2[2] = 1;
  *((_WORD *)v2 + 7) = 0;
  v2[16] = 0;
  *(void *)(v2 + 3) = 0LL;
  v2[11] = 0;
  *((void *)v2 + 18) = 0LL;
  *((_DWORD *)v2 + 38) = 0;
  v2[156] = 1;
  *((void *)v2 + 20) = 0LL;
  *((_DWORD *)v2 + 42) = 0;
  uint64_t v3 = sub_1001EC038(0LL, 0LL);
  double result = 0.0;
  *(_OWORD *)(v2 + 184) = 0u;
  uint64_t v5 = v2 + 184;
  *((void *)v5 - 1) = v3;
  *((_OWORD *)v5 + 1) = 0u;
  *((_OWORD *)v5 + 2) = 0u;
  *((_OWORD *)v5 + 3) = 0u;
  *((_OWORD *)v5 + 4) = 0u;
  *((_OWORD *)v5 + 5) = 0u;
  *((_OWORD *)v5 + 6) = 0u;
  *((_OWORD *)v5 + 7) = 0u;
  *((_OWORD *)v5 + 8) = 0u;
  *((_OWORD *)v5 + 9) = 0u;
  *((_OWORD *)v5 + 10) = 0u;
  *((_OWORD *)v5 + 11) = 0u;
  *((_OWORD *)v5 + 12) = 0u;
  *((_OWORD *)v5 + 13) = 0u;
  *((_OWORD *)v5 + 14) = 0u;
  *((_OWORD *)v5 + 15) = 0u;
  *((_OWORD *)v5 + 16) = 0u;
  *((_OWORD *)v5 + 17) = 0u;
  *((_OWORD *)v5 + 18) = 0u;
  *((_OWORD *)v5 + 19) = 0u;
  *((_OWORD *)v5 + 20) = 0u;
  *((_OWORD *)v5 + 21) = 0u;
  *((_OWORD *)v5 + 22) = 0u;
  *((_OWORD *)v5 + 23) = 0u;
  *((_OWORD *)v5 + 24) = 0u;
  *((_OWORD *)v5 + 25) = 0u;
  *((_OWORD *)v5 + 26) = 0u;
  *((_OWORD *)v5 + 27) = 0u;
  *((_OWORD *)v5 + 28) = 0u;
  *((_OWORD *)v5 + 29) = 0u;
  *((_OWORD *)v5 + 30) = 0u;
  *((_OWORD *)v5 + 31) = 0u;
  *((void *)v5 + 64) = 0LL;
  *((_DWORD *)v5 + 130) = 0;
  return result;
}

uint64_t sub_100181A70(unsigned int *a1)
{
  uint64_t result = sub_10017AB4C(a1);
  uint64_t v3 = *(void *)(result + 112);
  if (v3)
  {
    for (uint64_t i = 184LL; i != 696; i += 8LL)
    {
      uint64_t v5 = *(void **)(v3 + i);
      if (v5)
      {
        sub_100181B54(v5);
        *(void *)(v3 + i) = 0LL;
      }
    }

    unsigned int v6 = *(void **)(v3 + 696);
    if (v6)
    {
      sub_1000B1838(v6);
      *(void *)(v3 + 696) = 0LL;
    }

    sub_100181B84(a1);
    sub_100181800(a1);
    uint64_t v7 = *(unsigned int *)(v3 + 168);
    if ((_DWORD)v7)
    {
      sub_1001EEB14(v7);
      *(_DWORD *)(v3 + 168) = 0;
    }

    uint64_t v8 = *(void *)(v3 + 176);
    if (v8)
    {
      uint64_t v9 = sub_1001EC43C(v8);
      for (j = v9; j; uint64_t v9 = j)
      {
        uint64_t v10 = (void *)sub_1001EC460(v9);
        uint64_t v11 = v10[5];
        if (v11) {
          sub_1001EF45C(v11);
        }
        sub_1000B1838(v10);
        sub_1001EC444((uint64_t)&j);
      }

      sub_1001EC070(*(void **)(v3 + 176));
    }

    sub_1000B1838((void *)v3);
    uint64_t result = sub_10017AB4C(a1);
    *(void *)(result + 112) = 0LL;
  }

  return result;
}

void sub_100181B54(void *ptr)
{
  unsigned int v2 = (void *)ptr[1];
  if (v2) {
    sub_1000B1838(v2);
  }
  ptr[1] = 0LL;
  sub_1000B1838(ptr);
}

uint64_t sub_100181B84(unsigned int *a1)
{
  uint64_t result = sub_10017AB4C(a1);
  if (*(_DWORD *)(*(void *)(result + 112) + 164LL))
  {
    uint64_t v3 = sub_10017AB4C(a1);
    sub_1001EEB14(*(unsigned int *)(*(void *)(v3 + 112) + 164LL));
    uint64_t result = sub_10017AB4C(a1);
    *(_DWORD *)(*(void *)(result + 112) + 164LL) = 0;
  }

  return result;
}

uint64_t sub_100181BD4(unsigned int *a1)
{
  uint64_t v1 = *(void *)(sub_10017AB4C(a1) + 112);
  __int16 v2 = *(_WORD *)(v1 + 4);
  *(_WORD *)(v1 + 4) = ((_BYTE)v2 + 1) & 0x3F;
  return v2;
}

BOOL sub_100181C00(unsigned int *a1)
{
  uint64_t v2 = sub_10017AB4C(a1);
  unsigned int v3 = sub_1001EC434(*(void *)(*(void *)(v2 + 112) + 176LL));
  return v3 < *(unsigned __int8 *)(sub_10017AB4C(a1) + 66)
      && !*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 15LL)
      && *(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 2LL) == 1;
}

uint64_t sub_100181C78(unsigned int *a1, uint64_t a2)
{
  uint64_t v4 = *(void *)(sub_10017AB4C(a1) + 112);
  if (*(_BYTE *)(sub_10017AB4C(a1) + 67)) {
    ++*(_BYTE *)(a2 + 48);
  }
  ++*(_WORD *)(v4 + 154);
  sub_100181CF4(a1);
  sub_1001EC22C(*(void *)(v4 + 176), a2, 8LL, sub_10017B350);
  return 0LL;
}

uint64_t sub_100181CF4(unsigned int *a1)
{
  if (!*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 156LL)
    || !*(_WORD *)(sub_10017AB4C(a1) + 68)
    || *(_DWORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 164LL))
  {
    return 0LL;
  }

  if (*(_DWORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 160LL))
  {
    unsigned int v4 = *(_DWORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 160LL);
    uint64_t v5 = sub_10017AB4C(a1);
    uint64_t v6 = sub_1001EE978(v4, (5243 * (*(unsigned __int16 *)(v5 + 68) >> 2)) >> 17);
  }

  else
  {
    v17[1] = a1 + 1;
    v17[0] = (const void *)2;
    unsigned int v7 = (5243 * (*(unsigned __int16 *)(sub_10017AB4C(a1) + 68) >> 2)) >> 17;
    uint64_t v8 = sub_10017AB4C(a1);
    uint64_t v6 = sub_1001EE6E8((uint64_t)sub_1001836AC, v17, v7, (int *)(*(void *)(v8 + 112) + 160LL));
  }

  uint64_t v2 = v6;
  if ((_DWORD)v6)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not register timer %!", v9, v10, v11, v12, v13, v14, v15, v2);
      unsigned int v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v2;
}

uint64_t sub_100181E3C(unsigned int *a1)
{
  uint64_t v1 = sub_10017AB4C(a1);
  return (unsigned __int16)sub_1001EC434(*(void *)(*(void *)(v1 + 112) + 176LL));
}

uint64_t sub_100181E60(unsigned int *a1)
{
  return *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
}

uint64_t sub_100181E7C(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5 = *(void *)(sub_10017AB4C(a1) + 112);
  if (v5)
  {
    uint64_t v6 = *(void *)(v5 + 176);
    if (v6)
    {
      uint64_t v7 = sub_1001EC43C(v6);
      for (i = v7; i; uint64_t v7 = i)
      {
        uint64_t v8 = sub_1001EC460(v7);
        if (*(void *)(v8 + 8) == a2) {
          *(void *)(v8 + 8) = a3;
        }
        sub_1001EC444((uint64_t)&i);
      }
    }
  }

  return 0LL;
}

uint64_t sub_100181EEC(uint64_t a1, unsigned int a2, int a3)
{
  uint64_t result = sub_1001826B8((unsigned int *)a1, a2);
  if (a3 == 1)
  {
    sub_100181B84((unsigned int *)a1);
    uint64_t v7 = sub_10017AB4C((unsigned int *)a1);
    if (sub_1001EC434(*(void *)(*(void *)(v7 + 112) + 176LL)))
    {
      uint64_t v8 = sub_100181CF4((unsigned int *)a1);
      if ((_DWORD)v8)
      {
        uint64_t v9 = v8;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to restart retransmission timer : %!", v10, v11, v12, v13, v14, v15, v16, v9);
          unsigned int v17 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 2LL) = 1;
    return sub_100187C98(*(unsigned __int16 *)(a1 + 4));
  }

  return result;
}

uint64_t sub_100181FF4(unsigned int *a1, char a2, char a3)
{
  if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 16LL)) {
    return sub_10017B608((uint64_t)a1, a2, a3);
  }
  else {
    return sub_10017B860((uint64_t)a1, a2, a3);
  }
}

uint64_t sub_100182058(uint64_t a1, char a2)
{
  return sub_100187C98(*(unsigned __int16 *)(a1 + 4));
}

uint64_t sub_10018209C(uint64_t a1, unsigned int a2, char a3)
{
  uint64_t v6 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  uint64_t v43 = 0LL;
  memset(v42, 0, sizeof(v42));
  uint64_t v7 = sub_1001EC43C(*(void *)(v6 + 176));
  int v41 = (void *)v7;
  if (v7)
  {
    char v8 = a3 ^ 1;
    while (*(unsigned __int16 *)(sub_1001EC460(v7) + 38) != a2)
    {
      sub_1001EC444((uint64_t)&v41);
      uint64_t v7 = (uint64_t)v41;
      if (!v41) {
        goto LABEL_5;
      }
    }

    int v18 = v41;
    do
    {
      uint64_t v19 = sub_1001EC460((uint64_t)v41);
      sub_1001EC124((uint64_t)v42, v19, 8LL);
    }

    while ((sub_1001EC444((uint64_t)&v41) & 1) != 0);
    sub_1001EC550(*(void **)(v6 + 176), v18, 0);
    uint64_t v20 = sub_1001EC43C((uint64_t)v42);
    int v41 = (void *)v20;
    if (v20)
    {
      while (1)
      {
        uint64_t v21 = sub_1001EC460(v20);
        if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 67))
        {
          unsigned int v22 = *(unsigned __int8 *)(v21 + 48);
        }

        if ((v8 & 1) == 0) {
          *(_BYTE *)(v6 + 14) = 1;
        }
        if (sub_1001891CC(v21))
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Failed to retransmit packet.", v23, v24, v25, v26, v27, v28, v29, v40);
            unsigned int v30 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR))
            {
              unsigned int v31 = sub_1001EDDCC();
              *(_DWORD *)int buf = 136446466;
              __int16 v45 = v31;
              __int16 v46 = 1024;
              int v47 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v30,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }

          sub_1001EC22C(*(void *)(v6 + 176), v21, 8LL, sub_10017B350);
        }

        sub_1001EC444((uint64_t)&v41);
        uint64_t v20 = (uint64_t)v41;
        char v8 = 1;
        if (!v41) {
          goto LABEL_22;
        }
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Retry count exceeded", v32, v33, v34, v35, v36, v37, v38, v40);
        int v39 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      sub_1001759FC(*(unsigned __int16 *)(a1 + 4), 436LL);
      return 541LL;
    }

    else
    {
LABEL_22:
      sub_1001EC0C4((uint64_t)v42);
      return 0LL;
    }
  }

  else
  {
LABEL_5:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not find the IFrame with reqSeq %d", v9, v10, v11, v12, v13, v14, v15, a2);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 540LL;
  }

uint64_t sub_100182380(unsigned int *a1)
{
  *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 154LL) = 0;
  uint64_t v2 = *(void *)(sub_10017AB4C(a1) + 112);
  int v3 = *(unsigned __int8 *)(v2 + 16);
  if (*(_BYTE *)(v2 + 16))
  {
    sub_10017B608((uint64_t)a1, 0, 1);
    char v4 = 0;
  }

  else
  {
    char v4 = 1;
  }

  if (*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 15LL))
  {
    uint64_t v5 = sub_10017AB4C(a1);
  }

  if (!*(_BYTE *)(*(void *)(sub_10017AB4C(a1) + 112) + 16LL)
    && !*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 154LL))
  {
    sub_10017B860((uint64_t)a1, 0, v3 == 0);
    char v4 = 0;
  }

  return sub_100182058((uint64_t)a1, v4);
}

uint64_t sub_10018245C(uint64_t a1, int a2)
{
  uint64_t result = sub_10017AB4C((unsigned int *)a1);
  if (a2 == 1 && *(_BYTE *)(*(void *)(result + 112) + 2LL) != 1)
  {
    sub_100181B84((unsigned int *)a1);
    uint64_t v5 = sub_10017AB4C((unsigned int *)a1);
    if (sub_1001EC434(*(void *)(*(void *)(v5 + 112) + 176LL)))
    {
      uint64_t v6 = sub_100181CF4((unsigned int *)a1);
      if ((_DWORD)v6)
      {
        uint64_t v7 = v6;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to restart retransmission timer : %!", v8, v9, v10, v11, v12, v13, v14, v7);
          uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    *(_BYTE *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 2LL) = 1;
    return sub_100187C98(*(unsigned __int16 *)(a1 + 4));
  }

  return result;
}

uint64_t sub_100182530(uint64_t a1, int a2, int a3)
{
  uint64_t v6 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  uint64_t v7 = (void *)sub_1001EC43C(*(void *)(v6 + 176));
  ptr = v7;
  if (!v7)
  {
LABEL_18:
    if (!*(_DWORD *)(*(void *)(sub_10017AB4C((unsigned int *)a1) + 112) + 160LL))
    {
      sub_100181B84((unsigned int *)a1);
      sub_100181CF4((unsigned int *)a1);
    }

    return 0LL;
  }

  while (1)
  {
    uint64_t v8 = sub_1001EC460((uint64_t)v7);
    sub_1001EC444((uint64_t)&ptr);
    uint64_t v7 = ptr;
    if (!ptr) {
      goto LABEL_18;
    }
  }

  uint64_t v9 = v8;
  if (!*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 67)
    || (unsigned int v10 = *(unsigned __int8 *)(v9 + 48), v10 < *(unsigned __int8 *)(sub_10017AB4C((unsigned int *)a1) + 67)))
  {
    if (a3) {
      *(_BYTE *)(v6 + 14) = 1;
    }
    if (sub_1001891CC(v9))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to retransmit packet.", v11, v12, v13, v14, v15, v16, v17, v28);
        int v18 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      sub_1001EC4B4(*(void *)(v6 + 176), ptr, 0);
    }

    goto LABEL_18;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Retry count exceeded", v19, v20, v21, v22, v23, v24, v25, v28);
    uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  sub_1001759FC(*(unsigned __int16 *)(a1 + 4), 436LL);
  return 542LL;
}

uint64_t sub_1001826B8(unsigned int *a1, unsigned int a2)
{
  uint64_t v4 = *(void *)(sub_10017AB4C(a1) + 112);
  uint64_t v5 = (void *)sub_1001EC43C(*(void *)(v4 + 176));
  ptr = v5;
  if (v5)
  {
    do
    {
      while (1)
      {
        uint64_t v6 = sub_1001EC460((uint64_t)v5);
        unsigned int v7 = *(unsigned __int16 *)(v4 + 6);
        unsigned int v8 = *(unsigned __int16 *)(v6 + 38);
        if (v7 <= v8 && v8 < a2) {
          break;
        }
        BOOL v10 = v7 > v8 && v8 >= a2;
        BOOL v11 = !v10;
        if (v7 > a2 && v11) {
          break;
        }
        sub_1001EC444((uint64_t)&ptr);
        uint64_t v5 = ptr;
        if (!ptr) {
          goto LABEL_21;
        }
      }

      sub_100186F84((void *)v6);
      uint64_t v14 = ptr;
      sub_1001EC444((uint64_t)&v14);
      sub_1001EC4B4(*(void *)(v4 + 176), ptr, 1);
      uint64_t v5 = v14;
      ptr = v14;
    }

    while (v14);
  }

uint64_t sub_10018278C(uint64_t a1)
{
  uint64_t v2 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  if (*(_BYTE *)(v2 + 16)) {
    return sub_10017B608(a1, 0, 0);
  }
  if (!*(_BYTE *)(v2 + 15))
  {
    if (sub_10018929C(*(unsigned __int16 *)(a1 + 4)))
    {
      uint64_t v4 = sub_10017AB4C((unsigned int *)a1);
      unsigned int v5 = sub_1001EC434(*(void *)(*(void *)(v4 + 112) + 176LL));
    }
  }

  v13[1] = (const void *)(a1 + 4);
  v13[0] = (const void *)2;
  int v7 = *(_DWORD *)(v2 + 168);
  uint64_t v6 = (unsigned int *)(v2 + 168);
  unsigned __int16 v8 = *((_WORD *)v6 - 78) + 1;
  *((_WORD *)v6 - 78) = v8;
  if (!v7)
  {
    int v11 = 1;
    uint64_t v12 = (int *)v6;
    return sub_1001EE6E8((uint64_t)sub_1001828D8, v13, v11, v12);
  }

  unsigned int v9 = v8;
  uint64_t result = sub_10017AB4C((unsigned int *)a1);
  if (*(unsigned __int8 *)(result + 54) <= 0x23u)
  {
    uint64_t result = sub_10017AB4C((unsigned int *)a1);
    unsigned int v10 = *(unsigned __int8 *)(result + 54) >> 2;
  }

  else
  {
    unsigned int v10 = 8;
  }

  if (v10 < v9)
  {
    sub_1001EEB14(*v6);
    int v11 = 0;
    uint64_t v12 = 0LL;
    return sub_1001EE6E8((uint64_t)sub_1001828D8, v13, v11, v12);
  }

  return result;
}

void sub_1001828D8(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
  unsigned int v10 = 0LL;
  if (sub_100171EC4(v1, (uint64_t *)&v10))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"SFrame ac Timeout triggered on a released channel (0x%x), this is bad.",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v1);
      unsigned int v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    *(_WORD *)(*(void *)(sub_10017AB4C(v10) + 112) + 12LL) = 0;
    *(_DWORD *)(*(void *)(sub_10017AB4C(v10) + 112) + 168LL) = 0;
    sub_10017B860((uint64_t)v10, 0, 0);
  }

uint64_t sub_100182988(unsigned int *a1)
{
  if (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 144LL))
  {
    uint64_t v2 = *(void *)(sub_10017AB4C(a1) + 112);
    uint64_t v3 = sub_10017AB4C(a1);
    uint64_t v4 = sub_100182A80((uint64_t)a1, *(_BYTE *)(v2 + 2LL * *(unsigned __int16 *)(*(void *)(v3 + 112) + 144LL) + 16), 1);
    if ((_DWORD)v4)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to send SREJ : %!", v5, v6, v7, v8, v9, v10, v11, v4);
        uint64_t v12 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Nothing queued in SREJ list.", v13, v14, v15, v16, v17, v18, v19, v22);
      uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 539LL;
  }

  return v4;
}

uint64_t sub_100182A80(uint64_t a1, char a2, char a3)
{
  uint64_t v21 = 0LL;
  memset(v20, 0, sizeof(v20));
  __int128 v18 = 0u;
  __int128 v19 = 0u;
  uint64_t v22 = 0LL;
  __int16 v17 = 0;
  LOBYTE(v18) = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
  *((void *)&v18 + 1) = *(void *)sub_10017AB4C((unsigned int *)a1);
  LODWORD(v19) = 0;
  WORD2(v19) = *(_WORD *)(a1 + 4);
  WORD3(v19) = 256;
  BYTE8(v19) = 0;
  size_t v6 = (sub_100186728((unsigned int *)a1, 3, 0, a3, a2, (_WORD *)&v22 + 2) + 4);
  WORD5(v19) = 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0) + v6;
  LOBYTE(v22) = v6 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0);
  BYTE1(v22) = (unsigned __int16)(v6 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0)) >> 8;
  WORD1(v22) = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 8);
  sub_1001EF520((uint64_t)v20 + 8, 2u);
  sub_1001EFB10((unsigned __int8 *)v20 + 8, (char *)&v22, v6, 2u);
  if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78))
  {
    sub_100185704((uint64_t)v20 + 8, &v17);
    sub_1001EFB10((unsigned __int8 *)v20 + 8, (char *)&v17, 2uLL, 2u);
  }

  uint64_t v7 = sub_10018904C((uint64_t)&v18);
  if ((_DWORD)v7)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send S-Frame %!.", v8, v9, v10, v11, v12, v13, v14, v7);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v7;
}

void sub_100182C98(unsigned int *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  __int16 v8 = (*(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL) + 1) & 0x3F;
  *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 10LL) = v8;
  sub_100181800(a1);
  sub_100181B84(a1);
  sub_1001830FC((uint64_t)a1, a2, a3, a4);
}

uint64_t sub_100182D14(unsigned int *a1, uint64_t a2)
{
  if (*(void *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL * *(unsigned __int16 *)(a2 + 2) + 184))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Got the same frame twice (txSeq=%d",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  *(unsigned __int16 *)(a2 + 2));
      uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  uint64_t result = sub_10017AB4C(a1);
  *(void *)(*(void *)(result + 112) + 8LL * *(unsigned __int16 *)(a2 + 2) + 184) = a2;
  return result;
}

uint64_t sub_100182DBC(unsigned int *a1, unsigned __int8 a2)
{
  unsigned int v4 = *(unsigned __int8 *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL);
  unsigned __int8 v5 = a2 + 64;
  if (v4 <= a2) {
    unsigned __int8 v5 = a2;
  }
  unsigned int v6 = v5;
  if (v5 <= v4)
  {
LABEL_6:
    uint64_t v10 = 0LL;
  }

  else
  {
    while (1)
    {
      uint64_t v7 = sub_100182A80((uint64_t)a1, v4 & 0x3F, 0);
      if ((_DWORD)v7) {
        break;
      }
      uint64_t v8 = *(void *)(sub_10017AB4C(a1) + 112);
      *(_WORD *)(v8 + 2LL * *(unsigned __int16 *)(*(void *)(sub_10017AB4C(a1) + 112) + 144LL) + 18) = v4 & 0x3F;
      uint64_t v9 = sub_10017AB4C(a1);
      ++*(_WORD *)(*(void *)(v9 + 112) + 144LL);
      LOBYTE(v4) = v4 + 1;
    }

    uint64_t v10 = v7;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send SREJ : %!", v12, v13, v14, v15, v16, v17, v18, v10);
      __int128 v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  *(_WORD *)(*(void *)(sub_10017AB4C(a1) + 112) + 8LL) = (a2 + 1) & 0x3F;
  return v10;
}

uint64_t sub_100182EE0(uint64_t a1)
{
  uint64_t v18 = 0LL;
  memset(v17, 0, sizeof(v17));
  __int128 v15 = 0u;
  __int128 v16 = 0u;
  uint64_t v19 = 0LL;
  __int16 v14 = 0;
  LOBYTE(v15) = *(__int16 *)(sub_10017AB4C((unsigned int *)a1) + 38) == -1;
  *((void *)&v15 + 1) = *(void *)sub_10017AB4C((unsigned int *)a1);
  LODWORD(v16) = 0;
  WORD2(v16) = *(_WORD *)(a1 + 4);
  WORD3(v16) = 256;
  BYTE8(v16) = 0;
  uint64_t v2 = sub_10017AB4C((unsigned int *)a1);
  size_t v3 = (sub_100186728( (unsigned int *)a1,  1,  0,  0,  *(_BYTE *)(*(void *)(v2 + 112) + 8LL),  (_WORD *)&v19 + 2)
                       + 4);
  WORD5(v16) = 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0) + v3;
  uint64_t v19 = (v3 - 4 + 2 * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0));
  *(_DWORD *)((char *)&v19 + 1) = ((unsigned __int16)(v3
                                                                     - 4
                                                                     + 2
                                                                     * (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78) != 0)) >> 8);
  WORD1(v19) = *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 8);
  sub_1001EF520((uint64_t)v17 + 8, 2u);
  sub_1001EFB10((unsigned __int8 *)v17 + 8, (char *)&v19, v3, 2u);
  if (*(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 78))
  {
    sub_100185704((uint64_t)v17 + 8, &v14);
    sub_1001EFB10((unsigned __int8 *)v17 + 8, (char *)&v14, 2uLL, 2u);
  }

  uint64_t v4 = sub_10018904C((uint64_t)&v15);
  if ((_DWORD)v4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to send S-Frame %!.", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v4;
}

void sub_1001830FC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8 = *(void *)(sub_10017AB4C((unsigned int *)a1) + 112);
  if (*(_BYTE *)(a2 + 4) == 1)
  {
    if (*(void *)(v8 + 696)) {
      sub_1001EE2A0();
    }
    uint64_t v9 = (char *)sub_1000B17F4(*(unsigned __int16 *)(a2 + 6));
    *(void *)(v8 + 696) = v9;
    if (!v9) {
      goto LABEL_21;
    }
    *(_BYTE *)(v8 + 708) = 0;
  }

  else
  {
    if (!*(_BYTE *)(a2 + 4))
    {
      sub_100176A28( *(unsigned __int16 *)(a1 + 4),  *(void *)(a2 + 8),  *(unsigned __int16 *)(a2 + 16),  *(unsigned __int16 *)(a2 + 2),  a3,  a4);
LABEL_12:
      sub_100181B54((void *)a2);
      return;
    }

    uint64_t v9 = *(char **)(v8 + 696);
    if (!v9)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Looks like we didn't get a START before this position (%d) -> ignoring.",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  *(unsigned __int8 *)(a2 + 4));
        uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      goto LABEL_12;
    }
  }

  size_t v10 = *(unsigned __int16 *)(a2 + 16);
  uint64_t v11 = *(unsigned int *)(v8 + 704);
  if (*(unsigned __int16 *)(a2 + 6) - v11 >= v10)
  {
    memmove(&v9[v11], *(const void **)(a2 + 8), v10);
    int v12 = *(_DWORD *)(v8 + 704) + *(unsigned __int16 *)(a2 + 16);
    *(_DWORD *)(v8 + 704) = v12;
    char v13 = *(_BYTE *)(v8 + 708) | a3;
    *(_BYTE *)(v8 + 708) = v13;
    if (*(_BYTE *)(a2 + 4) == 2)
    {
      sub_100176A28( *(unsigned __int16 *)(a1 + 4),  *(void *)(v8 + 696),  (unsigned __int16)v12,  *(unsigned __int16 *)(a2 + 2),  v13 != 0,  a4);
      sub_1000B1838(*(void **)(v8 + 696));
      *(void *)(v8 + 696) = 0LL;
      *(_DWORD *)(v8 + 704) = 0;
    }

    goto LABEL_12;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"retransmissionData->reassemblyPacket buffer space (%d) is too small for received data (%d).",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  *(unsigned __int16 *)(a2 + 6) - *(_DWORD *)(v8 + 704));
    a2 = sub_100086554(0x2Fu);
    if (os_log_type_enabled((os_log_t)a2, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  sub_1000AFE20(428LL);
LABEL_21:
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Failed to allocate %d bytes for retransmissionData.",  v29,  v30,  v31,  v32,  v33,  v34,  v35,  *(unsigned __int16 *)(a2 + 6));
    uint64_t v36 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  sub_1000AFE20(106LL);
  sub_10018332C();
}

uint64_t sub_10018332C(unsigned int *a1)
{
  uint64_t v2 = sub_10017AB4C(a1);
  __int16 v3 = *(_WORD *)(*(void *)(v2 + 112) + 144LL);
  __chkstk_darwin(v2, v3);
  uint64_t v5 = (char *)&v11 - v4;
  bzero((char *)&v11 - v4, v6);
  uint64_t result = sub_10017AB4C(a1);
  uint64_t v8 = *(void *)(result + 112);
  if ((v3 & 0xFE) != 0)
  {
    size_t v9 = (v3 - 1);
    memmove(v5, (const void *)(v8 + 20), v9);
    uint64_t v10 = sub_10017AB4C(a1);
    memmove((void *)(*(void *)(v10 + 112) + 18LL), v5, v9);
    uint64_t result = sub_10017AB4C(a1);
    --*(_WORD *)(*(void *)(result + 112) + 144LL);
  }

  else
  {
    *(_WORD *)(v8 + 144) = 0;
  }

  return result;
}

void sub_100183428(unsigned int *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8 = *(void *)(sub_10017AB4C(a1) + 112);
  unsigned int v9 = *(unsigned __int16 *)(a2 + 2);
  if (v9 == *(unsigned __int16 *)(v8 + 152))
  {
    for (uint64_t i = v8 + 8LL * v9; ; uint64_t i = v8 + 8LL * v9)
    {
      uint64_t v13 = *(void *)(i + 184);
      int v12 = (void *)(i + 184);
      uint64_t v11 = v13;
      if (!v13) {
        break;
      }
      sub_1001830FC((uint64_t)a1, v11, a3, a4);
      *(_WORD *)(v8 + 152) = (*(_WORD *)(v8 + 152) + 1) & 0x3F;
      *int v12 = 0LL;
      unsigned int v9 = (v9 + 1) & 0x3F;
    }
  }

void sub_1001834B8(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
  unsigned int v42 = 0LL;
  if (sub_100171EC4(v1, (uint64_t *)&v42))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Monitor timer triggered on a released channel (0x%x), this is bad.",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v1);
      unsigned int v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
LABEL_20:
      }
        sub_100657858();
    }
  }

  else
  {
    *(_DWORD *)(*(void *)(sub_10017AB4C(v42) + 112) + 164LL) = 0;
    uint64_t v10 = v42;
    if (*(_BYTE *)(*(void *)(sub_10017AB4C(v42) + 112) + 2LL))
    {
      sub_1001EE2A0();
      return;
    }

    unsigned int v11 = *(unsigned __int8 *)(*(void *)(sub_10017AB4C(v10) + 112) + 146LL);
    if (v11 >= *(unsigned __int8 *)(sub_10017AB4C(v10) + 67))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Monitor timeout expired", v23, v24, v25, v26, v27, v28, v29, v41);
        uint64_t v30 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      sub_1001759FC(*((unsigned __int16 *)v10 + 2), 436LL);
    }

    else
    {
      char v12 = *(_BYTE *)(*(void *)(sub_10017AB4C(v10) + 112) + 146LL) + 1;
      *(_BYTE *)(*(void *)(sub_10017AB4C(v10) + 112) + 146LL) = v12;
      uint64_t v13 = sub_100181FF4(v10, 1, 0);
      if ((_DWORD)v13)
      {
        uint64_t v14 = v13;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to send RR or RNR : %!", v15, v16, v17, v18, v19, v20, v21, v14);
          uint64_t v22 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
            goto LABEL_20;
          }
        }
      }

      else
      {
        uint64_t v31 = sub_100181850(v10);
        if ((_DWORD)v31)
        {
          uint64_t v32 = v31;
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Failed to start monitor timer %!.", v33, v34, v35, v36, v37, v38, v39, v32);
            uint64_t v40 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
              goto LABEL_20;
            }
          }
        }
      }
    }
  }

void sub_1001836AC(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
  uint64_t v31 = 0LL;
  if (sub_100171EC4(v1, (uint64_t *)&v31))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Monitor timer triggered on a released channel (0x%x), this is bad.",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v1);
      unsigned int v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
LABEL_4:
      }
        sub_100657858();
    }
  }

  else
  {
    *(_DWORD *)(*(void *)(sub_10017AB4C(v31) + 112) + 160LL) = 0;
    uint64_t v10 = v31;
    if (*(_BYTE *)(*(void *)(sub_10017AB4C(v31) + 112) + 2LL) == 1)
    {
      uint64_t v11 = sub_100181FF4(v10, 1, 0);
      if ((_DWORD)v11)
      {
        uint64_t v12 = v11;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to send RR or RNR : %!", v13, v14, v15, v16, v17, v18, v19, v12);
          uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
            goto LABEL_4;
          }
        }
      }

      else
      {
        *(_BYTE *)(*(void *)(sub_10017AB4C(v10) + 112) + 146LL) = 1;
        uint64_t v21 = sub_100181850(v10);
        if ((_DWORD)v21)
        {
          uint64_t v22 = v21;
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Failed to start monitor timer %!.", v23, v24, v25, v26, v27, v28, v29, v22);
            uint64_t v30 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }
        }

        *(_BYTE *)(*(void *)(sub_10017AB4C(v10) + 112) + 2LL) = 0;
      }
    }

    else
    {
      sub_1001EE2A0();
    }
  }

void sub_10018383C(uint64_t a1, __int16 a2, int a3)
{
  qword_1008E2BD0 = a1;
  word_1008E2BD8 = a2;
  if (a3 != 1216)
  {
    if ((byte_1008E2BDC & 1) == 0) {
      sub_1001EE2A0();
    }
    v14[0] = (const void *)8;
    byte_1008E2BDC = 0;
    sub_1000B0400((uint64_t)&unk_1008E2BE4);
    v15[0] = a3;
    v15[1] = byte_1008E2BE0;
    v14[1] = v15;
    uint64_t v4 = sub_1001EE6DC((uint64_t)sub_100183920, v14, 0LL);
    if ((_DWORD)v4)
    {
      uint64_t v5 = v4;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"OI_Dispatch_RegisterFunc failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
        uint64_t v13 = (os_log_s *)sub_100086554(0x3Au);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

void sub_100183920(uint64_t a1)
{
}

uint64_t sub_100183930()
{
  uint64_t result = sub_1000FC0D8();
  if (!(_DWORD)result)
  {
    uint64_t v1 = sub_1000B1814(0x810uLL);
    qword_1008E2BF0 = (uint64_t)v1;
    v1[509] = 4;
    *((_BYTE *)v1 + 2060) = 0;
    if (*((_BYTE *)v1 + 2040)) {
      *((_BYTE *)v1 + 2040) = 0;
    }
    qword_1008E2BF8 = 0LL;
    sub_1000B0400((uint64_t)&unk_1008E2BE4);
    *(_BYTE *)(qword_1008E2BF0 + 2049) = 0;
    sub_1001842C0(5);
    return 109LL;
  }

  return result;
}

uint64_t sub_1001839A4()
{
  if (*(_DWORD *)(qword_1008E2BF0 + 2036) == 4) {
    return 109LL;
  }
  else {
    return 0LL;
  }
}

uint64_t sub_1001839C4()
{
  return 2032LL;
}

uint64_t sub_1001839CC(int a1, __int16 a2, int a3)
{
  char v5 = a1;
  if (a1 != 1 && *(_BYTE *)(qword_1008E2BF0 + 2040)) {
    return 129LL;
  }
  if (a1 == 2) {
    unsigned __int16 v7 = 5;
  }
  else {
    unsigned __int16 v7 = 4;
  }
  if (byte_1008E2BDC == 1)
  {
    sub_1001EE2A0();
    return 118LL;
  }

  else
  {
    if (!qword_1008E2BD0) {
      sub_1001EE2A0();
    }
    unsigned int v9 = (unsigned __int16)word_1008E2BD8;
    if (!word_1008E2BD8)
    {
      sub_1001EE2A0();
      unsigned int v9 = (unsigned __int16)word_1008E2BD8;
    }

    uint64_t v10 = qword_1008E2BD0;
    uint64_t v6 = 105LL;
    if (qword_1008E2BD0 && v9)
    {
      if (a3 + v7 <= v9)
      {
        *(_BYTE *)qword_1008E2BD0 = v5;
        *(_WORD *)(v10 + 1) = a2;
        *(_WORD *)(v10 + 3) = a3;
        if (a3) {
          sub_10011EF64((char *)(v10 + v7));
        }
        else {
          sub_1000BA1F0();
        }
        byte_1008E2BE0 = v5;
        byte_1008E2BDC = 1;
        uint64_t v6 = sub_1000FC0A8();
        if ((_DWORD)v6)
        {
          sub_1000B0400((uint64_t)&unk_1008E2BE4);
          byte_1008E2BDC = 0;
        }

        uint64_t v11 = qword_1008E2BF0;
        if (*(_BYTE *)(qword_1008E2BF0 + 2040) && *(_DWORD *)(qword_1008E2BF0 + 2036) == 4)
        {
          *(_BYTE *)(qword_1008E2BF0 + 2049) = 0;
          *(_DWORD *)(v11 + 2036) = 1;
          *(_WORD *)(v11 + 2042) = 5;
          sub_1001842C0(0x7FFF);
        }
      }

      else
      {
        sub_1001EE2A0();
        return 105LL;
      }
    }
  }

  return v6;
}

uint64_t sub_100183B44(char *__src, int a2)
{
  if (a2)
  {
    int v2 = a2;
    do
    {
      uint64_t v4 = qword_1008E2BF0;
      if (*(_BYTE *)(qword_1008E2BF0 + 2040))
      {
        *(void *)int buf = 0LL;
        uint64_t v67 = 0LL;
        sub_1000B08C0(&v67);
        sub_1000B0920(v67, qword_1008E2BF8, &stru_1008E2C00, buf, v5, v6, v7);
        if ((_DWORD)v8)
        {
          uint64_t v9 = v8;
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"OI_AbsoluteTime_Diff returned %!", v10, v11, v12, v13, v14, v15, v16, v9);
            uint64_t v17 = (os_log_s *)sub_100086554(0x3Au);
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
              sub_100657EA4(v68, &v69, v17);
            }
          }
        }

        j__usleep(0);
        uint64_t v4 = qword_1008E2BF0;
      }

      switch(*(_DWORD *)(v4 + 2036))
      {
        case 0:
        case 4:
          goto LABEL_53;
        case 1:
          uint64_t v18 = *__src;
          if ((v18 - 1) >= 4u)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"unknown packet type received %d", v37, v38, v39, v40, v41, v42, v43, v18);
              int v44 = (os_log_s *)sub_100086554(0x3Au);
              if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
              {
                unsigned int v63 = sub_1001EDDCC();
                *(_DWORD *)int buf = 136446466;
                *(void *)&uint8_t buf[4] = v63;
                __int16 v71 = 1024;
                int v72 = 0xFFFF;
                _os_log_error_impl( (void *)&_mh_execute_header,  v44,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
              }
            }

            sub_1001EE0E4("VirtualCTRL: unknown packet type received %d\n", v18);
            sub_1001844C0(0xF0u);
          }

          else
          {
            *(_WORD *)(v4 + 2042) = 0x2000300040003uLL >> (16 * (v18 - 1));
            *(_BYTE *)(v4 + 2048) = v18;
            *(_WORD *)(v4 + 2044) = 0;
            *(_DWORD *)(v4 + 2036) = 2;
            sub_1001842C0(20);
          }

          if (*(_DWORD *)(qword_1008E2BF0 + 2036) == 2)
          {
            ++__src;
            --v2;
          }

          continue;
        case 2:
          int v27 = 0;
          __int16 v28 = *(_WORD *)(v4 + 2042);
          uint64_t v29 = __src;
          break;
        case 3:
          else {
            size_t v33 = (unsigned __int16)v2;
          }
          memmove((void *)(v4 + *(unsigned __int16 *)(v4 + 2044) + 4), __src, v33);
          uint64_t v34 = qword_1008E2BF0;
          int v35 = *(unsigned __int16 *)(qword_1008E2BF0 + 2042);
          v2 -= v33;
          *(_WORD *)(qword_1008E2BF0 + 2044) += v33;
          __src += v33;
          int v36 = v35 - v33;
          *(_WORD *)(v34 + 2042) = v36;
          if (v36) {
            continue;
          }
          goto LABEL_47;
        default:
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Invalid receive state %d",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  *(unsigned int *)(qword_1008E2BF0 + 2036));
            uint64_t v26 = (os_log_s *)sub_100086554(0x3Au);
            if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
            {
              unsigned int v62 = sub_1001EDDCC();
              *(_DWORD *)int buf = 136446466;
              *(void *)&uint8_t buf[4] = v62;
              __int16 v71 = 1024;
              int v72 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v26,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }

          sub_1001EE0E4("VirtualCTRL: Invalid receive state %d\n", *(_DWORD *)(qword_1008E2BF0 + 2036));
          sub_1001844C0(0xF2u);
          sub_1001EE2A0();
          continue;
      }

      while (v28)
      {
        char v30 = *v29++;
        uint64_t v31 = *(unsigned __int16 *)(v4 + 2044);
        *(_WORD *)(v4 + 2044) = v31 + 1;
        *(_BYTE *)(v4 + v31 + 4) = v30;
        __int16 v28 = *(_WORD *)(v4 + 2042) - 1;
        *(_WORD *)(v4 + 2042) = v28;
        if ((unsigned __int16)++v27 >= (unsigned __int16)v2)
        {
          int v27 = v2;
          if (v28) {
            goto LABEL_46;
          }
          break;
        }
      }

      *(_DWORD *)(v4 + 2036) = 3;
      switch(*(_BYTE *)(v4 + 2048))
      {
        case 1:
        case 3:
          __int16 v32 = *(unsigned __int8 *)(v4 + 6);
          goto LABEL_41;
        case 2:
          __int16 v32 = *(_WORD *)(v4 + 6);
          goto LABEL_41;
        case 4:
          __int16 v32 = *(unsigned __int8 *)(v4 + 5);
LABEL_41:
          *(_WORD *)(v4 + 2042) = v32;
          unsigned __int16 v53 = *(_WORD *)(v4 + 2044) + v32;
          *(_WORD *)(v4 + 2046) = v53;
          if (v53 >= 0x7F1u)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"RxPacketHeader - bogus packet length (%d)",  v54,  v55,  v56,  v57,  v58,  v59,  v60,  *(unsigned __int16 *)(qword_1008E2BF0 + 2046));
              int v61 = (os_log_s *)sub_100086554(0x3Au);
              if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
              {
                int v64 = sub_1001EDDCC();
                *(_DWORD *)int buf = 136446466;
                *(void *)&uint8_t buf[4] = v64;
                __int16 v71 = 1024;
                int v72 = 0xFFFF;
                _os_log_error_impl( (void *)&_mh_execute_header,  v61,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
              }
            }

            sub_1001EE0E4( "VirtualCTRL: RxPacketHeader - bogus packet length (%d)\n",  *(unsigned __int16 *)(qword_1008E2BF0 + 2046));
            sub_1001844C0(0xF4u);
          }

          break;
        default:
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Invalid packet type %d",  v45,  v46,  v47,  v48,  v49,  v50,  v51,  *(unsigned __int8 *)(qword_1008E2BF0 + 2048));
            int v52 = (os_log_s *)sub_100086554(0x3Au);
            if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
            {
              unsigned __int8 v65 = sub_1001EDDCC();
              *(_DWORD *)int buf = 136446466;
              *(void *)&uint8_t buf[4] = v65;
              __int16 v71 = 1024;
              int v72 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v52,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }

          sub_1001EE0E4("VirtualCTRL: Invalid packet type %d\n", *(unsigned __int8 *)(qword_1008E2BF0 + 2048));
          sub_1001844C0(0xF0u);
          sub_1001EE2A0();
          int v27 = 0;
          break;
      }

uint64_t sub_10018412C(int a1, __int16 a2, size_t __len, void *__src)
{
  char v4 = a1;
  if (a1 != 1 && *(_BYTE *)(qword_1008E2BF0 + 2040)) {
    return 129LL;
  }
  uint64_t v6 = 4LL;
  if (a1 == 2) {
    uint64_t v6 = 5LL;
  }
  if (byte_1008E2BDC == 1)
  {
    sub_1001EE2A0();
    return 118LL;
  }

  else
  {
    uint64_t v7 = qword_1008E2BD0;
    if (qword_1008E2BD0) {
      BOOL v8 = word_1008E2BD8 == 0;
    }
    else {
      BOOL v8 = 1;
    }
    if (v8)
    {
      return 105LL;
    }

    else
    {
      *(_BYTE *)qword_1008E2BD0 = a1;
      *(_WORD *)(v7 + 1) = a2;
      *(_WORD *)(v7 + 3) = __len;
      memmove((void *)(v7 + v6), __src, __len);
      byte_1008E2BE0 = v4;
      byte_1008E2BDC = 1;
      uint64_t v9 = sub_1000FC0A8();
      uint64_t v5 = v9;
      if ((_DWORD)v9)
      {
        sub_1000B0400((uint64_t)&unk_1008E2BE4);
        byte_1008E2BDC = 0;
      }

      uint64_t v10 = qword_1008E2BF0;
      if (*(_BYTE *)(qword_1008E2BF0 + 2040) && *(_DWORD *)(qword_1008E2BF0 + 2036) == 4)
      {
        *(_BYTE *)(qword_1008E2BF0 + 2049) = 0;
        *(_DWORD *)(v10 + 2036) = 1;
        *(_WORD *)(v10 + 2042) = 5;
        sub_1001842C0(0x7FFF);
      }
    }
  }

  return v5;
}

void sub_100184264(int a1)
{
  if (a1)
  {
    if (!*(_BYTE *)(qword_1008E2BF0 + 2040))
    {
      *(_BYTE *)(qword_1008E2BF0 + 2040) = 1;
      sub_1000B08C0(&qword_1008E2BF8);
      sub_1000B08E8(&stru_1008E2C00);
    }
  }

  else
  {
    if (*(_BYTE *)(qword_1008E2BF0 + 2040)) {
      *(_BYTE *)(qword_1008E2BF0 + 2040) = 0;
    }
    qword_1008E2BF8 = 0LL;
  }

uint64_t sub_1001842C0(int a1)
{
  if (sub_1001EE9D8(*(_DWORD *)qword_1008E2BF0)) {
    return sub_1001EE978(*(_DWORD *)qword_1008E2BF0, a1);
  }
  else {
    return sub_1001EE6E8((uint64_t)sub_100184318, 0LL, a1, (int *)qword_1008E2BF0);
  }
}

void sub_100184318()
{
  uint64_t v0 = qword_1008E2BF0;
  unsigned int v1 = *(_DWORD *)(qword_1008E2BF0 + 2036);
  if (v1 < 2)
  {
    if (!*(_BYTE *)(qword_1008E2BF0 + 2040))
    {
LABEL_14:
      sub_1001842C0(0x7FFFLL);
      return;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"timed out waiting for reset response %d",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  *(unsigned int *)(qword_1008E2BF0 + 2036));
      uint64_t v17 = (os_log_s *)sub_100086554(0x3Au);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657F08();
      }
    }
  }

  else
  {
    if (v1 - 2 < 2)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Timed out while receiving a packet. Current state:%d",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  *(unsigned int *)(qword_1008E2BF0 + 2036));
        uint64_t v9 = (os_log_s *)sub_100086554(0x3Au);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
          sub_100657F08();
        }
      }

      sub_1001EE0E4( "VirtualCTRL: Timed out while receiving a packet. Current state:%d\n",  *(_DWORD *)(qword_1008E2BF0 + 2036));
      sub_1001844C0(0xF1u);
      return;
    }

    if (v1 == 4)
    {
      if (*(_BYTE *)(qword_1008E2BF0 + 2040)) {
        return;
      }
      *(_BYTE *)(qword_1008E2BF0 + 2049) = 0;
      *(_DWORD *)(v0 + 2036) = 1;
      *(_WORD *)(v0 + 2042) = 5;
      goto LABEL_14;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid receive state %d",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  *(unsigned int *)(qword_1008E2BF0 + 2036));
      uint64_t v25 = (os_log_s *)sub_100086554(0x3Au);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EE0E4("VirtualCTRL: Invalid receive state %d\n", *(_DWORD *)(qword_1008E2BF0 + 2036));
    sub_1001844C0(0xF3u);
    sub_1001EE2A0();
  }

uint64_t sub_1001844C0(unsigned int a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"RxErrorDetected:%d", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x3Au);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_1006578C0();
    }
  }

  uint64_t v10 = qword_1008E2BF0;
  if (!*(_BYTE *)(qword_1008E2BF0 + 2040))
  {
    *(_WORD *)(qword_1008E2BF0 + 4) = 272;
    *(_BYTE *)(v10 + 6) = a1;
    *(_WORD *)(v10 + 2046) = 3;
    *(_BYTE *)(v10 + 2048) = 4;
    sub_10018457C();
    uint64_t v10 = qword_1008E2BF0;
  }

  *(_DWORD *)(v10 + 2036) = 4;
  sub_100184264(1);
  return sub_1001842C0(5LL);
}

void sub_10018457C()
{
  uint64_t v0 = qword_1008E2BF0;
  if (*(unsigned __int16 *)(qword_1008E2BF0 + 2046) >= 0x7F1u)
  {
    sub_1001EE2A0();
    uint64_t v0 = qword_1008E2BF0;
  }

  *(_BYTE *)(v0 + 2049) = 0;
  *(_DWORD *)(v0 + 2036) = 1;
  *(_WORD *)(v0 + 2042) = 5;
  sub_1001842C0(0x7FFFLL);
  v1[1] = 0LL;
  v1[0] = mach_continuous_time();
  sub_10012F73C( *(unsigned __int8 *)(qword_1008E2BF0 + 2048),  (unsigned __int8 *)(qword_1008E2BF0 + 4),  *(unsigned __int16 *)(qword_1008E2BF0 + 2046),  (uint64_t)v1);
}

void sub_1001845F8()
{
  if (*(_BYTE *)(qword_1008E2BF0 + 2048) == 4 && *(_WORD *)(qword_1008E2BF0 + 2046) == 6)
  {
    uint64_t v0 = 0LL;
    char v1 = 1;
    uint64_t v2 = &byte_1006BD5DF;
    do
    {
      int v3 = (*(v2 - 1) & *(_BYTE *)(qword_1008E2BF0 + 4 + v0));
      int v4 = *v2;
      v2 += 2;
      if (v3 != v4) {
        char v1 = 0;
      }
      ++v0;
    }

    while (v0 != 6);
    if ((v1 & 1) != 0)
    {
      if (*(_BYTE *)(qword_1008E2BF0 + 2040)) {
        *(_BYTE *)(qword_1008E2BF0 + 2040) = 0;
      }
      qword_1008E2BF8 = 0LL;
      sub_10018457C();
    }
  }

void sub_100184674()
{
  uint64_t v0 = qword_1008E2BF0;
  if (*(unsigned __int16 *)(qword_1008E2BF0 + 2046) >= 0x7F1u)
  {
    sub_1001EE2A0();
    uint64_t v0 = qword_1008E2BF0;
  }

  if (*(_BYTE *)(v0 + 2060))
  {
    sub_1001EE0E4("Rx routing suspended during stack termination!\n");
  }

  else
  {
    *(_BYTE *)(v0 + 2049) = 0;
    *(_DWORD *)(v0 + 2036) = 1;
    *(_WORD *)(v0 + 2042) = 5;
    sub_1001842C0(0x7FFF);
    v1[1] = 0LL;
    v1[0] = mach_continuous_time();
    sub_10012F73C( *(unsigned __int8 *)(qword_1008E2BF0 + 2048),  (unsigned __int8 *)(qword_1008E2BF0 + 4),  *(unsigned __int16 *)(qword_1008E2BF0 + 2046),  (uint64_t)v1);
  }

uint64_t sub_100184714()
{
  return 0LL;
}

void sub_10018471C()
{
  *(_BYTE *)(qword_1008E2BF0 + 2060) = 1;
}

char *sub_100184730(char *result, int a2)
{
  if (a2 >= 2)
  {
    uint64_t v2 = a2 >> 1;
    int v3 = a2 - 1;
    int v4 = result;
    do
    {
      char v5 = *v4;
      *v4++ = result[v3];
      result[v3--] = v5;
      --v2;
    }

    while (v2);
  }

  return result;
}

uint64_t sub_100184764(const void *a1, unsigned int a2, void *a3, int a4)
{
  __int128 v43 = 0uLL;
  __int128 v42 = 0uLL;
  __int128 v41 = *(_OWORD *)"1pmt";
  unint64_t v8 = a2;
  __memmove_chk(&v43, a1, a2, 16LL);
  if (a2 <= 0xF)
  {
    unsigned int v9 = 16 - a2;
    unint64_t v10 = v8;
    do
    {
      unsigned int v11 = v9 - a2;
      if (v9 >= a2) {
        size_t v12 = a2;
      }
      else {
        size_t v12 = v9;
      }
      memmove((char *)&v43 + v10, a1, v12);
      v10 += v8;
      unsigned int v9 = v11;
    }

    while (v10 < 0x10);
  }

  if (!a4)
  {
    uint64_t v23 = sub_100111E38(&v43, 0x746D7031u, &v42);
    if ((_DWORD)v23)
    {
      uint64_t v14 = v23;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"SMP_Crypto_h6 failed creating ILK %!", v24, v25, v26, v27, v28, v29, v30, v14);
        uint64_t v31 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      return v14;
    }

    goto LABEL_16;
  }

  uint64_t v13 = sub_100111F70(&v43, &v41, &v42);
  if (!(_DWORD)v13)
  {
LABEL_16:
    uint64_t v14 = sub_100111E38(&v42, 0x6C656272u, a3);
    if ((_DWORD)v14)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"SMP_Crypto_h6 failed creating LTK %!", v32, v33, v34, v35, v36, v37, v38, v14);
        uint64_t v39 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          goto LABEL_19;
        }
      }
    }

    return v14;
  }

  uint64_t v14 = v13;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"SMP_Crypto_h7 failed creating ILK %!", v15, v16, v17, v18, v19, v20, v21, v14);
    uint64_t v22 = (os_log_s *)sub_100086554(0x43u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
LABEL_19:
    }
      sub_100657F74();
  }

  return v14;
}

uint64_t sub_10018496C(uint64_t a1, unsigned int a2, void *a3, int a4)
{
  __int128 v41 = 0uLL;
  __int128 v40 = 0uLL;
  __int128 v39 = *(_OWORD *)"2pmt";
  __memmove_chk(&v41, a1, a2, 16LL);
  if (a2 <= 0xF)
  {
    unsigned int v7 = 16 - a2;
    unint64_t v8 = a2;
    do
    {
      unsigned int v9 = v7 - a2;
      if (v7 >= a2) {
        size_t v10 = a2;
      }
      else {
        size_t v10 = v7;
      }
      memmove((char *)&v41 + v8, a3, v10);
      v8 += a2;
      unsigned int v7 = v9;
    }

    while (v8 < 0x10);
  }

  if (!a4)
  {
    uint64_t v21 = sub_100111E38(&v41, 0x746D7032u, &v40);
    if ((_DWORD)v21)
    {
      uint64_t v12 = v21;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"SMP_Crypto_h6 failed creating ILK %!", v22, v23, v24, v25, v26, v27, v28, v12);
        uint64_t v29 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      return v12;
    }

    goto LABEL_16;
  }

  uint64_t v11 = sub_100111F70(&v41, &v39, &v40);
  if (!(_DWORD)v11)
  {
LABEL_16:
    uint64_t v12 = sub_100111E38(&v40, 0x62726C65u, a3);
    if ((_DWORD)v12)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"SMP_Crypto_h6 failed creating LK %!", v30, v31, v32, v33, v34, v35, v36, v12);
        uint64_t v37 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
          goto LABEL_19;
        }
      }
    }

    return v12;
  }

  uint64_t v12 = v11;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"SMP_Crypto_h7 failed creating ILTK %!", v13, v14, v15, v16, v17, v18, v19, v12);
    uint64_t v20 = (os_log_s *)sub_100086554(0x43u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
LABEL_19:
    }
      sub_100657F74();
  }

  return v12;
}

__int128 *sub_100184B70()
{
  return &xmmword_1008E2C08;
}

__int128 *sub_100184B7C()
{
  return &xmmword_1008E2C18;
}

__n128 sub_100184B88(__n128 *a1)
{
  __n128 result = *a1;
  xmmword_1008E2C08 = (__int128)*a1;
  return result;
}

__n128 sub_100184B9C(__n128 *a1)
{
  __n128 result = *a1;
  xmmword_1008E2C18 = (__int128)*a1;
  return result;
}

void sub_100184BB0(char *ptr, uint64_t a2, int a3)
{
  uint64_t v4 = a2;
  uint64_t v6 = *(void *)ptr;
  __int128 v29 = 0uLL;
  if ((_DWORD)a2)
  {
    BOOL v7 = 0LL;
  }

  else
  {
    __int128 v29 = *(_OWORD *)(ptr + 562);
    BOOL v7 = ptr[593] != 0;
  }

  uint64_t v8 = *((unsigned int *)ptr + 3);
  if ((_DWORD)v8)
  {
    sub_1001EEB14(v8);
    *((_DWORD *)ptr + 3) = 0;
  }

  if (!(_DWORD)v4)
  {
    if (ptr[612])
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Pairing completed with a compromised device", v9, v10, v11, v12, v13, v14, v15, v28);
        uint64_t v16 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      uint64_t v4 = 4832LL;
    }

    else
    {
      uint64_t v4 = 0LL;
    }
  }

  if (*((_DWORD *)ptr + 154))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"using override status %d",  v17,  v18,  v19,  v20,  v21,  v22,  v23,  *((unsigned int *)ptr + 154));
      uint64_t v24 = (os_log_s *)sub_100086554(0x43u);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    uint64_t v4 = *((unsigned int *)ptr + 154);
  }

  sub_1000B1838(ptr);
  if (sub_10012D5EC(v6))
  {
    *(void *)(v6 + 240) = 0LL;
    if (a3 && unk_1008F6EB8)
    {
      if (*(_BYTE *)(v6 + 55)) {
        uint64_t v25 = v6 + 56;
      }
      else {
        uint64_t v25 = 0LL;
      }
      unk_1008F6EB8(v6 + 48, v25, v4, 0LL);
    }

    BOOL v27 = (_DWORD)v4 == 4832 || (_DWORD)v4 == 0;
    *(_BYTE *)(v6 + 208) = v27;
    sub_1001AA788(v6);
  }

  else if (sub_10012D514(v6))
  {
    *(void *)(v6 + 312) = 0LL;
    if (a3)
    {
      if (off_1008F6EC0) {
        off_1008F6EC0(v6 + 48, v4, &v29, v7, 0LL);
      }
    }
  }

void sub_100184DA0(uint64_t a1, unsigned __int8 *a2, uint64_t a3)
{
  if (!a2 || !(_DWORD)a3)
  {
    sub_1001EE134((uint64_t)"BR/EDR Security Manager error : invalid size %d", v8, v9, v10, v11, v12, v13, v14, a3);
    uint64_t v15 = (os_log_s *)sub_100086554(0x43u);
    if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_19:
    sub_100657858();
    return;
  }

  if (sub_10012D514(a1))
  {
    unsigned int v6 = *a2;
    if (v6 < 0xF)
    {
      BOOL v7 = &unk_1008843F8;
      goto LABEL_12;
    }
  }

  if (!sub_10012D5EC(a1) || (unsigned int v6 = *a2, v6 >= 0xF))
  {
    sub_1001EE134((uint64_t)"Invalid connection", v17, v18, v19, v20, v21, v22, v23, v33);
    uint64_t v24 = (os_log_s *)sub_100086554(0x43u);
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_19;
  }

  BOOL v7 = &unk_100886090;
LABEL_12:
  uint64_t v16 = (void (*)(uint64_t, unsigned __int8 *, void))v7[v6];
  if (v16)
  {
    v16(a1, a2 + 1, (unsigned __int16)(a3 - 1));
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Unknow SMP header 0x%x or invalid connection", v25, v26, v27, v28, v29, v30, v31, *a2);
    uint64_t v32 = (os_log_s *)sub_100086554(0x43u);
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
      goto LABEL_19;
    }
  }

uint64_t sub_100184F2C(uint64_t a1)
{
  if (sub_10012D5EC(a1))
  {
    uint64_t v2 = a1 + 240;
    return *(void *)v2;
  }

  if (sub_10012D514(a1))
  {
    uint64_t v2 = a1 + 312;
    return *(void *)v2;
  }

  return 0LL;
}

uint64_t sub_100184F74(__int128 *a1, char *a2, size_t a3, int a4)
{
  if (!sub_10012D5EC((uint64_t)a1) && !sub_10012D514((uint64_t)a1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid handle", v27, v28, v29, v30, v31, v32, v33, v48);
      uint64_t v34 = (os_log_s *)sub_100086554(0x43u);
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4820LL;
  }

  uint64_t v8 = sub_1001EF520((uint64_t)v49, 1u);
  if (!(_DWORD)v8)
  {
    uint64_t v18 = sub_1001EFB10((unsigned __int8 *)v49, a2, a3, 2u);
    if ((_DWORD)v18)
    {
      uint64_t v9 = v18;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to append mbuf result %!", v19, v20, v21, v22, v23, v24, v25, v9);
        uint64_t v26 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
          goto LABEL_26;
        }
      }

      return v9;
    }

    if (sub_10012D514((uint64_t)a1))
    {
      uint64_t v36 = 7LL;
    }

    else
    {
      if (!sub_10012D5EC((uint64_t)a1))
      {
        uint64_t v9 = 0LL;
        goto LABEL_23;
      }

      uint64_t v36 = 6LL;
    }

    uint64_t v9 = sub_100172A98(0LL, v36, a1, (uint64_t)v49, 0);
    if ((_DWORD)v9) {
      sub_1001EE2A0();
    }
LABEL_23:
    sub_1001EF5E4((uint64_t)v49);
    uint64_t v37 = sub_100184F2C((uint64_t)a1);
    if ((_DWORD)v9)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not write to the SMP channel for handle 0x%x with status %!",  v38,  v39,  v40,  v41,  v42,  v43,  v44,  (uint64_t)a1);
        uint64_t v45 = (os_log_s *)sub_100086554(0x43u);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          goto LABEL_26;
        }
      }
    }

    else
    {
      uint64_t v46 = (int *)v37;
      if (v37)
      {
        uint64_t v47 = *(unsigned int *)(v37 + 12);
        if ((_DWORD)v47)
        {
          sub_1001EEB14(v47);
          v46[3] = 0;
        }

        if (a4) {
          sub_1001851B4(v46);
        }
      }

      return 0LL;
    }

    return v9;
  }

  uint64_t v9 = v8;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Failed to init mbuf result %!", v10, v11, v12, v13, v14, v15, v16, v9);
    uint64_t v17 = (os_log_s *)sub_100086554(0x43u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
LABEL_26:
    }
      sub_100657F74();
  }

  return v9;
}

void sub_1001851B4(int *a1)
{
  v11[1] = a1;
  v11[0] = (const void *)8;
  uint64_t v1 = sub_1001EE6E8((uint64_t)sub_100185544, v11, 300, a1 + 3);
  if ((_DWORD)v1)
  {
    uint64_t v2 = v1;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not register timeout for SMP Tx wth status %!.", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = (os_log_s *)sub_100086554(0x43u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

_BYTE *sub_100185244(uint64_t a1)
{
  if (sub_10012D5EC(a1) && *(void *)(a1 + 240) || sub_10012D514(a1) && *(void *)(a1 + 312)) {
    return 0LL;
  }
  uint64_t v3 = sub_1000B17F4(0x270uLL);
  uint64_t v2 = v3;
  if (v3)
  {
    bzero(v3, 0x270uLL);
    *(void *)uint64_t v2 = a1;
    v2[8] = 0;
  }

  if (sub_10012D5EC(a1))
  {
    *(void *)(a1 + 240) = v2;
    sub_1001AA69C(a1);
  }

  else if (sub_10012D514(a1))
  {
    *(void *)(a1 + 312) = v2;
  }

  return v2;
}

BOOL sub_1001852E0(uint64_t a1, char a2, char a3, char a4, unsigned int a5, char a6, char a7)
{
  *(_BYTE *)(a1 + 78) = a2;
  *(_BYTE *)(a1 + 79) = a3;
  *(_BYTE *)(a1 + 80) = a4;
  *(_BYTE *)(a1 + 82) = a6;
  *(_BYTE *)(a1 + 83) = a7;
  if (sub_10012D5EC(*(void *)a1))
  {
    if (a5 >= 0x10) {
      char v9 = 16;
    }
    else {
      char v9 = a5;
    }
    *(_BYTE *)(a1 + 81) = v9;
  }

  else
  {
    *(_BYTE *)(a1 + 9) = 1;
  }

  return sub_100185340((uint64_t *)a1);
}

BOOL sub_100185340(uint64_t *a1)
{
  BOOL result = sub_10012D5EC(*a1);
  if (result)
  {
    BOOL result = sub_10012D5EC(*a1);
    if (!result) {
      return sub_10012D514(*a1);
    }
  }

  return result;
}

BOOL sub_100185384(uint64_t a1)
{
  return sub_10012D5EC(a1) && *(void *)(a1 + 240) || sub_10012D514(a1) && *(void *)(a1 + 312);
}

uint64_t sub_1001853D0(uint64_t result)
{
  byte_1008D8E98 = result;
  return result;
}

uint64_t sub_1001853DC()
{
  return byte_1008D8E98;
}

uint64_t sub_1001853E8(char a1)
{
  else {
    return dword_1006BD610[(char)(a1 + 16)];
  }
}

const char *sub_100185414()
{
  return "";
}

void sub_100185420(uint64_t a1, char a2)
{
  if (sub_1000B0174())
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"SMP State device:%: %s -> %s", v4, v5, v6, v7, v8, v9, v10, *(void *)a1 + 49LL);
      uint64_t v11 = (os_log_s *)sub_100086554(0x43u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v13 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  *(_BYTE *)(a1 + 8) = a2;
}

BOOL sub_10018550C(uint64_t a1, int a2)
{
  return *(unsigned __int8 *)(a1 + 8) == a2;
}

uint64_t sub_10018551C(uint64_t a1, int a2)
{
  uint64_t result = sub_100184F2C(a1);
  if (result) {
    *(_DWORD *)(result + 616) = a2;
  }
  return result;
}

void sub_100185544(uint64_t a1)
{
  uint64_t v1 = **(void **)(a1 + 8);
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"SMP timeout for handle 0x%x.", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x43u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  if (!sub_10012D5EC(v1) && !sub_10012D514(v1))
  {
    sub_1001EE134( (uint64_t)"Handle is not valid anymore, probably disconnected. Ignoring.",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  v30);
    uint64_t v29 = (os_log_s *)sub_100086554(0x43u);
    if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_17:
    sub_100657F74();
    return;
  }

  uint64_t v10 = sub_100184F2C(v1);
  if (!v10)
  {
    sub_1001EE134((uint64_t)"No pairing entry for handle 0x%x", v14, v15, v16, v17, v18, v19, v20, v1);
    uint64_t v21 = (os_log_s *)sub_100086554(0x43u);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_17;
  }

  uint64_t v11 = (char *)v10;
  BOOL v12 = sub_10012D5EC(v1);
  uint64_t v13 = 4807LL;
  if (v12)
  {
    if (v11[490]) {
      uint64_t v13 = 4807LL;
    }
    else {
      uint64_t v13 = 4827LL;
    }
  }

  sub_100184BB0(v11, v13, 1);
}

BOOL sub_10018568C(char *a1, unsigned int a2, char *a3, unsigned int a4, int a5)
{
  unsigned __int16 v10 = 0;
  int v8 = sub_1000F710C(a1, a2, &v10);
  BOOL result = 0LL;
  if (!v8) {
    return !sub_1000F710C(a3, a4, &v10) && v10 == a5;
  }
  return result;
}

uint64_t sub_100185704(uint64_t a1, _WORD *a2)
{
  size_t v4 = *(unsigned __int16 *)(a1 + 4);
  __chkstk_darwin();
  uint64_t v6 = &v8[-v5];
  bzero(&v8[-v5], v4);
  __int16 v9 = 0;
  sub_1001EFCEC(v6, a1, v4);
  sub_1001EF6C0(a1);
  uint64_t result = sub_1000F710C(v6, v4, &v9);
  if (!(_DWORD)result) {
    *a2 = v9;
  }
  return result;
}

unsigned int *sub_1001857CC(unsigned int a1)
{
  uint64_t v2 = 0LL;
  uint64_t result = v2;
  if (v2)
  {
    if (*(_BYTE *)(sub_10017AB4C(v2) + 64)) {
      return (unsigned int *)*(unsigned __int8 *)(sub_10017AB4C(v2) + 66);
    }
    return 0LL;
  }

  return result;
}

BOOL sub_10018581C(unsigned int a1)
{
  uint64_t v3 = 0LL;
  else {
    return 0LL;
  }
}

BOOL sub_100185870(unsigned int a1)
{
  uint64_t v3 = 0LL;
  else {
    return 0LL;
  }
}

uint64_t sub_1001858C4(unsigned int a1)
{
  uint64_t v11 = 0LL;
  if (sub_100171EC4(a1, (uint64_t *)&v11))
  {
    uint64_t result = sub_1000A86F0();
    if ((_DWORD)result)
    {
      sub_1001EE134((uint64_t)"Invalid channel 0x%x", v3, v4, v5, v6, v7, v8, v9, a1);
      unsigned __int16 v10 = (os_log_s *)sub_100086554(0x2Fu);
      uint64_t result = os_log_type_enabled(v10, OS_LOG_TYPE_ERROR);
      if ((_DWORD)result)
      {
        sub_100657858();
        return 0LL;
      }
    }
  }

  else
  {
    return *(_BYTE *)(sub_10017AB4C(v11) + 64) != 3 || sub_100181C00(v11);
  }

  return result;
}

uint64_t sub_100185968(unsigned int a1)
{
  BOOL v2 = 0LL;
  else {
    return sub_100181BD4(v2);
  }
}

uint64_t sub_1001859B4(unsigned int a1)
{
  BOOL v2 = 0LL;
  else {
    return sub_10016ED64(v2);
  }
}

uint64_t sub_1001859EC(unsigned int a1, uint64_t a2)
{
  uint64_t v4 = 0LL;
  if (*(_BYTE *)(sub_10017AB4C(v4) + 64) == 3) {
    return sub_100181C78(v4, a2);
  }
  return 534LL;
}

uint64_t sub_100185A50(unsigned int a1)
{
  BOOL v2 = 0LL;
  else {
    return sub_100181E3C(v2);
  }
}

uint64_t sub_100185A9C(unsigned int a1, char a2)
{
  uint64_t v4 = 0LL;
  uint64_t result = sub_100171EC4(a1, (uint64_t *)&v4);
  if (!(_DWORD)result)
  {
    uint64_t result = sub_10017AB4C(v4);
    if (*(_BYTE *)(result + 64) == 3) {
      return sub_10017BA84(v4, a2);
    }
  }

  return result;
}

uint64_t sub_100185AF0(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  if (sub_100185B88(a1))
  {
    uint64_t v6 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 64);
    *(_BYTE *)(a3 + 10) = v6;
    ((void (*)(unsigned int *, uint64_t, uint64_t))off_100885DA0[v6])(a1, a2, a3);
    if (!*(_BYTE *)(sub_10017AB4C(a1) + 64)) {
      return sub_100185C6C(a1);
    }
  }

  else
  {
    if ((sub_100185C6C(a1) & 1) != 0) {
      return 2LL;
    }
    *(_BYTE *)(a3 + 10) = 0;
  }

  return 1LL;
}

BOOL sub_100185B88(unsigned int *a1)
{
  uint64_t v2 = *(void *)sub_10017AB4C(a1);
  int v3 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 64);
  if (*(_BYTE *)(v2 + 2))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Forcing channel mode for non-ACL handle.", v4, v5, v6, v7, v8, v9, v10, v13);
      uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return v3 == 0;
  }

  else
  {
    BOOL result = 1LL;
    switch(v3)
    {
      case 0:
        return result;
      case 1:
        BOOL result = *(_BYTE *)(v2 + 229) & 1;
        break;
      case 2:
        BOOL result = (*(unsigned __int8 *)(v2 + 229) >> 1) & 1;
        break;
      case 3:
        BOOL result = (*(unsigned __int8 *)(v2 + 229) >> 3) & 1;
        break;
      case 4:
        BOOL result = (*(unsigned __int8 *)(v2 + 229) >> 2) & 1;
        break;
      default:
        BOOL result = 0LL;
        break;
    }
  }

  return result;
}

uint64_t sub_100185C6C(unsigned int *a1)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  return *(unsigned __int8 *)(sub_10017AB4C(a1) + 65);
}

uint64_t sub_100185C9C(uint64_t a1)
{
  int v2 = a1;
  uint64_t result = 1LL;
  switch(v2)
  {
    case 0:
      return result;
    case 1:
    case 2:
    case 4:
      goto LABEL_2;
    case 3:
      uint64_t result = *(_BYTE *)(sub_1001EDBA0(0x2Fu) + 12) != 0;
      break;
    default:
      uint64_t result = sub_1000A86F0();
      if ((_DWORD)result)
      {
        sub_1001EE134((uint64_t)"Unknown mode 0x%x.", v4, v5, v6, v7, v8, v9, v10, a1);
        uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
        uint64_t result = os_log_type_enabled(v11, OS_LOG_TYPE_ERROR);
        if ((_DWORD)result)
        {
          sub_100657858();
LABEL_2:
          uint64_t result = 0LL;
        }
      }

      break;
  }

  return result;
}

uint64_t sub_100185D48()
{
  return *(unsigned __int8 *)(sub_1001EDBA0(0x2Fu) + 13);
}

uint64_t sub_100185D64(unsigned int *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  unsigned int v8 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 64);
  uint64_t v9 = *(unsigned __int8 *)(a2 + 10);
  if (v8 == (_DWORD)v9)
  {
    *(_BYTE *)(a4 + 10) = v8;
    goto LABEL_3;
  }

  int v21 = sub_100185C6C(a1);
  int v22 = v21;
  if (!(_DWORD)a3)
  {
    if (v21)
    {
      uint64_t v24 = 2LL;
      if (sub_1000A86F0())
      {
        else {
          uint64_t v48 = off_100885E00[(char)v9];
        }
        sub_1001EE134( (uint64_t)"Remote responded with %s, since our mode (%s) is mandatory, failing.",  v41,  v42,  v43,  v44,  v45,  v46,  v47,  (uint64_t)v48);
        uint64_t v82 = (os_log_s *)sub_100086554(0x2Fu);
        if (!os_log_type_enabled(v82, OS_LOG_TYPE_ERROR)) {
          return 2LL;
        }
        goto LABEL_57;
      }

      return v24;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Remote device responded with a mode we don't support, falling back to basic.",  v57,  v58,  v59,  v60,  v61,  v62,  v63,  v100);
      int v64 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_46;
  }

  int v23 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 76);
  if (!v22)
  {
    if (v23)
    {
      if (!sub_100185C9C(v9))
      {
        uint64_t v24 = 2LL;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Remote device requested an unsupported mode a second time, failling negotiation.",  v49,  v50,  v51,  v52,  v53,  v54,  v55,  v100);
          uint64_t v56 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
            goto LABEL_57;
          }
          return 2LL;
        }

        return v24;
      }

uint64_t sub_100186230(unsigned int *a1, int a2, char a3)
{
  unsigned __int16 v36 = 0;
  if (a1)
  {
    sub_100135DC8(&v36);
    uint64_t result = 490LL;
    switch(a2)
    {
      case 0:
        *(_BYTE *)(sub_10017AB4C(a1) + 66) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 67) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 68) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 70) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 72) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 54) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 55) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 56) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 58) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 60) = 0;
        goto LABEL_22;
      case 3:
        int v15 = *(unsigned __int16 *)(sub_10017AB4C(a1) + 48);
        uint64_t v16 = sub_10017AB4C(a1);
        if (v15)
        {
          if (!*(_BYTE *)(v16 + 42)) {
            sub_1001EE2A0();
          }
          if (!*(_BYTE *)(sub_10017AB4C(a1) + 43)) {
            sub_1001EE2A0();
          }
          uint64_t v17 = sub_10017AB4C(a1);
          uint64_t v18 = sub_10017AB4C(a1);
          __int16 v19 = *(_WORD *)(v18 + 50);
          *(void *)(v17 + 66) = *(void *)(v18 + 42);
          *(_WORD *)(v17 + 74) = v19;
          uint64_t v20 = sub_10017AB4C(a1);
          uint64_t v21 = sub_10017AB4C(a1);
          __int16 v22 = *(_WORD *)(v21 + 50);
          *(void *)(v20 + 54) = *(void *)(v21 + 42);
          *(_WORD *)(v20 + 62) = v22;
        }

        else
        {
          *(_BYTE *)(v16 + 66) = 63;
          *(_BYTE *)(sub_10017AB4C(a1) + 67) = 16;
          *(_WORD *)(sub_10017AB4C(a1) + 68) = 2000;
          *(_WORD *)(sub_10017AB4C(a1) + 70) = 12000;
          __int16 v30 = word_1008D8E9A - 4;
          *(_WORD *)(sub_10017AB4C(a1) + 72) = v30;
          *(_BYTE *)(sub_10017AB4C(a1) + 54) = 63;
          *(_BYTE *)(sub_10017AB4C(a1) + 55) = 16;
          *(_WORD *)(sub_10017AB4C(a1) + 56) = 2000;
          *(_WORD *)(sub_10017AB4C(a1) + 58) = 12000;
          __int16 v31 = word_1008D8E9A - 4;
          *(_WORD *)(sub_10017AB4C(a1) + 60) = v31;
        }

        sub_100181984((uint64_t)a1);
        goto LABEL_22;
      case 4:
        int v23 = *(unsigned __int16 *)(sub_10017AB4C(a1) + 48);
        uint64_t v24 = sub_10017AB4C(a1) + 66;
        if (v23)
        {
          uint64_t v25 = sub_10017AB4C(a1);
          __int16 v26 = *(_WORD *)(v25 + 50);
          *(void *)uint64_t v24 = *(void *)(v25 + 42);
          *(_WORD *)(v24 + 8) = v26;
          uint64_t v27 = sub_10017AB4C(a1);
          uint64_t v28 = sub_10017AB4C(a1);
          __int16 v29 = *(_WORD *)(v28 + 50);
          *(void *)(v27 + 54) = *(void *)(v28 + 42);
          *(_WORD *)(v27 + 62) = v29;
        }

        else
        {
          *(_BYTE *)uint64_t v24 = 0;
          *(_BYTE *)(sub_10017AB4C(a1) + 67) = 0;
          *(_WORD *)(sub_10017AB4C(a1) + 68) = 0;
          *(_WORD *)(sub_10017AB4C(a1) + 70) = 0;
          __int16 v32 = word_1008D8E9A - 4;
          *(_WORD *)(sub_10017AB4C(a1) + 72) = v32;
          *(_BYTE *)(sub_10017AB4C(a1) + 54) = 0;
          *(_BYTE *)(sub_10017AB4C(a1) + 55) = 0;
          *(_WORD *)(sub_10017AB4C(a1) + 56) = 0;
          *(_WORD *)(sub_10017AB4C(a1) + 58) = 0;
          __int16 v33 = word_1008D8E9A - 4;
          *(_WORD *)(sub_10017AB4C(a1) + 60) = v33;
        }

        goto LABEL_22;
      case 5:
        *(_BYTE *)(sub_10017AB4C(a1) + 66) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 67) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 68) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 70) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 54) = 0;
        *(_BYTE *)(sub_10017AB4C(a1) + 55) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 56) = 0;
        *(_WORD *)(sub_10017AB4C(a1) + 58) = 0;
LABEL_22:
        *(_BYTE *)(sub_10017AB4C(a1) + 64) = a2;
        *(_BYTE *)(sub_10017AB4C(a1) + 65) = a3;
        uint64_t v34 = sub_10017AB4C(a1);
        uint64_t result = 0LL;
        *(_BYTE *)(v34 + 52) = a2;
        break;
      default:
        return result;
    }
  }

  else
  {
    sub_1001EE2A0();
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid channel", v7, v8, v9, v10, v11, v12, v13, v35);
      uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 535LL;
  }

  return result;
}

uint64_t sub_100186624(unsigned int *a1)
{
  if (*(_BYTE *)(sub_10017AB4C(a1) + 52) == 3 || *(_BYTE *)(sub_10017AB4C(a1) + 64) == 3) {
    return sub_100181A70(a1);
  }
  uint64_t result = sub_10017AB4C(a1);
  if (*(_BYTE *)(result + 64) == 5) {
    return sub_10016ED80(a1);
  }
  return result;
}

uint64_t sub_100186698(unsigned int *a1, _WORD *a2, __int16 a3, char a4)
{
  int v8 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 64);
  if ((v8 - 3) < 2)
  {
    int v11 = ((sub_10017B840(a1) & 1) << 7) | (2 * (a4 & 0x3F));
    *a2 = (a3 << 14) | ((sub_100181E60(a1) & 0x3F) << 8) | v11;
    return 2LL;
  }

  else
  {
    if (v8) {
      BOOL v9 = v8 == 5;
    }
    else {
      BOOL v9 = 1;
    }
    if (!v9) {
      sub_1001EE2A0();
    }
    return 0LL;
  }

uint64_t sub_100186728(unsigned int *a1, char a2, char a3, char a4, char a5, _WORD *a6)
{
  int v11 = *(unsigned __int8 *)(sub_10017AB4C(a1) + 64);
  if ((v11 - 3) < 2)
  {
    *a6 = ((16 * (a3 & 1)) | (4 * (a2 & 3)) | (a4 << 7)) | 1 | ((a5 & 0x3F) << 8);
    return 2LL;
  }

  else
  {
    if (v11) {
      BOOL v12 = v11 == 5;
    }
    else {
      BOOL v12 = 1;
    }
    if (!v12) {
      sub_1001EE2A0();
    }
    return 0LL;
  }

void sub_1001867B4(unsigned int a1, unsigned __int16 *a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v18 = 0LL;
  if (sub_100171EC4(a1, (uint64_t *)&v18))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Unable to get channel from CID=0x%x", v10, v11, v12, v13, v14, v15, v16, a1);
      uint64_t v17 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    if (!*(_BYTE *)(sub_10017AB4C(v18) + 64)) {
      sub_1001EE2A0();
    }
    if (*(_BYTE *)(sub_10017AB4C(v18) + 64) == 3)
    {
      sub_10017BB58((uint64_t)v18, a2, a3, a4, a5);
    }

    else if (*(_BYTE *)(sub_10017AB4C(v18) + 64) == 5)
    {
      sub_10016EF04((uint64_t)v18, a2, a3, a4, a5);
    }

    else
    {
      sub_1001EE2A0();
    }
  }

uint64_t sub_1001868D0(unsigned int a1)
{
  int v2 = 0LL;
  if (*(_BYTE *)(sub_10017AB4C(v2) + 64) == 3) {
    return sub_10017B59C(v2);
  }
  return 0LL;
}

uint64_t sub_100186924(unsigned int *a1)
{
  uint64_t result = sub_10017AB4C(a1);
  if (*(_BYTE *)(result + 64) == 3)
  {
    uint64_t v3 = sub_10017AB4C(a1);
    return sub_10017B47C(*(unsigned __int16 **)(v3 + 112));
  }

  return result;
}

uint64_t sub_10018696C(unsigned int *a1, int a2, uint64_t a3)
{
  int v6 = *(unsigned __int8 *)(a3 + 10);
  uint64_t result = sub_10017AB4C(a1);
  if (v6 == *(unsigned __int8 *)(result + 64))
  {
    *(_WORD *)(a3 + 11) = 4159;
    if (a2) {
      __int16 v8 = 0;
    }
    else {
      __int16 v8 = 2000;
    }
    if (a2) {
      __int16 v9 = 0;
    }
    else {
      __int16 v9 = 12000;
    }
    *(_WORD *)(a3 + 14) = v8;
    *(_WORD *)(a3 + 16) = v9;
    __int16 v10 = word_1008D8E9A - 4;
  }

  else
  {
    *(_BYTE *)(a3 + 11) = *(_BYTE *)(sub_10017AB4C(a1) + 66);
    *(_BYTE *)(a3 + 12) = *(_BYTE *)(sub_10017AB4C(a1) + 67);
    if (a2)
    {
      __int16 v11 = 0;
      *(_WORD *)(a3 + 14) = 0;
    }

    else
    {
      *(_WORD *)(a3 + 14) = *(_WORD *)(sub_10017AB4C(a1) + 68);
      __int16 v11 = *(_WORD *)(sub_10017AB4C(a1) + 70);
    }

    *(_WORD *)(a3 + 16) = v11;
    uint64_t result = sub_10017AB4C(a1);
    __int16 v10 = *(_WORD *)(result + 72);
  }

  *(_WORD *)(a3 + 18) = v10;
  return result;
}

uint64_t sub_100186A40(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  int v5 = *(unsigned __int8 *)(a3 + 10);
  uint64_t result = sub_10017AB4C(a1);
  if (v5 == *(unsigned __int8 *)(result + 64))
  {
    __int16 v7 = word_1008D8E9A - 4;
  }

  else
  {
    uint64_t result = sub_10017AB4C(a1);
    __int16 v7 = *(_WORD *)(result + 72);
  }

  *(_WORD *)(a3 + 18) = v7;
  return result;
}

uint64_t sub_100186A9C(uint64_t a1, uint64_t a2)
{
  char v3 = *(_BYTE *)(a2 + 10);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 64) = v3;
  return sub_100189344(*(unsigned __int16 *)(a1 + 4));
}

uint64_t sub_100186AC8(uint64_t a1, uint64_t a2, _WORD *a3)
{
  char v6 = *(_BYTE *)(a2 + 10);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 64) = v6;
  char v7 = *(_BYTE *)(a2 + 11);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 66) = v7;
  char v8 = *(_BYTE *)(a2 + 12);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 67) = v8;
  __int16 v9 = *(_WORD *)(a2 + 14);
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 68) = v9;
  if (!*(_WORD *)(a2 + 14)) {
    *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 68) = 2000;
  }
  __int16 v10 = *(_WORD *)(a2 + 16);
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 70) = v10;
  __int16 v11 = *(_WORD *)(a2 + 18);
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 72) = v11;
  LOBYTE(v11) = *(_BYTE *)(a2 + 10);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 52) = v11;
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 54) = 63;
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 55) = 16;
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 56) = 2000;
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 58) = 12000;
  __int16 v12 = word_1008D8E9A - 4;
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 60) = v12;
  if (a3)
  {
    *(_WORD *)((char *)a3 + 11) = *(_WORD *)(a2 + 11);
    __int16 v13 = *(_WORD *)(a2 + 14);
    if (!v13) {
      __int16 v13 = 2000;
    }
    a3[7] = v13;
    __int16 v14 = *(_WORD *)(a2 + 16);
    if (!v14) {
      __int16 v14 = 12000;
    }
    a3[8] = v14;
    a3[9] = *(_WORD *)(a2 + 18);
  }

  sub_100181984(a1);
  return sub_100189344(*(unsigned __int16 *)(a1 + 4));
}

uint64_t sub_100186C38(uint64_t a1, uint64_t a2, uint64_t a3)
{
  char v6 = *(_BYTE *)(a2 + 10);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 64) = v6;
  __int16 v7 = *(_WORD *)(a2 + 18);
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 72) = v7;
  LOBYTE(v7) = *(_BYTE *)(a2 + 10);
  *(_BYTE *)(sub_10017AB4C((unsigned int *)a1) + 52) = v7;
  __int16 v8 = word_1008D8E9A - 4;
  *(_WORD *)(sub_10017AB4C((unsigned int *)a1) + 60) = v8;
  if (a3) {
    *(_WORD *)(a3 + 18) = *(_WORD *)(a2 + 18);
  }
  return sub_100189344(*(unsigned __int16 *)(a1 + 4));
}

uint64_t sub_100186CB8(uint64_t result, uint64_t a2)
{
  if (qword_1008E2C28)
  {
    char v3 = (_DWORD *)result;
    uint64_t v4 = qword_1008E2C28;
    while (*(unsigned __int16 *)(v4 + 24) != *(unsigned __int16 *)(result + 4))
    {
      uint64_t v4 = *(void *)(v4 + 80);
      if (v4 == qword_1008E2C28 || v4 == 0) {
        return result;
      }
    }

    if (*(_BYTE *)(v4 + 16))
    {
      sub_100186E5C(*(void **)(v4 + 8), a2);
      return (uint64_t)sub_100186E5C(*(void **)v4, a2);
    }

    else
    {
      BOOL v6 = sub_100186EDC(v4);
      sub_100186E5C(*(void **)v4, a2);
      uint64_t result = sub_100186EDC(v4);
      if (v6 && (result & 1) == 0 && *v3 == 3)
      {
        __int16 v7 = (unsigned __int16 *)(v4 + 24);
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"queueDrained, cid 0x%x\n", v8, v9, v10, v11, v12, v13, v14, *v7);
          uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
          {
            LODWORD(buf) = 136446210;
            *(void *)((char *)&buf + 4) = sub_1001EDDCC();
            _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&buf, 0xCu);
          }
        }

        *(void *)&__int128 buf = 2LL;
        *((void *)&buf + 1) = v7;
        return sub_1001EE6E8((uint64_t)sub_100189A00, (const void **)&buf, 0, 0LL);
      }
    }
  }

  return result;
}

void *sub_100186E5C(void *result, uint64_t a2)
{
  if (result)
  {
    uint64_t v3 = (uint64_t)result;
    uint64_t result = (void *)sub_1001EC43C((uint64_t)result);
    for (ptr = result; result; ptr = result)
    {
      while (1)
      {
        uint64_t v4 = sub_1001EC460((uint64_t)result);
        if (v4)
        {
          if (*(void *)(v4 + 8) == a2) {
            break;
          }
        }

        sub_1001EC444((uint64_t)&ptr);
        uint64_t result = ptr;
        if (!ptr) {
          return result;
        }
      }

      sub_1001EC4B4(v3, ptr, 1);
      uint64_t result = (void *)sub_1001EC43C(v3);
    }
  }

  return result;
}

BOOL sub_100186EDC(uint64_t a1)
{
  if (*(_BYTE *)(a1 + 16))
  {
    return sub_1001EC434(*(void *)a1) - *(_DWORD *)(a1 + 20) == *(unsigned __int8 *)(a1 + 26);
  }

  else
  {
    BOOL v3 = sub_100185870(*(unsigned __int16 *)(a1 + 24));
    unsigned int v4 = sub_1001EC434(*(void *)a1);
    unsigned int v5 = *(unsigned __int8 *)(a1 + 26);
    if (!v3) {
      return v4 >= v5;
    }
    return v4 == v5 - sub_100187584(*(unsigned __int16 *)(a1 + 24));
  }

void *sub_100186F64(uint64_t a1)
{
  return sub_100186E5C((void *)qword_1008E2C38, a1);
}

void *sub_100186F74(uint64_t a1)
{
  return sub_100186E5C((void *)qword_1008E2C40, a1);
}

void sub_100186F84(void *ptr)
{
  int v2 = *(unsigned __int8 *)ptr;
  BOOL v3 = (void *)ptr[3];
  if (v2)
  {
    if (v3) {
LABEL_3:
    }
      sub_1001EF45C((uint64_t)v3);
  }

  else
  {
    if (v3) {
      sub_1001EF69C(v3);
    }
    BOOL v3 = (void *)ptr[5];
    if (v3) {
      goto LABEL_3;
    }
  }

  sub_1000B1838(ptr);
}

uint64_t sub_100186FCC(uint64_t result, const void **a2)
{
  int v2 = result;
  if (a2)
  {
    if (*((unsigned __int16 *)a2 + 12) == (_DWORD)result)
    {
      sub_1001EE0E4("\t cid : 0x%x, address %p\n", result, a2);
      if (*((_BYTE *)a2 + 29)) {
        unsigned int v4 = "Yes";
      }
      else {
        unsigned int v4 = "No";
      }
      sub_1001EE0E4("\t\t stalled : %s\n", v4);
      if (*((_BYTE *)a2 + 16)) {
        unsigned int v5 = "Yes";
      }
      else {
        unsigned int v5 = "No";
      }
      sub_1001EE0E4("\t\t retransmitEnabled : %s\n", v5);
      sub_1001EE0E4("\t\t maxPackets : %d\n", *((unsigned __int8 *)a2 + 26));
      sub_1001EE0E4("\t\t priority : %d\n", *((unsigned __int8 *)a2 + 27));
      sub_1001EE0E4("\t\t transport : 0x%x\n", *((unsigned __int8 *)a2 + 28));
      if (a2[8]) {
        BOOL v6 = "Yes";
      }
      else {
        BOOL v6 = "No";
      }
      sub_1001EE0E4("\t\t readyForTx : %s\n", v6);
      sub_1001EE0E4("\t\t packetSent : 0x%x\n", a2[9]);
      sub_1001EE0E4("\t\t nextQueue : 0x%x\n", a2[10]);
      sub_1001EE0E4("\t\t previousQueue : 0x%x\n", a2[11]);
      if (*((_BYTE *)a2 + 16))
      {
        sub_1001EE0E4("\t\t iFrames : %p\n", *a2);
        uint64_t v7 = sub_1001EC43C((uint64_t)*a2);
        uint64_t v14 = v7;
        if (v7)
        {
          int v8 = 0;
          do
          {
            uint64_t v9 = (unsigned __int8 *)sub_1001EC460(v7);
            sub_1001EE0E4("\tiFrame number %d\n", (unsigned __int16)v8);
            sub_10018724C(v9);
            sub_1001EC444((uint64_t)&v14);
            ++v8;
            uint64_t v7 = v14;
          }

          while (v14);
        }

        sub_1001EE0E4("\t\t sFrames : %p\n", a2[1]);
        uint64_t result = sub_1001EC43C((uint64_t)a2[1]);
        uint64_t v14 = result;
        if (result)
        {
          int v10 = 0;
          do
          {
            uint64_t v11 = (unsigned __int8 *)sub_1001EC460(result);
            sub_1001EE0E4("\tsFrame number %d\n", (unsigned __int16)v10);
            sub_10018724C(v11);
            sub_1001EC444((uint64_t)&v14);
            ++v10;
            uint64_t result = v14;
          }

          while (v14);
        }
      }

      else
      {
        sub_1001EE0E4("\t\t dataQueues : %p\n", *a2);
        uint64_t result = sub_1001EC43C((uint64_t)*a2);
        uint64_t v14 = result;
        if (result)
        {
          int v12 = 0;
          do
          {
            uint64_t v13 = (unsigned __int8 *)sub_1001EC460(result);
            sub_1001EE0E4("\tFrame number %d\n", (unsigned __int16)v12);
            sub_10018724C(v13);
            sub_1001EC444((uint64_t)&v14);
            ++v12;
            uint64_t result = v14;
          }

          while (v14);
        }
      }
    }
  }

  else
  {
    sub_1001EE2A0();
    return sub_1001EE0E4("Queue is null, cid 0x%x", v2);
  }

  return result;
}

uint64_t sub_10018724C(unsigned __int8 *a1)
{
  if (a1[1]) {
    int v2 = "Yes";
  }
  else {
    int v2 = "No";
  }
  sub_1001EE0E4("\t\t\t reliable : %s\n", v2);
  sub_1001EE0E4("\t\t\t sendState : 0x%x\n", *((_DWORD *)a1 + 1));
  sub_1001EE0E4("\t\t\t handle : %p\n", *((const void **)a1 + 1));
  sub_1001EE0E4("\t\t\t mbuf : %p\n", *((const void **)a1 + 3));
  sub_1001EE0E4("\t\t\t priority : %d\n", a1[32]);
  sub_1001EE0E4("\t\t\t packetPosition : 0x%x\n", a1[33]);
  sub_1001EE0E4("\t\t\t totalSize : %d\n", *((unsigned __int16 *)a1 + 17));
  sub_1001EE0E4("\t\t\t cid : 0x%x\n", *((unsigned __int16 *)a1 + 18));
  sub_1001EE0E4("\t\t\t txSequence : %d\n", *((unsigned __int16 *)a1 + 19));
  if (*((void *)a1 + 5)) {
    sub_1001EE0E4("\t\t\t payloadMBuf : %p, numbytes %d\n");
  }
  else {
    sub_1001EE0E4("\t\t\t payloadMBuf : NONE\n");
  }
  return sub_1001EE0E4("\t\t\t retryCount : %d\n", a1[48]);
}

void sub_10018739C()
{
  uint64_t v0 = qword_1008E2C28;
  uint64_t v9 = 0LL;
  sub_1001EE0E4("L2CAP Queue states :\n");
  sub_1001EE0E4("\trunning = 0x%x\n", byte_1008E2C48);
  sub_1001EE0E4("\tnbQueues = %d\n", byte_1008E2C30);
  sub_1001EE0E4("\tqueues = %p\n", (const void *)qword_1008E2C28);
  sub_1001EE0E4("\tfragmentedQueue = %p\n", (const void *)qword_1008E2C38);
  sub_1001EE0E4("\tunstallableQueue = %p\n", (const void *)qword_1008E2C40);
  uint64_t v1 = 0LL;
  sub_1001EE0E4("TxQ State: %s\n", v1);
  sub_1001EE0E4("L2CAP Queues :\n");
  if (v0)
  {
    do
    {
      sub_100186FCC(*(unsigned __int16 *)(v0 + 24), (const void **)v0);
      uint64_t v0 = *(void *)(v0 + 80);
      if (v0) {
        BOOL v2 = v0 == qword_1008E2C28;
      }
      else {
        BOOL v2 = 1;
      }
    }

    while (!v2);
  }

  if (qword_1008E2C38)
  {
    sub_1001EE0E4("Fragmented Queue : %p\n", (const void *)qword_1008E2C38);
    uint64_t v3 = sub_1001EC43C(qword_1008E2C38);
    uint64_t v9 = v3;
    if (v3)
    {
      int v4 = 0;
      do
      {
        unsigned int v5 = (unsigned __int8 *)sub_1001EC460(v3);
        sub_1001EE0E4("\tFrame number %d\n", (unsigned __int16)v4);
        sub_10018724C(v5);
        sub_1001EC444((uint64_t)&v9);
        ++v4;
        uint64_t v3 = v9;
      }

      while (v9);
    }
  }

  if (qword_1008E2C40)
  {
    sub_1001EE0E4("Unstallable Queue : %p\n", (const void *)qword_1008E2C40);
    uint64_t v6 = sub_1001EC43C(qword_1008E2C40);
    uint64_t v9 = v6;
    if (v6)
    {
      int v7 = 0;
      do
      {
        int v8 = (unsigned __int8 *)sub_1001EC460(v6);
        sub_1001EE0E4("\tPacket number %d\n", (unsigned __int16)v7);
        sub_10018724C(v8);
        sub_1001EC444((uint64_t)&v9);
        ++v7;
        uint64_t v6 = v9;
      }

      while (v9);
    }
  }

  sub_100171FAC();
}

uint64_t sub_100187584(unsigned int a1)
{
  uint64_t v3 = 0LL;
  if (!sub_100171EC4(a1, (uint64_t *)&v3)
    && v3
    && (*v3 != 4 ? (BOOL v2 = *v3 == 2) : (BOOL v2 = 1), v2 && sub_100185870(*((unsigned __int16 *)v3 + 2))))
  {
    return sub_10016EC28(v3);
  }

  else
  {
    return 1LL;
  }

uint64_t sub_1001875E0(unsigned int a1)
{
  if (qword_1008E2C28)
  {
    unsigned int v1 = a1;
    uint64_t v2 = qword_1008E2C28;
    while (*(unsigned __int16 *)(v2 + 24) != a1)
    {
      uint64_t v2 = *(void *)(v2 + 80);
      if (v2 == qword_1008E2C28 || v2 == 0) {
        goto LABEL_9;
      }
    }
  }

  else
  {
LABEL_9:
    sub_1001EE2A0();
    __break(1u);
  }

  if (!*(_BYTE *)(v2 + 16))
  {
    uint64_t v13 = sub_1001EC324(*(void *)v2, 0);
    if (v13)
    {
      (*(void (**)(uint64_t, uint64_t))(v2 + 72))(v2, v13);
      sub_100172A10(v1);
    }

    else
    {
      uint64_t result = sub_1000A86F0();
      if (!(_DWORD)result) {
        return result;
      }
      sub_1001EE134((uint64_t)"Invalid packet", v14, v15, v16, v17, v18, v19, v20, v22);
      uint64_t v21 = (os_log_s *)sub_100086554(0x2Fu);
      uint64_t result = os_log_type_enabled(v21, OS_LOG_TYPE_ERROR);
      if (!(_DWORD)result) {
        return result;
      }
      sub_100657858();
    }

    return 0LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Should not be flushing Queue with E/RT enabled", v4, v5, v6, v7, v8, v9, v10, v22);
    uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return 485LL;
}

void sub_100187700()
{
  dword_1008E2C4C = 2;
}

void sub_100187710(int a1)
{
  if (!a1 && dword_1008E2C4C == 1 || a1 && dword_1008E2C4C != 2)
  {
    dword_1008E2C4C = 2;
    sub_100187740();
  }

void sub_100187740()
{
  ptr = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
  uint64_t v48 = 0LL;
  while (1)
  {
    uint64_t v49 = 0LL;
    uint64_t v0 = sub_1000B05D8();
    uint64_t v1 = qword_1008E2C28;
    if (qword_1008E2C28)
    {
      uint64_t v2 = v0;
      uint64_t v3 = (void *)qword_1008E2C28;
      do
      {
        unint64_t v4 = v3[7];
        unint64_t v5 = v2 - v3[6];
        if (v5 > v4 || v4 == 0xFFFFFFFF && v5 >= 0xFA1)
        {
          uint64_t v6 = sub_100189E4C((uint64_t)v3, (uint64_t)&v49, v2, &v48);
          if (v6) {
            goto LABEL_18;
          }
          uint64_t v1 = qword_1008E2C28;
        }

        uint64_t v3 = (void *)v3[10];
        if (v3 == (void *)v1)
        {
          uint64_t v49 = 0LL;
          if (!v1) {
            goto LABEL_20;
          }
LABEL_14:
          while (1)
          {
            uint64_t v6 = sub_100189E4C(v1, (uint64_t)&v49, v2, &v48);
            if (v6) {
              break;
            }
            uint64_t v1 = *(void *)(v1 + 80);
            if (v1 == qword_1008E2C28)
            {
              uint64_t v49 = 0LL;
              goto LABEL_20;
            }

            if (!v1) {
              goto LABEL_20;
            }
          }

uint64_t sub_100187C98(uint64_t result)
{
  if (qword_1008E2C28)
  {
    uint64_t v1 = qword_1008E2C28;
    do
    {
      uint64_t v1 = *(void *)(v1 + 80);
    }

    while (v1 != qword_1008E2C28 && v1 != 0);
  }

  dword_1008E2C4C = 2;
  return result;
}

uint64_t sub_100187CD4(unsigned int a1, char a2, unsigned int a3, uint64_t a4, uint64_t *a5, unsigned int a6)
{
  uint64_t v27 = 0LL;
  if (!qword_1008E2C28)
  {
LABEL_11:
    uint64_t v15 = sub_1000B17F4(0x68uLL);
    if (!v15) {
      return 106LL;
    }
    uint64_t v16 = (uint64_t)v15;
    if (a3 >= 0x13) {
      int v17 = 19;
    }
    else {
      int v17 = a3;
    }
    if (a3) {
      unsigned int v18 = v17;
    }
    else {
      unsigned int v18 = 1;
    }
    if (sub_10018581C(a1))
    {
      *(_BYTE *)(v16 + 16) = 1;
      *(_DWORD *)(v16 + 20) = 0;
      *(void *)uint64_t v16 = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
      *(void *)(v16 + 8) = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
      uint64_t v19 = sub_100187F28;
      uint64_t v20 = sub_100188074;
    }

    else
    {
      BOOL v21 = sub_100185870(a1);
      *(_BYTE *)(v16 + 16) = 0;
      *(_DWORD *)(v16 + 20) = 0;
      *(void *)uint64_t v16 = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
      if (v21)
      {
        uint64_t v19 = sub_1001880E8;
        uint64_t v20 = sub_100188204;
      }

      else
      {
        uint64_t v19 = sub_100188260;
        uint64_t v20 = sub_10018839C;
      }
    }

    *(void *)(v16 + 64) = v19;
    *(void *)(v16 + 72) = v20;
    *(void *)(v16 + 56) = a6;
    *(_WORD *)(v16 + 24) = a1;
    *(_BYTE *)(v16 + 26) = a2;
    *(_BYTE *)(v16 + 27) = v18;
    *(_WORD *)(v16 + 28) = 255;
    *(void *)(v16 + 40) = a4;
    *(_DWORD *)(v16 + 32) = 0;
    *(void *)(v16 + 48) = sub_1000B05D8();
    uint64_t v22 = qword_1008E2C28;
    if (qword_1008E2C28)
    {
      uint64_t v23 = qword_1008E2C28;
      while (*(unsigned __int8 *)(v23 + 27) >= v18)
      {
        uint64_t v23 = *(void *)(v23 + 80);
        if (qword_1008E2C28 == v23)
        {
          uint64_t v23 = qword_1008E2C28;
          break;
        }
      }

      uint64_t v24 = *(void *)(v23 + 88);
      *(void *)(v16 + 80) = v23;
      *(void *)(v16 + 88) = v24;
      *(void *)(*(void *)(v23 + 88) + 80LL) = v16;
      *(void *)(v23 + 88) = v16;
      uint64_t v25 = &qword_1008E2C28;
    }

    else
    {
      qword_1008E2C28 = v16;
      *(void *)(v16 + 80) = v16;
      uint64_t v25 = (uint64_t *)(v16 + 88);
    }

    *uint64_t v25 = v16;
LABEL_34:
    if (a5) {
      *a5 = v16;
    }
    ++byte_1008E2C30;
    if (!sub_100171EC4(a1, (uint64_t *)&v27) && *v27 == 4)
    {
      uint64_t v26 = (unsigned __int16 **)sub_10017AB4C(v27);
      sub_100102DB4(*v26);
    }

    return 0LL;
  }

  uint64_t v13 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v13 + 24) != a1)
  {
    uint64_t v13 = *(void *)(v13 + 80);
    if (v13 == qword_1008E2C28 || v13 == 0) {
      goto LABEL_11;
    }
  }

  return 119LL;
}

uint64_t sub_100187F28(uint64_t a1, uint64_t *a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  *a2 = 0LL;
  if (*(_BYTE *)(a1 + 29)) {
    return 0LL;
  }
  unint64_t v4 = (uint64_t *)(a1 + 8);
  if (!sub_1001EC434(*(void *)(a1 + 8)))
  {
    unint64_t v4 = (uint64_t *)a1;
    if (!sub_1001EC434(*(void *)a1))
    {
      if (*(void *)(a1 + 56) == 0xFFFFFFFFLL)
      {
        uint64_t v13 = sub_1000B05D8();
        uint64_t result = 0LL;
        *(void *)(a1 + 48) = v13;
        return result;
      }

      return 0LL;
    }
  }

  uint64_t v5 = sub_1001EC30C(*v4);
  *(void *)(a1 + 96) = *v4;
  uint64_t v6 = *(void *)(v5 + 8);
  int v7 = *(unsigned __int8 *)(v6 + 2);
  if (!*(_BYTE *)(v6 + 2) && byte_1008F6E91 == 0) {
    return 0LL;
  }
  if (v7 == 4 && byte_1008F6E92 == 0) {
    return 0LL;
  }
  if (v7 == 8 && byte_1008F6E90 == 0) {
    return 0LL;
  }
  uint64_t v11 = v5;
  if (!sub_10012D514(*(void *)(v5 + 8))
    && !sub_10012D5BC(v6)
    && !sub_10012D5EC(v6)
    && !sub_10012D61C(v6)
    || (*(_BYTE *)(*(void *)(v11 + 8) + 2LL) || (uint64_t result = sub_10012D654(v6), (_DWORD)result))
    && (uint64_t result = sub_10018A2D0(v6, *(unsigned __int8 *)(a1 + 27)), (_DWORD)result))
  {
    *a2 = v11;
    return 1LL;
  }

  return result;
}

void sub_100188074(uint64_t a1, _BYTE *a2)
{
  uint64_t v3 = (void *)*((void *)a2 + 3);
  if (*a2)
  {
    sub_1001EF45C((uint64_t)v3);
    *((void *)a2 + 3) = 0LL;
    sub_1000B1838(a2);
  }

  else
  {
    if (v3)
    {
      sub_1001EF69C(v3);
      *((void *)a2 + 3) = 0LL;
    }

    sub_1001EF6C0(*((void *)a2 + 5));
  }

uint64_t sub_1001880E8(uint64_t a1, uint64_t *a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  *a2 = 0LL;
  uint64_t v4 = *(void *)a1;
  *(void *)(a1 + 96) = *(void *)a1;
  if (!sub_1001EC434(v4))
  {
    if (*(void *)(a1 + 56) == 0xFFFFFFFFLL)
    {
      uint64_t v9 = sub_1000B05D8();
      uint64_t result = 0LL;
      *(void *)(a1 + 48) = v9;
      return result;
    }

    return 0LL;
  }

  uint64_t v5 = sub_1001EC30C(*(void *)a1);
  if (!sub_10012D514(*(void *)(v5 + 8))
    && !sub_10012D5BC(*(void *)(v5 + 8))
    && !sub_10012D5EC(*(void *)(v5 + 8))
    && !sub_10012D61C(*(void *)(v5 + 8)))
  {
    goto LABEL_17;
  }

  uint64_t v10 = 0LL;
  uint64_t v6 = *(void *)(v5 + 8);
  if (*(_BYTE *)(v6 + 2) == 4 && byte_1008F6E92 == 0) {
    return 0LL;
  }
  uint64_t result = sub_10012D688(v6);
  if (!(_DWORD)result) {
    return result;
  }
  uint64_t result = sub_10016EDCC(v10);
  if ((_DWORD)result)
  {
    uint64_t result = sub_10018A2D0(*(void *)(v5 + 8), *(unsigned __int8 *)(v5 + 32));
    if ((_DWORD)result)
    {
LABEL_17:
      *a2 = v5;
      return 1LL;
    }
  }

  return result;
}

void sub_100188204(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = 0LL;
  uint64_t v3 = *(void *)(a2 + 24);
  if (v3)
  {
    sub_1001EF45C(v3);
    *(void *)(a2 + 24) = 0LL;
  }

  sub_1000B1838((void *)a2);
}

BOOL sub_100188260(uint64_t a1, uint64_t *a2)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  *a2 = 0LL;
  if (*(_BYTE *)(a1 + 29)) {
    return 0LL;
  }
  uint64_t v5 = *(void *)a1;
  *(void *)(a1 + 96) = *(void *)a1;
  uint64_t v6 = sub_1001EC30C(v5);
  if (!v6)
  {
    if (*(void *)(a1 + 56) == 0xFFFFFFFFLL)
    {
      uint64_t v10 = sub_1000B05D8();
      BOOL result = 0LL;
      *(void *)(a1 + 48) = v10;
      return result;
    }

    return 0LL;
  }

  uint64_t v7 = v6;
  uint64_t v8 = *(void *)(v6 + 8);
  if (!sub_10012D514(v8) && !sub_10012D5BC(v8) && !sub_10012D5EC(v8) && !sub_10012D61C(v8))
  {
LABEL_26:
    *a2 = v7;
    return 1LL;
  }

  int v9 = *(unsigned __int8 *)(v8 + 2);
  if (v9 == 8) {
    goto LABEL_24;
  }
  if (v9 != 4)
  {
    if (!*(_BYTE *)(v8 + 2))
    {
      if (byte_1008F6E91 && (sub_10012D654(v8) & 1) != 0) {
        goto LABEL_25;
      }
      return 0LL;
    }

    sub_1001EE2A0();
LABEL_24:
    if (byte_1008F6E90) {
      goto LABEL_25;
    }
    return 0LL;
  }

  if (!*(_BYTE *)(v8 + 129) && (!byte_1008F6E92 || !sub_10012D688(v8))) {
    return 0LL;
  }
LABEL_25:
  BOOL result = sub_10018A2D0(v8, *(unsigned __int8 *)(v7 + 32));
  if (result) {
    goto LABEL_26;
  }
  return result;
}

void sub_10018839C(uint64_t a1, void *a2)
{
  if (!a2) {
    sub_1001EE2A0();
  }
  uint64_t v3 = a2[3];
  if (v3 || (sub_1001EE2A0(), (uint64_t v3 = a2[3]) != 0))
  {
    sub_1001EF45C(v3);
    a2[3] = 0LL;
  }

  sub_1000B1838(a2);
}

void *sub_1001883E0(void *result)
{
  if (byte_1008E2C48 == 1)
  {
    int v1 = (int)result;
    if (!qword_1008E2C28)
    {
LABEL_22:
      sub_1001884E4(qword_1008E2C38, v1);
      return sub_1001884E4(qword_1008E2C40, v1);
    }

    uint64_t v2 = (void **)qword_1008E2C28;
    while (*((unsigned __int16 *)v2 + 12) != (_DWORD)result)
    {
      uint64_t v2 = (void **)v2[10];
      if (v2 == (void **)qword_1008E2C28 || v2 == 0LL) {
        goto LABEL_22;
      }
    }

    if (v2[5]) {
      sub_1001EEB14(*((unsigned int *)v2 + 8));
    }
    uint64_t v4 = v2[10];
    if (v4 == v2)
    {
      uint64_t v6 = 0LL;
    }

    else
    {
      uint64_t v5 = v2[11];
      v5[10] = v4;
      uint64_t v6 = (uint64_t)v2[10];
      *(void *)(v6 + 88) = v5;
      if ((void **)qword_1008E2C28 != v2)
      {
LABEL_19:
        --byte_1008E2C30;
        if (*((_BYTE *)v2 + 16)) {
          sub_1001EC070(v2[1]);
        }
        sub_1001EC070(*v2);
        sub_1000B1838(v2);
        goto LABEL_22;
      }
    }

    qword_1008E2C28 = v6;
    goto LABEL_19;
  }

  return result;
}

void *sub_1001884E4(uint64_t a1, int a2)
{
  BOOL result = (void *)sub_1001EC43C(a1);
  for (ptr = result; ptr; BOOL result = ptr)
  {
    while (1)
    {
      uint64_t v5 = sub_1001EC460((uint64_t)result);
      sub_1001EC4B4(a1, ptr, 1);
      BOOL result = (void *)sub_1001EC43C(a1);
      ptr = result;
      if (!result) {
        return result;
      }
    }

    sub_1001EC444((uint64_t)&ptr);
  }

  return result;
}

uint64_t sub_100188560(int a1)
{
  if (!qword_1008E2C28) {
    return 0LL;
  }
  uint64_t v1 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v1 + 24) != a1)
  {
    uint64_t v1 = *(void *)(v1 + 80);
    if (v1 == qword_1008E2C28 || v1 == 0) {
      return 0LL;
    }
  }

  return sub_1001EC434(*(void *)v1);
}

void sub_10018859C(unsigned int a1)
{
  if (!qword_1008E2C28) {
    return;
  }
  uint64_t v2 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v2 + 24) != a1)
  {
    uint64_t v2 = *(void *)(v2 + 80);
    if (v2 == qword_1008E2C28 || v2 == 0) {
      return;
    }
  }

  if (!*(_BYTE *)(v2 + 16))
  {
    BOOL v6 = sub_100185870(a1);
    unsigned int v7 = sub_1001EC434(*(void *)v2);
    unsigned int v8 = *(unsigned __int8 *)(v2 + 26);
    if (v6)
    {
    }

    else if (v7 < v8)
    {
      goto LABEL_14;
    }

unsigned int *sub_1001886B8(unsigned int *result, unsigned __int16 *a2, unint64_t a3, char a4)
{
  unsigned int v7 = result;
  uint64_t v8 = qword_1008E2C28;
  do
  {
    if (!v8) {
      break;
    }
    unsigned int v9 = *(unsigned __int16 *)(v8 + 24);
    if (a3)
    {
      if (v9 == *a2)
      {
        BOOL v10 = 1;
      }

      else
      {
        uint64_t v11 = 1LL;
        do
        {
          unint64_t v12 = v11;
          if (a3 == v11) {
            break;
          }
          int v13 = a2[v11++];
        }

        while (v9 != v13);
        BOOL v10 = v12 < a3;
      }
    }

    else
    {
      BOOL v10 = 0;
    }

    uint64_t v14 = 0LL;
    BOOL result = (unsigned int *)sub_100171EC4(v9, (uint64_t *)&v14);
    if (!v10 && !(_DWORD)result)
    {
      BOOL result = v14;
      if (*v14 == 2)
      {
        BOOL result = (unsigned int *)sub_10017AB4C(v14);
      }
    }

    uint64_t v8 = *(void *)(v8 + 80);
  }

  while (v8 != qword_1008E2C28);
  if ((a4 & 1) == 0) {
    dword_1008E2C4C = 2;
  }
  return result;
}

uint64_t sub_1001887B0(uint64_t result, unsigned __int16 *a2, uint64_t a3, char a4)
{
  uint64_t v7 = result;
  int v13 = 0LL;
  uint64_t v8 = qword_1008E2C28;
  do
  {
    if (!v8) {
      break;
    }
    BOOL result = *(unsigned __int16 *)(v8 + 24);
    char v9 = 0;
    if (a3)
    {
      uint64_t v10 = a3;
      uint64_t v11 = a2;
      do
      {
        int v12 = *v11++;
        v9 |= (_DWORD)result == v12;
        --v10;
      }

      while (v10);
    }

    if (result >= 0x40 && (v9 & 1) == 0)
    {
      BOOL result = sub_100171EC4(result, (uint64_t *)&v13);
      if (!(_DWORD)result)
      {
        BOOL result = (uint64_t)v13;
        if (*v13 == 4)
        {
          BOOL result = sub_10017AB4C(v13);
          if (*(void *)result == v7) {
            *(_BYTE *)(v8 + 29) = a4;
          }
        }
      }
    }

    uint64_t v8 = *(void *)(v8 + 80);
  }

  while (v8 != qword_1008E2C28);
  if ((a4 & 1) == 0) {
    dword_1008E2C4C = 2;
  }
  return result;
}

uint64_t sub_100188888(uint64_t a1, uint64_t a2, unsigned __int16 *a3, unint64_t a4)
{
  uint64_t v43 = 0LL;
  uint64_t i = 0LL;
  uint64_t v8 = qword_1008E2C28;
  char v9 = (mach_header_64 *)&_mh_execute_header;
  do
  {
    if (!v8) {
      break;
    }
    unsigned int v10 = *(unsigned __int16 *)(v8 + 24);
    if (v10 >= 0x40)
    {
      if (a4)
      {
        if (v10 == *a3)
        {
          BOOL v11 = 1;
        }

        else
        {
          uint64_t v12 = 1LL;
          do
          {
            unint64_t v13 = v12;
            if (a4 == v12) {
              break;
            }
            int v14 = a3[v12++];
          }

          while (v10 != v14);
          BOOL v11 = v13 < a4;
        }
      }

      else
      {
        BOOL v11 = 0;
      }

      if (!sub_100171EC4(v10, (uint64_t *)&v43))
      {
        BOOL v15 = *v43 != 4 || v11;
        if (!v15 && *(void *)sub_10017AB4C(v43) == a1)
        {
          *(void *)sub_10017AB4C(v43) = a2;
          uint64_t v16 = v9;
          if (*(_BYTE *)(v8 + 16)) {
            uint64_t v17 = *(void *)(v8 + 8);
          }
          else {
            uint64_t v17 = 0LL;
          }
          uint64_t v18 = *(void *)v8;
          if (*(void *)v8)
          {
            if (sub_1001EC434(*(void *)v8))
            {
              uint64_t v19 = sub_1001EC43C(v18);
              for (i = v19; i; uint64_t v19 = i)
              {
                uint64_t v20 = sub_1001EC460(v19);
                if (*(void *)(v20 + 8) == a1) {
                  *(void *)(v20 + 8) = a2;
                }
                sub_1001EC444((uint64_t)&i);
              }
            }
          }

          char v9 = v16;
          if (v17)
          {
            if (sub_1001EC434(v17))
            {
              uint64_t v21 = sub_1001EC43C(v17);
              for (i = v21; i; uint64_t v21 = i)
              {
                uint64_t v22 = sub_1001EC460(v21);
                if (*(void *)(v22 + 8) == a1) {
                  *(void *)(v22 + 8) = a2;
                }
                sub_1001EC444((uint64_t)&i);
              }
            }
          }

          sub_100181E7C(v43, a1, a2);
        }
      }

      if (sub_1000A86F0())
      {
        uint64_t v23 = *(unsigned __int16 *)(v8 + 24);
        sub_10017AB4C(v43);
        sub_1001EE134( (uint64_t)"CID:0x%04x cidExcluded:%d currentHandle:%p oldHandle:%p newHandle:%p",  v24,  v25,  v26,  v27,  v28,  v29,  v30,  v23);
        __int16 v31 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v32 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v46 = v32;
          _os_log_impl(v9, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }

    uint64_t v8 = *(void *)(v8 + 80);
  }

  while (v8 != qword_1008E2C28);
  uint64_t v33 = sub_1001EC43C(qword_1008E2C38);
  for (i = v33; i; uint64_t v33 = i)
  {
    uint64_t v34 = sub_1001EC460(v33);
    if (a4)
    {
      unsigned int v35 = *(unsigned __int16 *)(v34 + 36);
      uint64_t v36 = a3;
      unint64_t v37 = a4;
      do
      {
        if (v35 >= 0x40 && v35 != *v36 && *(void *)(v34 + 8) == a1) {
          *(void *)(v34 + 8) = a2;
        }
        ++v36;
        --v37;
      }

      while (v37);
    }

    sub_1001EC444((uint64_t)&i);
  }

  uint64_t result = sub_1001EC43C(qword_1008E2C40);
  for (i = result; i; uint64_t result = i)
  {
    uint64_t v39 = sub_1001EC460(result);
    if (a4)
    {
      unsigned int v40 = *(unsigned __int16 *)(v39 + 36);
      uint64_t v41 = a3;
      unint64_t v42 = a4;
      do
      {
        if (v40 >= 0x40 && v40 != *v41 && *(void *)(v39 + 8) == a1) {
          *(void *)(v39 + 8) = a2;
        }
        ++v41;
        --v42;
      }

      while (v42);
    }

    sub_1001EC444((uint64_t)&i);
  }

  return result;
}

uint64_t sub_100188BE4(uint64_t a1)
{
  if (!qword_1008E2C28) {
    return 404LL;
  }
  unsigned int v2 = *(unsigned __int16 *)(a1 + 20);
  uint64_t v3 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v3 + 24) != v2)
  {
    uint64_t v3 = *(void *)(v3 + 80);
    if (v3 == qword_1008E2C28 || v3 == 0) {
      return 404LL;
    }
  }

  uint64_t v7 = (unsigned __int16 *)(v3 + 24);
  int v8 = sub_10018581C(v2);
  int v9 = *(unsigned __int8 *)(v3 + 16);
  if (v9 != v8)
  {
    sub_1001EE2A0();
    int v9 = *(unsigned __int8 *)(v3 + 16);
  }

  if (v9)
  {
    int v10 = sub_1001EC434(*(void *)v3);
    unsigned int v11 = v10 - *(_DWORD *)(v3 + 20);
    unsigned int v12 = *(unsigned __int8 *)(v3 + 26);
    if (v11 >= v12) {
      return 410LL;
    }
    int v13 = v10;
    if (v11 == v12 - 1) {
      uint64_t v5 = 0LL;
    }
    else {
      uint64_t v5 = 412LL;
    }
    int v14 = sub_1000B17F4(0x40uLL);
    if (!v14) {
      return 106LL;
    }
    BOOL v15 = v14;
    *int v14 = 0;
    v14[1] = *(_BYTE *)a1;
    *((_DWORD *)v14 + 1) = 0;
    *((void *)v14 + 1) = *(void *)(a1 + 8);
    *((_DWORD *)v14 + 4) = *(_DWORD *)(a1 + 16);
    if (sub_1001EF2D8((void *)v14 + 5, a1 + 40, 0))
    {
      sub_1000B1838(v15);
      return 106LL;
    }

    *((_BYTE *)v15 + 32) = *(_BYTE *)(v3 + 27);
    *((_BYTE *)v15 + 33) = *(_BYTE *)(a1 + 24);
    *((_WORD *)v15 + 17) = *(_WORD *)(a1 + 26);
    unsigned int v19 = *(unsigned __int16 *)(v3 + 24);
    *((_WORD *)v15 + 18) = v19;
    *((_WORD *)v15 + 19) = sub_100185968(v19);
    *((void *)v15 + 3) = 0LL;
    *((_BYTE *)v15 + 48) = 0;
    *((void *)v15 + 7) = *(void *)(a1 + 32);
    if (!v13 && *(void *)(v3 + 56) == 0xFFFFFFFFLL) {
      *(void *)(v3 + 48) = sub_1000B05D8();
    }
    uint64_t v20 = *(void *)v3;
    uint64_t v21 = (uint64_t)v15;
    goto LABEL_53;
  }

  v29[0] = 0LL;
  __int16 v30 = 0;
  unsigned int v16 = sub_1001EC434(*(void *)v3);
  if (v16 >= *(unsigned __int8 *)(v3 + 26))
  {
    uint64_t v5 = 410LL;
    goto LABEL_54;
  }

  unsigned int v17 = v16;
  if (sub_100185870(*v7)
    && (int v18 = *(unsigned __int8 *)(v3 + 26), v17 >= ~sub_100187584(*(unsigned __int16 *)(v3 + 24)) + v18))
  {
    uint64_t v5 = 0LL;
  }

  else if (v17 == *(unsigned __int8 *)(v3 + 26) - 1)
  {
    uint64_t v5 = 0LL;
  }

  else
  {
    uint64_t v5 = 412LL;
  }

  uint64_t v22 = sub_1000B17F4(0x40uLL);
  if (!v22)
  {
LABEL_43:
    uint64_t v5 = 106LL;
    goto LABEL_54;
  }

  uint64_t v23 = v22;
  *uint64_t v22 = -1;
  unsigned int v24 = *v7;
  *((_WORD *)v23 + 18) = v24;
  v23[1] = *(_BYTE *)a1;
  *((_DWORD *)v23 + 1) = 0;
  *((void *)v23 + 1) = *(void *)(a1 + 8);
  *((_DWORD *)v23 + 4) = *(_DWORD *)(a1 + 16);
  *((void *)v23 + 7) = *(void *)(a1 + 32);
  BOOL v25 = 0;
  if (!sub_100171EC4(v24, (uint64_t *)v29)) {
    BOOL v25 = (*(_DWORD *)v29[0] == 4 || *(_DWORD *)v29[0] == 2)
  }
       && *(_BYTE *)(sub_10017AB4C((unsigned int *)v29[0]) + 78) != 0;
  uint64_t v26 = (uint64_t *)(v23 + 24);
  if (sub_1001EF2D8((void *)v23 + 3, a1 + 40, v25))
  {
    sub_1000B1838(v23);
    goto LABEL_43;
  }

  if (v25)
  {
    sub_100185704(*v26, &v30);
    sub_1001EFB10((unsigned __int8 *)*v26, (char *)&v30, 2uLL, 0);
  }

  *((_WORD *)v23 + 17) = *(_WORD *)(*((void *)v23 + 3) + 4LL);
  *((void *)v23 + 5) = 0LL;
  v23[32] = *(_BYTE *)(v3 + 27);
  if (!v17 && *(void *)(v3 + 56) == 0xFFFFFFFFLL) {
    *(void *)(v3 + 48) = sub_1000B05D8();
  }
  if (*(_BYTE *)(a1 + 1)) {
    uint64_t v20 = qword_1008E2C40;
  }
  else {
    uint64_t v20 = *(void *)v3;
  }
  uint64_t v21 = (uint64_t)v23;
LABEL_53:
  sub_1001EC1DC(v20, v21, 8LL);
LABEL_54:
  if ((_DWORD)v5 == 412 || !(_DWORD)v5)
  {
    dword_1008E2C4C = 2;
    if (*(void *)(v3 + 40))
    {
      unsigned int v28 = *(_DWORD *)(v3 + 32);
      uint64_t v27 = (unsigned int *)(v3 + 32);
      if (sub_1001EE9D8(v28))
      {
        sub_1001EE978(*v27, 300);
      }

      else
      {
        v29[1] = v7;
        v29[0] = (const void *)2;
        sub_1001EE6E8((uint64_t)sub_100188F5C, v29, 300, (int *)v27);
      }
    }
  }

  return v5;
}

void sub_100188F5C(uint64_t a1)
{
  if (a1)
  {
    uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
    if (qword_1008E2C28)
    {
      uint64_t v2 = qword_1008E2C28;
      while (*(unsigned __int16 *)(v2 + 24) != (_DWORD)v1)
      {
        uint64_t v2 = *(void *)(v2 + 80);
        if (v2 == qword_1008E2C28 || v2 == 0) {
          goto LABEL_10;
        }
      }
    }

    else
    {
LABEL_10:
      sub_1001EE2A0();
      uint64_t v2 = 0LL;
    }

    if (!*(void *)(v2 + 40)) {
      sub_1001EE2A0();
    }
    sub_1000B05D8();
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Stall Monitor detected TX stall on CID 0x%04x Priority= %u maxLatency=%llu lastServiceTime=%llu, deltaT ime=%llu ms,  CB 0x%x",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  v1);
      unsigned int v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    unsigned int v12 = *(void (**)(uint64_t))(v2 + 40);
    if (v12) {
      v12(v1);
    }
  }

  else
  {
    sub_1001EE2A0();
  }

uint64_t sub_10018904C(uint64_t a1)
{
  if (!qword_1008E2C28) {
    goto LABEL_15;
  }
  uint64_t v2 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v2 + 24) != *(unsigned __int16 *)(a1 + 20))
  {
    uint64_t v2 = *(void *)(v2 + 80);
    if (v2 == qword_1008E2C28 || v2 == 0) {
      goto LABEL_15;
    }
  }

  if (*(_BYTE *)(v2 + 16))
  {
    sub_1001EC434(*(void *)(v2 + 8));
    int v4 = sub_1001EC434(*(void *)(v2 + 8));
    uint64_t v5 = sub_1000B17F4(0x40uLL);
    if (!v5) {
      return 106LL;
    }
    uint64_t v6 = (uint64_t)v5;
    *uint64_t v5 = 1;
    v5[1] = *(_BYTE *)a1;
    *((_DWORD *)v5 + 1) = 0;
    *((void *)v5 + 1) = *(void *)(a1 + 8);
    *((_DWORD *)v5 + 4) = *(_DWORD *)(a1 + 16);
    if (sub_1001EF2D8((void *)v5 + 3, a1 + 40, 0))
    {
      sub_1000B1838((void *)v6);
      return 106LL;
    }

    *(_BYTE *)(v6 + 32) = *(_BYTE *)(v2 + 27);
    *(_BYTE *)(v6 + 33) = *(_BYTE *)(a1 + 24);
    *(_WORD *)(v6 + 34) = *(_WORD *)(a1 + 26);
    *(_WORD *)(v6 + 36) = *(_WORD *)(v2 + 24);
    *(_BYTE *)(v6 + 48) = 0;
    *(void *)(v6 + 56) = 0LL;
    *(void *)(v6 + 40) = 0LL;
    if (*(void *)(v2 + 56) == 0xFFFFFFFFLL && !v4) {
      *(void *)(v2 + 48) = sub_1000B05D8();
    }
    sub_1001EC1DC(*(void *)(v2 + 8), v6, 8LL);
    uint64_t result = 0LL;
    dword_1008E2C4C = 2;
  }

  else
  {
LABEL_15:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Can't retransmit a basic flow control channel.", v8, v9, v10, v11, v12, v13, v14, v16);
      BOOL v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EE2A0();
    return 509LL;
  }

  return result;
}

uint64_t sub_1001891CC(uint64_t a1)
{
  if (!qword_1008E2C28) {
    goto LABEL_12;
  }
  uint64_t v1 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v1 + 24) != *(unsigned __int16 *)(a1 + 36))
  {
    uint64_t v1 = *(void *)(v1 + 80);
    if (v1 == qword_1008E2C28 || v1 == 0) {
      goto LABEL_12;
    }
  }

  if (*(_BYTE *)(v1 + 16))
  {
    *(_DWORD *)(a1 + 4) = 0;
    sub_1001EC124(*(void *)v1, a1, 8LL);
    uint64_t result = 0LL;
    ++*(_DWORD *)(v1 + 20);
    dword_1008E2C4C = 2;
  }

  else
  {
LABEL_12:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Can't retransmit a basic flow control channel.", v4, v5, v6, v7, v8, v9, v10, v12);
      uint64_t v11 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EE2A0();
    return 510LL;
  }

  return result;
}

uint64_t sub_10018929C(int a1)
{
  if (qword_1008E2C28)
  {
    uint64_t v1 = qword_1008E2C28;
    while (*(unsigned __int16 *)(v1 + 24) != a1)
    {
      uint64_t v1 = *(void *)(v1 + 80);
      if (v1 == qword_1008E2C28 || v1 == 0) {
        goto LABEL_12;
      }
    }

    if (*(_BYTE *)(v1 + 16)) {
      return sub_1001EC434(*(void *)v1) != 0;
    }
  }

uint64_t sub_100189344(unsigned int a1)
{
  if (!qword_1008E2C28) {
    return 404LL;
  }
  uint64_t v2 = (void **)qword_1008E2C28;
  while (*((unsigned __int16 *)v2 + 12) != a1)
  {
    uint64_t v2 = (void **)v2[10];
    if (v2 == (void **)qword_1008E2C28 || v2 == 0LL) {
      return 404LL;
    }
  }

  int v5 = *((unsigned __int8 *)v2 + 16);
  if (v5 == sub_10018581C(a1))
  {
    unsigned int v6 = *((unsigned __int8 *)v2 + 26);
    goto LABEL_27;
  }

  int v7 = *((unsigned __int8 *)v2 + 16);
  int v8 = sub_1001EC434((uint64_t)*v2);
  if (!v7)
  {
    if (v8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Warning there is packets queued in the basic queue. This will drop packets",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  v27);
        BOOL v25 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_10018859C(a1);
    }

    sub_1001EC070(*v2);
    *((_BYTE *)v2 + 16) = 1;
    *((_DWORD *)v2 + 5) = 0;
    const char *v2 = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
    v2[1] = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
    v2[8] = sub_100187F28;
    v2[9] = sub_100188074;
LABEL_27:
    unsigned __int8 v26 = sub_1001857CC(a1);
    uint64_t result = 0LL;
    *((_BYTE *)v2 + 26) = v26 + 1;
    return result;
  }

  if (v8 || sub_1001EC434((uint64_t)v2[1]))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Warning there is packets queued in the sFrame or iFrame queues. This will drop packets",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v27);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_10018859C(a1);
  }

  *((_BYTE *)v2 + 16) = 0;
  *((_DWORD *)v2 + 5) = 0;
  sub_1001EC070(*v2);
  sub_1001EC070(v2[1]);
  unsigned int v17 = sub_1001EC038(0LL, (uint64_t)sub_100186F84);
  uint64_t result = 0LL;
  const char *v2 = v17;
  v2[8] = sub_100188260;
  v2[9] = sub_10018839C;
  return result;
}

uint64_t sub_100189534(int a1)
{
  uint64_t v1 = qword_1008E2C28;
  if (!qword_1008E2C28) {
    return 404LL;
  }
  uint64_t v2 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v2 + 24) != a1)
  {
    uint64_t v2 = *(void *)(v2 + 80);
    if (v2 == qword_1008E2C28 || v2 == 0) {
      return 404LL;
    }
  }

  *(_BYTE *)(v2 + 27) = 10;
  if (v1 == v2) {
    return 0LL;
  }
  uint64_t v5 = *(void *)(v2 + 80);
  if (v2 == v5) {
    return 0LL;
  }
  uint64_t result = 0LL;
  uint64_t v6 = *(void *)(v2 + 88);
  *(void *)(v6 + 80) = v5;
  *(void *)(*(void *)(v2 + 80) + 88LL) = v6;
  uint64_t v7 = *(void *)(v1 + 88);
  *(void *)(v2 + 80) = v1;
  *(void *)(v2 + 88) = v7;
  *(void *)(*(void *)(v1 + 88) + 80LL) = v2;
  *(void *)(v1 + 88) = v2;
  qword_1008E2C28 = v2;
  return result;
}

uint64_t sub_1001895BC(int a1, unsigned int a2, unsigned int a3)
{
  if (!qword_1008E2C28) {
    return 404LL;
  }
  char v4 = a2;
  uint64_t v5 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v5 + 24) != a1)
  {
    uint64_t v5 = *(void *)(v5 + 80);
    if (v5 == qword_1008E2C28 || v5 == 0) {
      return 404LL;
    }
  }

  if (a2 >= 0x14)
  {
    sub_1001EE2A0();
    if (sub_1000A86F0())
    {
      char v4 = 19;
      sub_1001EE134((uint64_t)"Scaling down requested priority to %d", v8, v9, v10, v11, v12, v13, v14, 19LL);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        goto LABEL_17;
      }
      sub_100657F74();
    }

    char v4 = 19;
    goto LABEL_17;
  }

  if (a2 != 12)
  {
LABEL_17:
    sub_1000BC23C((_opaque_pthread_t *)qword_1008E2C50, 0, 0, 0, 1);
    goto LABEL_18;
  }

  sub_1000BC23C((_opaque_pthread_t *)qword_1008E2C50, 0, 0, 0, 0);
  char v4 = 12;
LABEL_18:
  *(void *)(v5 + 56) = a3;
  *(void *)(v5 + 48) = sub_1000B05D8();
  *(_BYTE *)(v5 + 27) = v4;
  uint64_t v16 = qword_1008E2C28;
  if (qword_1008E2C28 == v5) {
    return 0LL;
  }
  uint64_t v17 = *(void *)(v5 + 80);
  if (v5 == v17) {
    return 0LL;
  }
  uint64_t result = 0LL;
  uint64_t v18 = *(void *)(v5 + 88);
  *(void *)(v18 + 80) = v17;
  *(void *)(*(void *)(v5 + 80) + 88LL) = v18;
  uint64_t v19 = *(void *)(v16 + 88);
  *(void *)(v5 + 80) = v16;
  *(void *)(v5 + 88) = v19;
  *(void *)(*(void *)(v16 + 88) + 80LL) = v5;
  *(void *)(v16 + 88) = v5;
  qword_1008E2C28 = v5;
  return result;
}

uint64_t sub_100189724(int a1)
{
  if (!qword_1008E2C28) {
    return 404LL;
  }
  uint64_t v1 = qword_1008E2C28;
  while (*(unsigned __int16 *)(v1 + 24) != a1)
  {
    uint64_t v1 = *(void *)(v1 + 80);
    if (v1 == qword_1008E2C28 || v1 == 0) {
      return 404LL;
    }
  }

  uint64_t v4 = sub_1000B05D8();
  uint64_t result = 0LL;
  *(void *)(v1 + 48) = v4;
  return result;
}

BOOL sub_100189780()
{
  return dword_1008E2C4C == 2;
}

uint64_t sub_100189794()
{
  return j__pthread_cond_signal(&stru_1008E2C58);
}

uint64_t sub_1001897A0()
{
  if (byte_1008E2C48 == 1) {
    sub_1001EE2A0();
  }
  if (byte_1008E2C30) {
    sub_1001EE2A0();
  }
  if (qword_1008E2C28) {
    sub_1001EE2A0();
  }
  byte_1008E2C48 = 1;
  sub_1000BC2FC(&stru_1008E2C58);
  sub_1000BC2FC(&stru_1008E2C88);
  dword_1008E2C4C = 0;
  qword_1008E2C38 = (uint64_t)sub_1001EC038(0LL, (uint64_t)sub_100186F84);
  qword_1008E2C40 = (uint64_t)sub_1001EC038(0LL, (uint64_t)sub_100186F84);
  sub_100187CD4(1u, 48, 0xAu, 0LL, 0LL, 0xFFFFFFFF);
  sub_100187CD4(2u, 5, 1u, 0LL, 0LL, 0xFFFFFFFF);
  sub_1000BC20C((_opaque_pthread_t *)qword_1008E2C50, 63);
  uint64_t result = 0LL;
  byte_1008E2CB8 = 1;
  return result;
}

uint64_t sub_1001898BC()
{
  if (byte_1008E2C48 == 1)
  {
    do
    {
      sub_100187740();
      sub_1000A86C4(&stru_1008E2C58);
    }

    while ((byte_1008E2C48 & 1) != 0);
  }

  sub_1000A8688();
  byte_1008E2CB8 = 0;
  j__pthread_cond_signal(&stru_1008E2C88);
  return 0LL;
}

BOOL sub_10018992C()
{
  if ((byte_1008E2C48 & 1) == 0) {
    sub_1001EE2A0();
  }
  if (!qword_1008E2C28) {
    sub_1001EE2A0();
  }
  sub_1001883E0((void *)1);
  sub_1001883E0((void *)2);
  sub_1001EC070((void *)qword_1008E2C38);
  qword_1008E2C38 = 0LL;
  sub_1001EC070((void *)qword_1008E2C40);
  qword_1008E2C40 = 0LL;
  byte_1008E2C30 = 0;
  qword_1008E2C28 = 0LL;
  byte_1008E2C48 = 0;
  dword_1008E2C4C = 0;
  j__pthread_cond_signal(&stru_1008E2C58);
  do
    sub_1000A86C4(&stru_1008E2C88);
  while ((byte_1008E2CB8 & 1) != 0);
  sub_1000BC320(&stru_1008E2C58);
  return sub_1000BC320(&stru_1008E2C88);
}

uint64_t sub_100189A00(uint64_t a1)
{
  return sub_1001729A0(**(unsigned __int16 **)(a1 + 8));
}

void sub_100189A0C(uint64_t a1)
{
  uint64_t v2 = *(unsigned __int16 *)(a1 + 36);
  unsigned int v35 = 0LL;
  uint64_t v36 = 0LL;
  __int16 v37 = 0;
  __int16 v34 = 0;
  if (!sub_100171EC4(v2, (uint64_t *)&v35) && (*v35 != 4 ? (BOOL v11 = *v35 == 2) : (BOOL v11 = 1), v11))
  {
    if (!*(void *)(a1 + 24))
    {
      WORD1(v36) = *(_WORD *)(sub_10017AB4C(v35) + 8);
      if (*(_BYTE *)a1)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Why are we trying to add a header to a S-Frame ???",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v33);
          uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
            goto LABEL_4;
          }
        }
      }

      else
      {
        __int16 v20 = sub_100186698(v35, (_WORD *)&v36 + 2, *(unsigned __int8 *)(a1 + 33), *(_WORD *)(a1 + 38));
        unsigned __int16 v21 = v20 + 4;
        if (*(_BYTE *)(a1 + 33) == 1)
        {
          *(_WORD *)((char *)&v36 + (unsigned __int16)(v20 + 4)) = *(_WORD *)(a1 + 34);
          unsigned __int16 v21 = v20 + 6;
        }

        __int16 v22 = *(_WORD *)(*(void *)(a1 + 40) + 4LL) + v21 - 4;
        LOBYTE(v36) = v22 + 2 * (*(_BYTE *)(sub_10017AB4C(v35) + 78) != 0);
        BYTE1(v36) = (unsigned __int16)(v22 + 2 * (*(_BYTE *)(sub_10017AB4C(v35) + 78) != 0)) >> 8;
        uint64_t v23 = (unsigned __int8 *)sub_1001EF29C(7u);
        *(void *)(a1 + 24) = v23;
        if (v23)
        {
          sub_1001EFB10(v23, (char *)&v36, v21, 0);
          if (!*(_BYTE *)a1) {
            sub_1001EFC20(*(unsigned __int8 **)(a1 + 24), *(void *)(a1 + 40));
          }
          if (*(_BYTE *)(sub_10017AB4C(v35) + 78))
          {
            sub_100185704(*(void *)(a1 + 24), &v34);
            sub_1001EFB10(*(unsigned __int8 **)(a1 + 24), (char *)&v34, 2uLL, 0);
          }

          unsigned int v24 = *(unsigned __int16 *)(*(void *)(a1 + 24) + 4LL);
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to allocate a MBUF for flow control.", v25, v26, v27, v28, v29, v30, v31, v33);
          uint64_t v32 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
            goto LABEL_4;
          }
        }
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Failed to get channel for CID 0x%x", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
LABEL_4:
    }
      sub_100657858();
  }

uint64_t sub_100189C94(uint64_t a1)
{
  uint64_t v1 = a1;
  if (qword_1008E2C38 == a1 || qword_1008E2C40 == a1) {
    return sub_1001EC324(a1, 0);
  }
  if (!*(_BYTE *)(a1 + 16))
  {
    BOOL v3 = sub_100185870(*(unsigned __int16 *)(v1 + 24));
    unsigned int v4 = sub_1001EC434(*(void *)v1);
    unsigned int v5 = *(unsigned __int8 *)(v1 + 26);
    if (v3)
    {
      int v6 = v5 - sub_100187584(*(unsigned __int16 *)(v1 + 24));
      uint64_t v7 = sub_1001EC324(*(void *)v1, 0);
      if (v4 != v6) {
        return v7;
      }
    }

    else
    {
      uint64_t v7 = sub_1001EC324(*(void *)v1, 0);
      if (v4 < v5) {
        return v7;
      }
    }

uint64_t sub_100189E4C(uint64_t a1, uint64_t a2, uint64_t a3, void *a4)
{
  uint64_t v7 = a1;
  if (sub_10018A1A0(a2))
  {
    if (qword_1008E2C28)
    {
      unsigned int v8 = *(unsigned __int16 *)(*(void *)a2 + 36LL);
      uint64_t v9 = qword_1008E2C28;
      while (*(unsigned __int16 *)(v9 + 24) != v8)
      {
        uint64_t v9 = *(void *)(v9 + 80);
        if (v9 == qword_1008E2C28 || v9 == 0) {
          goto LABEL_11;
        }
      }

      if (!*(_BYTE *)(v9 + 16) || (sub_1001858C4(v8) & 1) != 0)
      {
        uint64_t v39 = &qword_1008E2C38;
        goto LABEL_72;
      }

      return 0LL;
    }

uint64_t sub_10018A1A0(uint64_t a1)
{
  uint64_t v2 = sub_1001EC43C(qword_1008E2C38);
  uint64_t v3 = v2;
  uint64_t v11 = v2;
  if (!a1)
  {
    sub_1001EE2A0();
    if (v3) {
      goto LABEL_5;
    }
    return 0LL;
  }

  if (!v2) {
    return 0LL;
  }
  while (1)
  {
LABEL_5:
    uint64_t v4 = sub_1001EC460(v3);
    uint64_t v5 = *(void *)(v4 + 8);
    if (*(void *)a1 && v5 != *(void *)(*(void *)a1 + 8LL)) {
      goto LABEL_26;
    }
    if (!sub_10012D514(v5)
      && !sub_10012D5BC(*(void *)(v4 + 8))
      && !sub_10012D5EC(*(void *)(v4 + 8))
      && !sub_10012D61C(*(void *)(v4 + 8)))
    {
      break;
    }

    int v6 = *(unsigned __int8 *)(*(void *)(v4 + 8) + 2LL);
    if (*(_BYTE *)(*(void *)(v4 + 8) + 2LL)) {
      BOOL v7 = 1;
    }
    else {
      BOOL v7 = byte_1008F6E91 == 0;
    }
    if (!v7
      || (v6 == 4 ? (BOOL v8 = byte_1008F6E92 == 0) : (BOOL v8 = 1), !v8 || (v6 == 8 ? (v9 = byte_1008F6E90 == 0) : (v9 = 1), !v9)))
    {
      *(void *)a1 = v4;
      sub_1001EC468(qword_1008E2C38, v11);
      return 1LL;
    }

BOOL sub_10018A2D0(uint64_t a1, unsigned int a2)
{
  if (*(_BYTE *)(a1 + 2) == 4)
  {
    unsigned int v8 = sub_100135EA0();
    int v9 = sub_10012EC68();
    unsigned int v11 = sub_100137114(2);
    if (*(_BYTE *)(a1 + 129)) {
      return 1LL;
    }
    unsigned int v10 = v11;
  }

  else
  {
    if (*(_BYTE *)(a1 + 2))
    {
      sub_1001EE2A0();
      return 0LL;
    }

    BOOL v4 = sub_100137128();
    int v5 = sub_10013713C();
    if (v5) {
      int v6 = 2;
    }
    else {
      int v6 = 1;
    }
    if (v4) {
      int v7 = v6;
    }
    else {
      int v7 = v5;
    }
    unsigned int v8 = sub_100135E18() - v7;
    int v9 = sub_10012EB98();
    unsigned int v10 = sub_100137114(0) - v7;
  }

  int v26 = 0;
  if (!v9)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"connectionHandle %x and NumOfConnections %d", v18, v19, v20, v21, v22, v23, v24, a1);
      BOOL v25 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return 1LL;
  }

  int v12 = sub_100173164(a1, &v26);
  if (v9 + 2 * v26 <= v8) {
    int v13 = 2;
  }
  else {
    int v13 = v26 + v9 <= v8;
  }
  int v14 = v8 - v9 + (v12 - v26) * v13;
  unsigned int v15 = v14 + 1;
  if (v10 >= v14 + 1) {
    unsigned int v16 = v14 + 1;
  }
  else {
    unsigned int v16 = v10;
  }
  if (a2 <= 0xA) {
    return !*(_WORD *)(a1 + 16) || v16 > v13 * v12;
  }
  return v16 != 0;
}

uint64_t sub_10018A448()
{
  return sub_1001C8874(&off_100885E48);
}

uint64_t sub_10018A454()
{
  qword_1008E2CC0 = 0LL;
  *(void *)&word_1008E2CC8 = 0LL;
  sub_100112C5C(sub_10018AB34);
  sub_1001E6660((uint64_t (*)(void, void, void))sub_10018AA80);
  sub_1001F02E8((uint64_t)sub_10018ABB0);
  sub_1001C87BC((__n128 *)&off_100885E48);
  return sub_10011E8D8(&off_100885E60, 0LL);
}

uint64_t sub_10018A4AC(uint64_t a1)
{
  uint64_t v2 = sub_1000B17F4(0x18uLL);
  if (!v2) {
    return 104LL;
  }
  uint64_t v3 = v2;
  v2[6] = 48;
  BOOL v4 = sub_1000B17F4(0x30uLL);
  *(void *)uint64_t v3 = v4;
  if (!v4)
  {
    sub_1000B1838(v3);
    return 104LL;
  }

  v3[7] = 0;
  int v5 = *(unsigned __int8 *)(a1 + 2);
  if (v5 == 8)
  {
    uint64_t result = 0LL;
    *(void *)(a1 + 64) = v3;
  }

  else if (v5 == 4)
  {
    *(void *)(a1 + 192) = v3;
    int v7 = sub_1001EC038(0LL, 0LL);
    uint64_t result = 0LL;
    *(void *)(a1 + 224) = v7;
  }

  else
  {
    uint64_t result = 0LL;
    if (!*(_BYTE *)(a1 + 2))
    {
      uint64_t result = 0LL;
      *(void *)(a1 + 160) = v3;
    }
  }

  return result;
}

void sub_10018A554(uint64_t a1)
{
  int v2 = *(unsigned __int8 *)(a1 + 2);
  if (v2 == 8)
  {
    int v5 = (uint64_t *)(a1 + 64);
    int v7 = *(void ***)(a1 + 64);
    if (!v7) {
      return;
    }
    sub_1000B1838(*v7);
    goto LABEL_11;
  }

  if (v2 == 4)
  {
    unsigned int v8 = *(void ***)(a1 + 192);
    if (v8)
    {
      sub_1000B1838(*v8);
      sub_1000B1838(*(void **)(a1 + 192));
      *(void *)(a1 + 192) = 0LL;
    }

    uint64_t v10 = *(void *)(a1 + 224);
    int v5 = (uint64_t *)(a1 + 224);
    uint64_t v9 = v10;
    if (v10)
    {
      uint64_t v11 = sub_1001EC324(v9, 0);
      if (v11)
      {
        int v12 = (unsigned __int16 *)v11;
        do
        {
          int v14 = 0LL;
          if (!sub_100171EC4(*v12, (uint64_t *)&v14) && *(void *)(sub_10017AB4C(v14) + 96))
          {
            uint64_t v13 = sub_10017AB4C(v14);
            (*(void (**)(void, void, void, uint64_t))(v13 + 96))( *((unsigned __int16 *)v14 + 2),  0LL,  0LL,  414LL);
          }

          sub_1000B1838(v12);
          int v12 = (unsigned __int16 *)sub_1001EC324(*v5, 0);
        }

        while (v12);
      }

      sub_1001EC070((void *)*v5);
      goto LABEL_23;
    }
  }

  else if (!*(_BYTE *)(a1 + 2))
  {
    uint64_t v3 = *(void ***)(a1 + 160);
    if (v3)
    {
      sub_1000B1838(*v3);
      sub_1000B1838(*(void **)(a1 + 160));
      *(void *)(a1 + 160) = 0LL;
    }

    int v6 = *(void ***)(a1 + 168);
    int v5 = (uint64_t *)(a1 + 168);
    BOOL v4 = v6;
    if (v6)
    {
      if (!*v4)
      {
LABEL_12:
        sub_1000B1838(v4);
LABEL_23:
        *int v5 = 0LL;
        return;
      }

      sub_1000B1838(*v4);
      *(void *)*int v5 = 0LL;
LABEL_11:
      BOOL v4 = (void **)*v5;
      goto LABEL_12;
    }
  }

uint64_t sub_10018A690(uint64_t a1)
{
  if (!sub_10012D514(a1) && !sub_10012D5EC(a1))
  {
    uint64_t result = sub_10012D61C(a1);
    if (!(_DWORD)result) {
      return result;
    }
  }

  unsigned int v3 = sub_100172644(a1, 1);
  if (v3 <= 0x2F) {
    sub_1001EE2A0();
  }
  int v4 = *(unsigned __int8 *)(a1 + 2);
  if (v4 == 8)
  {
    int v5 = (uint64_t *)(a1 + 64);
    goto LABEL_12;
  }

  if (v4 == 4)
  {
    int v5 = (uint64_t *)(a1 + 192);
LABEL_12:
    uint64_t v6 = *v5;
    if (*v5) {
      goto LABEL_14;
    }
    goto LABEL_13;
  }

  if (!*(_BYTE *)(a1 + 2))
  {
    int v5 = (uint64_t *)(a1 + 160);
    goto LABEL_12;
  }

uint64_t sub_10018A8DC(uint64_t a1, _BYTE *a2, int a3, __int16 a4)
{
  if (a3) {
    goto LABEL_2;
  }
  if (!sub_10012D514((uint64_t)a2) && !sub_10012D5EC((uint64_t)a2) && !sub_10012D61C((uint64_t)a2))
  {
    sub_1001EE134((uint64_t)"Invalid handle", v25, v26, v27, v28, v29, v30, v31, v33);
    uint64_t v32 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
      return 414LL;
    }
    goto LABEL_21;
  }

  if (sub_10012D514((uint64_t)a2) && (a2[152] == 255 || (a2[54] & 0xFE) == 6))
  {
    sub_1001EE134((uint64_t)"Link going down", v9, v10, v11, v12, v13, v14, v15, v33);
    uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      return 414LL;
    }
    goto LABEL_21;
  }

  if (!sub_10012D5EC((uint64_t)a2) || (a2[124] & 0xFE) != 6)
  {
    if (!sub_10012D61C((uint64_t)a2) || (a2[60] & 0xFE) != 6)
    {
LABEL_2:
      *(void *)(a1 + 8) = a2;
      *(_WORD *)(a1 + 20) = a4;
      *(_DWORD *)(a1 + 16) = a3;
      return sub_100188BE4(a1);
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid handle", v17, v18, v19, v20, v21, v22, v23, v33);
      uint64_t v24 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
LABEL_21:
      }
        sub_100657858();
    }
  }

  return 414LL;
}

void sub_10018AA78(uint64_t a1, uint64_t a2, int a3)
{
}

void sub_10018AA80(uint64_t a1, uint64_t a2, int a3)
{
  if (*(_BYTE *)(a2 + 2) == 4)
  {
    sub_10012EF80(a2);
    sub_100187710(1);
  }

  else if (*(_BYTE *)(a2 + 2))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid connection type.", v5, v6, v7, v8, v9, v10, v11, v13);
      uint64_t v12 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    char v4 = a3;
    if (a3)
    {
      if (!*(_BYTE *)(a2 + 153))
      {
        sub_10012EF80(a2);
        sub_100187710(1);
      }
    }

    *(_BYTE *)(a2 + 153) = v4;
  }

void sub_10018AB34(uint64_t a1, uint64_t a2)
{
  if (*(_BYTE *)(a2 + 2))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Received mode change for non ACL connection handle.", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    sub_10012EF80(a2);
    sub_100187710(3);
  }

void sub_10018ABB0(uint64_t a1)
{
}

_BYTE *sub_10018ABCC(_BYTE *result)
{
  if (!result[2])
  {
    uint64_t v1 = (uint64_t)result;
    result[192] = 1;
    if (result[152] == 2)
    {
      if (result[256])
      {
        uint64_t v9 = 0LL;
        sub_1000B0400((uint64_t)&v9);
        uint64_t result = (_BYTE *)sub_1001F43D4((int *)(v1 + 204), (int *)&v9);
        if (result <= (5 * *(unsigned __int16 *)(v1 + 136)) >> 3)
        {
          uint64_t result = (_BYTE *)sub_100128D24(0x2Au, v2, v3, v4, v5, v6, v7, v8, v1);
          if (!(_DWORD)result) {
            *(_BYTE *)(v1 + 152) |= 0x80u;
          }
        }

        *(void *)(v1 + 204) = v9;
      }
    }
  }

  return result;
}

void sub_10018AC64( unsigned __int16 *a1, unsigned int a2, int a3, uint64_t a4, size_t a5, uint64_t a6, uint64_t a7)
{
  if (*(_BYTE *)(a7 + 8))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"HciEvent_AclDataPacketReceived: wakeupCause ACL Packet from BT Controller (handle=0x%04x pbf=%d bf=%d dataLen=%d)\n",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  *a1);
      uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        __int16 v51 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  if (*((_BYTE *)a1 + 2))
  {
    if ((_DWORD)a5) {
      goto LABEL_7;
    }
LABEL_15:
    sub_1001EE134( (uint64_t)"SAR, HciEvent_AclDataPacketReceived received zero-length packet, ignoring",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  v49);
    uint64_t v29 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_26:
    sub_100657858();
    return;
  }

  if (!*((_DWORD *)a1 + 37)) {
    sub_10010C890((uint64_t)a1);
  }
  *((_BYTE *)a1 + 192) = 1;
  if (!(_DWORD)a5) {
    goto LABEL_15;
  }
LABEL_7:
  if (a3 == 4 && *(_WORD *)(a4 + 2) != 2)
  {
    sub_1001EE134( (uint64_t)"SAR, HciEvent_AclDataPacketReceived received APB for wrong CID=%d, ignoring",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  *(unsigned __int16 *)(a4 + 2));
    __int16 v37 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_26;
  }

  int v21 = *(unsigned __int8 *)(a7 + 8);
  switch(a2)
  {
    case 0u:
    case 2u:
      if (!a3 && *((_BYTE *)a1 + 25))
      {
        BOOL v46 = v21 != 0;
        uint64_t v47 = (uint64_t)a1;
        unsigned int v48 = a2;
        goto LABEL_31;
      }

      sub_10018B154((char *)a4, a5, (uint64_t)a1, a3, v21 != 0, a7);
      break;
    case 1u:
      if (a3 || !*((_BYTE *)a1 + 25))
      {
        sub_10018B468((char *)a4, a5, (uint64_t)a1, a3, v21 != 0, a7);
      }

      else
      {
        BOOL v46 = v21 != 0;
        uint64_t v47 = (uint64_t)a1;
        unsigned int v48 = 1;
LABEL_31:
        sub_10018B008(v47, v48, (char *)a4, a5, v46, a7);
      }

      break;
    case 3u:
      sub_100179E18((uint64_t)a1, 0x2Bu, a4, a5, v21 != 0);
      break;
    default:
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Invalid packet boundary flag - dropping packet", v38, v39, v40, v41, v42, v43, v44, v49);
        int v45 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          goto LABEL_26;
        }
      }

      break;
  }

uint64_t sub_10018AF44(uint64_t a1)
{
  uint64_t v2 = sub_100171DAC();
  uint64_t result = sub_1001EDBA0(0x2Fu);
  if (*(_WORD *)(result + 2))
  {
    unint64_t v4 = 0LL;
    do
    {
      BOOL v5 = *(_DWORD *)v2 == 4 || *(_DWORD *)v2 == 2;
      if (v5
        && *(void *)sub_10017AB4C((unsigned int *)v2) == a1
        && *(_BYTE *)(sub_10017AB4C((unsigned int *)v2) + 16) == 4
        && sub_100171F68((unsigned int *)v2))
      {
        sub_1001868D0(*(unsigned __int16 *)(v2 + 4));
        ++*(_DWORD *)(v2 + 88);
        uint64_t v6 = *(void (**)(void))(v2 + 136);
        if (v6) {
          v6(*(unsigned __int16 *)(v2 + 4));
        }
      }

      ++v4;
      uint64_t result = sub_1001EDBA0(0x2Fu);
      v2 += 144LL;
    }

    while (v4 < *(unsigned __int16 *)(result + 2));
  }

  return result;
}

void sub_10018B008(uint64_t a1, unsigned int a2, char *a3, unsigned int a4, int a5, uint64_t a6)
{
  unsigned __int16 v12 = 0;
  __int16 v13 = 0;
  unsigned __int16 v14 = a4;
  while (1)
  {
    int v15 = *(unsigned __int16 *)(a1 + 28);
    *(_WORD *)(a1 + 28) = 0;
    if (!v15) {
      LOWORD(v15) = *(_WORD *)a3 + 4;
    }
    if (a2 >= 3) {
      break;
    }
    else {
      size_t v16 = (unsigned __int16)v15;
    }
    if (a2 != 1 || v13) {
      sub_10018B154(a3, v16, a1, 0, a5, a6);
    }
    else {
      sub_10018B468(a3, v16, a1, 0, a5, a6);
    }
    v12 += v16;
    unsigned __int16 v14 = a4 - v12;
    if (a4 < v12) {
      unsigned __int16 v14 = 0;
    }
    if (v12 == a4) {
      return;
    }
    if (v12 > a4)
    {
      *(_WORD *)(a1 + 28) = v12 - a4;
      return;
    }

    a3 += v16;
    ++v13;
  }

  sub_1001EE2A0();
  if ((sub_1000A86F0() & 1) != 0)
  {
    sub_1001EE134( (uint64_t)"L2CAPAGG RX: This should never happen, Invalid packet boundary flag for aggregated packets - dropping packet",  v17,  v18,  v19,  v20,  v21,  v22,  v23,  v31);
    uint64_t v24 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  sub_1000AFE20(411LL);
  sub_10018B154(v25, v26, v27, v28, v29, v30);
}

void sub_10018B154(char *__src, size_t __len, uint64_t a3, int a4, char a5, uint64_t a6)
{
  unsigned int v10 = __len;
  int v12 = *(unsigned __int8 *)(a3 + 2);
  if (!a4)
  {
    if (v12 == 8)
    {
      uint64_t v21 = (void *)(a3 + 64);
    }

    else if (v12 == 4)
    {
      uint64_t v21 = (void *)(a3 + 192);
    }

    else
    {
      if (*(_BYTE *)(a3 + 2))
      {
LABEL_17:
        sub_1001EE2A0();
        uint64_t v22 = 0LL;
        goto LABEL_18;
      }

      uint64_t v21 = (void *)(a3 + 160);
    }

    uint64_t v22 = (_WORD *)*v21;
    if (*v21) {
      goto LABEL_18;
    }
    goto LABEL_17;
  }

  if (!*(_BYTE *)(a3 + 2))
  {
    uint64_t v22 = *(_WORD **)(a3 + 168);
    if (!v22)
    {
      if (!sub_10012D514(a3)) {
        return;
      }
      uint64_t v23 = sub_1000B1814(0x18uLL);
      *(void *)(a3 + 168) = v23;
      if (!v23) {
        return;
      }
      uint64_t v22 = v23;
      v23[6] = *(_WORD *)(sub_1001EDBA0(0x2Fu) + 4);
      *(void *)(a3 + 168) = v22;
    }

void sub_10018B468(char *__src, uint64_t __len, uint64_t a3, int a4, int a5, uint64_t a6)
{
  uint64_t v9 = __len;
  unsigned int v10 = __src;
  int v11 = *(unsigned __int8 *)(a3 + 2);
  if (a4)
  {
    if (*(_BYTE *)(a3 + 2)) {
      goto LABEL_15;
    }
    int v12 = (uint64_t *)(a3 + 168);
  }

  else if (v11 == 8)
  {
    int v12 = (uint64_t *)(a3 + 64);
  }

  else if (v11 == 4)
  {
    int v12 = (uint64_t *)(a3 + 192);
  }

  else
  {
    if (*(_BYTE *)(a3 + 2)) {
      goto LABEL_15;
    }
    int v12 = (uint64_t *)(a3 + 160);
  }

  uint64_t v13 = *v12;
  if (!*v12 || (uint64_t v14 = *(unsigned __int16 *)(v13 + 14), !*(_WORD *)(v13 + 14)))
  {
LABEL_15:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"CONTINUE packet with no FIRST packet - discarding this CONTINUE packet",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  v79);
      uint64_t v23 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        goto LABEL_17;
      }
    }

    return;
  }

  if ((v14 + __len) <= 3)
  {
    memmove((void *)(v13 + v14 + 8), __src, __len);
    __int16 v15 = *(_WORD *)(v13 + 14) + v9;
LABEL_14:
    *(_WORD *)(v13 + 14) = v15;
    return;
  }

  if (v14 > 3)
  {
    LOWORD(v25) = *(_WORD *)(v13 + 8);
    unsigned __int16 v35 = v14 - 4;
    unsigned int v26 = *(unsigned __int16 *)(v13 + 12);
    int v36 = __len;
    goto LABEL_30;
  }

  uint64_t v24 = 4 - v14;
  memmove((void *)(v13 + 8 + v14), __src, 4 - v14);
  uint64_t v25 = *(unsigned __int16 *)(v13 + 8);
  unsigned int v26 = *(unsigned __int16 *)(v13 + 12);
  if (v25 > v26)
  {
    sub_1001EE134((uint64_t)"Length in L2CAP header %d exceeds MTU %d", v27, v28, v29, v30, v31, v32, v33, v25);
    int v34 = (os_log_s *)sub_100086554(0x2Fu);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      goto LABEL_34;
    }
    goto LABEL_33;
  }

  if (v25 >= v9)
  {
    unsigned __int16 v35 = 0;
    v10 += v24;
    LOWORD(v9) = v9 - v24;
    int v36 = (unsigned __int16)v9;
LABEL_30:
    uint64_t v45 = v36 + v35;
    if (v45 > v26)
    {
      sub_1001EE134((uint64_t)"Received data %d exceeds exceeds buffer size %d", v46, v47, v48, v49, v50, v51, v52, v45);
      unsigned int v53 = (os_log_s *)sub_100086554(0x2Fu);
      if (!os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
        goto LABEL_34;
      }
LABEL_33:
      sub_100657858();
      goto LABEL_34;
    }

    uint64_t v54 = *(unsigned __int16 *)(v13 + 10);
    uint64_t v84 = 0LL;
    if (sub_100171EC4(v54, &v84) || (unsigned int v80 = *(unsigned __int16 **)(v84 + 48)) == 0LL)
    {
      memmove((void *)(*(void *)v13 + v35), v10, (unsigned __int16)v9);
      uint64_t v55 = 0LL;
      char v56 = 1;
      if (!a5) {
        goto LABEL_39;
      }
    }

    else
    {
      char v83 = 0;
      __int16 v82 = 0;
      unsigned __int16 v81 = 0;
      if (sub_100173ADC(v54, &v82, &v81, &v83) || v45 > v81)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Received %d length data exceeding upper layer l2cap buffer size %d",  v71,  v72,  v73,  v74,  v75,  v76,  v77,  v45);
          uint64_t v78 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        return;
      }

      uint64_t v70 = (char *)v80 + v35;
      uint64_t v55 = v80;
      memmove(v70, v10, (unsigned __int16)v9);
      char v56 = 0;
      if (!a5)
      {
LABEL_39:
        if ((unsigned __int16)v45 == (unsigned __int16)v25)
        {
          *(_WORD *)(v13 + 14) = 0;
          if ((v56 & 1) != 0)
          {
            uint64_t v57 = *(unsigned __int16 **)v13;
            BOOL v58 = *(_BYTE *)(v13 + 16) != 0;
            size_t v59 = (unsigned __int16)v25;
            uint64_t v60 = (_BYTE *)a3;
            uint64_t v61 = v54;
          }

          else
          {
            BOOL v58 = *(_BYTE *)(v13 + 16) != 0;
            size_t v59 = (unsigned __int16)v25;
            uint64_t v60 = (_BYTE *)a3;
            uint64_t v61 = v54;
            uint64_t v57 = v55;
          }

          sub_10018B864(v60, v61, v57, v59, v58, a6);
          goto LABEL_35;
        }

        if ((unsigned __int16)v45 <= (unsigned __int16)v25)
        {
          __int16 v15 = v45 + 4;
          goto LABEL_14;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Received data %d exceeds size in L2CAP header %d",  v62,  v63,  v64,  v65,  v66,  v67,  v68,  (unsigned __int16)v45);
          uint64_t v69 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

void sub_10018B864(_BYTE *a1, uint64_t a2, unsigned __int16 *a3, size_t a4, uint64_t a5, uint64_t a6)
{
  unsigned int v53 = 0LL;
  if ((_DWORD)a5)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"UpperLayerRecv: wakeupCause Packet from BT Controller (handle=0x%04x cid=0x%4x, len=%d)\n",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  *(unsigned __int16 *)a1);
      uint64_t v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v55 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v19, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  word_1008E2CC8 = a2;
  switch((_DWORD)a2)
  {
    case 2:
      sub_10017A21C((uint64_t)a1, a3, a4);
LABEL_15:
      word_1008E2CC8 = 0;
      return;
    case 1:
      sub_100198900(a1, a3, a4);
      goto LABEL_15;
    case 0:
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"%! (%d)", v20, v21, v22, v23, v24, v25, v26, 105LL);
        uint64_t v27 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      goto LABEL_15;
  }

  if (a2 <= 0x3F)
  {
    sub_100179E18((uint64_t)a1, a2, (uint64_t)a3, a4, a5);
    goto LABEL_15;
  }

  if (sub_100171EC4(a2, (uint64_t *)&v53))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Data received for invalid CID %d, ignoring packet", v28, v29, v30, v31, v32, v33, v34, a2);
      unsigned __int16 v35 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
LABEL_36:
      }
        sub_100657858();
    }
  }

  else if (sub_10017AB4C(v53))
  {
    if (*(_BYTE **)sub_10017AB4C(v53) == a1)
    {
      if (!*(_BYTE *)(sub_10017AB4C(v53) + 78)
        || (int v44 = *(unsigned __int16 *)((char *)a3 + a4 - 2),
            *(_WORD *)__int128 buf = a4,
            *(_WORD *)&buf[2] = a2,
            LOWORD(a4) = a4 - 2,
            sub_10018568C((char *)buf, 4u, (char *)a3, (unsigned __int16)a4, v44)))
      {
        if (sub_10018581C(a2) || sub_100185870(a2)) {
          sub_1001867B4(a2, a3, (unsigned __int16)a4, a5, a6);
        }
        else {
          sub_100176890(a2, (uint64_t)a3, (unsigned __int16)a4, a5, a6);
        }
        goto LABEL_15;
      }
    }

    else
    {
      if (*(void *)sub_10017AB4C(v53)) {
        sub_10017AB4C(v53);
      }
      if (sub_1000A86F0())
      {
        sub_10017AB4C(v53);
        sub_1001EE134( (uint64_t)"(CID: %#06x) Received ACL handle %#06x (%p) does not match stored handle %#06x (%p), ignoring packet",  v45,  v46,  v47,  v48,  v49,  v50,  v51,  a2);
        uint64_t v52 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
          goto LABEL_36;
        }
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"No connection data, ignoring packet", v36, v37, v38, v39, v40, v41, v42, a2);
    uint64_t v43 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
      goto LABEL_36;
    }
  }

void sub_10018BBFC(uint64_t a1, const void *a2)
{
  dword_1008E2CD0 = a1;
  if ((a1 - 1) > 0x7CE)
  {
    if ((a1 - 2000) > 0x7CF)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Invalid chipset %d", v4, v5, v6, v7, v8, v9, v10, a1);
        int v11 = (os_log_s *)sub_100086554(0x54u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    else
    {
      sub_1000BD078(&off_1008E2DE0);
      sub_1000BD054((void (**)(uint64_t *, uint64_t))&off_1008E36C0, a2);
    }
  }

  else
  {
    sub_10014A94C(&off_1008E2DE0);
    sub_10014A928((void (**)(uint64_t, uint64_t))&off_1008E36C0, a2);
  }

uint64_t sub_10018BCDC(void *a1)
{
  if (dword_1008E2DD8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"VSC state %d, can not create command",  v1,  v2,  v3,  v4,  v5,  v6,  v7,  dword_1008E2DD8);
      uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return 3600LL;
  }

  else
  {
    uint64_t result = 0LL;
    *a1 = &unk_1008E2CD4;
    a1[1] = 0x2000000FF00FFLL;
  }

  return result;
}

uint64_t sub_10018BD78( __int16 a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_1008E2DD8) {
    sub_1001EE2A0();
  }
  if (!a2 && (_DWORD)a3) {
    sub_1001EE2A0();
  }
  dword_1008E2DD8 = 1;
  uint64_t v13 = sub_10011EBB0((unsigned __int16)a1 | 0xFC00u, a3, a2, a4, a5, a6, a7, a8);
  if ((_DWORD)v13)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_HCI_VendorCmd failed %d", v14, v15, v16, v17, v18, v19, v20, v13);
      uint64_t v21 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  else
  {
    word_1008E2DD4 = a1;
  }

  dword_1008E2DD8 = 0;
  return v13;
}

uint64_t sub_10018BE60()
{
  return dword_1008E2CD0;
}

uint64_t sub_10018BE6C(int a1, uint64_t a2)
{
  uint64_t v2 = 0LL;
  dword_1008D8E9C = a1;
  qword_1008E36C8 = a2;
  return v2;
}

uint64_t sub_10018BEB4()
{
  dword_1008E2DD8 = 0;
  uint64_t v0 = sub_100112C10((uint64_t)sub_10018BF50, 0LL);
  if ((_DWORD)v0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to register vsevent %!", v1, v2, v3, v4, v5, v6, v7, v0);
      uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  return v0;
}

void sub_10018BF50(unsigned __int8 *a1, unsigned int a2, uint64_t a3, uint64_t a4)
{
  if (a2)
  {
    if (!a1) {
      sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/vsc.c", 268, "pData");
    }
    uint64_t v7 = a1;
    __int16 v8 = a2;
    __int16 v11 = 1;
    __int16 v9 = a2;
    if (a2 <= 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/vsc.c",  272,  "ByteStream_NumReadBytesAvail(bs) >= 1");
    }
    int v6 = *a1;
    __int16 v10 = 2;
    if (a2 - 2 != a1[1]) {
      sub_1001EE2A0();
    }
    if (v6 == 14)
    {
      if (a2 >= 6) {
        return;
      }
      goto LABEL_12;
    }

    if (v6 != 255)
    {
      if (v6 != 15 || a2 == 6) {
        return;
      }
LABEL_12:
      sub_1001EE2A0();
      return;
    }

    if (a2 <= 2) {
      sub_1001EE2A0();
    }
    if (off_1008E36C0) {
      off_1008E36C0(&v7, a4);
    }
  }

void sub_10018C058(uint64_t a1)
{
  qword_1008E36F0 = a1;
  if ((dword_1008E2CD0 - 1) > 0x7CE)
  {
    if ((dword_1008E2CD0 - 2000) > 0x7CF)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Invalid chipset %d", v1, v2, v3, v4, v5, v6, v7, dword_1008E2CD0);
        __int16 v8 = (os_log_s *)sub_100086554(0x54u);
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    else
    {
      sub_1000BD140(&unk_1008E36D0);
    }
  }

  else
  {
    sub_10014A980(&unk_1008E36D0);
  }

void sub_10018C118(uint64_t a1)
{
  qword_1008E3868 = a1;
  if ((dword_1008E2CD0 - 1) > 0x7CE)
  {
    if ((dword_1008E2CD0 - 2001) > 0x7CE)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid chipset %d for LMP Halt VSE Callback Registration",  v1,  v2,  v3,  v4,  v5,  v6,  v7,  dword_1008E2CD0);
        __int16 v8 = (os_log_s *)sub_100086554(0x54u);
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    else
    {
      sub_1000BD140(&unk_1008E36D0);
    }
  }

  else
  {
    sub_10014A980(&unk_1008E36D0);
  }

void sub_10018C1D8(uint64_t a1)
{
  qword_1008E37A8 = a1;
  if ((dword_1008E2CD0 - 1) > 0x7CE)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid chipset %d for Advanced Sniff Mode Change Registration",  v1,  v2,  v3,  v4,  v5,  v6,  v7,  dword_1008E2CD0);
      __int16 v8 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  else
  {
    sub_10014A980(&unk_1008E36D0);
  }

uint64_t sub_10018C274()
{
  if (off_1008E2DE0)
  {
    uint64_t v0 = off_1008E2DE0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    __int16 v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C2FC()
{
  if (off_1008E2DF0)
  {
    uint64_t v0 = off_1008E2DF0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    __int16 v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C384()
{
  if (off_1008E2DE8)
  {
    uint64_t v0 = off_1008E2DE8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    __int16 v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C40C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  if (off_1008E2DF8)
  {
    uint64_t v8 = off_1008E2DF8(a1, a2, a3, a4);
    if (!(_DWORD)v8) {
      return v8;
    }
  }

  else
  {
    uint64_t v8 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
    uint64_t v16 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v8;
}

uint64_t sub_10018C4CC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  if (off_1008E2E00)
  {
    uint64_t v6 = off_1008E2E00(a1, a2, a3);
    if (!(_DWORD)v6) {
      return v6;
    }
  }

  else
  {
    uint64_t v6 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v7, v8, v9, v10, v11, v12, v13, v6);
    uint64_t v14 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v6;
}

uint64_t sub_10018C584()
{
  if (off_1008E2E08)
  {
    uint64_t v0 = off_1008E2E08();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C60C()
{
  if (off_1008E2E10)
  {
    uint64_t v0 = off_1008E2E10();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C694()
{
  if (off_1008E2E18)
  {
    uint64_t v0 = off_1008E2E18();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C71C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  if (off_1008E2E20)
  {
    uint64_t v6 = off_1008E2E20(a1, a2, a3);
    if (!(_DWORD)v6) {
      return v6;
    }
  }

  else
  {
    uint64_t v6 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v7, v8, v9, v10, v11, v12, v13, v6);
    uint64_t v14 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v6;
}

uint64_t sub_10018C7D4()
{
  if (off_1008E2E40)
  {
    uint64_t v0 = off_1008E2E40();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C85C()
{
  if (off_1008E2E48)
  {
    uint64_t v0 = off_1008E2E48();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C8E4()
{
  if (off_1008E2E50)
  {
    uint64_t v0 = off_1008E2E50();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C96C()
{
  if (off_1008E2E58)
  {
    uint64_t v0 = off_1008E2E58();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018C9F4(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E2E60)
  {
    uint64_t v1 = off_1008E2E60();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018CA88()
{
  if (off_1008E2E68)
  {
    uint64_t v0 = off_1008E2E68();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CB10()
{
  if (off_1008E2E70)
  {
    uint64_t v0 = off_1008E2E70();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CB98()
{
  if (off_1008E2E78)
  {
    uint64_t v0 = off_1008E2E78();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CC20()
{
  if (off_1008E2E80)
  {
    uint64_t v0 = off_1008E2E80();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CCA8()
{
  if (off_1008E2E88)
  {
    uint64_t v0 = off_1008E2E88();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CD30()
{
  if (off_1008E2E28)
  {
    uint64_t v0 = off_1008E2E28();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CDB8()
{
  if (off_1008E2E30)
  {
    uint64_t v0 = off_1008E2E30();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CE40(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!a2) {
    return 101LL;
  }
  uint64_t v15 = 0LL;
  uint64_t v5 = sub_10010EEE0(a2, &v15);
  if (!(_DWORD)v5)
  {
    if (off_1008E2E38)
    {
      uint64_t v5 = off_1008E2E38(a1, v15, a3);
      if (!(_DWORD)v5) {
        return v5;
      }
    }

    else
    {
      uint64_t v5 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v7, v8, v9, v10, v11, v12, v13, v5);
      uint64_t v14 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v5;
}

uint64_t sub_10018CF08()
{
  if (off_1008E2E90)
  {
    uint64_t v0 = off_1008E2E90();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018CF90()
{
  if (off_1008E2E98)
  {
    uint64_t v0 = off_1008E2E98();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D018(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E2EA0)
  {
    uint64_t v1 = off_1008E2EA0();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018D0AC()
{
  if (dword_1008E2CD0 != 12) {
    return 3601LL;
  }
  if (off_1008E2EB8)
  {
    uint64_t v0 = off_1008E2EB8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D14C()
{
  if (off_1008E2EC0)
  {
    uint64_t v0 = off_1008E2EC0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D1D4()
{
  if (off_1008E2EC8)
  {
    uint64_t v0 = off_1008E2EC8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D25C()
{
  if (off_1008E2EF0)
  {
    uint64_t v0 = off_1008E2EF0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D2E4()
{
  if (off_1008E2F08)
  {
    uint64_t v0 = off_1008E2F08();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D36C()
{
  if (off_1008E2EF8)
  {
    uint64_t v0 = off_1008E2EF8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D3F4()
{
  if (off_1008E2F00)
  {
    uint64_t v0 = off_1008E2F00();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D47C()
{
  if (off_1008E2F40)
  {
    uint64_t v0 = off_1008E2F40();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D504(uint64_t a1, unint64_t a2, uint64_t a3)
{
  uint64_t v18 = 0LL;
  unint64_t v5 = sub_1001BEE0C(a2);
  int v16 = v5;
  __int16 v17 = WORD2(v5);
  uint64_t v6 = sub_10010EEE0((uint64_t)&v16, &v18);
  if (!(_DWORD)v6)
  {
    if (off_1008E2F10)
    {
      uint64_t v6 = off_1008E2F10(a1, v18, a3);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v8, v9, v10, v11, v12, v13, v14, v6);
      uint64_t v15 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v6;
}

uint64_t sub_10018D5D4()
{
  if (off_1008E2F18)
  {
    uint64_t v0 = off_1008E2F18();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D65C()
{
  if (off_1008E2F20)
  {
    uint64_t v0 = off_1008E2F20();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D6E4()
{
  if (off_1008E2F28)
  {
    uint64_t v0 = off_1008E2F28();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D76C()
{
  if (off_1008E2F30)
  {
    uint64_t v0 = off_1008E2F30();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D7F4()
{
  if (off_1008E2F38)
  {
    uint64_t v0 = off_1008E2F38();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D87C(uint64_t a1, uint64_t a2)
{
  if (off_1008E3518)
  {
    uint64_t v2 = off_1008E3518(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10018D914()
{
  if (off_1008E2F48)
  {
    uint64_t v0 = off_1008E2F48();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018D99C()
{
  if (off_1008E2F50)
  {
    uint64_t v0 = off_1008E2F50();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC LMP Halt failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DA24()
{
  if (off_1008E2F58)
  {
    uint64_t v0 = off_1008E2F58();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DAAC()
{
  if (off_1008E2F60)
  {
    uint64_t v0 = off_1008E2F60();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DB34()
{
  if (off_1008E2F68)
  {
    uint64_t v0 = off_1008E2F68();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DBBC()
{
  if (off_1008E35B0)
  {
    uint64_t v0 = off_1008E35B0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DC44(unsigned int a1, uint64_t a2)
{
  uint64_t v2 = 101LL;
  if (a1 <= 1 && a2)
  {
    if (off_1008E2F88)
    {
      uint64_t v2 = off_1008E2F88();
      if (!(_DWORD)v2) {
        return v2;
      }
    }

    else
    {
      uint64_t v2 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v2;
}

uint64_t sub_10018DCDC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v3 = 101LL;
  if (a2 && a3)
  {
    if (off_1008E2F70)
    {
      uint64_t v3 = off_1008E2F70();
      if (!(_DWORD)v3) {
        return v3;
      }
    }

    else
    {
      uint64_t v3 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v3;
}

uint64_t sub_10018DD70(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    return 101LL;
  }
  if (off_1008E2F78)
  {
    uint64_t v2 = off_1008E2F78();
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10018DE04()
{
  if (off_1008E2F80)
  {
    uint64_t v0 = off_1008E2F80();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DE8C()
{
  if (off_1008E2F90)
  {
    uint64_t v0 = off_1008E2F90();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DF14()
{
  if (off_1008E2F98)
  {
    uint64_t v0 = off_1008E2F98();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018DF9C()
{
  if (off_1008E2FA0)
  {
    uint64_t v0 = off_1008E2FA0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E024(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E2FA8)
  {
    uint64_t v1 = off_1008E2FA8();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018E0B8(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3090)
  {
    uint64_t v1 = off_1008E3090();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018E14C(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3098)
  {
    uint64_t v2 = off_1008E3098(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10018E1E8()
{
  if (off_1008E30B8)
  {
    uint64_t v0 = off_1008E30B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E270()
{
  if (off_1008E2FB0)
  {
    uint64_t v0 = off_1008E2FB0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E2F8(uint64_t a1, unsigned int a2)
{
  uint64_t v2 = 101LL;
  if (a1 && a2 <= 0x15)
  {
    if (off_1008E2FB8)
    {
      uint64_t v2 = off_1008E2FB8();
      if (!(_DWORD)v2) {
        return v2;
      }
    }

    else
    {
      uint64_t v2 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v2;
}

uint64_t sub_10018E390(uint64_t a1, unsigned int a2)
{
  uint64_t v2 = 101LL;
  if (a1 && a2 <= 0x15)
  {
    if (off_1008E2FC0)
    {
      uint64_t v2 = off_1008E2FC0();
      if (!(_DWORD)v2) {
        return v2;
      }
    }

    else
    {
      uint64_t v2 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v2;
}

uint64_t sub_10018E428()
{
  if (off_1008E2FC8)
  {
    uint64_t v0 = off_1008E2FC8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E4B0(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, unsigned int a5)
{
  uint64_t v5 = 101LL;
  if (a2 <= 2 && a5 <= 0xF)
  {
    if (off_1008E2EE0)
    {
      uint64_t v5 = off_1008E2EE0();
      if (!(_DWORD)v5) {
        return v5;
      }
    }

    else
    {
      uint64_t v5 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
      uint64_t v13 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v5;
}

uint64_t sub_10018E54C()
{
  if (off_1008E3388)
  {
    uint64_t v0 = off_1008E3388();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E5D4()
{
  if (off_1008E3390)
  {
    uint64_t v0 = off_1008E3390();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E65C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, unsigned int a8)
{
  uint64_t v8 = 101LL;
  if (a8 <= 8 && ((1 << a8) & 0x116) != 0)
  {
    if (off_1008E2EE8)
    {
      uint64_t v8 = off_1008E2EE8(a1, a2, a3);
      if (!(_DWORD)v8) {
        return v8;
      }
    }

    else
    {
      uint64_t v8 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
      int v16 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v8;
}

uint64_t sub_10018E71C(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  uint64_t v4 = 101LL;
  if (a4 <= a2 && a2 <= 0x19 && a1 && a3)
  {
    if (off_1008E3028)
    {
      uint64_t v4 = off_1008E3028(a1, a2, a3);
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v4;
}

uint64_t sub_10018E7E8(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  uint64_t v4 = 101LL;
  if (a4 <= a2 && a2 <= 0x16 && a1 && a3)
  {
    if (off_1008E3030)
    {
      uint64_t v4 = off_1008E3030(a1, a2, a3);
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v4;
}

uint64_t sub_10018E8B4(unsigned int a1, unsigned int a2, uint64_t a3)
{
  BOOL v7 = a1 > 4 && a2 != 0;
  uint64_t v4 = 101LL;
  if (a2 <= 0x19 && !v7)
  {
    if (off_1008E3038)
    {
      uint64_t v4 = off_1008E3038();
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v8, v9, v10, v11, v12, v13, v14, v4);
      uint64_t v15 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v4;
}

uint64_t sub_10018E970()
{
  if (off_1008E3070)
  {
    uint64_t v0 = off_1008E3070();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018E9F8()
{
  if (off_1008E3040)
  {
    uint64_t v0 = off_1008E3040();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EA80(uint64_t a1, uint64_t a2, int a3, uint64_t a4, int a5)
{
  uint64_t v5 = 101LL;
  if (a5 == 3 && a3 == 3 && a2 && a4)
  {
    if (off_1008E3048)
    {
      uint64_t v5 = off_1008E3048();
      if (!(_DWORD)v5) {
        return v5;
      }
    }

    else
    {
      uint64_t v5 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
      uint64_t v13 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v5;
}

uint64_t sub_10018EB2C()
{
  if (off_1008E3050)
  {
    uint64_t v0 = off_1008E3050();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EBB4()
{
  if (off_1008E3058)
  {
    uint64_t v0 = off_1008E3058();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EC3C(unsigned __int8 a1)
{
  if (off_1008E3060)
  {
    uint64_t v1 = off_1008E3060(a1);
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018ECC8()
{
  if (off_1008E3068)
  {
    uint64_t v0 = off_1008E3068();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018ED50(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  uint64_t v4 = 101LL;
  if (a4 <= a2 && a2 <= 0x16 && a1 && a3)
  {
    if (off_1008E2FD0)
    {
      uint64_t v4 = off_1008E2FD0(a1, a2);
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v4;
}

uint64_t sub_10018EDFC()
{
  if (off_1008E2FF0)
  {
    uint64_t v0 = off_1008E2FF0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EE84()
{
  if (off_1008E3008)
  {
    uint64_t v0 = off_1008E3008();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EF0C()
{
  if (off_1008E3010)
  {
    uint64_t v0 = off_1008E3010();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018EF94(char a1, unsigned int a2, uint64_t a3)
{
  if (off_1008E3018)
  {
    uint64_t v5 = off_1008E3018();
    if (!(_DWORD)v5) {
      return v5;
    }
  }

  else
  {
    uint64_t v5 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
    uint64_t v13 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v5;
}

uint64_t sub_10018F03C()
{
  if (off_1008E3020)
  {
    uint64_t v0 = off_1008E3020();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018F0C4()
{
  if (off_1008E2FF8)
  {
    uint64_t v0 = off_1008E2FF8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018F14C(uint64_t a1, uint64_t a2, unsigned int a3, uint64_t a4)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  unsigned int v8 = *(unsigned __int16 *)(a1 + 80);
  if (*(_WORD *)(a1 + 80) || (sub_1001EE2A0(), unsigned int v8 = *(unsigned __int16 *)(a1 + 80), *(_WORD *)(a1 + 80)))
  {
    unsigned int v9 = a3 / v8;
    if (v9 >= 0x100) {
      sub_1001EE2A0();
    }
  }

  else
  {
    LOBYTE(v9) = 127;
  }

  if (off_1008E2FD8)
  {
    uint64_t v10 = off_1008E2FD8(a1, a2, v9, a4);
    if (!(_DWORD)v10) {
      return v10;
    }
  }

  else
  {
    uint64_t v10 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v11, v12, v13, v14, v15, v16, v17, v10);
    uint64_t v18 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v10;
}

uint64_t sub_10018F238(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  if (!a2) {
    return 101LL;
  }
  if (off_1008E2FE0)
  {
    uint64_t v8 = off_1008E2FE0(a1, a2, a3, a4);
    if (!(_DWORD)v8) {
      return v8;
    }
  }

  else
  {
    uint64_t v8 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
    uint64_t v16 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v8;
}

uint64_t sub_10018F304(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E2FE8)
  {
    uint64_t v1 = off_1008E2FE8();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018F398(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E35E0)
  {
    uint64_t v2 = off_1008E35E0(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10018F444()
{
  if (off_1008E35E8)
  {
    uint64_t v0 = off_1008E35E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018F4CC(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E35D8)
  {
    uint64_t v1 = off_1008E35D8(a1);
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018F568(uint64_t a1, uint64_t a2)
{
  if (off_1008E30C0)
  {
    uint64_t v2 = off_1008E30C0(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10018F618(unint64_t a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v3 = sub_10012D954(a1);
  if (!sub_10012D5EC(v3)) {
    return 122LL;
  }
  *(_DWORD *)((char *)v14 + 3) = 0;
  v14[0] = 0;
  uint64_t v4 = 101LL;
  if (!sub_1001B9A58(v3, (uint64_t)v14, 0LL) && !LOBYTE(v14[0]))
  {
    if (off_1008E30C8)
    {
      uint64_t v4 = off_1008E30C8(v3, (char *)v14 + 1, a2);
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
    uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v4;
}

uint64_t sub_10018F708(void *a1)
{
  if (!a1 || !*a1) {
    return 101LL;
  }
  if (off_1008E3000)
  {
    uint64_t v1 = off_1008E3000();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018F7A0(uint64_t a1)
{
  if (!a1 || !*(void *)(a1 + 8)) {
    return 101LL;
  }
  if (off_1008E3078)
  {
    uint64_t v1 = off_1008E3078();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018F838(void *a1)
{
  if (!a1 || !*a1) {
    return 101LL;
  }
  if (off_1008E3080)
  {
    uint64_t v1 = off_1008E3080();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018F8D0(int a1, __int16 a2, __int16 a3)
{
  if (!a1 || (uint64_t v3 = 101LL, (unsigned __int16)(a2 - 16385) >= 0xC003u) && (unsigned __int16)(a3 - 16385) >= 0xC003u)
  {
    if (off_1008E3088)
    {
      uint64_t v3 = off_1008E3088();
      if (!(_DWORD)v3) {
        return v3;
      }
    }

    else
    {
      uint64_t v3 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v3;
}

uint64_t sub_10018F980(uint64_t a1, uint64_t a2, uint64_t a3, int *a4, uint64_t a5)
{
  if (a4)
  {
    if (!a1) {
      return 101LL;
    }
  }

  else
  {
    sub_1001EE2A0();
    if (!a1) {
      return 101LL;
    }
  }

  uint64_t v24 = 0LL;
  uint64_t v10 = sub_10010EEE0(a1, (uint64_t *)&v24);
  if (!(_DWORD)v10)
  {
    uint64_t v11 = (uint64_t)v24;
    if (*v24 == -1) {
      return 101LL;
    }
    int v12 = *((_DWORD *)v24 + 62);
    if ((_DWORD)a3)
    {
      *((_DWORD *)v24 + 62) = v12 | a2;
      *a4 = v12 | a2;
      if (!v12)
      {
LABEL_23:
        if (off_1008E30D8)
        {
          uint64_t v10 = off_1008E30D8(a1, a3, a2, a5);
          if (!(_DWORD)v10) {
            return v10;
          }
        }

        else
        {
          uint64_t v10 = 3601LL;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"VSC failed %!", v16, v17, v18, v19, v20, v21, v22, v10);
          uint64_t v23 = (os_log_s *)sub_100086554(0x54u);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        return v10;
      }
    }

    else
    {
      int v14 = v12 & ~(_DWORD)a2;
      *((_DWORD *)v24 + 62) = v14;
      if (v12 && !v14)
      {
        if (*(_BYTE *)(v11 + 144) == 1)
        {
          int v15 = *(unsigned __int8 *)(v11 + 197);
          if (*(_BYTE *)(v11 + 197))
          {
            *(_BYTE *)(v11 + 197) = 0;
            sub_100118D88(v11, 2);
            int v15 = *((_DWORD *)v24 + 62);
          }
        }

        else
        {
          int v15 = 0;
        }

        *a4 = v15;
        goto LABEL_23;
      }

      *a4 = v14;
    }

    return 3603LL;
  }

  return v10;
}

uint64_t sub_10018FB00()
{
  if (off_1008E30D0)
  {
    uint64_t v0 = off_1008E30D0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018FB88()
{
  if (off_1008E30E0)
  {
    uint64_t v0 = off_1008E30E0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018FC10()
{
  if (off_1008E30E8)
  {
    uint64_t v0 = off_1008E30E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018FC98()
{
  if (off_1008E30F8)
  {
    uint64_t v0 = off_1008E30F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018FD20(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!a2) {
    return 101LL;
  }
  uint64_t v15 = 0LL;
  uint64_t v5 = sub_10010EEE0(a2, &v15);
  if (!(_DWORD)v5)
  {
    if (off_1008E3100)
    {
      uint64_t v5 = off_1008E3100(a1, v15, a3);
      if (!(_DWORD)v5) {
        return v5;
      }
    }

    else
    {
      uint64_t v5 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v7, v8, v9, v10, v11, v12, v13, v5);
      int v14 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v5;
}

uint64_t sub_10018FDE8()
{
  if (off_1008E3108)
  {
    uint64_t v0 = off_1008E3108();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10018FE70(uint64_t a1)
{
  if (a1) {
    return 101LL;
  }
  if (off_1008E3110)
  {
    uint64_t v1 = off_1008E3110(0LL);
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10018FF04(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v13 = 0LL;
  uint64_t v3 = sub_10010EEE0(a1, &v13);
  if (!(_DWORD)v3)
  {
    if (off_1008E3118)
    {
      uint64_t v3 = off_1008E3118(v13, a2);
      if (!(_DWORD)v3) {
        return v3;
      }
    }

    else
    {
      uint64_t v3 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v3);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v3;
}

uint64_t sub_10018FFB4()
{
  if (off_1008E3128)
  {
    uint64_t v0 = off_1008E3128();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019003C(uint64_t a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v13 = 0LL;
  uint64_t v3 = sub_10010EEE0(a1, &v13);
  if (!(_DWORD)v3)
  {
    if (off_1008E3130)
    {
      uint64_t v3 = off_1008E3130(v13, a2);
      if (!(_DWORD)v3) {
        return v3;
      }
    }

    else
    {
      uint64_t v3 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v3);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v3;
}

uint64_t sub_1001900EC(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3138)
  {
    uint64_t v1 = off_1008E3138();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100190180(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3140)
  {
    uint64_t v1 = off_1008E3140();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100190214(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3148)
  {
    uint64_t v1 = off_1008E3148();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001902A8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v17 = 0LL;
  uint64_t v7 = sub_10010EEE0(a1, &v17);
  if (!(_DWORD)v7)
  {
    if (off_1008E3150)
    {
      uint64_t v7 = off_1008E3150(v17, a2, a3, a4);
      if (!(_DWORD)v7) {
        return v7;
      }
    }

    else
    {
      uint64_t v7 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v7);
      uint64_t v16 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v7;
}

uint64_t sub_100190370(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v23 = 0LL;
  uint64_t v13 = sub_10010EEE0(a1, &v23);
  if (!(_DWORD)v13)
  {
    if (off_1008E3158)
    {
      uint64_t v13 = off_1008E3158(v23, a2, a3, a4, a5, a6, a7);
      if (!(_DWORD)v13) {
        return v13;
      }
    }

    else
    {
      uint64_t v13 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v15, v16, v17, v18, v19, v20, v21, v13);
      uint64_t v22 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v13;
}

uint64_t sub_100190460( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, char a9, uint64_t a10)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v27 = 0LL;
  uint64_t v17 = sub_10010EEE0(a1, &v27);
  if (!(_DWORD)v17)
  {
    if (off_1008E3160)
    {
      uint64_t v17 = off_1008E3160(v27, a2, a3, a4, a5, a6, a7, a8, a9, a10);
      if (!(_DWORD)v17) {
        return v17;
      }
    }

    else
    {
      uint64_t v17 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v19, v20, v21, v22, v23, v24, v25, v17);
      uint64_t v26 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v17;
}

uint64_t sub_100190568()
{
  if (off_1008E3168)
  {
    uint64_t v0 = off_1008E3168();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001905F0()
{
  if (off_1008E3170)
  {
    uint64_t v0 = off_1008E3170();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190678(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3178)
  {
    uint64_t v1 = off_1008E3178();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_10019070C(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3180)
  {
    uint64_t v1 = off_1008E3180();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001907A0(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3188)
  {
    uint64_t v1 = off_1008E3188();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100190834(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3190)
  {
    uint64_t v1 = off_1008E3190();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001908C8()
{
  if (off_1008E3198)
  {
    uint64_t v0 = off_1008E3198();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190950()
{
  if (off_1008E31A0)
  {
    uint64_t v0 = off_1008E31A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001909D8()
{
  if (off_1008E31A8)
  {
    uint64_t v0 = off_1008E31A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190A60()
{
  if (off_1008E31B0)
  {
    uint64_t v0 = off_1008E31B0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190AE8()
{
  if (off_1008E31B8)
  {
    uint64_t v0 = off_1008E31B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190B70()
{
  if (off_1008E31C8)
  {
    uint64_t v0 = off_1008E31C8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190BF8()
{
  if (off_1008E31D0)
  {
    uint64_t v0 = off_1008E31D0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190C80()
{
  if (off_1008E31D8)
  {
    uint64_t v0 = off_1008E31D8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190D08()
{
  if (off_1008E31E0)
  {
    uint64_t v0 = off_1008E31E0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190D90()
{
  if (off_1008E31E8)
  {
    uint64_t v0 = off_1008E31E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190E18()
{
  if (off_1008E31F0)
  {
    uint64_t v0 = off_1008E31F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190EA0()
{
  if (off_1008E31F8)
  {
    uint64_t v0 = off_1008E31F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100190F28(unsigned __int16 *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (off_1008E3210)
  {
    uint64_t v8 = off_1008E3210(*a1, a2, a3, a4);
    if (!(_DWORD)v8) {
      return v8;
    }
  }

  else
  {
    uint64_t v8 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
    uint64_t v16 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v8;
}

uint64_t sub_100190FE8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v19 = 0LL;
  uint64_t v9 = sub_10010EEE0(a1, &v19);
  if (!(_DWORD)v9)
  {
    if (off_1008E31C0)
    {
      uint64_t v9 = off_1008E31C0(v19, a2, a3, a4, a5);
      if (!(_DWORD)v9) {
        return v9;
      }
    }

    else
    {
      uint64_t v9 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v11, v12, v13, v14, v15, v16, v17, v9);
      uint64_t v18 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v9;
}

uint64_t sub_1001910C0()
{
  if (off_1008E3200)
  {
    uint64_t v0 = off_1008E3200();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191148()
{
  if (off_1008E3208)
  {
    uint64_t v0 = off_1008E3208();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001911D0()
{
  if (off_1008E3218)
  {
    uint64_t v0 = off_1008E3218();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191258()
{
  if (off_1008E3220)
  {
    uint64_t v0 = off_1008E3220();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001912E0(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  uint64_t v11 = 0LL;
  uint64_t v1 = sub_10010EEE0(a1, (uint64_t *)&v11);
  if ((_DWORD)v1) {
    return v1;
  }
  if (*v11 == 0xFFFF) {
    return 101LL;
  }
  if (off_1008E3278)
  {
    uint64_t v1 = off_1008E3278();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001913B0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (sub_10012D5EC(a1))
  {
    if (off_1008E3228)
    {
      uint64_t v6 = off_1008E3228(a1, a2, a3);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 3601LL;
    }
  }

  else
  {
    uint64_t v6 = 122LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v7, v8, v9, v10, v11, v12, v13, v6);
    uint64_t v14 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v6;
}

uint64_t sub_100191468()
{
  if (off_1008E3230)
  {
    uint64_t v0 = off_1008E3230();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001914F0()
{
  if (off_1008E3238)
  {
    uint64_t v0 = off_1008E3238();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191578()
{
  if (off_1008E3240)
  {
    uint64_t v0 = off_1008E3240();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191600()
{
  if (off_1008E3248)
  {
    uint64_t v0 = off_1008E3248();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191688(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!sub_10012D5EC(a1)) {
    return 122LL;
  }
  *(_WORD *)(a1 + 94) = a2;
  if (off_1008E3288)
  {
    uint64_t v6 = off_1008E3288(a1, a2, a3);
    if (!(_DWORD)v6) {
      return v6;
    }
  }

  else
  {
    uint64_t v6 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v8, v9, v10, v11, v12, v13, v14, v6);
    uint64_t v15 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v6;
}

uint64_t sub_100191754(uint64_t a1, unsigned __int16 a2)
{
  if (off_1008E3540)
  {
    uint64_t v2 = off_1008E3540(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_1001917E0()
{
  if (off_1008E3548)
  {
    uint64_t v0 = off_1008E3548();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191868()
{
  if (off_1008E3250)
  {
    uint64_t v0 = off_1008E3250();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001918F0()
{
  if (off_1008E3258)
  {
    uint64_t v0 = off_1008E3258();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191978()
{
  if (off_1008E3260)
  {
    uint64_t v0 = off_1008E3260();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191A00()
{
  if (off_1008E3268)
  {
    uint64_t v0 = off_1008E3268();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191A88()
{
  if (off_1008E3290)
  {
    uint64_t v0 = off_1008E3290();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191B10()
{
  if (off_1008E3298)
  {
    uint64_t v0 = off_1008E3298();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191B98()
{
  if (off_1008E32A0)
  {
    uint64_t v0 = off_1008E32A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191C20()
{
  if (off_1008E32A8)
  {
    uint64_t v0 = off_1008E32A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191CA8()
{
  if (off_1008E32B0)
  {
    uint64_t v0 = off_1008E32B0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191D30()
{
  if (off_1008E32B8)
  {
    uint64_t v0 = off_1008E32B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191DB8()
{
  if (off_1008E32C0)
  {
    uint64_t v0 = off_1008E32C0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191E40()
{
  if (off_1008E32C8)
  {
    uint64_t v0 = off_1008E32C8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191EC8()
{
  if (off_1008E32D0)
  {
    uint64_t v0 = off_1008E32D0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191F50()
{
  if (off_1008E32D8)
  {
    uint64_t v0 = off_1008E32D8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100191FD8()
{
  if (off_1008E32E0)
  {
    uint64_t v0 = off_1008E32E0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192060()
{
  if (off_1008E32E8)
  {
    uint64_t v0 = off_1008E32E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001920E8()
{
  if (off_1008E32F0)
  {
    uint64_t v0 = off_1008E32F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192170()
{
  if (off_1008E32F8)
  {
    uint64_t v0 = off_1008E32F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001921F8()
{
  if (off_1008E3300)
  {
    uint64_t v0 = off_1008E3300();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192280()
{
  if (off_1008E3308)
  {
    uint64_t v0 = off_1008E3308();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192308()
{
  if (off_1008E3310)
  {
    uint64_t v0 = off_1008E3310();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192390()
{
  if (off_1008E3318)
  {
    uint64_t v0 = off_1008E3318();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192418()
{
  if (off_1008E3320)
  {
    uint64_t v0 = off_1008E3320();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001924A0()
{
  if (off_1008E3328)
  {
    uint64_t v0 = off_1008E3328();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192528()
{
  if (off_1008E3330)
  {
    uint64_t v0 = off_1008E3330();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001925B0(uint64_t a1, uint64_t a2)
{
  if (off_1008E3338)
  {
    uint64_t v2 = off_1008E3338(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_100192668(uint64_t a1, uint64_t a2)
{
  if (off_1008E3340)
  {
    uint64_t v2 = off_1008E3340(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_100192708(uint64_t a1, uint64_t a2)
{
  if (off_1008E3348)
  {
    uint64_t v2 = off_1008E3348(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_1001927B0(uint64_t a1, uint64_t a2)
{
  if (off_1008E3350)
  {
    uint64_t v2 = off_1008E3350(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_100192868()
{
  if (off_1008E3358)
  {
    uint64_t v0 = off_1008E3358();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001928F0()
{
  if (off_1008E3360)
  {
    uint64_t v0 = off_1008E3360();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192978()
{
  if (off_1008E3368)
  {
    uint64_t v0 = off_1008E3368();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192A00()
{
  if (off_1008E3370)
  {
    uint64_t v0 = off_1008E3370();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192A88()
{
  if (off_1008E3378)
  {
    uint64_t v0 = off_1008E3378();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192B10()
{
  if (off_1008E3380)
  {
    uint64_t v0 = off_1008E3380();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192B98()
{
  if (off_1008E33A8)
  {
    uint64_t v0 = off_1008E33A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192C20()
{
  if (off_1008E33B0)
  {
    uint64_t v0 = off_1008E33B0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192CA8()
{
  if (off_1008E33D8)
  {
    uint64_t v0 = off_1008E33D8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192D30()
{
  if (off_1008E33E0)
  {
    uint64_t v0 = off_1008E33E0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192DB8()
{
  if (off_1008E33E8)
  {
    uint64_t v0 = off_1008E33E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192E40()
{
  if (off_1008E3530)
  {
    uint64_t v0 = off_1008E3530();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192EC8()
{
  if (off_1008E3690)
  {
    uint64_t v0 = off_1008E3690();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192F50()
{
  if (off_1008E33F0)
  {
    uint64_t v0 = off_1008E33F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100192FD8()
{
  if (off_1008E34E8)
  {
    uint64_t v0 = off_1008E34E8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193060(uint64_t a1)
{
  if (off_1008E3408)
  {
    uint64_t v1 = off_1008E3408(a1);
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001930F0()
{
  if (off_1008E3410)
  {
    uint64_t v0 = off_1008E3410();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193178()
{
  if (off_1008E3418)
  {
    uint64_t v0 = off_1008E3418();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193200(uint64_t a1, uint64_t a2)
{
  if (off_1008E3420)
  {
    uint64_t v2 = off_1008E3420(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_100193298(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  if (off_1008E3428)
  {
    uint64_t v7 = off_1008E3428(a1, a2, a3, a4, a5, a6, a7);
    if (!(_DWORD)v7) {
      return v7;
    }
  }

  else
  {
    uint64_t v7 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v8, v9, v10, v11, v12, v13, v14, v7);
    uint64_t v15 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v7;
}

uint64_t sub_100193350()
{
  if (off_1008E3430)
  {
    uint64_t v0 = off_1008E3430();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001933D8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (off_1008E3438)
  {
    uint64_t v3 = off_1008E3438(a1, a2, a3);
    if (!(_DWORD)v3) {
      return v3;
    }
  }

  else
  {
    uint64_t v3 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
    uint64_t v11 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v3;
}

uint64_t sub_100193478()
{
  if (off_1008E3440)
  {
    uint64_t v0 = off_1008E3440();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193500()
{
  if (off_1008E3448)
  {
    uint64_t v0 = off_1008E3448();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193588()
{
  if (off_1008E3458)
  {
    uint64_t v0 = off_1008E3458();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193610(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (off_1008E3450)
  {
    uint64_t v4 = off_1008E3450(a1, a2, a3, a4);
    if (!(_DWORD)v4) {
      return v4;
    }
  }

  else
  {
    uint64_t v4 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
    uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v4;
}

uint64_t sub_1001936C0()
{
  if (off_1008E3460)
  {
    uint64_t v0 = off_1008E3460();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193748()
{
  if (off_1008E3468)
  {
    uint64_t v0 = off_1008E3468();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001937D0()
{
  if (off_1008E3470)
  {
    uint64_t v0 = off_1008E3470();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193858()
{
  if (off_1008E3478)
  {
    uint64_t v0 = off_1008E3478();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001938E0()
{
  if (off_1008E3480)
  {
    uint64_t v0 = off_1008E3480();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193968()
{
  if (off_1008E3488)
  {
    uint64_t v0 = off_1008E3488();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001939F0()
{
  if (off_1008E3490)
  {
    uint64_t v0 = off_1008E3490();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193A78()
{
  if (off_1008E3498)
  {
    uint64_t v0 = off_1008E3498();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193B00()
{
  if (off_1008E34A0)
  {
    uint64_t v0 = off_1008E34A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193B88()
{
  if (off_1008E34A8)
  {
    uint64_t v0 = off_1008E34A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193C10()
{
  if (off_1008E34B0)
  {
    uint64_t v0 = off_1008E34B0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193C98(uint64_t a1, uint64_t a2, void *a3)
{
  if (off_1008E34B8)
  {
    uint64_t v4 = off_1008E34B8(a1, a2, a3);
    if (!(_DWORD)v4) {
      goto LABEL_8;
    }
  }

  else
  {
    uint64_t v4 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
    uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

uint64_t sub_100193D38()
{
  if (off_1008E34C0)
  {
    uint64_t v0 = off_1008E34C0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193DC0()
{
  if (off_1008E34C8)
  {
    uint64_t v0 = off_1008E34C8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193E48()
{
  if (off_1008E34D0)
  {
    uint64_t v0 = off_1008E34D0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193ED0()
{
  if (off_1008E35B8)
  {
    uint64_t v0 = off_1008E35B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193F58()
{
  if (off_1008E3510)
  {
    uint64_t v0 = off_1008E3510();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100193FE0()
{
  if (off_1008E3558)
  {
    uint64_t v0 = off_1008E3558();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194068()
{
  if (off_1008E3560)
  {
    uint64_t v0 = off_1008E3560();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001940F0()
{
  if (off_1008E3568)
  {
    uint64_t v0 = off_1008E3568();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194178()
{
  if (off_1008E3570)
  {
    uint64_t v0 = off_1008E3570();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194200()
{
  if (off_1008E3578)
  {
    uint64_t v0 = off_1008E3578();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194288()
{
  if (off_1008E3580)
  {
    uint64_t v0 = off_1008E3580();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194310()
{
  if (off_1008E3588)
  {
    uint64_t v0 = off_1008E3588();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194398()
{
  if (off_1008E3590)
  {
    uint64_t v0 = off_1008E3590();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194420()
{
  if (off_1008E3598)
  {
    uint64_t v0 = off_1008E3598();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001944A8()
{
  if (off_1008E3550)
  {
    uint64_t v0 = off_1008E3550();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194530()
{
  if (off_1008E35A8)
  {
    uint64_t v0 = off_1008E35A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001945B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (off_1008E35D0)
  {
    uint64_t v5 = off_1008E35D0(a1, a2, a3, a4, a5);
    if (!(_DWORD)v5) {
      return v5;
    }
  }

  else
  {
    uint64_t v5 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
    uint64_t v13 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v5;
}

uint64_t sub_100194690()
{
  if (off_1008E35A0)
  {
    uint64_t v0 = off_1008E35A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194718()
{
  if (off_1008E3270)
  {
    uint64_t v0 = off_1008E3270();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001947A0()
{
  if (off_1008E33C0)
  {
    uint64_t v0 = off_1008E33C0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194828()
{
  if (off_1008E34D8)
  {
    uint64_t v0 = off_1008E34D8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001948B0()
{
  if (off_1008E34F0)
  {
    uint64_t v0 = off_1008E34F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194938()
{
  if (off_1008E34F8)
  {
    uint64_t v0 = off_1008E34F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001949C0()
{
  if (off_1008E3280)
  {
    uint64_t v0 = off_1008E3280();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194A48()
{
  if (off_1008E3500)
  {
    uint64_t v0 = off_1008E3500();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194AD0()
{
  if (off_1008E3508)
  {
    uint64_t v0 = off_1008E3508();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194B58(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v3 = a3;
  if (*(unsigned __int8 *)(a1 + 30) == (_DWORD)a3)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Phy stats for handle %p is already %s", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 408LL;
  }

  else
  {
    if (off_1008E3398)
    {
      uint64_t v13 = off_1008E3398(a1, a2, a3);
      if (!(_DWORD)v13)
      {
        *(_BYTE *)(a1 + 30) = v3 != 0;
        return v13;
      }
    }

    else
    {
      uint64_t v13 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC PhyStatsEnable failed %!", v14, v15, v16, v17, v18, v19, v20, v13);
      uint64_t v21 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v13;
}

uint64_t sub_100194C74(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v3 = a3;
  if (*(unsigned __int8 *)(a1 + 31) == (_DWORD)a3)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"State of Phy stats for handle %p is already %s", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 408LL;
  }

  else
  {
    if (off_1008E3398)
    {
      uint64_t v13 = off_1008E3398(a1, a2, a3);
      if (!(_DWORD)v13)
      {
        *(_BYTE *)(a1 + 31) = v3;
        *(_BYTE *)(a1 + 30) = v3 != 0;
        return v13;
      }
    }

    else
    {
      uint64_t v13 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC PhyStatsEnable failed %!", v14, v15, v16, v17, v18, v19, v20, v13);
      uint64_t v21 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v13;
}

uint64_t sub_100194DA8()
{
  if (off_1008E3538)
  {
    uint64_t v0 = off_1008E3538();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194E30()
{
  if (off_1008E2ED0)
  {
    uint64_t v0 = off_1008E2ED0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194EB8()
{
  if (off_1008E2ED8)
  {
    uint64_t v0 = off_1008E2ED8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194F40()
{
  if (off_1008E34E0)
  {
    uint64_t v0 = off_1008E34E0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100194FC8()
{
  if (off_1008E33A0)
  {
    uint64_t v0 = off_1008E33A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195050()
{
  if (off_1008E35F0)
  {
    uint64_t v0 = off_1008E35F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001950D8()
{
  if (off_1008E33B8)
  {
    uint64_t v0 = off_1008E33B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195160()
{
  if (off_1008E33C8)
  {
    uint64_t v0 = off_1008E33C8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001951E8()
{
  if (off_1008E33D0)
  {
    uint64_t v0 = off_1008E33D0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195270()
{
  if (off_1008E30F0)
  {
    uint64_t v0 = off_1008E30F0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001952F8()
{
  if (off_1008E33F8)
  {
    uint64_t v0 = off_1008E33F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001953C4()
{
  if (off_1008E3400)
  {
    uint64_t v0 = off_1008E3400();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019544C()
{
  if (off_1008E35C0)
  {
    uint64_t v0 = off_1008E35C0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001954D4()
{
  if (off_1008E35C8)
  {
    uint64_t v0 = off_1008E35C8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019555C()
{
  if (off_1008E35F8)
  {
    uint64_t v0 = off_1008E35F8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001955E4(uint64_t a1, uint64_t a2)
{
  if (off_1008E3520)
  {
    uint64_t v2 = off_1008E3520(a1, a2);
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_100195684()
{
  if (off_1008E3528)
  {
    uint64_t v0 = off_1008E3528();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019570C(unsigned int a1, __int16 a2, uint64_t a3, unsigned int a4)
{
  if ((dword_1008E2CD0 - 1) > 0x7CE || (uint64_t v4 = 101LL, (a2 & 0x8000) == 0) && a1 <= 4 && a3 && a4 <= 0xE6)
  {
    if (off_1008E3600)
    {
      uint64_t v4 = off_1008E3600();
      if (!(_DWORD)v4) {
        return v4;
      }
    }

    else
    {
      uint64_t v4 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v4;
}

uint64_t sub_1001957C4(uint64_t a1, int a2)
{
  if (off_1008E3608)
  {
    uint64_t v2 = off_1008E3608();
    if (!(_DWORD)v2) {
      return v2;
    }
  }

  else
  {
    uint64_t v2 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v2;
}

uint64_t sub_10019587C(unsigned int a1, uint64_t a2, unsigned int a3)
{
  if ((dword_1008E2CD0 - 1) > 0x7CE || (uint64_t v3 = 101LL, a1 <= 0x18) && a2 && a3 <= 0xCF)
  {
    if (off_1008E3610)
    {
      uint64_t v3 = off_1008E3610();
      if (!(_DWORD)v3) {
        return v3;
      }
    }

    else
    {
      uint64_t v3 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v3;
}

uint64_t sub_100195930()
{
  if (off_1008E3620)
  {
    uint64_t v0 = off_1008E3620();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001959B8()
{
  if (off_1008E3650)
  {
    uint64_t v0 = off_1008E3650();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195A40()
{
  if (off_1008E3628)
  {
    uint64_t v0 = off_1008E3628();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195AC8()
{
  if (off_1008E3658)
  {
    uint64_t v0 = off_1008E3658();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195B50()
{
  if (off_1008E3630)
  {
    uint64_t v0 = off_1008E3630();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195BD8()
{
  if (off_1008E3638)
  {
    uint64_t v0 = off_1008E3638();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195C60()
{
  if (off_1008E3640)
  {
    uint64_t v0 = off_1008E3640();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195CE8()
{
  if (off_1008E3648)
  {
    uint64_t v0 = off_1008E3648();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195D70(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3618)
  {
    uint64_t v1 = off_1008E3618();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100195E04()
{
  if (off_1008E3660)
  {
    uint64_t v0 = off_1008E3660();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100195E8C(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3668)
  {
    uint64_t v1 = off_1008E3668();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100195F20(uint64_t a1)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E3670)
  {
    uint64_t v1 = off_1008E3670();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_100195FB4()
{
  if (off_1008E3678)
  {
    uint64_t v0 = off_1008E3678();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019603C(uint64_t a1)
{
  if (!a1 || !*(void *)(a1 + 8) || !*(void *)(a1 + 32)) {
    return 101LL;
  }
  if (off_1008E36B0)
  {
    uint64_t v1 = off_1008E36B0();
    if (!(_DWORD)v1) {
      return v1;
    }
  }

  else
  {
    uint64_t v1 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"%s failed %!", v3, v4, v5, v6, v7, v8, v9, (uint64_t)"BT_VSC_AddToFilterAcceptListUnified");
    uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v1;
}

uint64_t sub_1001960E4()
{
  if (off_1008E3680)
  {
    uint64_t v0 = off_1008E3680();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019616C(unsigned int a1, uint64_t a2)
{
  uint64_t v2 = 101LL;
  if (a1 <= 0x1E && a2)
  {
    if (off_1008E3688)
    {
      uint64_t v2 = off_1008E3688();
      if (!(_DWORD)v2) {
        return v2;
      }
    }

    else
    {
      uint64_t v2 = 3601LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v2;
}

uint64_t sub_100196204( unsigned int a1, const void *a2, unsigned int a3, uint64_t (*a4)(void, void, void, void), uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = sub_1001290F0(a1, a2, a3, a4, a5, a6, a7, a8, a5, v18);
  if ((_DWORD)v8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"%s failed %!", v9, v10, v11, v12, v13, v14, v15, (uint64_t)"BT_VSC_sendRawHCIcmd");
      uint64_t v16 = (os_log_s *)sub_100086554(0x54u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v8;
}

uint64_t sub_100196284()
{
  if (off_1008E3698)
  {
    uint64_t v0 = off_1008E3698();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019630C()
{
  if (off_1008E36A0)
  {
    uint64_t v0 = off_1008E36A0();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_100196394()
{
  if (off_1008E36A8)
  {
    uint64_t v0 = off_1008E36A8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_10019641C()
{
  if (off_1008E36B8)
  {
    uint64_t v0 = off_1008E36B8();
    if (!(_DWORD)v0) {
      return v0;
    }
  }

  else
  {
    uint64_t v0 = 3601LL;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v0;
}

uint64_t sub_1001964A4()
{
  byte_1008E3898 = 0;
  qword_1008E38A8 = 0LL;
  return 0LL;
}

uint64_t sub_1001964BC(char *a1)
{
  *(_DWORD *)a1 = 0;
  int v2 = sub_100185D48();
  char v3 = *a1;
  if (v2) {
    char v3 = *a1 | 0x20;
  }
  *a1 = v3 | 0x80;
  a1[1] |= 2u;
  return 0LL;
}

uint64_t sub_100196568()
{
  else {
    unsigned __int8 v0 = byte_1008E3898 + 1;
  }
  byte_1008E3898 = v0;
  return v0;
}

uint64_t sub_10019658C(unsigned int *a1, int a2)
{
  v6[1] = &v7;
  uint64_t v7 = a1;
  v6[0] = (const void *)8;
  uint64_t v3 = sub_10017AB4C(a1);
  sub_1001EEB14(*(unsigned int *)(v3 + 84));
  *(_DWORD *)(sub_10017AB4C(v7) + 84) = 0;
  uint64_t v4 = sub_10017AB4C(v7);
  return sub_1001EE6E8((uint64_t)sub_1001965FC, v6, a2, (int *)(v4 + 84));
}

void sub_1001965FC(uint64_t a1)
{
  uint64_t v1 = **(unsigned int ***)(a1 + 8);
  if (*v1)
  {
    *(_DWORD *)(sub_10017AB4C(**(unsigned int ***)(a1 + 8)) + 84) = 0;
    switch(*(_BYTE *)(sub_10017AB4C(v1) + 16))
    {
      case 1:
        sub_1001EE134((uint64_t)"Timeout waiting for CONNECT_RSP", v18, v19, v20, v21, v22, v23, v24, v42);
        uint64_t v25 = (os_log_s *)sub_100086554(0x2Fu);
        if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          goto LABEL_18;
        }
        goto LABEL_17;
      case 3:
      case 5:
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Timeout waiting for CONFIG_RSP", v2, v3, v4, v5, v6, v7, v8, v42);
          uint64_t v9 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
            goto LABEL_17;
          }
        }

        goto LABEL_18;
      case 6:
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Timeout waiting for DISCONNECT_RSP", v34, v35, v36, v37, v38, v39, v40, v42);
          uint64_t v41 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
LABEL_17:
          }
            sub_100657858();
        }

uint64_t sub_1001967B8(unsigned int *a1)
{
  uint64_t v2 = sub_10017AB4C(a1);
  uint64_t v3 = sub_1001EEB14(*(unsigned int *)(v2 + 84));
  *(_DWORD *)(sub_10017AB4C(a1) + 84) = 0;
  return v3;
}

uint64_t sub_1001967F4( _BYTE *a1, unsigned int a2, unsigned int *a3, _BYTE *a4, char a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  uint64_t v119 = 0LL;
  uint64_t v120 = 0LL;
  ptr = 0LL;
  uint64_t result = sub_100197DE0((uint64_t *)&ptr, 107, a2, a5);
  if ((_DWORD)result) {
    return result;
  }
  uint64_t v115 = a3;
  char v116 = a5;
  uint64_t v117 = a4;
  int v15 = 0;
  LOBYTE(v16) = 0;
  LOBYTE(v17) = 0;
  uint64_t v120 = &a9;
  while (2)
  {
    switch(*a1)
    {
      case 'a':
        uint64_t v18 = (unsigned int *)v120++;
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_157:
          uint64_t v79 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_159:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  626,  v79);
        }

        if (WORD1(v119) - WORD2(v119) <= 1) {
          goto LABEL_157;
        }
        if (BYTE6(v119) != 2)
        {
          uint64_t v79 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_159;
        }

        unsigned int v16 = *v18;
        *((_BYTE *)ptr + WORD2(v119)) = *v18;
        unsigned int v17 = v16 >> 8;
        *((_BYTE *)ptr + WORD2(v119) + 1) = BYTE1(v16);
        WORD2(v119) += 2;
        v15 += 2;
        goto LABEL_136;
      case 'b':
      case 'e':
      case 'g':
      case 'h':
      case 'i':
      case 'j':
      case 'k':
      case 'l':
      case 'n':
      case 'p':
      case 'q':
        goto LABEL_136;
      case 'c':
        uint64_t v19 = (unsigned int *)v120++;
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_161:
          unsigned int v80 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_163:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  633,  v80);
        }

        uint64_t v20 = WORD2(v119);
        if (BYTE6(v119) != 2)
        {
          unsigned int v80 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_163;
        }

        LOBYTE(v17) = 0;
        unsigned int v16 = *v19;
        ++WORD2(v119);
        *((_BYTE *)ptr + v20) = v16;
        ++v15;
        goto LABEL_136;
      case 'd':
        uint64_t v43 = v120++;
        int v44 = (const void *)*v43;
        uint64_t v120 = v43 + 2;
        int v45 = *((_DWORD *)v43 + 2);
        uint64_t v46 = (char *)ptr;
        uint64_t v47 = WORD2(v119);
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          int v48 = 0;
        }

        else
        {
          int v48 = WORD1(v119) - WORD2(v119);
        }

        if (v48 < (unsigned __int16)v45)
        {
          unsigned __int16 v81 = "ByteStream_NumReadBytesAvail(bs) >= (count)";
          goto LABEL_166;
        }

        if (BYTE6(v119) != 2)
        {
          unsigned __int16 v81 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_166:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  723,  v81);
        }

        v15 += v45;
        memmove(&v46[v47], v44, (unsigned __int16)v45);
        WORD2(v119) += v45;
LABEL_136:
        ++a1;
        continue;
      case 'f':
        uint64_t v21 = v120++;
        uint64_t v22 = (_BYTE *)*v21;
        if (!v22) {
          goto LABEL_136;
        }
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_168:
          __int16 v82 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_170:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  659,  v82);
        }

        uint64_t v23 = WORD2(v119);
        if (BYTE6(v119) != 2)
        {
          __int16 v82 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_170;
        }

        ++WORD2(v119);
        *((_BYTE *)ptr + v23) = 2;
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_172:
          char v83 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_174:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  661,  v83);
        }

        uint64_t v24 = WORD2(v119);
        if (BYTE6(v119) != 2)
        {
          char v83 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_174;
        }

        ++WORD2(v119);
        *((_BYTE *)ptr + v24) = 2;
        if (HIBYTE(v119))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_176:
          uint64_t v84 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_177:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  663,  v84);
        }

        uint64_t v25 = WORD2(v119);
        if (WORD1(v119) - WORD2(v119) <= 1) {
          goto LABEL_176;
        }
        if (BYTE6(v119) != 2)
        {
          uint64_t v84 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_177;
        }

uint64_t sub_100197DE0(uint64_t *a1, __int16 a2, char a3, char a4)
{
  __int16 v8 = a2 + 8;
  uint64_t v9 = sub_1000B17F4((unsigned __int16)(a2 + 8));
  if (v9)
  {
    if (!v8) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  452,  "(totalLen) > 0");
    }
    *a1 = (uint64_t)v9;
    *((_WORD *)a1 + 4) = v8;
    *((_DWORD *)a1 + 3) = 0x20000;
    *((_WORD *)a1 + 5) = v8;
    if (v8 == 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  456,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    _BYTE *v9 = a2 + 4;
    *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 1) = (unsigned __int16)(a2 + 4) >> 8;
    unsigned __int16 v10 = *((_WORD *)a1 + 6) + 2;
    *((_WORD *)a1 + 6) = v10;
    if (*((_BYTE *)a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    }

    else if (*((unsigned __int16 *)a1 + 5) - v10 > 1)
    {
      if (*((_BYTE *)a1 + 14) == 2)
      {
        *(_BYTE *)(*a1 + v10) = 1;
        *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 1) = 0;
        __int16 v11 = *((_WORD *)a1 + 6);
        *((_WORD *)a1 + 6) = v11 + 2;
        if (*((_BYTE *)a1 + 15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        }

        else if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v11 + 2))
        {
          if (*((_BYTE *)a1 + 14) == 2)
          {
            uint64_t v12 = *a1;
            *((_WORD *)a1 + 6) = v11 + 3;
            *(_BYTE *)(v12 + (unsigned __int16)(v11 + 2)) = a3;
            if (*((_BYTE *)a1 + 15))
            {
              sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            }

            else
            {
              uint64_t v13 = *((unsigned __int16 *)a1 + 6);
              if (*((unsigned __int16 *)a1 + 5) > v13)
              {
                if (*((_BYTE *)a1 + 14) == 2)
                {
                  uint64_t v14 = *a1;
                  *((_WORD *)a1 + 6) = v13 + 1;
                  *(_BYTE *)(v14 + v13) = a4;
                  if (*((_BYTE *)a1 + 15))
                  {
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                  }

                  else
                  {
                    uint64_t v15 = *((unsigned __int16 *)a1 + 6);
                    if (*((unsigned __int16 *)a1 + 5) - (int)v15 > 1)
                    {
                      if (*((_BYTE *)a1 + 14) == 2)
                      {
                        uint64_t result = 0LL;
                        *(_BYTE *)(*a1 + v15) = a2;
                        *(_BYTE *)(*a1 + *((unsigned __int16 *)a1 + 6) + 1) = HIBYTE(a2);
                        *((_WORD *)a1 + 6) += 2;
                        return result;
                      }

                      uint64_t v20 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
                      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  462,  v20);
                    }
                  }

                  uint64_t v20 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
                  goto LABEL_35;
                }

                uint64_t v19 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  461,  v19);
              }
            }

            uint64_t v19 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
            goto LABEL_31;
          }

          uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  460,  v18);
        }

        uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
        goto LABEL_27;
      }

      unsigned int v17 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  457,  v17);
    }

    unsigned int v17 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_23;
  }

  return 106LL;
}

uint64_t sub_1001980CC(_BYTE *a1, uint64_t a2)
{
  uint64_t v4 = (unsigned __int8 *)sub_1000B1814(0x98uLL);
  if (!v4) {
    return 106LL;
  }
  uint64_t v5 = v4;
  uint64_t v6 = v4 + 40;
  sub_1001EF520((uint64_t)(v4 + 40), 1u);
  sub_1001EFB10(v6, *(char **)a2, *(unsigned __int16 *)(a2 + 10), 1u);
  *uint64_t v5 = 1;
  *((void *)v5 + 4) = 0LL;
  unsigned int v7 = sub_10018A8DC((uint64_t)v5, a1, 0, 1);
  if (v7)
  {
    sub_1001EF5E4((uint64_t)v6);
    sub_1000B1838(v5);
  }

  if (v7 == 412) {
    return 0LL;
  }
  else {
    return v7;
  }
}

uint64_t sub_100198178( _BYTE *a1, unsigned int a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  int v10 = 0;
  if (a2 == 2)
  {
    LOWORD(v10) = a4;
    BYTE2(v10) = a5;
    uint64_t v8 = 3LL;
    HIBYTE(a3) = HIBYTE(a5);
    goto LABEL_5;
  }

  if (a2 == 1)
  {
    LOBYTE(v10) = a3;
    uint64_t v8 = 1LL;
LABEL_5:
    *(_BYTE *)((unint64_t)&v10 | v8) = HIBYTE(a3);
  }

  return sub_1001967F4("ad", 1u, 0LL, a1, a6, a6, a7, a8, a2);
}

uint64_t sub_100198214(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, __int16 a5)
{
  if (a3 && a1)
  {
    int v10 = sub_1000B1814(0xE0uLL);
    if (v10)
    {
      uint64_t v11 = (uint64_t)v10;
      v10[152] = 8;
      *((void *)v10 + 24) = qword_1008E38A8;
      qword_1008E38A8 = (uint64_t)v10;
      else {
        char v12 = byte_1008E3898 + 1;
      }
      byte_1008E3898 = v12;
      v10[153] = v12;
      int v13 = *(_DWORD *)a3;
      *((_WORD *)v10 + 92) = *(_WORD *)(a3 + 4);
      *((_DWORD *)v10 + 45) = v13;
      *((void *)v10 + 21) = a2;
      *((void *)v10 + 25) = a1;
      *((void *)v10 + 26) = a4;
      *((_WORD *)v10 + 108) = a5;
      uint64_t v14 = sub_10010C710((uint64_t)sub_1001982FC, a3);
      if ((_DWORD)v14) {
        sub_100198640(v11, 0LL);
      }
    }

    else
    {
      return 104LL;
    }
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

  return v14;
}

void sub_1001982FC(uint64_t a1, uint64_t a2, _BYTE *a3)
{
  int v5 = a1;
  uint64_t v6 = qword_1008E38A8;
  if (qword_1008E38A8)
  {
    while (*(_DWORD *)(v6 + 180) != *(_DWORD *)a2 || *(unsigned __int16 *)(v6 + 184) != *(unsigned __int16 *)(a2 + 4))
    {
      uint64_t v6 = *(void *)(v6 + 192);
      if (!v6) {
        goto LABEL_7;
      }
    }

    uint64_t v43 = v6;
    if ((_DWORD)a1)
    {
      sub_100198640(v6, a1);
      return;
    }

    uint64_t v41 = 0LL;
    uint64_t v42 = 0LL;
    *(void *)(v6 + 160) = a3;
    int v16 = *(unsigned __int8 *)(v6 + 152);
    if (v16 != 8)
    {
      if (v16 != 10) {
        goto LABEL_30;
      }
      uint64_t v17 = sub_100197DE0(&v41, 2, 10, *(_BYTE *)(v6 + 153));
      if (!(_DWORD)v17)
      {
        if (HIBYTE(v42))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        }

        else
        {
          __int16 v18 = WORD2(v42);
          if (WORD1(v42) - WORD2(v42) > 1)
          {
            if (BYTE6(v42) == 2)
            {
              uint64_t v19 = (_BYTE *)(v41 + WORD2(v42));
              *uint64_t v19 = *(_BYTE *)(v6 + 200);
              v19[1] = *(_BYTE *)(v6 + 201);
              __int16 v20 = v18 + 2;
              goto LABEL_26;
            }

            uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  871,  v37);
          }
        }

        uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_39;
      }

void sub_100198640(uint64_t a1, uint64_t a2)
{
  if (!qword_1008E38A8) {
    sub_1001EE2A0();
  }
  uint64_t v4 = *(void *)(a1 + 160);
  if (v4) {
    sub_10010CAA4(v4, 0x13u);
  }
  int v5 = &qword_1008E38A8;
  uint64_t v6 = qword_1008E38A8;
  if (qword_1008E38A8 == a1)
  {
LABEL_9:
    *int v5 = *(void *)(a1 + 192);
    sub_1001EEB14(*(unsigned int *)(a1 + 176));
    if ((_DWORD)a2)
    {
      uint64_t v8 = sub_10012D890(a1 + 180);
      if (sub_10012D514(v8)
        || (uint64_t v9 = sub_10012D890(a1 + 180), sub_10012D5BC(v9))
        || (uint64_t v10 = sub_10012D890(a1 + 180), sub_10012D5EC(v10))
        || (uint64_t v11 = sub_10012D890(a1 + 180), sub_10012D61C(v11)))
      {
        int v12 = *(unsigned __int8 *)(a1 + 152);
        if (v12 == 10)
        {
          (*(void (**)(uint64_t, void, void, void, void, uint64_t))(a1 + 208))( a1 + 180,  *(void *)(a1 + 168),  *(unsigned __int16 *)(a1 + 200),  0LL,  0LL,  a2);
        }

        else if (v12 == 8)
        {
          (*(void (**)(uint64_t, void, void, void, void, void, uint64_t))(a1 + 200))( a1 + 180,  *(void *)(a1 + 168),  *(void *)(a1 + 208),  *(unsigned __int16 *)(a1 + 216),  0LL,  0LL,  a2);
        }

        else
        {
          sub_1001EE2A0();
        }
      }
    }

    sub_1000B1838((void *)a1);
  }

  else
  {
    while (v6)
    {
      uint64_t v7 = v6;
      uint64_t v6 = *(void *)(v6 + 192);
      if (v6 == a1)
      {
        int v5 = (uint64_t *)(v7 + 192);
        goto LABEL_9;
      }
    }
  }

uint64_t sub_100198780(uint64_t a1, uint64_t a2, uint64_t a3, __int16 a4)
{
  if (a1 && a3)
  {
    uint64_t v8 = sub_1000B1814(0xE0uLL);
    if (v8)
    {
      uint64_t v9 = (uint64_t)v8;
      v8[152] = 10;
      *((void *)v8 + 24) = qword_1008E38A8;
      qword_1008E38A8 = (uint64_t)v8;
      else {
        char v10 = byte_1008E3898 + 1;
      }
      byte_1008E3898 = v10;
      v8[153] = v10;
      int v11 = *(_DWORD *)a3;
      *((_WORD *)v8 + 92) = *(_WORD *)(a3 + 4);
      *((_DWORD *)v8 + 45) = v11;
      *((void *)v8 + 21) = a2;
      *((_WORD *)v8 + 100) = a4;
      *((void *)v8 + 26) = a1;
      uint64_t v12 = sub_10010C710((uint64_t)sub_1001982FC, a3);
      if ((_DWORD)v12) {
        sub_100198640(v9, 0LL);
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"AllocCommandTracker() failed", v14, v15, v16, v17, v18, v19, v20, v22);
        int v21 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 104LL;
    }
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

  return v12;
}

uint64_t sub_1001988A4(unsigned int a1, uint64_t a2)
{
  uint64_t v6 = 0LL;
  uint64_t v4 = sub_10017AB4C(v6);
  uint64_t result = 0LL;
  __int16 v5 = *(_WORD *)(v4 + 14);
  *(_DWORD *)a2 = *(_DWORD *)(v4 + 10);
  *(_WORD *)(a2 + 4) = v5;
  return result;
}

void sub_100198900(_BYTE *a1, unsigned __int16 *a2, size_t size)
{
  char v68 = 0LL;
  if (!a1[2])
  {
    unsigned int v11 = size;
    if (size <= 3)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Received L2CAP header with 0 length, disc ACL",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  (uint64_t)(a1 + 48));
        uint64_t v20 = (os_log_s *)sub_100086554(0x2Fu);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      sub_10010CDEC((uint64_t)(a1 + 48));
      return;
    }

    int v21 = a2;
    if (a2[1] + 4 == (_DWORD)size)
    {
      uint64_t v22 = 0LL;
    }

    else
    {
      uint64_t v23 = (unsigned __int16 *)sub_1000B17F4(size);
      if (!v23)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"OI_SignalMan_Recv Malloc failed!", v51, v52, v53, v54, v55, v56, v57, v67);
          BOOL v58 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
            goto LABEL_4;
          }
        }

        return;
      }

      uint64_t v22 = v23;
      memmove(v23, v21, v11);
      int v21 = v22;
    }

    unsigned __int16 v69 = v21;
    __int16 v70 = v11;
    int v72 = 0x10000;
    unsigned __int16 v71 = v11;
    while (1)
    {
      unsigned int v24 = v71;
      uint64_t v25 = (unsigned __int16)v72;
      if (BYTE2(v72) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1850,  "(bs).__RWFlag == BYTESTREAM_READ");
      }
      LOWORD(v72) = v72 + 1;
      if (v71 <= (unsigned __int16)(v25 + 1))
      {
        HIBYTE(v72) = 1;
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_47:
        HIBYTE(v72) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"OI_SignalMan_Recv - %!", v59, v60, v61, v62, v63, v64, v65, 411LL);
          uint64_t v66 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        break;
      }

      uint64_t v26 = *((unsigned __int8 *)v69 + v25);
      LOWORD(v72) = v25 + 2;
      uint64_t v27 = *((unsigned __int8 *)v69 + v25 + 1);
      uint64_t v28 = *(unsigned __int16 *)((char *)v69 + v25 + 2);
      unsigned __int16 v29 = v25 + 4;
      LOWORD(v72) = v29;
      if ((v26 - 18) > 0xFFFFFFEE)
      {
        if (v26 <= 0x11 && ((1 << v26) & 0x2A0AA) != 0)
        {
          sub_1001967B8(v68);
          unsigned __int16 v29 = v72;
          unsigned int v24 = v71;
        }

        unsigned int v40 = v28 + v29;
        if (v40 <= v24)
        {
          qword_100885E80[v26](&v69, v27, v28, a1);
          if (v40 > v71) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1895,  "(size_t)(endSignalPos) <= (size_t)((bs).__size)");
          }
        }

        else
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"%! - Signalling packet length error", v41, v42, v43, v44, v45, v46, v47, 411LL);
            int v48 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
            {
              uint64_t v50 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446466;
              uint64_t v74 = v50;
              __int16 v75 = 1024;
              int v76 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v48,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }

          LOWORD(v40) = v71;
        }
      }

      else
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Unrecognized command (%d), sending CommandReject",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  v26);
          uint64_t v37 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
          {
            uint64_t v49 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446466;
            uint64_t v74 = v49;
            __int16 v75 = 1024;
            int v76 = 0xFFFF;
            _os_log_error_impl( (void *)&_mh_execute_header,  v37,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
          }
        }

        *(_DWORD *)__int128 buf = 0;
        sub_1001967F4("ad", 1u, 0LL, a1, v27, v34, v35, v36, 0LL);
        if (HIBYTE(v72))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          int v38 = 0;
        }

        else
        {
          int v38 = v71 - (unsigned __int16)v72;
        }

        if (v38 < (int)v28)
        {
          HIBYTE(v72) = 1;
LABEL_51:
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          break;
        }

        LOWORD(v40) = v72 + v28;
      }

      LOWORD(v72) = v40;
      if (HIBYTE(v72)) {
        goto LABEL_51;
      }
    }

    if (v22) {
      sub_1000B1838(v22);
    }
    return;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Signalling channel should only be used by ACL handles.", v3, v4, v5, v6, v7, v8, v9, v67);
    char v10 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
LABEL_4:
    }
      sub_100657858();
  }

void *sub_100198E08(void *result)
{
  off_1008E38A0 = result;
  return result;
}

void sub_100198E14()
{
  off_1008E38A0 = 0LL;
}

void sub_100198E20(uint64_t a1)
{
  uint64_t v1 = **(void **)(a1 + 8);
  if (*(_BYTE *)(v1 + 152) == 8) {
    uint64_t v2 = 440LL;
  }
  else {
    uint64_t v2 = 441LL;
  }
  sub_100198640(v1, v2);
}

void sub_100198E3C(uint64_t a1, unsigned int a2, int a3, uint64_t a4)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v8 = 0;
  }

  else
  {
    int v8 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v8 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1006,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1009,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  unsigned __int16 v73 = 0LL;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_10:
    *(_BYTE *)(a1 + 15) = 1;
    __int16 v10 = 20297;
    goto LABEL_11;
  }

  uint64_t v9 = *(unsigned __int16 *)(a1 + 12);
  __int16 v10 = *(_WORD *)(*(void *)a1 + v9);
  *(_WORD *)(a1 + 12) = v9 + 2;
LABEL_11:
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Received Command Reject, identifier %d, handle %d, reason %d",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  a2);
    uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  if (v10 == 2)
  {
    if (*(_BYTE *)(a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1020,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*(_BYTE *)(a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      int v27 = *(unsigned __int8 *)(a1 + 14);
      *(_BYTE *)(a1 + 15) = 1;
      if (v27 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1021,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
    }

    else
    {
      uint64_t v36 = *(unsigned __int16 *)(a1 + 12);
      if (*(unsigned __int16 *)(a1 + 10) - (int)v36 > 1)
      {
        v74[1] = *(_WORD *)(*(void *)a1 + v36);
        *(_WORD *)(a1 + 12) = v36 + 2;
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v36 + 2) >= 2)
        {
          v74[0] = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v36 + 2));
          *(_WORD *)(a1 + 12) = v36 + 4;
LABEL_42:
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"  Rejected - invalid CID, localCID %d, remoteCID %d",  v46,  v47,  v48,  v49,  v50,  v51,  v52,  v74[1]);
            uint64_t v53 = (os_log_s *)sub_100086554(0x2Fu);
            if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
              goto LABEL_44;
            }
          }

          goto LABEL_45;
        }

void sub_100199334(uint64_t a1, char a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  __int16 v14 = 771;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1067,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  unsigned __int16 v13 = 0;
}

void sub_100199408( uint64_t a1, unsigned int a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  int v14 = 50529027;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1089,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  __int16 v13 = 0;
}

void sub_1001994F4(uint64_t *a1, char a2, unsigned int a3, uint64_t a4)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v8 = 0;
  }

  else
  {
    int v8 = *((unsigned __int16 *)a1 + 5) - *((unsigned __int16 *)a1 + 6);
  }

  if (v8 < (int)a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1158,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1164,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v9 = *((unsigned __int16 *)a1 + 6);
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v10 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v10 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1165,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_13;
  }

  if (*((unsigned __int16 *)a1 + 5) - (int)v9 <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_13:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    unsigned __int16 v127 = 0;
    goto LABEL_14;
  }

  unsigned __int16 v127 = *(_WORD *)(*a1 + v9);
  *((_WORD *)a1 + 6) = v9 + 2;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v9 + 2) >= 2)
  {
    char v11 = *(_BYTE *)(*a1 + (unsigned __int16)(v9 + 2));
    *((_WORD *)a1 + 6) = v9 + 4;
    goto LABEL_15;
  }

void sub_10019A46C(uint64_t *a1, unsigned int a2, int a3, uint64_t a4)
{
  int v73 = 0;
  __int16 v72 = 0;
  memset(v71, 0, 44);
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v8 = 0;
  }

  else
  {
    int v8 = *((unsigned __int16 *)a1 + 5) - *((unsigned __int16 *)a1 + 6);
  }

  if (v8 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1323,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1329,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v9 = *((unsigned __int16 *)a1 + 6);
  uint64_t v66 = a4;
  unsigned int v65 = a2;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v10 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v10 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1330,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_14;
  }

  if (*((unsigned __int16 *)a1 + 5) - (int)v9 <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_14:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v14 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v14 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1334,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned __int16 v63 = 0;
    goto LABEL_16;
  }

  unsigned __int16 v63 = *(_WORD *)(*a1 + v9);
  *((_WORD *)a1 + 6) = v9 + 2;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v9 + 2) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_16:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    char v64 = 0;
    LOWORD(v12) = *((_WORD *)a1 + 6);
    goto LABEL_17;
  }

  char v11 = *(_BYTE *)(*a1 + (unsigned __int16)(v9 + 2));
  LOWORD(v12) = v9 + 4;
  *((_WORD *)a1 + 6) = v9 + 4;
  char v64 = v11 & 1;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v9 + 4) >= 2)
  {
    int v13 = 0;
    __int16 v62 = *(_WORD *)(*a1 + (unsigned __int16)(v9 + 4));
    LOWORD(v12) = v9 + 6;
    *((_WORD *)a1 + 6) = v9 + 6;
    goto LABEL_18;
  }

void sub_10019ADC4( uint64_t a1, uint64_t a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  __int16 v14 = 771;
  unsigned __int16 v13 = 0;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1109,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
}

void sub_10019AE98( uint64_t a1, uint64_t a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  __int16 v13 = 771;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v11 = 0;
  }

  else
  {
    int v11 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v11 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1129,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  unsigned __int16 v12 = 0;
}

void sub_10019AF6C(uint64_t *a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v8 = 0;
  }

  else
  {
    int v8 = *((unsigned __int16 *)a1 + 5) - *((unsigned __int16 *)a1 + 6);
  }

  if (v8 < (int)a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1396,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  __int16 v25 = 0;
  int v24 = 0;
  if (sub_10010EF78((uint64_t)a4, (uint64_t)&v24))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"getBdaddrFromHandle failed", v12, v13, v14, v15, v16, v17, v18, v23);
      unsigned int v19 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else if (a3 >= 0x18 && off_1008E38A0)
  {
    off_1008E38A0(*a1, *((unsigned __int16 *)a1 + 5), a3, a2, a4);
  }

  else
  {
    uint64_t v20 = *a1;
    uint64_t v21 = *((unsigned __int16 *)a1 + 6);
    if ((_DWORD)a3 == 5
      && (*(_DWORD *)(v20 + v21) == 1819308097 ? (BOOL v22 = *(_BYTE *)(v20 + v21 + 4) == 101) : (BOOL v22 = 0), v22))
    {
      sub_1001967F4("d", 9u, 0LL, a4, a2, v9, v10, v11, (uint64_t)"Apple Computer Inc.");
    }

    else
    {
      sub_1001967F4("d", 9u, 0LL, a4, a2, v9, v10, v11, v20 + v21);
    }
  }

void sub_10019B100(uint64_t a1, unsigned int a2, uint64_t a3)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v6 = 0;
  }

  else
  {
    int v6 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v6 < (int)a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1430,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  uint64_t v7 = qword_1008E38A8;
  if (!qword_1008E38A8) {
    goto LABEL_13;
  }
  while (*(unsigned __int8 *)(v7 + 153) != a2)
  {
    uint64_t v7 = *(void *)(v7 + 192);
    if (!v7) {
      goto LABEL_13;
    }
  }

  if (*(_BYTE *)(v7 + 152) == 8)
  {
    int v8 = *(void (**)(uint64_t, void, void, void, void, uint64_t, void))(v7 + 200);
    if (!v8)
    {
      sub_1001EE2A0();
      int v8 = *(void (**)(uint64_t, void, void, void, void, uint64_t, void))(v7 + 200);
    }

    v8( v7 + 180,  *(void *)(v7 + 168),  *(void *)(v7 + 208),  *(unsigned __int16 *)(v7 + 216),  *(void *)a1 + *(unsigned __int16 *)(a1 + 12),  a3,  0LL);
    sub_100198640(v7, 0LL);
  }

  else
  {
LABEL_13:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Unexpected Echo Response (id %d)", v9, v10, v11, v12, v13, v14, v15, a2);
      uint64_t v16 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_10065C800();
      }
    }
  }

void sub_10019B254(uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  int v29 = 0;
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1457,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1459,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_13;
  }

  uint64_t v13 = *(unsigned __int16 *)(a1 + 12);
  if (*(unsigned __int16 *)(a1 + 10) - (int)v13 < 2)
  {
LABEL_13:
    *(_BYTE *)(a1 + 15) = 1;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"SignalMan_RecvInfoReq - %!", v15, v16, v17, v18, v19, v20, v21, 411LL);
      BOOL v22 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  uint64_t v14 = *(unsigned __int16 *)(*(void *)a1 + v13);
  *(_WORD *)(a1 + 12) = v13 + 2;
  switch((_DWORD)v14)
  {
    case 3:
      uint64_t v30 = 0LL;
      if (sub_100172934(&v30))
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Error retreiving the supported fixed channels", v23, v24, v25, v26, a6, a7, a8, v28);
          uint64_t v27 = (os_log_s *)sub_100086554(0x2Fu);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      uint64_t v14 = 3LL;
      break;
    case 2:
      sub_1001964BC((char *)&v29);
      uint64_t v14 = 2LL;
      break;
    case 1:
      sub_1001EDBA0(0x2Fu);
      uint64_t v14 = 1LL;
      break;
  }

  sub_1001967F4("aad", 0xBu, 0LL, a4, a2, a6, a7, a8, v14);
}

void sub_10019B4B8(uint64_t *a1, unsigned int a2, uint64_t a3, uint64_t a4)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v8 = 0;
  }

  else
  {
    int v8 = *((unsigned __int16 *)a1 + 5) - *((unsigned __int16 *)a1 + 6);
  }

  if (v8 < (int)a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1525,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v9 = 0;
  }

  else
  {
    int v9 = *((unsigned __int16 *)a1 + 5) - *((unsigned __int16 *)a1 + 6);
  }

  unsigned __int16 v10 = a3 - 4;
  if (a3 < 4 || v9 < (int)a3)
  {
    if (sub_1000A86F0())
    {
      if (*((_BYTE *)a1 + 15)) {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      }
      sub_1001EE134( (uint64_t)"Invalid RecvInfoRsp input: cmdLen %d, NumReadBytesAvail %d.  Disconecting physical link.",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  a3);
      uint64_t v27 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    sub_10010D064(a4 + 48);
    return;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1534,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v11 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v11 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1535,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_27;
  }

  uint64_t v19 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) - (int)v19 <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_27:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    unsigned __int16 v21 = 0;
    uint64_t v20 = *a1;
    unsigned __int16 v22 = *((_WORD *)a1 + 6);
    goto LABEL_28;
  }

  uint64_t v20 = *a1;
  unsigned __int16 v21 = *(_WORD *)(*a1 + v19);
  unsigned __int16 v22 = v19 + 2;
  *((_WORD *)a1 + 6) = v19 + 2;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v19 + 2) < 2)
  {
LABEL_28:
    *((_BYTE *)a1 + 15) = 1;
    uint64_t v26 = v20 + v22;
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v28 = 0;
    goto LABEL_29;
  }

  int v23 = *(unsigned __int16 *)(v20 + (unsigned __int16)(v19 + 2));
  unsigned __int16 v24 = v19 + 4;
  *((_WORD *)a1 + 6) = v19 + 4;
  if (!v23)
  {
    uint64_t v26 = v20 + v24;
    int v28 = *((unsigned __int16 *)a1 + 5) - v24;
LABEL_29:
    int v23 = 0;
    if (v28 >= v10)
    {
      *((_WORD *)a1 + 6) += v10;
      int v25 = 1;
    }

    else
    {
      int v25 = 1;
      *((_BYTE *)a1 + 15) = 1;
    }

    goto LABEL_32;
  }

  int v25 = 0;
  unsigned __int16 v10 = 0;
  uint64_t v26 = 0LL;
LABEL_32:
  uint64_t v29 = qword_1008E38A8;
  if (!qword_1008E38A8) {
    goto LABEL_41;
  }
  while (*(unsigned __int8 *)(v29 + 153) != a2)
  {
    uint64_t v29 = *(void *)(v29 + 192);
    if (!v29) {
      goto LABEL_41;
    }
  }

  if (*(_BYTE *)(v29 + 152) == 10)
  {
    sub_1001EEB14(*(unsigned int *)(v29 + 176));
    if (!*(void *)(v29 + 208)) {
      sub_1001EE2A0();
    }
    if (*((_BYTE *)a1 + 15))
    {
      uint64_t v30 = v29;
      uint64_t v31 = 411LL;
    }

    else
    {
      if (v25) {
        uint64_t v40 = 0LL;
      }
      else {
        uint64_t v40 = (v23 + 470);
      }
      (*(void (**)(uint64_t, void, void, uint64_t, void, uint64_t))(v29 + 208))( v29 + 180,  *(void *)(v29 + 168),  v21,  v26,  v10,  v40);
      uint64_t v30 = v29;
      uint64_t v31 = 0LL;
    }

    sub_100198640(v30, v31);
  }

  else
  {
LABEL_41:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Unexpected Info Response (id %d)", v32, v33, v34, v35, v36, v37, v38, a2);
      uint64_t v39 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        sub_10065C800();
      }
    }
  }

uint64_t sub_10019B86C( uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1572,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 == 5)
  {
    if (*(_BYTE *)(a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1575,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*(_BYTE *)(a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      int v13 = *(unsigned __int8 *)(a1 + 14);
      *(_BYTE *)(a1 + 15) = 1;
      if (v13 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1576,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      goto LABEL_18;
    }

    int v19 = *(unsigned __int16 *)(a1 + 12);
    if (*(unsigned __int16 *)(a1 + 10) - v19 <= 1)
    {
      *(_BYTE *)(a1 + 15) = 1;
LABEL_18:
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      int v20 = *(unsigned __int8 *)(a1 + 14);
      *(_BYTE *)(a1 + 15) = 1;
      if (v20 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1577,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      goto LABEL_19;
    }

    *(_WORD *)(a1 + 12) = v19 + 2;
    if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v19 + 2) <= 1)
    {
      *(_BYTE *)(a1 + 15) = 1;
LABEL_19:
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_20;
    }

    *(_WORD *)(a1 + 12) = v19 + 4;
    if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v19 + 4))
    {
LABEL_20:
      *(_BYTE *)(a1 + 15) = 1;
      return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
    }

    *(_WORD *)(a1 + 12) = v19 + 5;
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Wrong command size for channel creation command", v14, v15, v16, v17, a6, a7, a8, v22);
    uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
}

void sub_10019BAA0(uint64_t a1, unsigned int a2, int a3)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v6 = 0;
  }

  else
  {
    int v6 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v6 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1604,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 != 8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Wrong command size for channel creation response", v8, v9, v10, v11, v12, v13, v14, v29);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_23;
  }

  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1607,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v7 = *(unsigned __int8 *)(a1 + 14);
    *(_BYTE *)(a1 + 15) = 1;
    if (v7 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1608,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_19;
  }

  int v16 = *(unsigned __int16 *)(a1 + 12);
  if (*(unsigned __int16 *)(a1 + 10) - v16 <= 1)
  {
    *(_BYTE *)(a1 + 15) = 1;
LABEL_19:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v17 = *(unsigned __int8 *)(a1 + 14);
    *(_BYTE *)(a1 + 15) = 1;
    if (v17 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1609,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_20;
  }

  *(_WORD *)(a1 + 12) = v16 + 2;
  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v16 + 2) <= 1)
  {
    *(_BYTE *)(a1 + 15) = 1;
LABEL_20:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v18 = *(unsigned __int8 *)(a1 + 14);
    *(_BYTE *)(a1 + 15) = 1;
    if (v18 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1610,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_21;
  }

  *(_WORD *)(a1 + 12) = v16 + 4;
  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v16 + 4) <= 1)
  {
    *(_BYTE *)(a1 + 15) = 1;
LABEL_21:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_22;
  }

  *(_WORD *)(a1 + 12) = v16 + 6;
  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v16 + 6) < 2)
  {
LABEL_22:
    *(_BYTE *)(a1 + 15) = 1;
    goto LABEL_23;
  }

  *(_WORD *)(a1 + 12) = v16 + 8;
LABEL_23:
  uint64_t v19 = qword_1008E38A8;
  if (!qword_1008E38A8) {
    goto LABEL_30;
  }
  while (*(unsigned __int8 *)(v19 + 153) != a2)
  {
    uint64_t v19 = *(void *)(v19 + 192);
    if (!v19) {
      goto LABEL_30;
    }
  }

  if (*(_BYTE *)(v19 + 152) == 12)
  {
    sub_1001EEB14(*(unsigned int *)(v19 + 176));
    if (*(_BYTE *)(a1 + 15)) {
      uint64_t v20 = 411LL;
    }
    else {
      uint64_t v20 = 0LL;
    }
    sub_100198640(v19, v20);
  }

  else
  {
LABEL_30:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Unexpected create channel Response (id %d)", v21, v22, v23, v24, v25, v26, v27, a2);
      int v28 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_10065C800();
      }
    }
  }

uint64_t sub_10019BDB0( uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1643,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 == 3)
  {
    if (*(_BYTE *)(a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1646,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*(_BYTE *)(a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      int v13 = *(unsigned __int8 *)(a1 + 14);
      *(_BYTE *)(a1 + 15) = 1;
      if (v13 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1647,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      goto LABEL_17;
    }

    int v19 = *(unsigned __int16 *)(a1 + 12);
    if (*(unsigned __int16 *)(a1 + 10) - v19 <= 1)
    {
      *(_BYTE *)(a1 + 15) = 1;
LABEL_17:
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_18;
    }

    *(_WORD *)(a1 + 12) = v19 + 2;
    if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v19 + 2))
    {
LABEL_18:
      *(_BYTE *)(a1 + 15) = 1;
      return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
    }

    *(_WORD *)(a1 + 12) = v19 + 3;
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Wrong command size for channel move command", v14, v15, v16, v17, a6, a7, a8, v21);
    int v18 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
}

void sub_10019BF7C(uint64_t a1, unsigned int a2, int a3)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v6 = 0;
  }

  else
  {
    int v6 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v6 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1667,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 != 4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Wrong command size for channel move response", v8, v9, v10, v11, v12, v13, v14, v27);
      uint64_t v15 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_19;
  }

  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1670,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v7 = *(unsigned __int8 *)(a1 + 14);
    *(_BYTE *)(a1 + 15) = 1;
    if (v7 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1671,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_17;
  }

  int v16 = *(unsigned __int16 *)(a1 + 12);
  if (*(unsigned __int16 *)(a1 + 10) - v16 <= 1)
  {
    *(_BYTE *)(a1 + 15) = 1;
LABEL_17:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_18;
  }

  *(_WORD *)(a1 + 12) = v16 + 2;
  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v16 + 2) < 2)
  {
LABEL_18:
    *(_BYTE *)(a1 + 15) = 1;
    goto LABEL_19;
  }

  *(_WORD *)(a1 + 12) = v16 + 4;
LABEL_19:
  uint64_t v17 = qword_1008E38A8;
  if (!qword_1008E38A8) {
    goto LABEL_26;
  }
  while (*(unsigned __int8 *)(v17 + 153) != a2)
  {
    uint64_t v17 = *(void *)(v17 + 192);
    if (!v17) {
      goto LABEL_26;
    }
  }

  if (*(_BYTE *)(v17 + 152) == 14)
  {
    sub_1001EEB14(*(unsigned int *)(v17 + 176));
    if (*(_BYTE *)(a1 + 15)) {
      uint64_t v18 = 411LL;
    }
    else {
      uint64_t v18 = 0LL;
    }
    sub_100198640(v17, v18);
  }

  else
  {
LABEL_26:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Unexpected create channel Response (id %d)", v19, v20, v21, v22, v23, v24, v25, a2);
      uint64_t v26 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_10065C800();
      }
    }
  }

uint64_t sub_10019C1BC( uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v12 = 0;
  }

  else
  {
    int v12 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v12 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1703,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 == 4)
  {
    if (*(_BYTE *)(a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1705,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*(_BYTE *)(a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      int v13 = *(unsigned __int8 *)(a1 + 14);
      *(_BYTE *)(a1 + 15) = 1;
      if (v13 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1706,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      goto LABEL_17;
    }

    int v19 = *(unsigned __int16 *)(a1 + 12);
    if (*(unsigned __int16 *)(a1 + 10) - v19 <= 1)
    {
      *(_BYTE *)(a1 + 15) = 1;
LABEL_17:
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_18;
    }

    *(_WORD *)(a1 + 12) = v19 + 2;
    if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v19 + 2) < 2)
    {
LABEL_18:
      *(_BYTE *)(a1 + 15) = 1;
      return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
    }

    *(_WORD *)(a1 + 12) = v19 + 4;
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Wrong command size for channel move confirmation", v14, v15, v16, v17, a6, a7, a8, v21);
    uint64_t v18 = (os_log_s *)sub_100086554(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return sub_1001967F4("ad", 1u, 0LL, a4, a2, a6, a7, a8, 0LL);
}

void sub_10019C38C(uint64_t a1, unsigned int a2, int a3)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    int v6 = 0;
  }

  else
  {
    int v6 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
  }

  if (v6 < a3) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1723,  "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }
  if (a3 != 2)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Wrong command size for channel move response", v7, v8, v9, v10, v11, v12, v13, v26);
      uint64_t v14 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_15;
  }

  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c",  1726,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_14:
    *(_BYTE *)(a1 + 15) = 1;
    goto LABEL_15;
  }

  int v15 = *(unsigned __int16 *)(a1 + 12);
  *(_WORD *)(a1 + 12) = v15 + 2;
LABEL_15:
  uint64_t v16 = qword_1008E38A8;
  if (!qword_1008E38A8) {
    goto LABEL_22;
  }
  while (*(unsigned __int8 *)(v16 + 153) != a2)
  {
    uint64_t v16 = *(void *)(v16 + 192);
    if (!v16) {
      goto LABEL_22;
    }
  }

  if (*(_BYTE *)(v16 + 152) == 16)
  {
    sub_1001EEB14(*(unsigned int *)(v16 + 176));
    if (*(_BYTE *)(a1 + 15)) {
      uint64_t v17 = 411LL;
    }
    else {
      uint64_t v17 = 0LL;
    }
    sub_100198640(v16, v17);
  }

  else
  {
LABEL_22:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Unexpected move channel Confirmation Response (id %d)",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  a2);
      uint64_t v25 = (os_log_s *)sub_100086554(0x2Fu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_10065C800();
      }
    }
  }

uint64_t sub_10019C5A4()
{
  return byte_1008E38B0;
}

void sub_10019C5B0(int a1)
{
  if (sub_1000A86F0())
  {
    uint64_t v9 = "incoming connection";
    if (a1) {
      uint64_t v9 = "address change";
    }
    sub_1001EE134((uint64_t)"Advertising stopped due to %s", v2, v3, v4, v5, v6, v7, v8, (uint64_t)v9);
    uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v24 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  byte_1008E38B1 = 0;
  unsigned int v11 = byte_1008E7A80;
  if (byte_1008E7A80)
  {
    uint64_t v12 = &byte_1008E45C5;
    uint64_t v13 = byte_1008E7A80;
    do
    {
      *uint64_t v12 = 0;
      v12 += 3368;
      --v13;
    }

    while (v13);
    if (byte_1008E7A81)
    {
      uint64_t v14 = sub_1001214B4(207, 0LL, v3, v4, v5, v6, v7, v8, 0LL);
      if ((_DWORD)v14)
      {
        uint64_t v15 = v14;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v15);
          uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    else
    {
      unint64_t v20 = a1 ^ 1u;
      if (v11 > v20)
      {
        do
        {
          if (sub_100190E18())
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not stop the LE advertising for instance %d with status %!, but moving forward !",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  byte_1008E7A82[v20]);
              uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
              {
                uint64_t v22 = sub_1001EDDCC();
                *(_DWORD *)__int128 buf = 136446466;
                uint64_t v24 = v22;
                __int16 v25 = 1024;
                int v26 = 0xFFFF;
                _os_log_error_impl( (void *)&_mh_execute_header,  v21,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
              }
            }
          }

          ++v20;
        }

        while (v20 < byte_1008E7A80);
      }
    }

    sub_10019C8C0(0LL, v2, v3, v4, v5, v6, v7, v8);
  }

  else
  {
    if (a1)
    {
      if (!byte_1008E45C5) {
        return;
      }
      uint64_t v17 = sub_1001214B4(170, (uint64_t)sub_10019CBFC, v3, v4, v5, v6, v7, v8, 0LL);
      if (!(_DWORD)v17)
      {
        byte_1008E45C5 = 3;
        return;
      }

      uint64_t v18 = v17;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Could not stop the LE advertising : %!", v2, v3, v4, v5, v6, v7, v8, v18);
        uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      byte_1008E45C5 = 0;
    }

    sub_10019CBFC(0LL, v2, v3, v4, v5, v6, v7, v8);
  }

void sub_10019C8C0( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if (byte_1008E7A81)
  {
    uint64_t v9 = byte_1008E7A80;
    if (byte_1008E7A80)
    {
      uint64_t v10 = &byte_1008E45C5;
      do
      {
        char *v10 = 0;
        v10 += 3368;
        --v9;
      }

      while (v9);
    }
  }

  else
  {
    uint64_t v11 = byte_1008E7A8C;
    BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 0;
    if ((int)v11 + 1 < byte_1008E7A80)
    {
      unint64_t v12 = v11 + 1;
      uint64_t v13 = (char *)&qword_1008E38B8[421 * v11 + 838] + 5;
      do
      {
        if (*v13 == 2)
        {
          byte_1008E7A8C = v12;
          uint64_t v14 = sub_100190E18();
          if (!(_DWORD)v14) {
            return;
          }
          uint64_t v15 = v14;
          a1 = sub_1000A86F0();
          if ((_DWORD)a1)
          {
            sub_1001EE134((uint64_t)"Could not stop the LE advertising : %!", a2, a3, a4, a5, a6, a7, a8, v15);
            uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
            a1 = os_log_type_enabled(v16, OS_LOG_TYPE_ERROR);
            if ((_DWORD)a1)
            {
              uint64_t v17 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446466;
              uint64_t v31 = v17;
              __int16 v32 = 1024;
              int v33 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v16,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }
        }

        *uint64_t v13 = 0;
        ++v12;
        v13 += 3368;
      }

      while (v12 < byte_1008E7A80);
    }
  }

  if (byte_1008E38B0)
  {
    unint64_t v18 = 0LL;
    uint64_t v19 = &byte_1008E45C5;
    do
    {
      if (*v19)
      {
        sub_1001EE2A0();
        if (*v19)
        {
          a1 = sub_1000A86F0();
          if ((_DWORD)a1)
          {
            sub_1001EE134((uint64_t)"instance=%d state=%d instead of 0", a2, a3, a4, a5, a6, a7, a8, v29);
            unint64_t v20 = (os_log_s *)sub_100086554(0x42u);
            a1 = os_log_type_enabled(v20, OS_LOG_TYPE_ERROR);
            if ((_DWORD)a1)
            {
              uint64_t v21 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446466;
              uint64_t v31 = v21;
              __int16 v32 = 1024;
              int v33 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v20,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }

          *uint64_t v19 = 0;
        }
      }

      ++v18;
      v19 += 3368;
    }

    while (v18 < byte_1008E38B0);
  }

  if ((byte_1008E38B1 & 1) != 0)
  {
    uint64_t v22 = sub_1001A038C(a1, a2, a3, a4, a5, a6, a7, a8);
    if (!(_DWORD)v22) {
      return;
    }
    uint64_t v23 = v22;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to restart advertising : %!", v24, v25, a4, a5, a6, a7, a8, v23);
      int v26 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    byte_1008E45C5 = 0;
    uint64_t v27 = v23;
    int v28 = 0;
  }

  else
  {
    byte_1008E45C5 = 0;
    uint64_t v27 = v8;
    int v28 = 1;
  }

  sub_10019FEA8(v27, v28, 0LL, a4, a5, a6, a7, a8);
}

void sub_10019CBFC( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_1008E45C5 = 0;
  if (byte_1008E38B1 == 1)
  {
    *(_DWORD *)((char *)v24 + 3) = 0;
    v24[0] = 0;
    sub_1001BDFB4((uint64_t)v24);
    uint64_t v14 = sub_1001214B4(166, (uint64_t)sub_10019D64C, v8, v9, v10, v11, v12, v13, (unsigned __int16)word_1008E38C8);
    if ((_DWORD)v14)
    {
      uint64_t v15 = v14;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to restart advertising : %!", v16, v17, v18, v19, v20, v21, v22, v15);
        uint64_t v23 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_10019FEA8(v15, 0, 0LL, v18, v19, v20, v21, v22);
    }
  }

  else
  {
    sub_10019FEA8(a1, 1, 0LL, a4, a5, a6, a7, a8);
  }

uint64_t sub_10019CD00( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, unsigned __int8 *a6, uint64_t a7, uint64_t a8, unsigned __int16 a9, const void *a10, char a11, unsigned __int16 a12, const void *a13, char a14, unsigned __int8 a15, int *a16, char a17, char a18, char a19, char a20, char a21, char a22, char a23, uint64_t a24)
{
  *(_DWORD *)((char *)v183 + 3) = 0;
  v183[0] = 0;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"StartAdvertising tech=%d handle=%d",  v32,  v33,  v34,  v35,  v36,  v37,  v38,  byte_1008E7A81);
    uint64_t v39 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      v185 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v39, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (!a1) {
    return 101LL;
  }
  if (a15 && !byte_1008E7A80)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"We're doing legacy advertising, why did we try to set handle to %d",  v40,  v41,  v42,  v43,  v44,  v45,  v46,  a15);
      int v47 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EE2A0();
    return 101LL;
  }

  if (sub_1001BEB60())
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"We are busy rotating our address", v50, v51, v52, v53, v54, v55, v56, v182);
      uint64_t v57 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4073LL;
  }

  byte_1008E7A8C = a15;
  if (byte_1008E7A80) {
    unsigned int v58 = a15;
  }
  else {
    unsigned int v58 = 0;
  }
  if (BYTE5(qword_1008E38B8[421 * v58 + 417]))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"LE Advertising already in progress (handle:%d state:%d).",  v59,  v60,  v61,  v62,  v63,  v64,  v65,  byte_1008E7A8C);
      uint64_t v66 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 118LL;
  }

  if ((a3 - 16385) <= 0xFFFFC01E)
  {
    sub_1001EE134((uint64_t)"Invalid advertising interval parameters : %d", v67, v68, v69, v70, v71, v72, v73, a3);
    int v74 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v74, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if ((a4 - 16385) <= 0xFFFFC01E)
  {
    sub_1001EE134((uint64_t)"Invalid advertising interval parameters : %d", v75, v76, v77, v78, v79, v80, v81, a4);
    uint64_t v82 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v82, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if (a5 >= 4)
  {
    sub_1001EE134((uint64_t)"Invalid advertising type parameters : %d", v83, v84, v85, v86, v87, v88, v89, a5);
    uint64_t v90 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v90, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if ((_DWORD)a5 == 1 && !a6)
  {
    sub_1001EE134((uint64_t)"Address can't be NULL", v91, v92, v93, v94, v95, v96, v97, v182);
    uint64_t v98 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v98, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if ((_DWORD)a5 == 1 && *a6 >= 2u)
  {
    sub_1001EE134((uint64_t)"Invalid address type parameters : %d", v115, v116, v117, v118, v119, v120, v121, *a6);
    uint64_t v122 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v122, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
LABEL_65:
    sub_100657858();
    return 101LL;
  }

  if ((a7 - 8) <= 0xFFFFFFF8)
  {
    sub_1001EE134((uint64_t)"Invalid advertising map parameters : %d", v99, v100, v101, v102, v103, v104, v105, a7);
    uint64_t v106 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v106, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if (a8 >= 4)
  {
    sub_1001EE134((uint64_t)"Invalid advertising filter parameters : %d", v107, v108, v109, v110, v111, v112, v113, a8);
    uint64_t v114 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v114, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if (a9 && !a10)
  {
    sub_1001EE134( (uint64_t)"Invalid advertising data length parameters : %d",  v123,  v124,  v125,  v126,  v127,  v128,  v129,  a9);
    unsigned int v130 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v130, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if (a12 && !a13)
  {
    sub_1001EE134((uint64_t)"Invalid scan data length parameters : %d", v131, v132, v133, v134, v135, v136, v137, a9);
    uint64_t v138 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v138, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_65;
  }

  if (a16 && (a15 & 0xFB) != 0)
  {
    uint64_t v139 = &qword_1008E38B8[421 * a15];
    int v140 = *a16;
    *(_DWORD *)((char *)v139 + 3345) = *(int *)((char *)a16 + 3);
    *(_DWORD *)((char *)v139 + 3342) = v140;
    *((_BYTE *)v139 + 3349) = 1;
  }

  else
  {
    uint64_t v141 = &qword_1008E38B8[421 * a15];
    *((_BYTE *)v141 + 3349) = 1;
    uint64_t v142 = (_DWORD *)((char *)&unk_1008E7A8D + 8 * a15 - a15);
    BOOL v143 = *v142 == dword_1008E7AB0 && *(_DWORD *)((char *)v142 + 3) == *(int *)((char *)&dword_1008E7AB0 + 3);
    uint64_t v144 = (char *)v141 + 3342;
    if (v143)
    {
      if ((a15 & 0xFB) != 0)
      {
        *uint64_t v144 = 1;
        arc4random_buf((char *)&qword_1008E38B8[421 * a15 + 417] + 7, 6uLL);
        HIBYTE(qword_1008E38B8[421 * byte_1008E7A8C + 417]) &= 0x3Fu;
      }

      else
      {
        sub_1001BDF5C(0, (uint64_t)v144);
      }
    }

    else
    {
      *(_DWORD *)uint64_t v144 = *v142;
      *(_DWORD *)((char *)v141 + 3345) = *(_DWORD *)((char *)v142 + 3);
    }
  }

  if (byte_1008E7A80)
  {
    unsigned int v145 = byte_1008E7A8C;
    uint64_t v146 = &qword_1008E38B8[421 * byte_1008E7A8C];
    *uint64_t v146 = a1;
    v146[1] = a2;
    *((_WORD *)v146 + 8) = a3;
    *((_WORD *)v146 + 9) = a4;
    *((_BYTE *)v146 + 20) = a5;
    *((_BYTE *)v146 + 28) = a7;
    *((_BYTE *)v146 + 29) = a8;
    *((_WORD *)v146 + 15) = a9;
    *((_BYTE *)v146 + 1684) = a11;
    *((_BYTE *)v146 + 3340) = a14;
    *((_WORD *)v146 + 841) = 0;
    *((_WORD *)v146 + 1669) = 0;
    *((_BYTE *)v146 + 3350) = a17;
    *((_BYTE *)v146 + 3351) = a18;
    *((_BYTE *)v146 + 3352) = a19;
    *((_BYTE *)v146 + 3353) = a20;
    *((_BYTE *)v146 + 3354) = a21;
    *((_BYTE *)v146 + 3355) = a22;
    *((_BYTE *)v146 + 3356) = a23;
    uint64_t v147 = v146 + 4;
    v146[420] = a24;
    bzero(v146 + 4, 0x672uLL);
    if (a10)
    {
      memmove(v147, a10, a9);
      unsigned int v145 = byte_1008E7A8C;
    }

    uint64_t v148 = &qword_1008E38B8[421 * v145];
    *((_WORD *)v148 + 843) = a12;
    uint64_t v149 = v148 + 211;
    bzero(v148 + 211, 0x672uLL);
    uint64_t v157 = (uint64_t)a13;
    if (a13) {
      int v150 = memmove(v149, a13, a12);
    }
    uint64_t v48 = sub_1001A038C((uint64_t)v150, v157, v151, v152, v153, v154, v155, v156);
  }

  else
  {
    sub_1001BDFB4((uint64_t)v183);
    qword_1008E38B8[0] = a1;
    qword_1008E38C0 = a2;
    word_1008E38C8 = a3;
    word_1008E38CA = a4;
    byte_1008E38CC = a5;
    if ((_DWORD)a5 == 1)
    {
      int v164 = *(_DWORD *)a6;
      __int16 v165 = *((_WORD *)a6 + 2);
      byte_1008E38D3 = a6[6];
      word_1008E38D1 = v165;
      dword_1008E38CD = v164;
    }

    else
    {
      *(int *)((char *)&dword_1008E38CD + 3) = 0;
      dword_1008E38CD = 0;
    }

    byte_1008E38D4 = a7;
    byte_1008E38D5 = a8;
    word_1008E38D6 = a9;
    byte_1008E3F4C = a11;
    byte_1008E45C4 = a14;
    word_1008E3F4A = 0;
    word_1008E45C2 = 0;
    qword_1008E38D8[0] = 0LL;
    qword_1008E38D8[2] = 0LL;
    qword_1008E38D8[1] = 0LL;
    *(void *)((char *)&qword_1008E38D8[2] + 7) = 0LL;
    if (a10) {
      __memmove_chk(qword_1008E38D8, a10, a9, 16808LL);
    }
    word_1008E3F4E = a12;
    qword_1008E3F50[0] = 0LL;
    qword_1008E3F50[2] = 0LL;
    qword_1008E3F50[1] = 0LL;
    *(void *)((char *)&qword_1008E3F50[2] + 7) = 0LL;
    if (a13) {
      __memmove_chk(qword_1008E3F50, a13, a12, 15152LL);
    }
    uint64_t v48 = sub_1001214B4( 166,  (uint64_t)sub_10019D64C,  v158,  v159,  v160,  v161,  v162,  v163,  (unsigned __int16)word_1008E38C8);
    byte_1008E45C5 = 1;
  }

  if (byte_1008E7AB7 && (++dword_1008E7A88, !(dword_1008E7A88 % byte_1008E7AB7)))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Faking OI_BUSY_FAIL now", v166, v167, v168, v169, v170, v171, v172, v182);
      uint64_t v173 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v173, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    uint64_t v48 = 118LL;
  }

  else if (!(_DWORD)v48)
  {
    return v48;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Could not start a LE advertising %!", v174, v175, v176, v177, v178, v179, v180, v48);
    uint64_t v181 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v181, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return v48;
}

void sub_10019D64C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if ((_DWORD)a1
    || (uint64_t v8 = sub_1001214B4(168, (uint64_t)sub_1001A0178, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_1008E38D6),
        (_DWORD)v8))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"advertisingParametersCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    byte_1008E45C5 = 0;
    sub_10019FEA8(v8, 0, 0LL, v11, v12, v13, v14, v15);
  }

uint64_t sub_10019D6F8()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"StopAdvertising tech=%d", v0, v1, v2, v3, v4, v5, v6, byte_1008E7A81);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v59 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_1001BEB60())
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"We are busy rotating our address", v14, v15, v16, v17, v18, v19, v20, v57);
      uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4073LL;
  }

  uint64_t v23 = byte_1008E7A80;
  if (byte_1008E7A80)
  {
    if (byte_1008E7A81)
    {
      uint64_t v24 = sub_1001214B4(207, (uint64_t)sub_10019C8C0, v8, v9, v10, v11, v12, v13, 0LL);
      if ((_DWORD)v24)
      {
        uint64_t v22 = v24;
        sub_1001EE134( (uint64_t)"Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!",  v25,  v26,  v27,  v28,  v29,  v30,  v31,  v22);
        uint64_t v32 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
          return v22;
        }
LABEL_14:
        sub_100657858();
        return v22;
      }

      uint64_t v43 = byte_1008E7A80;
      if (byte_1008E7A80)
      {
        uint64_t v44 = &byte_1008E45C5;
        do
        {
          *uint64_t v44 = 3;
          v44 += 3368;
          --v43;
        }

        while (v43);
      }

      return 0LL;
    }

    uint64_t v41 = 0LL;
    for (uint64_t i = &byte_1008E45C5; *i != 2; i += 3368)
    {
      *uint64_t i = 0;
      if (v23 == ++v41) {
        return 0LL;
      }
    }

    byte_1008E7A8C = v41;
    uint64_t v45 = sub_100190E18();
    if ((_DWORD)v45)
    {
      uint64_t v46 = v45;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not stop the LE advertising : %!, resetting its state to idle",  v47,  v48,  v49,  v50,  v51,  v52,  v53,  v46);
        uint64_t v54 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      char v55 = 0;
    }

    else
    {
      char v55 = 3;
    }

    uint64_t v22 = 0LL;
    *uint64_t i = v55;
  }

  else
  {
    if (byte_1008E45C5 != 2) {
      return 0LL;
    }
    uint64_t v22 = sub_1001214B4(170, (uint64_t)sub_10019CBFC, v8, v9, v10, v11, v12, v13, 0LL);
    if (!(_DWORD)v22)
    {
      byte_1008E45C5 = 3;
      return v22;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not stop the LE advertising : %!", v33, v34, v35, v36, v37, v38, v39, v22);
      uint64_t v40 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
        goto LABEL_14;
      }
    }
  }

  return v22;
}

uint64_t sub_10019D9F8(int a1)
{
  if (byte_1008E45C5 != 2 || (byte_1008E38B1 & 1) != 0 || a1 && byte_1008E38D5 != 3) {
    return 0LL;
  }
  uint64_t result = sub_10019D6F8();
  if (!(_DWORD)result) {
    byte_1008E38B1 = 1;
  }
  return result;
}

BOOL sub_10019DA58()
{
  return byte_1008E45C5 == 2 && byte_1008E38CC < 2u;
}

void sub_10019DA78()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Halting advertising and resetting states", v0, v1, v2, v3, v4, v5, v6, v30);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v32 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  byte_1008E38B1 = 0;
  uint64_t v8 = byte_1008E7A80;
  if (byte_1008E7A80)
  {
    uint64_t v9 = qword_1008E38B8;
    do
    {
      *((_BYTE *)v9 + 3341) = 0;
      uint64_t *v9 = 0LL;
      v9 += 421;
      --v8;
    }

    while (v8);
    if (byte_1008E7A81)
    {
      uint64_t v10 = sub_1001214B4(207, 0LL, v1, v2, v3, v4, v5, v6, 0LL);
      if ((_DWORD)v10)
      {
        uint64_t v11 = v10;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
          uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    else
    {
      unint64_t v20 = 0LL;
      do
      {
        if (sub_100190E18())
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not stop the LE advertising for instance %d with status %!, but moving forward !",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  byte_1008E7A82[v20]);
            uint64_t v28 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
            {
              uint64_t v29 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446466;
              uint64_t v32 = v29;
              __int16 v33 = 1024;
              int v34 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v28,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }
        }

        ++v20;
      }

      while (v20 < byte_1008E7A80);
    }
  }

  byte_1008E7A8C = 0;
  bzero(qword_1008E38B8, 0x41C8uLL);
}

void sub_10019DCE4()
{
}

char *sub_10019DCF4(unsigned int a1)
{
  return (char *)&unk_1008E7A8D + 8 * a1 - a1;
}

uint64_t sub_10019DD08( int *a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = (_DWORD *)((char *)&unk_1008E7A8D + 8 * a2 - a2);
  int v9 = *a1;
  *(_DWORD *)((char *)v8 + 3) = *(int *)((char *)a1 + 3);
  *uint64_t v8 = v9;
  if (byte_1008E7A81)
  {
    uint64_t v10 = sub_1001214B4(203, a3, a3, a4, a5, a6, a7, a8, byte_1008E7A82[a2]);
    if ((_DWORD)v10)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"OI_HCI_CMD_LE_SetAdvertisingSetRandomAddress returned %!",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v10);
        uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
LABEL_6:
        }
          sub_100657858();
      }
    }
  }

  else
  {
    uint64_t v10 = sub_100190EA0();
    if ((_DWORD)v10)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"BT_VSC_UpdateMultipleAdvInstanceAddress returned %!",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  v10);
        uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
          goto LABEL_6;
        }
      }
    }
  }

  return v10;
}

uint64_t sub_10019DE34(uint64_t a1, unsigned int a2, unsigned int a3)
{
  uint64_t v3 = 101LL;
  if (a2 <= 2 && a3 <= 2)
  {
    uint64_t v3 = sub_10018D5D4();
    if ((_DWORD)v3)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"BT_VSC_SetAdvPhyOptions returned %!", v4, v5, v6, v7, v8, v9, v10, v3);
        uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

  return v3;
}

uint64_t sub_10019DEC8( int *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10019DD08(a1, 0, a2, a4, a5, a6, a7, a8);
}

uint64_t sub_10019DED4()
{
  return byte_1008E7A80;
}

uint64_t sub_10019DEE0(unsigned int a1)
{
  else {
    return byte_1008E7A82[a1];
  }
}

uint64_t sub_10019DF08(uint64_t (*a1)(void, void, void))
{
  if (off_1008E7AB8)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Already initializing", v1, v2, v3, v4, v5, v6, v7, v29);
      uint64_t v8 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 408LL;
  }

  if (byte_1008E7A80) {
    return 140LL;
  }
  bzero(qword_1008E38B8, 0x41C8uLL);
  off_1008E7AB8 = a1;
  if (byte_1008E7A81 == 1)
  {
    uint64_t v12 = byte_1008E38B0;
    byte_1008E7A80 = byte_1008E38B0;
    __memset_chk(&unk_1008E7A8D, 0LL, 7LL * byte_1008E38B0, 35LL);
    if (v12)
    {
      for (uint64_t i = 0LL; i != v12; ++i)
        byte_1008E7A82[i] = i;
    }

    sub_1001BDF5C(0, (uint64_t)&unk_1008E7AA9);
    sub_1001EE2A0();
    int v32 = 105;
    v31[1] = &v32;
    v31[0] = (const void *)4;
    uint64_t v20 = sub_1001EE6E8((uint64_t)sub_10019E1E8, v31, 0, 0LL);
    if (!(_DWORD)v20) {
      return 105LL;
    }
    uint64_t v9 = v20;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Could not register dispatchReadRemoteVersionInformation",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  v30);
      uint64_t v28 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return v9;
  }

  return sub_100190B70();
}

void sub_10019E0DC(int a1, unsigned int a2)
{
  int v20 = a1;
  if (a1) {
    a2 = (unsigned __int16)word_1008E7AC2;
  }
  else {
    word_1008E7AC2 = a2;
  }
  if (a2 >= 0x673)
  {
    sub_1001EE2A0();
    if ((unsigned __int16)word_1008E7AC2 >= 0x673u)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"fControllerMaxExtendedAdvertisingPayloadSize=%d",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  (unsigned __int16)word_1008E7AC2);
        uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      word_1008E7AC2 = 1650;
    }
  }

  v19[1] = &v20;
  v19[0] = (const void *)4;
  if (sub_1001EE6E8((uint64_t)sub_10019E1E8, v19, 0, 0LL) && sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Could not register dispatchReadRemoteVersionInformation",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v18);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_10019E1E8(uint64_t a1)
{
  uint64_t result = off_1008E7AB8(**(unsigned int **)(a1 + 8), byte_1008E7A82, byte_1008E7A80);
  off_1008E7AB8 = 0LL;
  return result;
}

uint64_t sub_10019E228(uint64_t a1, char a2)
{
  if ((_DWORD)a1)
  {
    uint64_t result = off_1008E7AB8(a1, byte_1008E7A82, byte_1008E7A80);
    off_1008E7AB8 = 0LL;
  }

  else
  {
    char v3 = byte_1008E7A80;
    byte_1008E7A82[byte_1008E7A80] = a2;
    unsigned __int8 v4 = v3 + 1;
    byte_1008E7A80 = v4;
    if (byte_1008E38B0 == v4)
    {
      __memset_chk(&unk_1008E7A8D, 0LL, 7LL * v4, 35LL);
      sub_1001BDF5C(0, (uint64_t)&unk_1008E7AA9);
      sub_1001BDF5C(0, (uint64_t)&unk_1008E7A8D);
      return off_1008E7AB8(0LL, byte_1008E7A82, byte_1008E7A80);
    }

    else
    {
      *(_DWORD *)((char *)v5 + 3) = 0;
      v5[0] = 1;
      arc4random_buf((char *)v5 + 1, 6uLL);
      BYTE1(v5[0]) &= 0x3Fu;
      return sub_100190B70();
    }
  }

  return result;
}

uint64_t sub_10019E340( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!byte_1008E7A80) {
    return 103LL;
  }
  if (byte_1008E7A81)
  {
    uint64_t v8 = sub_1001214B4(211, (uint64_t)nullsub_76, a3, a4, a5, a6, a7, a8, v31);
    if ((_DWORD)v8)
    {
      uint64_t v9 = v8;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"OI_HCI_CMD_LE_ClearAdvertisingSets returned %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

  else if (byte_1008E38B0)
  {
    unint64_t v19 = 0LL;
    do
    {
      uint64_t v20 = sub_100190BF8();
      if ((_DWORD)v20)
      {
        uint64_t v21 = v20;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"BT_VSC_RemoveMultipleAdvInstance returned %!", v22, v23, v24, v25, v26, v27, v28, v21);
          uint64_t v29 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
          {
            uint64_t v30 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446466;
            __int16 v33 = v30;
            __int16 v34 = 1024;
            int v35 = 0xFFFF;
            _os_log_error_impl( (void *)&_mh_execute_header,  v29,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
          }
        }
      }

      ++v19;
    }

    while (v19 < byte_1008E38B0);
  }

  uint64_t result = 0LL;
  byte_1008E7A80 = 0;
  off_1008E7AB8 = 0LL;
  return result;
}

BOOL sub_10019E510()
{
  return byte_1008E45C5 == 3 || byte_1008E45C5 == 0;
}

uint64_t sub_10019E528(uint64_t result)
{
  byte_1008E7A81 = result;
  return result;
}

uint64_t sub_10019E534(uint64_t result)
{
  byte_1008E7AC0 = result;
  if ((_DWORD)result) {
    byte_1008E7A81 = 1;
  }
  return result;
}

uint64_t sub_10019E550(uint64_t result)
{
  byte_1008E38B0 = result;
  return result;
}

uint64_t sub_10019E55C()
{
  return (unsigned __int16)word_1008E7AC2;
}

BOOL sub_10019E568()
{
  if (byte_1008E7A80)
  {
    uint64_t v0 = 0LL;
    BOOL v1 = 0;
    for (uint64_t i = &byte_1008E45C5; (*i | 2) != 3; i += 3368)
    {
      BOOL v1 = ++v0 >= (unint64_t)byte_1008E7A80;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"ADV instance %d is in state %d",  v3,  v4,  v5,  v6,  v7,  v8,  v9,  byte_1008E7A82[v0]);
      uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v13 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  else
  {
    return 1;
  }

  return v1;
}

BOOL sub_10019E68C()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_isPeriodicAdvStarting", v0, v1, v2, v3, v4, v5, v6, *(uint64_t *)v12);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v12 = 136446210;
      *(void *)&v12[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", v12, 0xCu);
    }
  }

  uint64_t v8 = 0LL;
  char v9 = 1;
  do
  {
    int v10 = dword_1008E7AE8[420 * v8];
    if ((v9 & 1) == 0) {
      break;
    }
    char v9 = 0;
    uint64_t v8 = 1LL;
  }

  while (v10 != 1);
  return v10 == 1;
}

BOOL sub_10019E77C(unsigned int a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_isPeriodicAdvCtxInUse advHandle=%d", v2, v3, v4, v5, v6, v7, v8, a1);
    char v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v16 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v10 = 0LL;
  int v11 = 1;
  do
  {
    while (1)
    {
      int v12 = v11;
      if (BYTE2(dword_1008E7AE8[420 * v10 + 1]) == a1) {
        break;
      }
      int v11 = 0;
      BOOL result = 0LL;
      uint64_t v10 = 1LL;
      if ((v12 & 1) == 0) {
        return result;
      }
    }

    int v13 = dword_1008E7AE8[420 * v10];
    BOOL result = v13 == 2;
    if (v13 == 2) {
      break;
    }
    int v11 = 0;
    uint64_t v10 = 1LL;
  }

  while (((v12 ^ 1) & 1) == 0);
  return result;
}

_DWORD *sub_10019E8A0()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_AllocatePeriodicAdvCtx", v0, v1, v2, v3, v4, v5, v6, *(uint64_t *)v21);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v21 = 136446210;
      *(void *)&uint8_t v21[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", v21, 0xCu);
    }
  }

  uint64_t v8 = 0LL;
  char v9 = 1;
  do
  {
    uint64_t v10 = &dword_1008E7AE8[420 * v8];
    if (!*v10)
    {
      bzero(v10, 0x690uLL);
      return v10;
    }

    char v11 = v9;
    char v9 = 0;
    uint64_t v8 = 1LL;
  }

  while ((v11 & 1) != 0);
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE_AllocatePeriodicAdvCtx there is no free periodic advertisng parameter.",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  *(uint64_t *)v21);
    unint64_t v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return 0LL;
}

uint64_t sub_10019E9E0(uint64_t (*a1)(void, void), void *a2)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_InitPeriodicAdvertising", v4, v5, v6, v7, v8, v9, v10, *(uint64_t *)v13);
    char v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v13 = 136446210;
      *(void *)&v13[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", v13, 0xCu);
    }
  }

  byte_1008E7AD0 = 0;
  off_1008E7AD8 = a1;
  off_1008E7AE0 = a2;
  bzero(dword_1008E7AE8, 0xD20uLL);
  return 0LL;
}

void sub_10019EAD4()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_TerminatePeriodicAdvertising", v0, v1, v2, v3, v4, v5, v6, v23);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v25 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_10019ECA0())
  {
    uint64_t v8 = 0LL;
    char v9 = 1;
    do
    {
      char v10 = v9;
      if ((dword_1008E7AE8[420 * v8] - 1) <= 1)
      {
        char v11 = &dword_1008E7AE8[420 * v8];
        unsigned int v13 = *((unsigned __int8 *)v11 + 6);
        uint64_t v12 = (unsigned __int8 *)v11 + 6;
        if (sub_10019ED68(v13, 1))
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Failed to stop periodic advertising advHandle %x",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  *v12);
            uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
            {
              uint64_t v22 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446466;
              uint64_t v25 = v22;
              __int16 v26 = 1024;
              int v27 = 0xFFFF;
              _os_log_error_impl( (void *)&_mh_execute_header,  v21,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
            }
          }
        }
      }

      char v9 = 0;
      uint64_t v8 = 1LL;
    }

    while ((v10 & 1) != 0);
  }

uint64_t sub_10019ECA0()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE_ReturnNumPeriodicAdvStarted numPeriodicAdvStarted=%d",  v0,  v1,  v2,  v3,  v4,  v5,  v6,  byte_1008E7AD0);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      char v10 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return byte_1008E7AD0;
}

uint64_t sub_10019ED68(unsigned int a1, char a2)
{
  uint64_t v4 = 0LL;
  char v5 = 1;
  do
  {
    char v6 = v5;
    if (BYTE2(dword_1008E7AE8[420 * v4 + 1]) == a1)
    {
      uint64_t v15 = &dword_1008E7AE8[420 * v4];
      goto LABEL_9;
    }

    char v5 = 0;
    uint64_t v4 = 1LL;
  }

  while ((v6 & 1) != 0);
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE_GetPeriodicAdvCtxByAdvHandle cannot find the context advHandle=%d.",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  a1);
    uint64_t v14 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  uint64_t v15 = 0LL;
LABEL_9:
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_StopPeriodicAdvertising advHandle=%d", v16, v17, v18, v19, v20, v21, v22, a1);
    uint64_t v23 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v80 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((a2 & 1) == 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE_isPeriodicAdvStopping", v24, v25, v26, v27, v28, v29, v30, v78);
      uint64_t v31 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
      {
        int v32 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v80 = v32;
        _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    uint64_t v33 = 0LL;
    char v34 = 1;
    do
    {
      int v35 = dword_1008E7AE8[420 * v33];
      if ((v34 & 1) == 0) {
        break;
      }
      char v34 = 0;
      uint64_t v33 = 1LL;
    }

    while (v35 != 3);
    if (v35 == 3)
    {
      sub_1001EE134((uint64_t)"LE_StopPeriodicAdvertising pending stop command", v54, v55, v56, v57, v58, v59, v60, v78);
      uint64_t v61 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v61, OS_LOG_TYPE_ERROR)) {
        return 117LL;
      }
      goto LABEL_41;
    }
  }

  if (v15)
  {
    if (off_1008E7AE0)
    {
      if (*v15 == 2)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Stopping Periodic Advertising", v36, v37, v38, v39, v40, v41, v42, v78);
          uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v44 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v80 = v44;
            _os_log_impl((void *)&_mh_execute_header, v43, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        uint64_t result = sub_1001214B4(214, (uint64_t)sub_10019F53C, v37, v38, v39, v40, v41, v42, 0LL);
        if (!(_DWORD)result) {
          *uint64_t v15 = 3;
        }
        return result;
      }

      sub_1001EE134((uint64_t)"No LE Periodic Advertising in progress.", v70, v71, v72, v73, v74, v75, v76, v78);
      uint64_t v77 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v77, OS_LOG_TYPE_ERROR)) {
        return 117LL;
      }
LABEL_41:
      sub_100657858();
      return 117LL;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising parameters no periodicAdvStoppedCb",  v62,  v63,  v64,  v65,  v66,  v67,  v68,  v78);
      uint64_t v69 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 114LL;
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE_StopPeriodicAdvertising invalid advHandle=%d", v46, v47, v48, v49, v50, v51, v52, a1);
      uint64_t v53 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 120LL;
  }

uint64_t sub_10019F138(unsigned __int8 *a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_StartPeriodicAdvertising advHandle=%d", v2, v3, v4, v5, v6, v7, v8, *a1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v88 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_10019E68C())
  {
    sub_1001EE134((uint64_t)"LE_StartPeriodicAdvertising pending start command", v10, v11, v12, v13, v14, v15, v16, v86);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      return 117LL;
    }
    goto LABEL_7;
  }

  if (off_1008E7AD8)
  {
    unsigned int v19 = *a1;
    if (v19 >= 0xF0)
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising parameters advHandle: %x",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  *a1);
      uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_25;
    }

    if (*((unsigned __int16 *)a1 + 1) <= 5u)
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising parameters periodicAdvInterval: %x",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  *((unsigned __int16 *)a1 + 1));
      uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_25;
    }

    if ((a1[4] & 0xBF) != 0)
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising parameters periodicAdvProperty: %x",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  a1[4]);
      uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
LABEL_25:
      sub_100657858();
      return 101LL;
    }

    if (sub_10019E77C(v19))
    {
      sub_1001EE134( (uint64_t)"LE_StartPeriodicAdvertising advHandle=%d is already started",  v53,  v54,  v55,  v56,  v57,  v58,  v59,  *a1);
      uint64_t v60 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v60, OS_LOG_TYPE_ERROR)) {
        return 117LL;
      }
LABEL_7:
      sub_100657858();
      return 117LL;
    }

    uint64_t v61 = sub_10019E8A0();
    if (v61)
    {
      uint64_t v68 = v61;
      *((_BYTE *)v61 + 6) = *a1;
      *((_WORD *)v61 + 4) = *((_WORD *)a1 + 1);
      *((_BYTE *)v61 + 10) = a1[4];
      size_t v69 = *((unsigned __int16 *)a1 + 3);
      if (*((_WORD *)a1 + 3))
      {
        memmove((char *)v61 + 14, a1 + 8, v69);
        *((_WORD *)v68 + 6) = *((_WORD *)a1 + 3);
        *((_WORD *)v68 + 832) = 0;
      }

      uint64_t v18 = sub_10019F4D4((unsigned __int8 *)v68, v62, v69, v63, v64, v65, v66, v67);
      if ((_DWORD)v18)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not start the LE periodic advertising %!",  v70,  v71,  v72,  v73,  v74,  v75,  v76,  v18);
          uint64_t v77 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v77, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"LE_StartPeriodicAdvertising No resource", v78, v79, v80, v81, v82, v83, v84, v86);
        uint64_t v85 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v85, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 104LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising parameters no periodicAdvStartedCb",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v86);
      int v35 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 114LL;
  }

  return v18;
}

uint64_t sub_10019F4D4( unsigned __int8 *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v9 = sub_1001214B4(212, (uint64_t)sub_1001A12F0, a3, a4, a5, a6, a7, a8, a1[6]);
  if ((_DWORD)v9) {
    sub_1001A105C(a1);
  }
  else {
    *(_DWORD *)a1 = 1;
  }
  return v9;
}

void sub_10019F53C(uint64_t a1)
{
  uint64_t v2 = 0LL;
  char v3 = 1;
  while (1)
  {
    uint64_t v4 = (unsigned __int8 *)&dword_1008E7AE8[420 * v2];
    if (*(_DWORD *)v4 == 3) {
      break;
    }
    char v5 = v3;
    char v3 = 0;
    uint64_t v2 = 1LL;
    if ((v5 & 1) == 0)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"LE_GetPeriodicAdvCtxStopping cannot find the context",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  v39);
        uint64_t v13 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_1001EE2A0();
      uint64_t v4 = 0LL;
      break;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Periodic advertising stopped %! advHandle=%d", v14, v15, v16, v17, v18, v19, v20, a1);
    uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v41 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  *(_DWORD *)uint64_t v4 = 0;
  --byte_1008E7AD0;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"notifyPeriodicAdvStoppped status=%d advHandle=%d", v22, v23, v24, v25, v26, v27, v28, a1);
    uint64_t v29 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v30 = sub_1001EDDCC();
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v41 = v30;
      _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1001A105C(v4);
  if (off_1008E7AE0)
  {
    off_1008E7AE0(a1, v4[6]);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Could not find a callback, might be a problem ?", v31, v32, v33, v34, v35, v36, v37, v39);
    uint64_t v38 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_10019F774()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_RefreshPeriodicAdvRandomAddress", v0, v1, v2, v3, v4, v5, v6, v20);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v22 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v8 = 0LL;
  uint64_t v9 = 0LL;
  char v10 = 1;
  do
  {
    char v11 = v10;
    if (dword_1008E7AE8[420 * v8] == 2)
    {
      uint64_t v12 = (char *)&dword_1008E7AE8[420 * v8];
      v12[4] = 1;
      uint64_t v13 = v12 + 4;
      uint64_t v14 = sub_1001214B4(214, (uint64_t)sub_10019F95C, v1, v2, v3, v4, v5, v6, 1LL);
      if ((_DWORD)v14)
      {
        uint64_t v15 = v14;
        *uint64_t v13 = 0;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Fail to refresh random address for periodic advertising advHandle=%d",  v16,  v1,  v2,  v3,  v4,  v5,  v6,  v13[2]);
          uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            uint64_t v18 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446466;
            uint64_t v22 = v18;
            __int16 v23 = 1024;
            int v24 = 0xFFFF;
            _os_log_error_impl( (void *)&_mh_execute_header,  v17,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
          }
        }

        uint64_t v9 = v15;
      }
    }

    char v10 = 0;
    uint64_t v8 = 1LL;
  }

  while ((v11 & 1) != 0);
  return v9;
}

void sub_10019F95C(uint64_t a1)
{
  uint64_t v2 = (unsigned __int8 *)sub_1001A1260();
  if (!v2) {
    sub_1001EE2A0();
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Periodic advertising started %! advHandle=%d addressChanged=%d",  v3,  v4,  v5,  v6,  v7,  v8,  v9,  a1);
    char v10 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v28 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (v2[4])
  {
    if ((_DWORD)a1 && sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Fail to refresh random address for periodic advertising advHandle=%d",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v2[6]);
      uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    v2[4] = 0;
  }

  else
  {
    if ((_DWORD)a1)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Could not start advertising : %!", v19, v20, v21, v22, v23, v24, v25, a1);
        uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      *(_DWORD *)uint64_t v2 = 2;
      ++byte_1008E7AD0;
    }

    sub_1001A1128(a1, v2);
  }

uint64_t sub_10019FB0C(uint64_t result)
{
  byte_1008E7AC8 = result;
  return result;
}

uint64_t sub_10019FB18()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE_GetPeriodicAdvertisingEnabled enabled=%d",  v0,  v1,  v2,  v3,  v4,  v5,  v6,  byte_1008E7AC8);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      char v10 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return byte_1008E7AC8;
}

void sub_10019FBE0(char a1)
{
  byte_1008E7AB7 = a1;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Invoking fake OI_BUSY_FAIL every %d attempts",  v1,  v2,  v3,  v4,  v5,  v6,  v7,  byte_1008E7AB7);
    uint64_t v8 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      char v10 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

uint64_t sub_10019FCA8()
{
  uint64_t result = sub_1001EE0E4( "gNumOfAdvHandles=%d gInitMultiAdvCb=%x currentHandle=%d tech=%d extendedAdvertisingEnabled=%d gMaxControlle rSupportedAdvertisingPacketSize=%d",  byte_1008E7A80,  (_DWORD)off_1008E7AB8,  byte_1008E7A8C,  byte_1008E7A81,  byte_1008E7AC0,  (unsigned __int16)word_1008E7AC2);
  if (byte_1008E7A80)
  {
    unint64_t v1 = 0LL;
    uint64_t v2 = (char *)&unk_1008E7A8E;
    uint64_t v3 = &qword_1008E38B8;
    do
    {
      sub_1001EE0E4("advertisingParams for instance %d :", v1);
      sub_1001EE0E4( "\tintervalMin=%d intervalMax=%d type=%d channelMap=%d state=%d",  *((unsigned __int16 *)v3 + 8),  *((unsigned __int16 *)v3 + 9),  *((unsigned __int8 *)v3 + 20),  *((unsigned __int8 *)v3 + 28),  *((unsigned __int8 *)v3 + 3341));
      sub_1001EE0E4("\tdata:%@", v3 + 4, *((unsigned __int16 *)v3 + 15));
      sub_1001EE0E4("\tscanRsp:%@", v3 + 211, *((unsigned __int16 *)v3 + 843));
      sub_1001EE0E4("\taddress: %: type:%d", v2, *(v2 - 1));
      sub_1001EE0E4("\tprimaryPHY:%d", *((unsigned __int8 *)v3 + 3350));
      sub_1001EE0E4("\tsecondaryPHY:%d", *((unsigned __int8 *)v3 + 3351));
      sub_1001EE0E4("\tprimaryPhyOptions:%d", *((unsigned __int8 *)v3 + 3352));
      sub_1001EE0E4("\tsecondaryPhyOptions:%d", *((unsigned __int8 *)v3 + 3353));
      sub_1001EE0E4("\tuseDecisionBasedAdvPayload:%d", *((unsigned __int8 *)v3 + 3354));
      sub_1001EE0E4("\tDBAFDecisionTypeFlags:%d", *((unsigned __int8 *)v3 + 3355));
      sub_1001EE0E4("\tDBAFDecisionDataLength:%d", *((unsigned __int8 *)v3 + 3356));
      uint64_t result = sub_1001EE0E4("\tDBAFDecisionData:%s", (const char *)v3[420]);
      ++v1;
      v2 += 7;
      v3 += 421;
    }

    while (v1 < byte_1008E7A80);
  }

  return result;
}

void sub_10019FEA8( uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  unsigned int v8 = a3;
  uint64_t v9 = a1;
  char v10 = 0LL;
  uint64_t v45 = qword_1008E38C0;
  uint64_t v11 = byte_1008E38B1;
  unint64_t v12 = 0x1FFFFFFFFFFFF7C7uLL;
  do
  {
    if (qword_1008E38B8[v12 + 2105]) {
      char v10 = (void (*)(uint64_t, uint64_t))qword_1008E38B8[v12 + 2105];
    }
    v12 += 421LL;
  }

  while (v12 * 8);
  if ((_DWORD)a1)
  {
    if (byte_1008E7A80)
    {
      if (byte_1008E7A81)
      {
        uint64_t v13 = sub_1001214B4(207, 0LL, a3, a4, a5, a6, a7, a8, 0LL);
        if ((_DWORD)v13)
        {
          uint64_t v14 = v13;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v14);
            uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }
        }
      }

      else
      {
        unint64_t v33 = 0LL;
        do
        {
          uint64_t v34 = sub_100190E18();
          if ((_DWORD)v34)
          {
            uint64_t v35 = v34;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not stop the LE advertising BT_VSC_SetMultipleAdvInstanceEnable returned  %!",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v35);
              uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
              {
                uint64_t v44 = sub_1001EDDCC();
                *(_DWORD *)__int128 buf = 136446466;
                uint64_t v47 = v44;
                __int16 v48 = 1024;
                int v49 = 0xFFFF;
                _os_log_error_impl( (void *)&_mh_execute_header,  v43,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
              }
            }
          }

          ++v33;
        }

        while (v33 < byte_1008E7A80);
      }
    }
  }

  else if (!a2)
  {
    goto LABEL_14;
  }

  byte_1008E7A8C = 0;
  uint64_t v23 = &qword_1008E38B8[421 * v8];
  bzero(v23 + 4, 0x672uLL);
  bzero(v23 + 211, 0x672uLL);
  *((_WORD *)v23 + 843) = 0;
  *((_WORD *)v23 + 15) = 0;
  *((_BYTE *)v23 + 3341) = 0;
LABEL_14:
  byte_1008E38B1 = 0;
  if (v10)
  {
    if (sub_1001BEB60())
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Stopped due to address change, recovering silentRestartSequence=%d",  v24,  v25,  v26,  v27,  v28,  v29,  v30,  v11);
        uint64_t v31 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v32 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v47 = v32;
          _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      uint64_t v9 = 4073LL;
    }

    if ((v11 & 1) == 0) {
      v10(v9, v45);
    }
  }

void sub_1001A0178( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if ((_DWORD)a1)
  {
LABEL_2:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"advertisingDataCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v24);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    byte_1008E45C5 = 0;
    sub_10019FEA8(v8, 0, 0LL, v11, v12, v13, v14, v15);
    return;
  }

  if (word_1008E3F4E)
  {
    uint64_t v8 = sub_1001214B4(169, (uint64_t)sub_1001A0260, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_1008E3F4E);
    if (!(_DWORD)v8) {
      return;
    }
    goto LABEL_2;
  }

void sub_1001A0260( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if ((_DWORD)a1 || (uint64_t v8 = sub_1001214B4(170, (uint64_t)sub_1001A0304, a3, a4, a5, a6, a7, a8, 1LL), (_DWORD)v8))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"scanResponseDataCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    byte_1008E45C5 = 0;
    sub_10019FEA8(v8, 0, 0LL, v11, v12, v13, v14, v15);
  }

void sub_1001A0304( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"advertiseStart Could not start advertising : %!", v9, v10, a4, a5, a6, a7, a8, a1);
      uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  byte_1008E45C5 = 2;
  sub_10019FEA8(a1, 0, 0LL, a4, a5, a6, a7, a8);
}

uint64_t sub_1001A038C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = byte_1008E7A8C;
  if (!byte_1008E7A81)
  {
    uint64_t v10 = sub_100190C80();
    if ((_DWORD)v10) {
      return v10;
    }
LABEL_9:
    uint64_t v10 = 0LL;
    BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 1;
    return v10;
  }

  if (byte_1008E7A8C == 4) {
    uint64_t v8 = &dword_100000004;
  }
  uint64_t v9 = sub_1001214B4(204, (uint64_t)sub_1001A080C, a3, a4, a5, a6, a7, a8, byte_1008E7A82[v8]);
  if (!(_DWORD)v9) {
    goto LABEL_9;
  }
  uint64_t v10 = v9;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"OI_HCI_CMD_LE_SetExtendedAdvertisingParameters returned %!",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v10);
    uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return v10;
}

void sub_1001A057C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if ((_DWORD)a1)
  {
LABEL_2:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"setMultipleAdvParamsCompleteCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    uint64_t v17 = byte_1008E7A8C;
    BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 0;
    sub_10019FEA8(v8, 0, v17, v11, v12, v13, v14, v15);
    return;
  }

  if (!HIWORD(qword_1008E38B8[421 * byte_1008E7A8C + 3])
    || (byte_1008E7A8C == 4
      ? (BOOL v18 = BYTE4(qword_1008E38B8[421 * byte_1008E7A8C + 210]) == 0)
      : (BOOL v18 = 0),
        v18))
  {
    sub_1001A0960(0LL, a2, a3, a4, a5, a6, a7, a8);
    return;
  }

  if (!byte_1008E7A81)
  {
    uint64_t v36 = sub_100190D08();
LABEL_26:
    uint64_t v8 = v36;
    if (!(_DWORD)v36) {
      return;
    }
    goto LABEL_2;
  }

  if (!BYTE2(qword_1008E38B8[421 * byte_1008E7A8C + 419]))
  {
    uint64_t v36 = sub_1001A0B08(a1, a2, a3, a4, a5, a6, a7, a8);
    goto LABEL_26;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"We are using DBAF! Sending Decision Ind Data instead.",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  v37);
    uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_INFO))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v39 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v27 = sub_1001214B4( 257,  (uint64_t)sub_1001A0F98,  v20,  v21,  v22,  v23,  v24,  v25,  byte_1008E7A82[byte_1008E7A8C]);
  if ((_DWORD)v27)
  {
    uint64_t v8 = v27;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"OI_HCI_CMD_LE_SetDecisionDataCommand returned %!", v28, v29, v30, v31, v32, v33, v34, v8);
      uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_2;
  }

void sub_1001A080C(uint64_t a1, uint64_t a2)
{
  char v2 = a2;
  sub_1001BEB28(a2, byte_1008E7A8C);
  uint64_t v10 = byte_1008E7A8C;
  if (!byte_1008E7A8C)
  {
    uint64_t v11 = (unsigned __int16)word_1008E38D6;
    if (word_1008E38D6)
    {
      int v12 = 0;
      unsigned __int8 v13 = 0;
      do
      {
        if ((unsigned __int16)word_1008E38D6 - 2 > v12
          && *((_BYTE *)&qword_1008E38B8[4] + v13) == 2
          && *((_BYTE *)&qword_1008E38B8[4] + (v12 + 1)) == 10)
        {
          uint64_t v15 = (v12 + 2);
          goto LABEL_10;
        }

        int v12 = ++v13;
      }

      while (v13 < (unsigned __int16)word_1008E38D6);
    }

    word_1008E38D6 += 3;
    uint64_t v14 = (char *)&unk_1008E38D8 + v11;
    *uint64_t v14 = 2;
    uint64_t v15 = v11 + 2;
    v14[1] = 10;
LABEL_10:
    *((_BYTE *)&qword_1008E38B8[4] + v15) = v2;
  }

void sub_1001A0960( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if (!(_DWORD)a1)
  {
    if (byte_1008E7A81)
    {
      uint64_t v18 = sub_1001214B4( 206,  (uint64_t)sub_1001A0C1C,  (uint64_t)&unk_1008E3F50,  a4,  a5,  a6,  a7,  a8,  byte_1008E7A82[byte_1008E7A8C]);
      if (!(_DWORD)v18) {
        return;
      }
      uint64_t v8 = v18;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"OI_HCI_CMD_LE_SetExtendedScanResponseData returned %!", a2, a3, a4, a5, a6, a7, a8, v8);
        uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }

    else
    {
      uint64_t v8 = sub_100190D90();
    }

    if (HIWORD(qword_1008E38B8[421 * byte_1008E7A8C + 210]) && (_DWORD)v8 != 0)
    {
LABEL_20:
      sub_1001A0C1C(0LL, a2, a3, a4, a5, a6, a7, a8);
      return;
    }

    if (!(_DWORD)v8) {
      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"setMultipleAdvertisingDataCompleteCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v8);
    uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  uint64_t v17 = byte_1008E7A8C;
  BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 0;
  sub_10019FEA8(v8, 0, v17, v11, v12, v13, v14, v15);
}

uint64_t sub_1001A0B08( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = &qword_1008E38B8[421 * byte_1008E7A8C];
  __int16 v9 = *((_WORD *)v8 + 841);
  else {
    __int16 v10 = *((_WORD *)v8 + 15) - v9;
  }
  uint64_t v11 = sub_1001214B4( 205,  (uint64_t)sub_1001A0F9C,  a3,  a4,  a5,  a6,  a7,  a8,  byte_1008E7A82[byte_1008E7A8C]);
  if ((_DWORD)v11)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"OI_HCI_CMD_LE_SetExtendedAdvertisingData returned %!",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
      uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    WORD1(qword_1008E38B8[421 * byte_1008E7A8C + 210]) += v10;
  }

  return v11;
}

void sub_1001A0C1C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if ((_DWORD)a1)
  {
LABEL_2:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"setMultipleAdvertisingScanRspDataCompleteCb Could not start advertising : %!",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v8);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    uint64_t v17 = byte_1008E7A8C;
    BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 0;
    sub_10019FEA8(v8, 0, v17, v11, v12, v13, v14, v15);
    return;
  }

  uint64_t v18 = (int *)((char *)&unk_1008E7A8D + 8 * byte_1008E7A8C - byte_1008E7A8C);
  uint64_t v19 = (int *)((char *)&qword_1008E38B8[421 * byte_1008E7A8C + 417] + 6);
  int v20 = *v18;
  int v21 = *(int *)((char *)v18 + 3);
  if (v20 == *v19 && v21 == *(_DWORD *)((char *)&qword_1008E38B8[421 * byte_1008E7A8C + 418] + 1))
  {
    sub_1001A0D64((uint64_t)v19, byte_1008E7A8C, a3, a4, a5, a6, a7, a8);
    return;
  }

  uint64_t v23 = sub_10019DD08(v19, byte_1008E7A8C, (uint64_t)sub_1001A0D64, a4, a5, a6, a7, a8);
  if ((_DWORD)v23)
  {
    uint64_t v8 = v23;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE_UpdateMultiAdvertisingSetAddress returned %!", v24, v25, v26, v27, v28, v29, v30, v8);
      uint64_t v31 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    goto LABEL_2;
  }

void sub_1001A0D64( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = (_DWORD *)((char *)&unk_1008E7A8D + 8 * byte_1008E7A8C - byte_1008E7A8C);
  uint64_t v9 = (_DWORD *)((char *)&qword_1008E38B8[421 * byte_1008E7A8C + 417] + 6);
  *uint64_t v8 = *v9;
  *(_DWORD *)((char *)v8 + 3) = *(_DWORD *)((char *)v9 + 3);
  if (byte_1008E7A81)
  {
    uint64_t v10 = sub_1001214B4(207, (uint64_t)sub_1001A0EF4, a3, a4, a5, a6, a7, a8, 1LL);
    if (!(_DWORD)v10) {
      return;
    }
    uint64_t v11 = v10;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Failed to start advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
      uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    uint64_t v11 = sub_100190E18();
    if (!(_DWORD)v11) {
      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"setAdvertisingSetAddressBeforeEnablingCB Could not start advertising : %!",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  v11);
    uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  uint64_t v28 = byte_1008E7A8C;
  BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 0;
  sub_10019FEA8(v11, 0, v28, v22, v23, v24, v25, v26);
}

void sub_1001A0EF4( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"multipleAdvStartCb Could not start advertising : %!", v9, v10, a4, a5, a6, a7, a8, a1);
      uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    BYTE5(qword_1008E38B8[421 * byte_1008E7A8C + 417]) = 2;
  }

  sub_10019FEA8(a1, 0, byte_1008E7A8C, a4, a5, a6, a7, a8);
}

void sub_1001A0F9C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((_DWORD)a1
    || HIWORD(qword_1008E38B8[421 * byte_1008E7A8C + 3]) == WORD1(qword_1008E38B8[421
                                                                                                 * byte_1008E7A8C
                                                                                                 + 210])
    || (a1 = sub_1001A0B08(), (_DWORD)a1))
  {
    sub_1001A0960(a1, a2, a3, a4, a5, a6, a7, a8);
  }

void sub_1001A0FE8( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not setAdvPhyOptions: %!", a2, a3, a4, a5, a6, a7, a8, a1);
      uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  sub_1001A057C(0LL, a2, a3, a4, a5, a6, a7, a8);
}

void sub_1001A105C(void *a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_FreePeriodicAdvCtx", v2, v3, v4, v5, v6, v7, v8, *(uint64_t *)v10);
    uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v10 = 136446210;
      *(void *)&v10[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", v10, 0xCu);
    }
  }

  if (a1) {
    bzero(a1, 0x690uLL);
  }
}

void sub_1001A1128(uint64_t a1, unsigned __int8 *a2)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"notifyPeriodicAdvStarted status=%d advHandle=%d", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v22 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((_DWORD)a1) {
    sub_1001A105C(a2);
  }
  if (off_1008E7AD8)
  {
    off_1008E7AD8(a1, a2[6]);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Could not find a callback, might be a problem ?", v12, v13, v14, v15, v16, v17, v18, v20);
    uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

_DWORD *sub_1001A1260()
{
  uint64_t v0 = 0LL;
  for (char i = 1; ; char i = 0)
  {
    uint64_t result = (_DWORD *)((char *)&unk_1008E7AE8 + 1680 * v0);
    if (*result == 1) {
      break;
    }
    char v3 = i;
    uint64_t v0 = 1LL;
    if ((v3 & 1) == 0)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"LE_GetPeriodicAdvCtxStarting cannot find the context", v4, v5, v6, v7, v8, v9, v10, v12);
        uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 0LL;
    }
  }

  return result;
}

void sub_1001A12F0(uint64_t a1)
{
  uint64_t v2 = (unsigned __int8 *)sub_1001A1260();
  if (!v2) {
    sub_1001EE2A0();
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"setPeriodicAdvParamsCompleteCb status %! ", v3, v4, v5, v6, v7, v8, v9, a1);
    uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v29 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((_DWORD)a1)
  {
LABEL_7:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not start periodic advertising : %!", v11, v12, v13, v14, v15, v16, v17, a1);
      uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    *(_DWORD *)uint64_t v2 = 0;
    sub_1001A1128(a1, v2);
    return;
  }

  if (*((_WORD *)v2 + 6))
  {
    a1 = sub_1001A165C((uint64_t)v2);
    if (!(_DWORD)a1) {
      return;
    }
    goto LABEL_7;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Periodic advertising data size is 0, skip setting data for adv instance %d",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  v2[6]);
    uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v27 = sub_1001EDDCC();
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v29 = v27;
      _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1001A14C4(0LL, v2);
}

void sub_1001A14C4(uint64_t a1, unsigned __int8 *a2)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Set Periodic Advertising Data Complete %! advHandle=%d", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v30 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (!(_DWORD)a1)
  {
    uint64_t v20 = sub_1001214B4(214, (uint64_t)sub_10019F95C, v5, v6, v7, v8, v9, v10, 1LL);
    if (!(_DWORD)v20) {
      return;
    }
    a1 = v20;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Failed to start advertising OI_HCI_CMD_LE_SetPeriodicAdvertisingEnable returned %!",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  a1);
      uint64_t v28 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Could not start peirodic advertising : %!", v12, v13, v14, v15, v16, v17, v18, a1);
    uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  *(_DWORD *)a2 = 0;
  sub_1001A1128(a1, a2);
}

uint64_t sub_1001A165C(uint64_t a1)
{
  unsigned __int16 v2 = *(_WORD *)(a1 + 12) - *(_WORD *)(a1 + 1664);
  if (v2 >= 0xFCu) {
    __int16 v3 = 252;
  }
  else {
    __int16 v3 = *(_WORD *)(a1 + 12) - *(_WORD *)(a1 + 1664);
  }
  if (v2 > 0xFCu) {
    unsigned int v4 = 1;
  }
  else {
    unsigned int v4 = 3;
  }
  if (*(_WORD *)(a1 + 1664)) {
    uint64_t v5 = 2 * (v2 < 0xFDu);
  }
  else {
    uint64_t v5 = v4;
  }
  if ((sub_1000A86F0() & 1) != 0)
  {
    sub_1001EE134( (uint64_t)"setPeriodicAdvDataPacket operation:%d dataLeft:%d totalDataLen:%d dataLengthThisPacket:%d position:%d",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  v5);
    uint64_t v13 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v25 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v14 = sub_1001214B4(213, (uint64_t)sub_1001A17F8, v7, v8, v9, v10, v11, v12, *(unsigned __int8 *)(a1 + 6));
  if ((_DWORD)v14)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"OI_HCI_CMD_LE_SetPeriodicAdvertisingData returned %!",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v14);
      uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    *(_WORD *)(a1 + 1664) += v3;
  }

  return v14;
}

void sub_1001A17F8(uint64_t a1)
{
  unsigned __int16 v2 = (unsigned __int8 *)sub_1001A1260();
  if (!v2) {
    sub_1001EE2A0();
  }
  int v3 = *((unsigned __int16 *)v2 + 6);
  int v4 = *((unsigned __int16 *)v2 + 832);
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"setPeriodicAdvDataPacketCompleteCb dataLeft:%d status:%!",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  (unsigned __int16)(v3 - v4));
    uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v14 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((_DWORD)a1 || v3 == v4 || (a1 = sub_1001A165C(v2), (_DWORD)a1)) {
    sub_1001A14C4(a1, v2);
  }
}

uint64_t sub_1001A1910()
{
  if (qword_1008E8820) {
    return qword_1008E8820();
  }
  return result;
}

uint64_t sub_1001A1924()
{
  if (off_1008E8830) {
    return off_1008E8830();
  }
  return result;
}

uint64_t sub_1001A1938()
{
  if (off_1008E8828) {
    return off_1008E8828();
  }
  return result;
}

uint64_t sub_1001A194C()
{
  xmmword_1008E8840 = 0u;
  unk_1008E8850 = 0u;
  qword_1008E8860 = 0LL;
  sub_1001C87BC((__n128 *)off_100885F10);
  if ((_DWORD)v0)
  {
    uint64_t v1 = v0;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to add state callbacks : %!", v2, v3, v4, v5, v6, v7, v8, v1);
      uint64_t v9 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
LABEL_4:
      }
        sub_100657858();
    }
  }

  else
  {
    uint64_t v10 = sub_1001B7C4C((uint64_t)off_100885F28);
    if ((_DWORD)v10)
    {
      uint64_t v1 = v10;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to add GAP connections callbacks : %!", v11, v12, v13, v14, v15, v16, v17, v1);
        uint64_t v18 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          goto LABEL_4;
        }
      }
    }

    else
    {
      dword_1008E8868 = 0;
      qword_1008E8870 = 0LL;
      uint64_t v1 = sub_1001732EC(4u, 3, 16, 3u, &xmmword_1008E8840, (uint64_t)sub_1001A3368);
      if ((_DWORD)v1 || !(void)xmmword_1008E8840)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Could not register the l2cap : %!", v19, v20, v21, v22, v23, v24, v25, v1);
          uint64_t v26 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      else
      {
        *(_WORD *)sub_10017AF44((unsigned int *)xmmword_1008E8840) = 527;
        *(_WORD *)(sub_10017AF44((unsigned int *)xmmword_1008E8840) + 2) = -1;
      }

      if (sub_1000A86F0())
      {
        uint64_t v27 = (unsigned __int16 *)sub_10017AF44((unsigned int *)xmmword_1008E8840);
        sub_1001EE134((uint64_t)"ATT L2CAP channel MTU: %d", v28, v29, v30, v31, v32, v33, v34, *v27);
        uint64_t v35 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)__int128 buf = 136446210;
          __int16 v48 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v35, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      qword_1008E8878 = (uint64_t)sub_1001EC038(0LL, (uint64_t)sub_1001A54C4);
      uint64_t v36 = sub_1000B1E6C();
      if ((_DWORD)v36)
      {
        uint64_t v37 = v36;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"ATT classic registration failed with %!", v38, v39, v40, v41, v42, v43, v44, v37);
          uint64_t v45 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }
    }
  }

  return v1;
}

void sub_1001A1BF8()
{
  if ((void)xmmword_1008E8840) {
    sub_1001734D8(xmmword_1008E8840);
  }
  uint64_t v0 = (void *)*((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    do
    {
      uint64_t v1 = (void *)v0[10];
      uint64_t v2 = (void *)v0[6];
      if (v2) {
        sub_1000B1838(v2);
      }
      if (off_1008E8838) {
        off_1008E8838(v0);
      }
      sub_1000B1838(v0);
      uint64_t v0 = v1;
    }

    while (v1);
  }

  sub_1001C8874(off_100885F10);
  sub_1001B7DDC((uint64_t)off_100885F28);
  qword_1008E8860 = 0LL;
  xmmword_1008E8840 = 0u;
  unk_1008E8850 = 0u;
  if (qword_1008E8878) {
    sub_1001EC070((void *)qword_1008E8878);
  }
  off_1008E8880 = 0LL;
  dword_1008E8868 = 0;
  qword_1008E8870 = 0LL;
}

uint64_t sub_1001A1CBC(void *a1)
{
  if (off_1008E8880) {
    return 119LL;
  }
  uint64_t result = 0LL;
  off_1008E8880 = a1;
  return result;
}

uint64_t sub_1001A1CE0(void *a1, uint64_t a2)
{
  if (!a1) {
    return 101LL;
  }
  if (off_1008E8858) {
    return 119LL;
  }
  uint64_t result = 0LL;
  off_1008E8858 = a1;
  qword_1008E8860 = a2;
  return result;
}

void *sub_1001A1D18(void *result)
{
  if (off_1008E8858 == result)
  {
    off_1008E8858 = 0LL;
    qword_1008E8860 = 0LL;
  }

  return result;
}

uint64_t (*sub_1001A1D3C(void *a1))(void)
{
  uint64_t v1 = (void *)*((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    return 0LL;
  }
  uint64_t v3 = (void *)*((void *)&xmmword_1008E8840 + 1);
  while (v3 != a1)
  {
    uint64_t v3 = (void *)v3[10];
    if (!v3) {
      return 0LL;
    }
  }

  uint64_t v4 = a1[11];
  if (v4) {
    *(void *)(v4 + 80) = a1[10];
  }
  uint64_t v5 = a1[10];
  if (v5) {
    *(void *)(v5 + 88) = v4;
  }
  if (v1 == a1) {
    *((void *)&xmmword_1008E8840 + 1) = v5;
  }
  uint64_t v6 = (void *)a1[6];
  if (v6) {
    sub_1000B1838(v6);
  }
  uint64_t v7 = *((unsigned int *)a1 + 15);
  if ((_DWORD)v7) {
    sub_1001EEB14(v7);
  }
  if (off_1008E8838) {
    off_1008E8838(a1);
  }
  uint64_t v8 = (void *)sub_1001EC43C(qword_1008E8878);
  for (ptr = v8; ptr; uint64_t v8 = ptr)
  {
    while (1)
    {
      uint64_t v9 = sub_1001EC460((uint64_t)v8);
      if (v9) {
        break;
      }
LABEL_25:
      sub_1001EC4B4(qword_1008E8878, ptr, 1);
      uint64_t v8 = (void *)sub_1001EC43C(qword_1008E8878);
      ptr = v8;
      if (!v8) {
        goto LABEL_26;
      }
    }

    if (*a1 == *(void *)v9)
    {
      if (!*(_BYTE *)(v9 + 16)) {
        sub_1001A1ED4();
      }
      goto LABEL_25;
    }

    sub_1001EC444((uint64_t)&ptr);
  }

uint64_t (*sub_1001A1ED4())(void)
{
  int v0 = dword_1008E8868;
  if (dword_1008E8868 <= 0)
  {
    sub_1001EE2A0();
    int v0 = dword_1008E8868;
  }

  dword_1008E8868 = v0 - 1;
  uint64_t result = off_1008E8880;
  if (v0 == 1 && off_1008E8880 != 0LL) {
    return (uint64_t (*)(void))off_1008E8880();
  }
  return result;
}

void sub_1001A1F2C()
{
  qword_1008E8870 = 0LL;
  do
  {
    int v0 = (void *)sub_1001EC324(qword_1008E8878, 0);
    if (!v0) {
      break;
    }
    uint64_t v1 = v0;
    if (!*v0)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"LE_ATT_WriteCfm - Packet handle NULL", v2, v3, v4, v5, v6, v7, v8, v20);
        uint64_t v9 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
          sub_10065BAC0();
        }
      }
    }

    uint64_t v10 = sub_1001A2714((__int128 *)*v1, v1[1]);
    uint64_t v11 = v10;
    if ((_DWORD)v10 != 412)
    {
      if ((_DWORD)v10)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"LE_ATT_WriteCfm - Write Failed:%!", v12, v13, v14, v15, v16, v17, v18, v11);
          uint64_t v19 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
            sub_10065BAC0();
          }
        }
      }

      else
      {
        qword_1008E8870 = *v1;
      }
    }

    if (!*((_BYTE *)v1 + 16)) {
      sub_1001A1ED4();
    }
    sub_1001EF45C(v1[1]);
    sub_1000B1838(v1);
  }

  while ((_DWORD)v11);
  if (!qword_1008E8870) {
    sub_1001A6A8C();
  }
}

uint64_t sub_1001A20C0(uint64_t a1, uint64_t a2, __int16 a3)
{
  uint64_t v3 = a1;
  *(void *)a1 = a2;
  *(_WORD *)(a1 + 18) = a3;
  *(_WORD *)(a1 + 64) = 0;
  uint64_t v4 = sub_1001A642C(a2, a3);
  *(void *)(v3 + 72) = v4;
  if (!v4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to allocate ATT DB Session", v5, v6, v7, v8, v9, v10, v11, v14);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 0LL;
  }

  return v3;
}

_BYTE *sub_1001A2144(uint64_t a1, char a2)
{
  if (sub_1001A2248(a1))
  {
    sub_1001EE134((uint64_t)"Already have a session ATT", v4, v5, v6, v7, v8, v9, v10, v25);
    uint64_t v11 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      return 0LL;
    }
    goto LABEL_4;
  }

  uint64_t result = sub_1000B1814(0x68uLL);
  if (!result)
  {
    sub_1001EE134((uint64_t)"Failed to allocate the bearer", v17, v18, v19, v20, v21, v22, v23, v25);
    uint64_t v24 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      return 0LL;
    }
LABEL_4:
    sub_100657858();
    return 0LL;
  }

  result[66] = a2;
  int v13 = *(_DWORD *)a1;
  __int16 v14 = *(_WORD *)(a1 + 4);
  *((void *)result + 10) = 0LL;
  *((_WORD *)result + 6) = v14;
  *((_DWORD *)result + 2) = v13;
  uint64_t v15 = *((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    do
    {
      uint64_t v16 = v15;
      uint64_t v15 = *(void *)(v15 + 80);
    }

    while (v15);
    *((void *)result + 11) = v16;
    *(void *)(v16 + 80) = result;
  }

  else
  {
    *((void *)&xmmword_1008E8840 + 1) = result;
    *((void *)result + 10) = 0LL;
    *((void *)result + 11) = 0LL;
  }

  return result;
}

uint64_t sub_1001A2248(uint64_t a1)
{
  for (uint64_t result = *((void *)&xmmword_1008E8840 + 1); result; uint64_t result = *(void *)(result + 80))
  {
  }

  return result;
}

uint64_t sub_1001A2280(uint64_t a1, char a2)
{
  uint64_t v4 = (void *)*((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    while (*v4 != a1)
    {
      uint64_t v4 = (void *)v4[10];
      if (!v4) {
        goto LABEL_4;
      }
    }

    sub_1001EE134((uint64_t)"Already have a session ATT", v9, v10, v11, v12, v13, v14, v15, v26);
    uint64_t v16 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      return 0LL;
    }
LABEL_13:
    sub_100657858();
    return 0LL;
  }

void *sub_1001A23CC(uint64_t a1)
{
  uint64_t result = (void *)*((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    do
    {
      if (*result == a1) {
        break;
      }
      uint64_t result = (void *)result[10];
    }

    while (result);
  }

  return result;
}

uint64_t sub_1001A23F4(unsigned __int16 *a1)
{
  uint64_t v1 = (uint64_t *)*((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    return 149LL;
  }
  while ((unsigned __int16 *)*v1 != a1)
  {
    uint64_t v1 = (uint64_t *)v1[10];
    if (!v1) {
      return 149LL;
    }
  }

  if (v1[9])
  {
    sub_1001A6710(a1);
    a1 = (unsigned __int16 *)*v1;
  }

  if (!a1)
  {
    sub_1001EE2A0();
    a1 = (unsigned __int16 *)*v1;
  }

  sub_1001A1D3C(v1);
  return 0LL;
}

uint64_t sub_1001A246C(int a1)
{
  for (uint64_t result = *((void *)&xmmword_1008E8840 + 1); result; uint64_t result = *(void *)(result + 80))
  {
  }

  return result;
}

uint64_t sub_1001A2494(uint64_t a1)
{
  uint64_t v1 = 0LL;
  if (a1)
  {
    uint64_t v2 = *((void *)&xmmword_1008E8840 + 1);
    if (*((void *)&xmmword_1008E8840 + 1))
    {
      while (v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 80);
        if (!v2) {
          return 0LL;
        }
      }

      return *(unsigned __int16 *)(a1 + 18);
    }
  }

  return v1;
}

uint64_t sub_1001A24CC(uint64_t result, __int16 a2)
{
  if (result)
  {
    uint64_t v2 = *((void *)&xmmword_1008E8840 + 1);
    if (*((void *)&xmmword_1008E8840 + 1))
    {
      while (v2 != result)
      {
        uint64_t v2 = *(void *)(v2 + 80);
        if (!v2) {
          return result;
        }
      }

      *(_WORD *)(result + 18) = a2;
    }
  }

  return result;
}

uint64_t sub_1001A24F8(uint64_t a1)
{
  uint64_t v1 = 0LL;
  if (a1)
  {
    uint64_t v2 = *((void *)&xmmword_1008E8840 + 1);
    if (*((void *)&xmmword_1008E8840 + 1))
    {
      while (v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 80);
        if (!v2) {
          return 0LL;
        }
      }

      return *(void *)(a1 + 72);
    }
  }

  return v1;
}

uint64_t sub_1001A2530(__int128 *a1, uint64_t a2, char a3, BOOL *a4)
{
  if (!qword_1008E8870)
  {
    uint64_t v9 = sub_1001A2714(a1, a2);
    if ((_DWORD)v9 != 412)
    {
      uint64_t v8 = v9;
      if (!(_DWORD)v9)
      {
        qword_1008E8870 = (uint64_t)a1;
        if (!a4) {
          return v8;
        }
        goto LABEL_28;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Wrote ATT MBUF - Write Failed:%! reliable:%d _queuedNonReliablePackets:%d",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  v8);
        uint64_t v28 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
        {
          sub_100657F74();
          if (!a4) {
            return v8;
          }
          goto LABEL_28;
        }
      }

      goto LABEL_27;
    }

    if (qword_1008E8870) {
      sub_1001EE2A0();
    }
LABEL_26:
    uint64_t v8 = 0LL;
LABEL_27:
    if (!a4) {
      return v8;
    }
LABEL_28:
    *a4 = qword_1008E8870 == 0;
    return v8;
  }

  if ((a3 & 1) == 0 && dword_1008E8868 > 31)
  {
    uint64_t v8 = 4001LL;
    if (!a4) {
      return v8;
    }
    goto LABEL_28;
  }

  uint64_t v10 = sub_1000B17F4(0x18uLL);
  if (!v10)
  {
    uint64_t v8 = 106LL;
    if (!a4) {
      return v8;
    }
    goto LABEL_28;
  }

  uint64_t v11 = v10;
  void *v10 = a1;
  *((_BYTE *)v10 + 16) = a3;
  uint64_t v12 = sub_1001EF2D8(v10 + 1, a2, 0);
  if (!(_DWORD)v12)
  {
    sub_1001EC1DC(qword_1008E8878, (uint64_t)v11, 8LL);
    if ((a3 & 1) == 0)
    {
      uint64_t v8 = 0LL;
      ++dword_1008E8868;
      if (!a4) {
        return v8;
      }
      goto LABEL_28;
    }

    goto LABEL_26;
  }

  uint64_t v8 = v12;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Wrote ATT MBUF - OI_MBUF_Copy Failed:%!", v13, v14, v15, v16, v17, v18, v19, v8);
    uint64_t v20 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  sub_1000B1838(v11);
  if (a4) {
    goto LABEL_28;
  }
  return v8;
}

uint64_t sub_1001A2714(__int128 *a1, uint64_t a2)
{
  if (sub_10012D514((uint64_t)a1))
  {
    uint64_t v4 = *((void *)&xmmword_1008E8840 + 1);
    if (*((void *)&xmmword_1008E8840 + 1))
    {
      while (*(__int128 **)v4 != a1)
      {
        uint64_t v4 = *(void *)(v4 + 80);
        if (!v4) {
          goto LABEL_5;
        }
      }

      uint64_t v15 = *(unsigned __int16 *)(v4 + 16);
      if (!*(_WORD *)(v4 + 16)) {
        sub_1001EE2A0();
      }
      uint64_t v13 = v15;
      return sub_100172A98((uint64_t)sub_1001A54F8, v13, a1, a2, 1);
    }

uint64_t sub_1001A27F8(uint64_t a1, uint64_t a2, unsigned int a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  __int16 v7 = a3;
  if (a3 < 0x17) {
    return 101LL;
  }
  if (*(_WORD *)(a1 + 18) != 23) {
    return 146LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  *(_WORD *)(a1 + 40) = 3;
  uint64_t v8 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1))
  {
LABEL_12:
    uint64_t result = 142LL;
    goto LABEL_13;
  }

  while (v8 != a1)
  {
    uint64_t v8 = *(void *)(v8 + 80);
    if (!v8) {
      goto LABEL_12;
    }
  }

  uint64_t v9 = sub_1000B1814(3uLL);
  *(void *)(a1 + 48) = v9;
  if (!v9)
  {
    uint64_t result = 106LL;
    goto LABEL_13;
  }

  _BYTE *v9 = 2;
  *(_WORD *)(*(void *)(a1 + 48) + 1LL) = v7;
  uint64_t result = sub_1001A2950(a1);
  if ((_DWORD)result)
  {
LABEL_13:
    *(void *)uint64_t v5 = 0LL;
    *(void *)(v5 + 8) = 0LL;
    *(_WORD *)(v5 + 16) = 0;
    return result;
  }

  uint64_t v10 = sub_1001A589C(*(void *)a1);
  if (v10)
  {
    sub_1001A5DE4((uint64_t)v10, 1, 0LL);
    return 0LL;
  }

  uint64_t result = sub_1000A86F0();
  if ((_DWORD)result)
  {
    sub_1001EE134( (uint64_t)"Couldn't find server session for connection 0x%08x - can't change MTU!",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  *(void *)a1);
    uint64_t v18 = (os_log_s *)sub_100086554(0x44u);
    uint64_t result = os_log_type_enabled(v18, OS_LOG_TYPE_ERROR);
    if ((_DWORD)result)
    {
      sub_100657858();
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001A2950(uint64_t a1)
{
  uint64_t v24 = a1;
  if (!a1) {
    return 4002LL;
  }
  uint64_t v2 = *(__int128 **)a1;
  if (!v2) {
    return 0LL;
  }
  memset(v23, 0, sizeof(v23));
  if (*((_BYTE *)v2 + 2) != 4) {
    goto LABEL_7;
  }
  if (!sub_10012D5EC((uint64_t)v2))
  {
    sub_1001EE134((uint64_t)"Not valid LE connection handle", v5, v6, v7, v8, v9, v10, v11, (uint64_t)v22[0]);
    uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      return 4003LL;
    }
    goto LABEL_23;
  }

  uint64_t v2 = *(__int128 **)a1;
  if (*(void *)a1)
  {
LABEL_7:
    sub_1001EE134((uint64_t)"Not valid ACL connection handle", v13, v14, v15, v16, v17, v18, v19, (uint64_t)v22[0]);
    uint64_t v20 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
      return 4003LL;
    }
LABEL_23:
    sub_100657858();
    return 4003LL;
  }

uint64_t sub_1001A2AF8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  *(_WORD *)(a1 + 40) = 5;
  uint64_t v8 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    goto LABEL_13;
  }
  while (v8 != a1)
  {
    uint64_t v8 = *(void *)(v8 + 80);
    if (!v8) {
      goto LABEL_13;
    }
  }

  if (*(unsigned __int16 *)(a1 + 18) >= 5u)
  {
    uint64_t v11 = sub_1000B1814(5uLL);
    *(void *)(a1 + 48) = v11;
    if (v11)
    {
      memmove(v11, (const void *)a3, *(unsigned __int16 *)(a1 + 40));
      uint64_t v6 = sub_1001A2950(a1);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 106LL;
    }
  }

  else
  {
LABEL_13:
    uint64_t v6 = 142LL;
  }

  uint64_t v10 = *(void **)(a1 + 48);
  if (v10) {
    sub_1000B1838(v10);
  }
  *(void *)(a1 + 48) = 0LL;
  *(void *)uint64_t v5 = 0LL;
  *(void *)(v5 + 8) = 0LL;
  *(_WORD *)(v5 + 16) = 0;
  return v6;
}

uint64_t sub_1001A2BF4( uint64_t a1, uint64_t a2, __int16 a3, __int16 a4, unsigned int a5, const void *a6, unsigned int a7, uint64_t a8)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v9 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  __int16 v11 = a5;
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a8;
  *(_WORD *)(a1 + 40) = a7 + 7;
  uint64_t v16 = *((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    while (v16 != a1)
    {
      uint64_t v16 = *(void *)(v16 + 80);
      if (!v16) {
        goto LABEL_13;
      }
    }

    LODWORD(v16) = *(unsigned __int16 *)(a1 + 18);
  }

uint64_t sub_1001A2D24(uint64_t a1, uint64_t a2, int *a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  uint64_t v8 = (__int128 *)((char *)a3 + 5);
  size_t v9 = *((unsigned __int8 *)a3 + 5) + 5LL;
  *(_WORD *)(a1 + 40) = v9;
  uint64_t v10 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    goto LABEL_13;
  }
  while (v10 != a1)
  {
    uint64_t v10 = *(void *)(v10 + 80);
    if (!v10) {
      goto LABEL_13;
    }
  }

  if (*(unsigned __int16 *)(a1 + 18) >= v9)
  {
    uint64_t v13 = sub_1000B1814(v9);
    *(void *)(a1 + 48) = v13;
    if (v13)
    {
      int v14 = *a3;
      v13[4] = *((_BYTE *)a3 + 4);
      *(_DWORD *)uint64_t v13 = v14;
      __int128 v15 = *v8;
      int v16 = *(int *)((char *)a3 + 21);
      sub_1001BEF1C((_BYTE *)(*(void *)(a1 + 48) + 5LL), (unsigned __int8 *)&v15, 1);
      uint64_t v6 = sub_1001A2950(a1);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 106LL;
    }
  }

  else
  {
LABEL_13:
    uint64_t v6 = 142LL;
  }

  uint64_t v12 = *(void **)(a1 + 48);
  if (v12) {
    sub_1000B1838(v12);
  }
  *(void *)(a1 + 48) = 0LL;
  *(void *)uint64_t v5 = 0LL;
  *(void *)(v5 + 8) = 0LL;
  *(_WORD *)(v5 + 16) = 0;
  return v6;
}

uint64_t sub_1001A2E80(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  if (!*(_WORD *)(a3 + 1)) {
    return 101LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  *(_WORD *)(a1 + 40) = 3;
  uint64_t v8 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    goto LABEL_12;
  }
  while (v8 != a1)
  {
    uint64_t v8 = *(void *)(v8 + 80);
    if (!v8) {
      goto LABEL_12;
    }
  }

  if (*(unsigned __int16 *)(a1 + 18) >= 3u)
  {
    __int16 v11 = sub_1000B1814(3uLL);
    *(void *)(a1 + 48) = v11;
    if (v11)
    {
      memmove(v11, (const void *)a3, *(unsigned __int16 *)(a1 + 40));
      uint64_t v6 = sub_1001A2950(a1);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 106LL;
    }
  }

  else
  {
LABEL_12:
    uint64_t v6 = 142LL;
  }

  size_t v9 = *(void **)(a1 + 48);
  if (v9) {
    sub_1000B1838(v9);
  }
  *(void *)(a1 + 48) = 0LL;
  *(void *)uint64_t v5 = 0LL;
  *(void *)(v5 + 8) = 0LL;
  *(_WORD *)(v5 + 16) = 0;
  return v6;
}

uint64_t sub_1001A2F6C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  if (!*(_WORD *)(a3 + 1)) {
    return 101LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  *(_WORD *)(a1 + 40) = 5;
  uint64_t v8 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    goto LABEL_12;
  }
  while (v8 != a1)
  {
    uint64_t v8 = *(void *)(v8 + 80);
    if (!v8) {
      goto LABEL_12;
    }
  }

  if (*(unsigned __int16 *)(a1 + 18) >= 5u)
  {
    __int16 v11 = sub_1000B1814(5uLL);
    *(void *)(a1 + 48) = v11;
    if (v11)
    {
      memmove(v11, (const void *)a3, *(unsigned __int16 *)(a1 + 40));
      uint64_t v6 = sub_1001A2950(a1);
      if (!(_DWORD)v6) {
        return v6;
      }
    }

    else
    {
      uint64_t v6 = 106LL;
    }
  }

  else
  {
LABEL_12:
    uint64_t v6 = 142LL;
  }

  size_t v9 = *(void **)(a1 + 48);
  if (v9) {
    sub_1000B1838(v9);
  }
  *(void *)(a1 + 48) = 0LL;
  *(void *)uint64_t v5 = 0LL;
  *(void *)(v5 + 8) = 0LL;
  *(_WORD *)(v5 + 16) = 0;
  return v6;
}

uint64_t sub_1001A3058(uint64_t a1, uint64_t a2, __int16 *a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  *(_BYTE *)(a1 + 56) = a2 != 0;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  uint64_t v9 = *(unsigned __int16 *)((char *)a3 + 3);
  size_t v10 = v9 + 3;
  *(_WORD *)(a1 + 40) = v9 + 3;
  uint64_t v11 = *((void *)&xmmword_1008E8840 + 1);
  if (!*((void *)&xmmword_1008E8840 + 1)) {
    goto LABEL_13;
  }
  while (v11 != a1)
  {
    uint64_t v11 = *(void *)(v11 + 80);
    if (!v11) {
      goto LABEL_13;
    }
  }

  if (*(unsigned __int16 *)(a1 + 18) < v10)
  {
LABEL_13:
    uint64_t v6 = 142LL;
    goto LABEL_14;
  }

  int v14 = sub_1000B1814(v10);
  *(void *)(a1 + 48) = v14;
  if (!v14)
  {
    uint64_t v6 = 106LL;
    goto LABEL_14;
  }

  __int16 v15 = *a3;
  _DWORD v14[2] = *((_BYTE *)a3 + 2);
  *(_WORD *)int v14 = v15;
  memmove((void *)(*(void *)(a1 + 48) + 3LL), *(const void **)((char *)a3 + 5), *(unsigned __int16 *)((char *)a3 + 3));
  uint64_t v6 = sub_1001A2950(a1);
  if ((_DWORD)v6)
  {
LABEL_14:
    uint64_t v12 = *(void **)(a1 + 48);
    if (v12) {
      sub_1000B1838(v12);
    }
    *(void *)(a1 + 48) = 0LL;
    *(void *)uint64_t v5 = 0LL;
    *(void *)(v5 + 8) = 0LL;
    *(_WORD *)(v5 + 16) = 0;
    return v6;
  }

  if (a2) {
    return 0LL;
  }
  if (!dword_1008E8868 && off_1008E8880) {
    off_1008E8880();
  }
  sub_1000B1838(*(void **)(a1 + 48));
  uint64_t v6 = 0LL;
  *(void *)(a1 + 48) = 0LL;
  return v6;
}

uint64_t sub_1001A31A8(uint64_t a1, uint64_t a2, int *a3, uint64_t a4)
{
  if (!a1)
  {
    sub_1001EE2A0();
    return 101LL;
  }

  uint64_t v5 = a1 + 24;
  if (*(void *)(a1 + 24)) {
    return 118LL;
  }
  *(_BYTE *)(a1 + 56) = 1;
  *(void *)(a1 + 24) = a2;
  *(void *)(a1 + 32) = a4;
  unsigned __int16 v8 = *(_WORD *)((char *)a3 + 5) + 5;
  *(_WORD *)(a1 + 40) = v8;
  uint64_t v9 = *((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    while (v9 != a1)
    {
      uint64_t v9 = *(void *)(v9 + 80);
      if (!v9) {
        goto LABEL_12;
      }
    }

    LODWORD(v9) = *(unsigned __int16 *)(a1 + 18);
  }

uint64_t sub_1001A32B0(uint64_t a1, uint64_t a2, char a3, uint64_t a4)
{
  if (a1)
  {
    uint64_t v5 = a1 + 24;
    if (!*(void *)(a1 + 24))
    {
      *(_BYTE *)(a1 + 56) = 1;
      *(void *)(a1 + 24) = a2;
      *(void *)(a1 + 32) = a4;
      *(_WORD *)(a1 + 40) = 2;
      unsigned __int16 v8 = sub_1000B1814(2uLL);
      *(void *)(a1 + 48) = v8;
      if (v8)
      {
        *unsigned __int16 v8 = 24;
        *(_BYTE *)(*(void *)(a1 + 48) + 1LL) = a3;
        uint64_t v6 = sub_1001A2950(a1);
        if (!(_DWORD)v6) {
          return v6;
        }
        uint64_t v9 = *(void **)(a1 + 48);
        if (v9) {
          sub_1000B1838(v9);
        }
        *(void *)(a1 + 48) = 0LL;
        *(void *)uint64_t v5 = 0LL;
        *(void *)(v5 + 8) = 0LL;
      }

      else
      {
        *(void *)uint64_t v5 = 0LL;
        *(void *)(v5 + 8) = 0LL;
        uint64_t v6 = 106LL;
      }

      *(_WORD *)(v5 + 16) = 0;
      return v6;
    }

    return 118LL;
  }

  else
  {
    sub_1001EE2A0();
    return 101LL;
  }

void sub_1001A3368(uint64_t a1, unsigned __int8 *a2, unsigned int a3, uint64_t a4)
{
  if (!a1) {
    goto LABEL_15;
  }
  int v8 = *(unsigned __int8 *)(a1 + 2);
  if (v8 == 4)
  {
    if (!sub_10012D5EC(a1)) {
      goto LABEL_15;
    }
    int v8 = *(unsigned __int8 *)(a1 + 2);
  }

  if (!v8 && !sub_10012D514(a1))
  {
LABEL_15:
    sub_1001EE134((uint64_t)"ATT error : not transport handle", v11, v12, v13, v14, v15, v16, v17, v314);
    uint64_t v18 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_149:
    sub_100657858();
    return;
  }

  if (!a2 || !a3)
  {
    sub_1001EE134((uint64_t)"Invalid packet size.", v19, v20, v21, v22, v23, v24, v25, v314);
    uint64_t v26 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_149;
  }

  if (sub_1001A589C(a1))
  {
    uint64_t v9 = *a2;
    switch(*a2)
    {
      case 1u:
      case 3u:
      case 5u:
      case 7u:
      case 9u:
      case 0xBu:
      case 0xDu:
      case 0xFu:
      case 0x11u:
      case 0x13u:
      case 0x17u:
      case 0x19u:
        uint64_t v10 = *((void *)&xmmword_1008E8840 + 1);
        if (!*((void *)&xmmword_1008E8840 + 1)) {
          return;
        }
        break;
      case 2u:
      case 4u:
      case 6u:
      case 8u:
      case 0xAu:
      case 0xCu:
      case 0xEu:
      case 0x10u:
      case 0x12u:
      case 0x16u:
      case 0x18u:
        goto LABEL_29;
      case 0x14u:
      case 0x15u:
      case 0x1Au:
      case 0x1Cu:
        goto LABEL_30;
      case 0x1Bu:
        if (off_1008E8858) {
          off_1008E8858(a1, *(unsigned __int16 *)(a2 + 1), a2 + 3, (unsigned __int16)(a3 - 3), a4, qword_1008E8860);
        }
        return;
      case 0x1Du:
        sub_1001A4540((__int128 *)a1, (unsigned __int16 *)(a2 + 1), (unsigned __int16)(a3 - 1), a4);
        return;
      case 0x1Eu:
        sub_1001A6ED4(a1);
        return;
      default:
        if ((_DWORD)v9 == 82 || (_DWORD)v9 == 210)
        {
LABEL_29:
          sub_1001A6F40((__int128 *)a1, (char *)a2, a3, a4);
        }

        else
        {
LABEL_30:
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Received unknown opcode 0x%x", v35, v36, v37, v38, v39, v40, v41, v9);
            uint64_t v42 = (os_log_s *)sub_100086554(0x44u);
            if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          sub_1001A4604(a1, v9);
        }

        return;
    }

    while (*(void *)v10 != a1)
    {
      uint64_t v10 = *(void *)(v10 + 80);
      if (!v10) {
        return;
      }
    }

    switch(*a2)
    {
      case 1u:
        sub_1001A49E0(v10, a2 + 1, (unsigned __int16)(a3 - 1));
        return;
      case 3u:
        uint64_t v51 = *(_BYTE **)(v10 + 48);
        if (v51 && *v51 == 2)
        {
          unsigned __int16 v52 = a3 - 1;
          uint64_t v53 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v10 + 24);
          int v54 = v51[1];
          int v55 = v51[2];
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if (v52 != 2)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"Invalid MTU payload size %d.", v232, v233, v234, v235, v236, v237, v238, v52);
              uint64_t v239 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v239, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v240 = *(void *)(v10 + 32);
            uint64_t v241 = v10;
            uint64_t v242 = 4005LL;
            uint64_t v243 = 0LL;
            goto LABEL_194;
          }

          unsigned int v56 = *(unsigned __int16 *)(a2 + 1);
          if (v56 <= 0x17) {
            unsigned int v56 = 23;
          }
          else {
            int v57 = v54 | (v55 << 8);
          }
          LOWORD(v319) = v57;
          int v58 = *(unsigned __int16 *)(v10 + 18);
          if (v58 != 23 && v57 != v58)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"The negotiated MTU is different from a previously negotiated one: %u != %u",  v59,  v60,  v61,  v62,  v63,  v64,  v65,  *(unsigned __int16 *)(v10 + 18));
              uint64_t v66 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }
          }

          uint64_t v67 = *((void *)&xmmword_1008E8840 + 1);
          if (*((void *)&xmmword_1008E8840 + 1))
          {
            while (v67 != v10)
            {
              uint64_t v67 = *(void *)(v67 + 80);
              if (!v67) {
                goto LABEL_187;
              }
            }

            *(_WORD *)(v10 + 18) = v57;
          }

LABEL_187:
          uint64_t v284 = sub_1001A589C(*(void *)v10);
          if (v284)
          {
            sub_1001A5DE4((uint64_t)v284, 0, &v319);
            if (!v53) {
              return;
            }
            goto LABEL_193;
          }

          if (!sub_1000A86F0()
            || (sub_1001EE134( (uint64_t)"Couldn't find server session for connection 0x%08x - can't change MTU!",  v285,  v286,  v287,  v288,  v289,  v290,  v291,  *(void *)v10),  int v292 = (os_log_s *)sub_100086554(0x44u),  !os_log_type_enabled(v292, OS_LOG_TYPE_ERROR)))
          {
            if (!v53) {
              return;
            }
            goto LABEL_193;
          }

          sub_100657858();
          if (v53)
          {
LABEL_193:
            uint64_t v243 = (unsigned __int16)v319;
            uint64_t v240 = *(void *)(v10 + 32);
            uint64_t v241 = v10;
            uint64_t v242 = 0LL;
LABEL_194:
            v53(v241, v242, v243, v240);
            return;
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No MTU request matching this response. Ignoring.",  v160,  v161,  v162,  v163,  v164,  v165,  v166,  v314);
          uint64_t v167 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v167, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 5u:
        uint64_t v68 = *(_BYTE **)(v10 + 48);
        if (v68 && *v68 == 4)
        {
          unsigned __int16 v69 = a3 - 1;
          uint64_t v70 = *(void (**)(uint64_t, uint64_t, void *, void, uint64_t))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          uint64_t v71 = v69;
          if (v69 <= 4u)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid find information payload size %d.",  v72,  v73,  v74,  v75,  v76,  v77,  v78,  v69);
              uint64_t v79 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v79, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v80 = *(void *)(v10 + 32);
            uint64_t v81 = v10;
            uint64_t v82 = 4006LL;
LABEL_163:
            v70(v81, v82, 0LL, 0LL, v80);
            return;
          }

          v244 = a2 + 1;
          int v245 = a2[1];
          if (v245 == 1) {
            uint64_t v246 = 2LL;
          }
          else {
            uint64_t v246 = 16 * (v245 == 2);
          }
          if (!(_DWORD)v246 || ((int)v71 - 1) % (v246 + 2))
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid find information payload size %d (uuidSize == %u).",  v247,  v248,  v249,  v250,  v251,  v252,  v253,  v71);
              unsigned __int16 v254 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v254, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v80 = *(void *)(v10 + 32);
            uint64_t v81 = v10;
            uint64_t v82 = 4007LL;
            goto LABEL_163;
          }

          uint64_t v293 = (unsigned __int16)(((int)v71 - 1) / (v246 + 2));
          unsigned __int16 v318 = ((int)v71 - 1) / (v246 + 2);
          uint64_t v294 = (char *)sub_1000B17F4(24 * v318);
          uint64_t v295 = v294;
          if (v294)
          {
            if ((_DWORD)v293)
            {
              int v296 = 0;
              uint64_t v297 = a2 + 3;
              uint64_t v298 = v294;
              do
              {
                uint64_t v299 = (unsigned __int16)v296 & 0xFFFE | 1LL;
                __int16 v300 = v244[(v296 & 0xFFFE) + 2];
                *(_WORD *)uint64_t v298 = v300 << 8;
                *(_WORD *)uint64_t v298 = v244[v299] | (unsigned __int16)(v300 << 8);
                sub_1001BEE18((int8x16_t *)&v297[v299], v246, 1, (uint64_t)&v319);
                __int128 v301 = v319;
                *((_DWORD *)v298 + 5) = v320;
                *(_OWORD *)(v298 + 4) = v301;
                v298 += 24;
                v296 += v246 + 2;
                --v293;
              }

              while (v293);
            }
          }

          else
          {
            unsigned __int16 v318 = 0;
          }

          if (v70) {
            v70(v10, 0LL, v295, v318, *(void *)(v10 + 32));
          }
          sub_1000B1838(v295);
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No Find information request matching this response. Ignoring.",  v168,  v169,  v170,  v171,  v172,  v173,  v174,  v314);
          uint64_t v175 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v175, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 7u:
        uint64_t v83 = *(_BYTE **)(v10 + 48);
        if (v83 && *v83 == 6)
        {
          unsigned __int16 v84 = a3 - 1;
          unsigned __int16 v315 = *(void (**)(uint64_t, uint64_t, unsigned __int8 *, void, void))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if (v84 < 4u || (v84 & 3) != 0)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid find by type value payload size %d.",  v255,  v256,  v257,  v258,  v259,  v260,  v261,  v84);
              unsigned __int16 v262 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v262, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            v315(v10, 4022LL, 0LL, 0LL, *(void *)(v10 + 32));
          }

          else
          {
            v315(v10, 0LL, a2 + 1, v84 >> 2, *(void *)(v10 + 32));
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No Find by type value request matching this response. Ignoring.",  v176,  v177,  v178,  v179,  v180,  v181,  v182,  v314);
          uint64_t v183 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v183, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 9u:
        uint64_t v85 = *(_BYTE **)(v10 + 48);
        if (v85 && *v85 == 8)
        {
          uint64_t v86 = *(void (**)(uint64_t, uint64_t, void *, void, uint64_t, uint64_t))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          uint64_t v87 = (unsigned __int16)(a3 - 1);
          if (v87 <= 2)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"Invalid read by type payload size %d.", v88, v89, v90, v91, v92, v93, v94, v87);
              uint64_t v95 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v95, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v96 = *(void *)(v10 + 32);
            uint64_t v97 = v10;
            uint64_t v98 = 4008LL;
            goto LABEL_180;
          }

          uint64_t v263 = a2 + 1;
          uint64_t v264 = a2[1];
          if (v264 < 2
            || (unsigned int v265 = ((int)v87 - 1) / v264, ((int)v87 - 1) % v264))
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid read by type payload size %d.",  v266,  v267,  v268,  v269,  v270,  v271,  v272,  v87);
              unint64_t v273 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v273, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v96 = *(void *)(v10 + 32);
            uint64_t v97 = v10;
            uint64_t v98 = 4009LL;
            goto LABEL_180;
          }

          uint64_t v302 = sub_1000B17F4(16 * (unsigned __int16)(((int)v87 - 1) / v264));
          unsigned __int16 v303 = v302;
          if (!v302) {
            goto LABEL_210;
          }
          if ((_WORD)v265)
          {
            uint64_t v304 = 0LL;
            int v305 = v302;
            do
            {
              int v306 = &v263[(unsigned __int16)(v304 * v264 + 1)];
              __int16 v307 = v306[1];
              *(_WORD *)int v305 = v307 << 8;
              *(_WORD *)int v305 = *v306 | (unsigned __int16)(v307 << 8);
              v305[1] = v306 + 2;
              ++v304;
              v305 += 2;
            }

            while ((unsigned __int16)v265 != v304);
          }

          goto LABEL_211;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read by type request matching this response. Ignoring.",  v184,  v185,  v186,  v187,  v188,  v189,  v190,  v314);
          uint64_t v191 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v191, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0xBu:
        uint64_t v99 = *(_BYTE **)(v10 + 48);
        if (v99 && *v99 == 10) {
          goto LABEL_89;
        }
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read request matching this response. Ignoring.",  v100,  v101,  v102,  v103,  v104,  v105,  v106,  v314);
          uint64_t v107 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v107, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0xDu:
        uint64_t v108 = *(_BYTE **)(v10 + 48);
        if (v108 && *v108 == 12) {
          goto LABEL_89;
        }
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v109,  v110,  v111,  v112,  v113,  v114,  v115,  v314);
          uint64_t v116 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v116, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0xFu:
        uint64_t v117 = *(_BYTE **)(v10 + 48);
        if (v117 && *v117 == 14)
        {
LABEL_89:
          uint64_t v316 = *(void (**)(uint64_t, void, unsigned __int8 *, void, void))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if (v316) {
            v316(v10, 0LL, a2 + 1, (unsigned __int16)(a3 - 1), *(void *)(v10 + 32));
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v192,  v193,  v194,  v195,  v196,  v197,  v198,  v314);
          uint64_t v199 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v199, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0x11u:
        uint64_t v118 = *(_BYTE **)(v10 + 48);
        if (v118 && *v118 == 16)
        {
          uint64_t v86 = *(void (**)(uint64_t, uint64_t, void *, void, uint64_t, uint64_t))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          uint64_t v119 = (unsigned __int16)(a3 - 1);
          if (v119 <= 4)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid read by group type payload size %d.",  v120,  v121,  v122,  v123,  v124,  v125,  v126,  v119);
              uint64_t v127 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v127, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v96 = *(void *)(v10 + 32);
            uint64_t v97 = v10;
            uint64_t v98 = 4010LL;
LABEL_180:
            v86(v97, v98, 0LL, 0LL, 0LL, v96);
            return;
          }

          BOOL v274 = a2 + 1;
          uint64_t v264 = a2[1];
          if (v264 < 4
            || (unsigned int v265 = ((int)v119 - 1) / v264, ((int)v119 - 1) % v264))
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid read by group type payload size %d.",  v275,  v276,  v277,  v278,  v279,  v280,  v281,  v119);
              uint64_t v282 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v282, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v96 = *(void *)(v10 + 32);
            uint64_t v97 = v10;
            uint64_t v98 = 4011LL;
            goto LABEL_180;
          }

          int v308 = sub_1000B17F4(16 * (unsigned __int16)(((int)v119 - 1) / v264));
          unsigned __int16 v303 = v308;
          if (v308)
          {
            if ((_WORD)v265)
            {
              uint64_t v309 = 0LL;
              unsigned int v310 = v308;
              do
              {
                unsigned int v311 = &v274[(unsigned __int16)(v309 * v264 + 1)];
                __int16 v312 = v311[1];
                *unsigned int v310 = v312 << 8;
                *unsigned int v310 = *v311 | (unsigned __int16)(v312 << 8);
                __int16 v313 = v311[3];
                v310[1] = v313 << 8;
                v310[1] = v311[2] | (unsigned __int16)(v313 << 8);
                *((void *)v310 + 1) = v311 + 4;
                ++v309;
                v310 += 8;
              }

              while ((unsigned __int16)v265 != v309);
            }
          }

          else
          {
LABEL_210:
            uint64_t v264 = 0LL;
            LOWORD(v265) = 0;
          }

        dispatch_once(&qword_1008D61A8, &stru_10088BCE0);
        goto LABEL_103;
      }

      if (qword_1008D67C8 != -1) {
        dispatch_once(&qword_1008D67C8, &stru_10088BCA0);
      }
      uint64_t v60 = sub_10027BC04((uint64_t)off_1008D67C0, v25, a8);
      uint64_t v61 = v60;
      if (!v60)
      {
        if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_ERROR)) {
          sub_1006659A4();
        }
        (*(void (**)(uint64_t, uint64_t, id))(*(void *)v98 + 8LL))(v98, v25, v19);
        if (qword_1008D61A8 == -1) {
          goto LABEL_103;
        }
        goto LABEL_187;
      }

      *(void *)(v60 + 120) = a3;
      uint64_t v62 = (void **)(v60 + 88);
      objc_storeStrong((id *)(v60 + 88), obj);
      if (qword_1008D92A8 != -1) {
        dispatch_once(&qword_1008D92A8, &stru_10088BD00);
      }
      *(_BYTE *)(v61 + 128) = sub_10064D244(qword_1008D92A0, v19);
      uint64_t v63 = (void **)(v61 + 96);
      objc_storeStrong((id *)(v61 + 96), a9);
      if (!*(_BYTE *)(v100 + 409))
      {
        if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_ERROR)) {
          sub_1006659FC();
        }
        uint64_t v64 = *v63;
        *uint64_t v63 = 0LL;
      }

      if (*v63) {
        *(_BYTE *)(v100 + 178) = 1;
      }
      *(_BYTE *)(v61 + 28) = (*(unsigned int (**)(uint64_t, uint64_t))(*(void *)v98 + 56LL))(v98, v25) != 32;
      *(_BYTE *)(v61 + 27) = BYTE2(v104);
      *(_WORD *)(v61 + 36) = *(_WORD *)((char *)&v104 + 3);
      *(_BYTE *)(v61 + 184) = BYTE6(v104);
      *(_BYTE *)(v61 + 25) = v105;
      *(_BYTE *)(v61 + 26) = 0;
      uint64_t v65 = (void **)(v61 + 104);
      objc_storeStrong((id *)(v61 + 104), a2);
      *(_BYTE *)(v61 + 73) = 0;
      if ((*(unsigned int (**)(uint64_t))(*(void *)v61 + 16LL))(v61) == 1)
      {
        if (_os_feature_enabled_impl("FindMy", "BA_Power_Off"))
        {
          *(_BYTE *)(v61 + 264) = HIBYTE(v104);
        }

        else if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_ERROR))
        {
          sub_1006659D0();
        }
      }

      if (!a8) {
        *(_BYTE *)(v61 + 350) = HIBYTE(v106);
      }
      uint64_t v75 = (void *)objc_claimAutoreleasedReturnValue(+[NSString stringWithUTF8String:](&OBJC_CLASS___NSString, "stringWithUTF8String:"));
      sub_10027B2AC((uint64_t)v75, v61, v76, v75, BYTE5(v104));
      uint64_t v77 = (os_log_s *)qword_1008F7628;
      if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
      {
        sub_100494958(v25, (uint64_t)v113);
        uint64_t v78 = v116 >= 0 ? v113 : *(_BYTE **)v113;
        uint64_t v79 = *(unsigned __int8 *)(v100 + 179);
        *(_DWORD *)__int128 buf = 136447234;
        *(void *)&uint8_t buf[4] = v78;
        *(_WORD *)&_BYTE buf[12] = 1024;
        *(_DWORD *)&buf[14] = BYTE3(v104);
        *(_WORD *)&buf[18] = 1024;
        *(_DWORD *)&buf[20] = BYTE4(v104);
        *(_WORD *)&buf[24] = 1024;
        *(_DWORD *)&buf[26] = v79;
        *(_WORD *)&buf[30] = 1024;
        *(_DWORD *)uint64_t v108 = BYTE6(v104);
        _os_log_impl( (void *)&_mh_execute_header,  v77,  OS_LOG_TYPE_DEFAULT,  "Session %{public}s : needsRestrictedStateOperation = %d, overrideRestrictedState = %d , denylistMode = %d, receivesControllerBTClockEvents=%d ",  buf,  0x24u);
        if (v116 < 0) {
          operator delete(*(void **)v113);
        }
      }

      if (!(BYTE1(v105) | HIBYTE(v105)))
      {
        if (BYTE3(v104))
        {
          if (qword_1008D6788 != -1) {
            dispatch_once(&qword_1008D6788, &stru_10088BAC0);
          }
          uint64_t v80 = sub_1002075B4((uint64_t)off_1008D6780);
          if (v80 == 1)
          {
            *a11 = *(_BYTE *)(v100 + 179);
LABEL_175:
            *a10 = v80;
            uint64_t v85 = sub_1002E6E00();
            sub_10002418C(buf, "Sentinel");
            sub_10002418C(v113, "LEConnection");
            uint64_t v86 = (unsigned __int8 *)(v61 + 44);
            uint64_t v87 = (*(uint64_t (**)(uint64_t, _BYTE *, _BYTE *, unsigned __int8 *))(*(void *)v85 + 72LL))( v85,  buf,  v113,  v86);
            if (v116 < 0) {
              operator delete(*(void **)v113);
            }
            if ((buf[23] & 0x80000000) != 0) {
              operator delete(*(void **)buf);
            }
            if (v87)
            {
              uint64_t v88 = (os_log_s *)qword_1008F7628;
              if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
              {
                uint64_t v89 = *v86;
                *(_DWORD *)__int128 buf = 67109120;
                *(_DWORD *)&uint8_t buf[4] = v89;
                _os_log_impl( (void *)&_mh_execute_header,  v88,  OS_LOG_TYPE_DEFAULT,  "Sentinel LE Connection Enabled Override %d",  buf,  8u);
              }
            }

            uint64_t v90 = (void *)[*(id *)(v100 + 320) objectForKeyedSubscript:*v62];
            uint64_t v91 = v90;

            goto LABEL_105;
          }
        }

        if (BYTE4(v104) || !*(_BYTE *)(v100 + 179))
        {
          if (qword_1008D6788 != -1) {
            dispatch_once(&qword_1008D6788, &stru_10088BAC0);
          }
          uint64_t v80 = sub_1002075B4((uint64_t)off_1008D6780);
          goto LABEL_175;
        }
      }

      uint64_t v80 = 0;
      goto LABEL_175;
    }

    if (qword_1008D6788 != -1) {
      dispatch_once(&qword_1008D6788, &stru_10088BAC0);
    }
    uint64_t v40 = sub_1002075B4((uint64_t)off_1008D6780);
    if (v40)
    {
      if (!*(_BYTE *)(v100 + 179)) {
        goto LABEL_75;
      }
      uint64_t v41 = (os_log_s *)qword_1008F7628;
      if (!os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT)) {
        goto LABEL_74;
      }
      sub_100494958(v25, (uint64_t)buf);
      if (buf[23] >= 0) {
        uint64_t v42 = buf;
      }
      else {
        uint64_t v42 = *(_BYTE **)buf;
      }
      *(_DWORD *)uint64_t v113 = 136446210;
      *(void *)&v113[4] = v42;
      uint64_t v43 = "Bluetooth is in denylist mode - show LE_DENYLIST_ENABLED alert for %{public}s";
    }

    else
    {
      uint64_t v41 = (os_log_s *)qword_1008F7628;
      if (!os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_DEFAULT))
      {
LABEL_74:
        (*(void (**)(uint64_t, uint64_t, BOOL))(*(void *)v98 + 24LL))(v98, v25, v40 != 0);
        goto LABEL_75;
      }

      sub_100494958(v25, (uint64_t)buf);
      if (buf[23] >= 0) {
        uint64_t v46 = buf;
      }
      else {
        uint64_t v46 = *(_BYTE **)buf;
      }
      *(_DWORD *)uint64_t v113 = 136446210;
      *(void *)&v113[4] = v46;
      uint64_t v43 = "Bluetooth is powered off - notifying session %{public}s";
    }

    _os_log_impl((void *)&_mh_execute_header, v41, OS_LOG_TYPE_DEFAULT, v43, v113, 0xCu);
    if ((buf[23] & 0x80000000) != 0) {
      operator delete(*(void **)buf);
    }
    goto LABEL_74;
  }

  *(void *)&uint64_t v21 = 136446466LL;
  uint64_t v92 = v21;
  while (1)
  {
    uint64_t v25 = v22[4];
    uint64_t v24 = v22[5];
    if (*(void *)(v24 + 120) == a3)
    {
      uint64_t v26 = (os_log_s *)qword_1008F7628;
      if (os_log_type_enabled((os_log_t)qword_1008F7628, OS_LOG_TYPE_FAULT))
      {
        sub_100494958(v25, (uint64_t)buf);
        uint64_t v31 = buf;
        if (buf[23] < 0) {
          uint64_t v31 = *(_BYTE **)buf;
        }
        *(_DWORD *)uint64_t v113 = v92;
        *(void *)&v113[4] = v31;
        uint64_t v114 = 2114;
        uint64_t v115 = v19;
        _os_log_fault_impl( (void *)&_mh_execute_header,  v26,  OS_LOG_TYPE_FAULT,  "Duplicate check-in message from session %{public}s in application %{public}@",  v113,  0x16u);
        if ((buf[23] & 0x80000000) != 0) {
          operator delete(*(void **)buf);
        }
      }
    }

    if (objc_msgSend(*(id *)(v24 + 88), "isEqualToString:", v19, v92))
    {
      if (!*(void *)(v24 + 120) && *(void *)(v24 + 96))
      {
        uint64_t v27 = (os_log_s *)qword_1008F7680;
        if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v28 = *(void *)(v24 + 88);
          *(_DWORD *)__int128 buf = 138543362;
          *(void *)&uint8_t buf[4] = v28;
          _os_log_impl( (void *)&_mh_execute_header,  v27,  OS_LOG_TYPE_DEFAULT,  "Starting timer for a dead session to clean up leaked prior session for %{public}@",  buf,  0xCu);
        }

        sub_10027B07C(v100, *(void **)(v24 + 88), 15);
      }

      if ([*(id *)(v24 + 96) isEqualToString:v20]
        && (*(unsigned int (**)(uint64_t))(*(void *)v24 + 16LL))(v24) == a8)
      {
        break;
      }
    }

    uint64_t v29 = (void *)v22[1];
    if (v29)
    {
      do
      {
        uint64_t v30 = v29;
        uint64_t v29 = (void *)*v29;
      }

      while (v29);
    }

    else
    {
      do
      {
        uint64_t v30 = (void *)v22[2];
        uint64_t v37 = *v30 == (void)v22;
        uint64_t v22 = v30;
      }

      while (!v37);
    }

    uint64_t v22 = v30;
    if (v30 == v23) {
      goto LABEL_24;
    }
  }

  uint64_t v44 = (os_log_s *)qword_1008F7680;
  if (*(void *)(v24 + 120))
  {
    if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_ERROR))
    {
      sub_100494958(v25, (uint64_t)v113);
      uint64_t v45 = v116 >= 0 ? v113 : *(_BYTE **)v113;
      *(_DWORD *)__int128 buf = 138543874;
      *(void *)&uint8_t buf[4] = v20;
      *(_WORD *)&_BYTE buf[12] = 2082;
      *(void *)&buf[14] = v45;
      *(_WORD *)&buf[22] = 2114;
      *(void *)&buf[24] = v19;
      _os_log_error_impl( (void *)&_mh_execute_header,  v44,  OS_LOG_TYPE_ERROR,  "Duplicate restore identifier %{public}@ from session %{public}s in application %{public}@",  buf,  0x20u);
      if (v116 < 0) {
        operator delete(*(void **)v113);
      }
    }

    goto LABEL_104;
  }

  if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_DEFAULT))
  {
    sub_100494958(v25, (uint64_t)v113);
    uint64_t v66 = v116 >= 0 ? v113 : *(_BYTE **)v113;
    *(_DWORD *)__int128 buf = 67109634;
    *(_DWORD *)&uint8_t buf[4] = a8;
    *(_WORD *)&buf[8] = 2082;
    *(void *)&buf[10] = v66;
    *(_WORD *)&buf[18] = 2114;
    *(void *)&buf[20] = v19;
    _os_log_impl( (void *)&_mh_execute_header,  v44,  OS_LOG_TYPE_DEFAULT,  "Restoring zombie'd session type %d %{public}s for application %{public}@",  buf,  0x1Cu);
    if (v116 < 0) {
      operator delete(*(void **)v113);
    }
  }

  *(void *)(v24 + 120) = a3;
  uint64_t v67 = a7;
  sub_100494C98(v25, a7);
  uint64_t v68 = (void *)objc_claimAutoreleasedReturnValue(+[NSString stringWithUTF8String:](&OBJC_CLASS___NSString, "stringWithUTF8String:", v67));
  sub_10027B2AC((uint64_t)v68, v24, v69, v68, BYTE5(v104));
  uint64_t v70 = (void *)[*(id *)(v100 + 304) objectForKey:v19];
  if (v70)
  {
    uint64_t v71 = (os_log_s *)qword_1008F7680;
    if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_DEFAULT))
    {
      sub_100494958(v25, (uint64_t)v113);
      uint64_t v72 = v116 >= 0 ? v113 : *(_BYTE **)v113;
      *(_DWORD *)__int128 buf = 138543874;
      *(void *)&uint8_t buf[4] = v20;
      *(_WORD *)&_BYTE buf[12] = 2082;
      *(void *)&buf[14] = v72;
      *(_WORD *)&buf[22] = 2114;
      *(void *)&buf[24] = v19;
      _os_log_impl( (void *)&_mh_execute_header,  v71,  OS_LOG_TYPE_DEFAULT,  "Restore identifier %{public}@ from session %{public}s in application %{public}@ found, canceling resurrectionTimer",  buf,  0x20u);
      if (v116 < 0) {
        operator delete(*(void **)v113);
      }
    }

    dispatch_block_cancel(v70);
    [*(id *)(v100 + 304) removeObjectForKey:v19];
    [*(id *)(v100 + 296) removeObject:v19];
  }

  (*(void (**)(uint64_t, uint64_t))(*(void *)v100 + 16LL))(v100, v25);
  uint64_t v73 = (os_log_s *)qword_1008F7680;
  if (os_log_type_enabled((os_log_t)qword_1008F7680, OS_LOG_TYPE_DEFAULT))
  {
    *(_WORD *)__int128 buf = 0;
    _os_log_impl( (void *)&_mh_execute_header,  v73,  OS_LOG_TYPE_DEFAULT,  "Ignore needsRestrictedStateOperation since restorable sessions are always apps",  buf,  2u);
  }

  if (*(_BYTE *)(v100 + 179))
  {
    uint64_t v74 = 0;
  }

  else
  {
    if (qword_1008D6788 != -1) {
      dispatch_once(&qword_1008D6788, &stru_10088BAC0);
    }
    uint64_t v74 = sub_1002075B4((uint64_t)off_1008D6780);
  }

  *a10 = v74;
  uint64_t v81 = sub_1002E6BF0();
  uint64_t v82 = (*(uint64_t (**)(uint64_t))(*(void *)v81 + 384LL))(v81);
  if (*a10) {
    uint64_t v83 = v82;
  }
  else {
    uint64_t v83 = 0;
  }
  if (v83 == 1)
  {
    unsigned __int16 v84 = sub_100404FE8();
    v103[0] = _NSConcreteStackBlock;
    v103[1] = 3221225472LL;
    v103[2] = sub_10027B3C0;
    v103[3] = &unk_100888050;
    v103[4] = v100;
    v103[5] = v25;
    v103[6] = v24;
    sub_100405384(v84, v103);
  }

LABEL_105:
  return v25;
}

              uint64_t v85 = "], ";
              uint64_t v86 = 3LL;
              goto LABEL_191;
            }

            if ((_DWORD)v66 == 4)
            {
              uint64_t v76 = v175;
              uint64_t v77 = v176 - (_BYTE *)v175;
              if (v176 == v175)
              {
                uint64_t v85 = "no extended UUIDs, ";
                uint64_t v86 = 19LL;
              }

              else
              {
                sub_1001FD17C(&buf[16], (uint64_t)"extended UUID(s) [ ", 19LL);
                uint64_t v78 = 0LL;
                uint64_t v79 = 0xCCCCCCCCCCCCCCCDLL * (v77 >> 2);
                uint64_t v80 = 1;
                do
                {
                  sub_1006344B4((uint64_t)v76 + 20 * v78, &__p);
                  if ((__p.__r_.__value_.__s.__size_ & 0x80u) == 0) {
                    uint64_t v81 = &__p;
                  }
                  else {
                    uint64_t v81 = (std::stringbuf::string_type *)__p.__r_.__value_.__r.__words[0];
                  }
                  if ((__p.__r_.__value_.__s.__size_ & 0x80u) == 0) {
                    uint64_t v82 = __p.__r_.__value_.__s.__size_;
                  }
                  else {
                    uint64_t v82 = __p.__r_.__value_.__l.__size_;
                  }
                  uint64_t v83 = sub_1001FD17C(&buf[16], (uint64_t)v81, v82);
                  sub_1001FD17C(v83, (uint64_t)" ", 1LL);
                  uint64_t v78 = v80;
                  unsigned __int16 v84 = v79 > v80++;
                }

                while (v84);
                uint64_t v85 = "], ";
                uint64_t v86 = 3LL;
              }
            }

            else
            {
              uint64_t v104 = sub_1002E6BF0();
              uint64_t v105 = (*(uint64_t (**)(uint64_t))(*(void *)v104 + 936LL))(v104) ^ 1;
              if (v66 != 3) {
                LOBYTE(v105) = 1;
              }
              if ((v105 & 1) != 0) {
                goto LABEL_192;
              }
              uint64_t v85 = "NonConnectable Secondary Data, ";
              uint64_t v86 = 31LL;
            }

LABEL_211:
          if (v86) {
            v86(v10, 0LL, v303, (unsigned __int16)v265, v264, *(void *)(v10 + 32));
          }
          sub_1000B1838(v303);
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v200,  v201,  v202,  v203,  v204,  v205,  v206,  v314);
          uint64_t v207 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v207, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0x13u:
        uint64_t v128 = *(unsigned __int8 **)(v10 + 48);
        if (v128 && ((v129 = *v128, v129 != 210) ? (BOOL v130 = v129 == 18) : (BOOL v130 = 1), v130))
        {
          unsigned __int16 v131 = a3 - 1;
          uint64_t v132 = *(void (**)(uint64_t, void, void))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if (!v131) {
            goto LABEL_121;
          }
          sub_1001EE134((uint64_t)"Invalid Write response length %d.", v133, v134, v135, v136, v137, v138, v139, v131);
          int v140 = (os_log_s *)sub_100086554(0x44u);
          if (!os_log_type_enabled(v140, OS_LOG_TYPE_ERROR)) {
            goto LABEL_121;
          }
          sub_100657858();
          if (v132) {
            goto LABEL_122;
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v224,  v225,  v226,  v227,  v228,  v229,  v230,  v314);
          uint64_t v231 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v231, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0x17u:
        uint64_t v141 = *(_BYTE **)(v10 + 48);
        if (v141 && *v141 == 22)
        {
          int v317 = *(void (**)(uint64_t, uint64_t, void, void, unsigned __int8 *, void, void))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if ((unsigned __int16)(a3 - 1) > 3u)
          {
            if (v317)
            {
              else {
                unsigned __int16 v283 = a2 + 5;
              }
              v317( v10,  0LL,  *(unsigned __int16 *)(a2 + 1),  *(unsigned __int16 *)(a2 + 3),  v283,  (unsigned __int16)(a3 - 5),  *(void *)(v10 + 32));
            }
          }

          else
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Invalid prepare write response length %d.",  v142,  v143,  v144,  v145,  v146,  v147,  v148,  (unsigned __int16)(a3 - 1));
              uint64_t v149 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v149, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            v317(v10, 4012LL, 0LL, 0LL, 0LL, 0LL, *(void *)(v10 + 32));
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v208,  v209,  v210,  v211,  v212,  v213,  v214,  v314);
          uint64_t v215 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v215, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        return;
      case 0x19u:
        int v150 = *(_BYTE **)(v10 + 48);
        if (v150 && *v150 == 24)
        {
          unsigned __int16 v151 = a3 - 1;
          uint64_t v132 = *(void (**)(uint64_t, void, void))(v10 + 24);
          sub_1001EEB14(*(unsigned int *)(v10 + 60));
          *(_DWORD *)(v10 + 60) = 0;
          sub_1000B1838(*(void **)(v10 + 48));
          *(void *)(v10 + 48) = 0LL;
          *(void *)(v10 + 24) = 0LL;
          if (!v151
            || !sub_1000A86F0()
            || (sub_1001EE134( (uint64_t)"Invalid execute write response length %d.",  v152,  v153,  v154,  v155,  v156,  v157,  v158,  v151),  uint64_t v159 = (os_log_s *)sub_100086554(0x44u),  !os_log_type_enabled(v159, OS_LOG_TYPE_ERROR)))
          {
LABEL_121:
            if (!v132) {
              return;
            }
            goto LABEL_122;
          }

          sub_100657858();
          if (v132)
          {
LABEL_122:
            v132(v10, 0LL, *(void *)(v10 + 32));
            return;
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"No read blob request matching this response. Ignoring.",  v216,  v217,  v218,  v219,  v220,  v221,  v222,  v314);
          uint64_t v223 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v223, OS_LOG_TYPE_ERROR)) {
            goto LABEL_149;
          }
        }

        break;
      default:
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Unknown opcode 0x%x", v43, v44, v45, v46, v47, v48, v49, v9);
          uint64_t v50 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
            goto LABEL_23;
          }
        }

        return;
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Invalid handle, there is no active session associated with the handle.",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  v314);
    uint64_t v34 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
LABEL_23:
    }
      sub_100657858();
  }

void sub_1001A4540(__int128 *a1, unsigned __int16 *a2, unsigned int a3, uint64_t a4)
{
  if (a2 && a3 >= 2)
  {
    uint64_t v9 = v4;
    uint64_t v10 = v5;
    if (off_1008E8858) {
      off_1008E8858(a1, *a2, a2 + 1, (unsigned __int16)(a3 - 2), a4, qword_1008E8860);
    }
    char v8 = 0;
    memset(v7, 0, sizeof(v7));
    if (!sub_1001EF520((uint64_t)v7, 1u))
    {
      char v8 = 30;
    }

    sub_1001EF5E4((uint64_t)v7);
  }

void sub_1001A4604(uint64_t a1, char a2)
{
  __src[0] = 1;
  __src[1] = a2;
  __int16 v6 = 0;
  char v7 = 6;
  uint64_t v2 = *((void *)&xmmword_1008E8840 + 1);
  if (*((void *)&xmmword_1008E8840 + 1))
  {
    while (*(void *)v2 != a1)
    {
      uint64_t v2 = *(void *)(v2 + 80);
      if (!v2) {
        return;
      }
    }

    *(void *)(v2 + 24) = 0LL;
    *(_BYTE *)(v2 + 56) = 0;
    *(void *)(v2 + 32) = 0LL;
    *(_WORD *)(v2 + 40) = 5;
    uint64_t v3 = sub_1000B1814(5uLL);
    *(void *)(v2 + 48) = v3;
    if (v3)
    {
      memmove(v3, __src, *(unsigned __int16 *)(v2 + 40));
      uint64_t v4 = *(void **)(v2 + 48);
      if (v4) {
        sub_1000B1838(v4);
      }
    }

    *(void *)(v2 + 48) = 0LL;
    *(void *)(v2 + 24) = 0LL;
    *(void *)(v2 + 32) = 0LL;
    *(_WORD *)(v2 + 40) = 0;
  }

uint64_t sub_1001A46B8(uint64_t a1)
{
  if (sub_10012D5EC(a1))
  {
    if (!a1) {
      sub_1001EE2A0();
    }
    if (*(_WORD *)(a1 + 86)) {
      unsigned __int16 v2 = 625 * *(_WORD *)(a1 + 86);
    }
    else {
      unsigned __int16 v2 = 6250;
    }
    if (*(_BYTE *)(a1 + 70))
    {
      uint64_t v3 = 527LL;
    }

    else
    {
      __int16 v12 = sub_1001ACFFC( *(unsigned __int16 *)(a1 + 108),  *(unsigned __int16 *)(a1 + 104),  v2,  *(_DWORD *)(a1 + 144),  *(_DWORD *)(a1 + 148));
      if (v12)
      {
        unsigned __int16 v13 = v12 - 4;
      }

      else
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Calculated MTU is zero for rx %d, tx %d, and CE %d us, probe %d",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  *(unsigned __int16 *)(a1 + 108));
          uint64_t v21 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        unsigned __int16 v13 = 527;
      }

      if (v13 >= 0x20Fu) {
        uint64_t v3 = 527LL;
      }
      else {
        uint64_t v3 = v13;
      }
    }

    if (sub_1000A86F0())
    {
      uint64_t v29 = "peripheral";
      if (!*(_BYTE *)(a1 + 70)) {
        uint64_t v29 = "central";
      }
      sub_1001EE134( (uint64_t)"ATT %s MTU %d (calculated %d): for rx %d bytes, tx %d bytes, ce %d us, probestate %d",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  (uint64_t)v29);
      uint64_t v30 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v34 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v30, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid LE Handle", v4, v5, v6, v7, v8, v9, v10, v32);
      uint64_t v11 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 0LL;
  }

  return v3;
}

__n128 sub_1001A48D8(uint64_t a1)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  result.n128_u64[0] = (unint64_t)vmovn_s32((int32x4_t)vmvnq_s8((int8x16_t)vuzp1q_s32( (int32x4_t)vceqzq_s64(*(int64x2_t *)&qword_1008E8820),  (int32x4_t)vceqzq_s64(*(int64x2_t *)&off_1008E8830))));
  result.n128_u16[0] = vmaxv_u16((uint16x4_t)result.n128_u64[0]);
  if ((result.n128_u8[0] & 1) != 0) {
    sub_1001EE2A0();
  }
  if (a1)
  {
    __n128 result = *(__n128 *)a1;
    __int128 v3 = *(_OWORD *)(a1 + 16);
    *(_OWORD *)&qword_1008E8820 = *(_OWORD *)a1;
    *(_OWORD *)&off_1008E8830 = v3;
  }

  return result;
}

double sub_1001A4938()
{
  double result = 0.0;
  *(_OWORD *)&qword_1008E8820 = 0u;
  *(_OWORD *)&off_1008E8830 = 0u;
  return result;
}

void sub_1001A4950(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v4 = sub_1001A2248(a1 + 1);
  if (v4)
  {
    *(_BYTE *)(v4 + 65) = 1;
    if (*(_BYTE *)(v4 + 64))
    {
      *(_BYTE *)(v4 + 64) = 0;
      uint64_t v5 = *(_BYTE **)(v4 + 48);
      if (v5)
      {
        if (*(_WORD *)(v4 + 40))
        {
          if (a3 != 4832 && a3)
          {
            int v6 = 251658240;
            LOBYTE(v6) = *v5;
            sub_1001A49E0(v4, (unsigned __int8 *)&v6, 4LL);
          }

          else
          {
            sub_1001A2950(v4);
          }
        }
      }
    }
  }

void sub_1001A49E0(uint64_t a1, unsigned __int8 *a2, uint64_t a3)
{
  uint64_t v4 = *(void (**)(uint64_t, unint64_t, void, void))(a1 + 24);
  if (v4)
  {
    if ((_DWORD)a3 == 4)
    {
      unint64_t v6 = a2[3];
      uint64_t v7 = *(unsigned __int8 **)(a1 + 48);
      if (v7)
      {
        int v8 = *a2;
        if (*v7 == v8)
        {
          uint64_t v19 = v4;
          if (((v6 < 0x10) & (0x9120u >> v6)) == 0
            || *(_BYTE *)(a1 + 65)
            || (int v18 = sub_1001A4C1C((uint64_t *)a1, v6), v18 != 4804) && v18)
          {
            sub_1001EEB14(*(unsigned int *)(a1 + 60));
            *(_DWORD *)(a1 + 60) = 0;
            *(void *)(a1 + 24) = 0LL;
            uint64_t v9 = *(void **)(a1 + 48);
            if (v9) {
              sub_1000B1838(v9);
            }
            *(void *)(a1 + 48) = 0LL;
            switch(v8)
            {
              case 2:
                v19(a1, v6, 0LL, *(void *)(a1 + 32));
                break;
              case 3:
              case 5:
              case 7:
              case 9:
              case 11:
              case 13:
              case 15:
              case 17:
              case 19:
              case 20:
              case 21:
              case 23:
                return;
              case 4:
              case 6:
              case 10:
              case 12:
              case 14:
                ((void (*)(uint64_t, unint64_t, void, void, void))v19)( a1,  v6,  0LL,  0LL,  *(void *)(a1 + 32));
                break;
              case 8:
              case 16:
                ((void (*)(uint64_t, unint64_t, void, void, void, void))v19)( a1,  v6,  0LL,  0LL,  0LL,  *(void *)(a1 + 32));
                break;
              case 18:
              case 24:
                goto LABEL_20;
              case 22:
                ((void (*)(uint64_t, unint64_t, void, void, void, void, void))v19)( a1,  v6,  0LL,  0LL,  0LL,  0LL,  *(void *)(a1 + 32));
                break;
              default:
                if (v8 == 210) {
LABEL_20:
                }
                  ((void (*)(uint64_t, unint64_t, void))v19)(a1, v6, *(void *)(a1 + 32));
                break;
            }
          }

          else
          {
            *(_BYTE *)(a1 + 64) = 1;
            sub_1001EEB14(*(unsigned int *)(a1 + 60));
          }
        }
      }
    }

    else if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid error payload size %d.", v10, v11, v12, v13, v14, v15, v16, a3);
      uint64_t v17 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

uint64_t sub_1001A4C1C(uint64_t *a1, int a2)
{
  if ((sub_1001C902C(*a1) & 1) == 0)
  {
    if (a2 <= 11)
    {
      if (a2 == 5) {
        return sub_1001D377C(*a1, 1);
      }
      if (a2 != 8) {
        return 4004LL;
      }
      sub_1001EE134( (uint64_t)"GATT is Asking to pair due to LE_ATT_ERROR_INSUFFICIENT_AUTHORIZATION",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  *(uint64_t *)v41);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (!os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT)) {
        return sub_1001D377C(*a1, 1);
      }
      goto LABEL_24;
    }

    if (a2 != 12)
    {
      if (a2 != 15) {
        return 4004LL;
      }
      sub_1001EE134( (uint64_t)"GATT is Asking to pair due to LE_ATT_ERROR_INSUFFICIENT_ENCRYPTION",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  *(uint64_t *)v41);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (!os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT)) {
        return sub_1001D377C(*a1, 1);
      }
      goto LABEL_24;
    }

    return 1424LL;
  }

  if ((sub_1001C8ECC(*a1) & 1) == 0)
  {
    if (a2 > 11)
    {
      if (a2 == 12) {
        return 1424LL;
      }
      if (a2 != 15) {
        return 4004LL;
      }
    }

    else if (a2 != 5)
    {
      if (a2 != 8) {
        return 4004LL;
      }
      sub_1001EE134( (uint64_t)"GATT is Asking to pair due to LE_ATT_ERROR_INSUFFICIENT_AUTHORIZATION",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  *(uint64_t *)v41);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (!os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT)) {
        return sub_1001D377C(*a1, 1);
      }
      goto LABEL_24;
    }

    return sub_1001C8D80(*a1);
  }

  if ((sub_1001C8F50(*a1) & 1) == 0)
  {
    if (a2 <= 11)
    {
      if (a2 != 5)
      {
        if (a2 == 8)
        {
          sub_1001EE134( (uint64_t)"GATT is Asking to pair due to LE_ATT_ERROR_INSUFFICIENT_AUTHORIZATION",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  *(uint64_t *)v41);
          uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
          if (!os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT)) {
            return sub_1001D377C(*a1, 1);
          }
          goto LABEL_24;
        }

        return 4004LL;
      }

      sub_1001EE134( (uint64_t)"GATT is Asking to pair due to LE_ATT_ERROR_INSUFFICIENT_AUTHENTICATION",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  *(uint64_t *)v41);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (!os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT)) {
        return sub_1001D377C(*a1, 1);
      }
LABEL_24:
      *(_DWORD *)uint64_t v41 = 136446210;
      *(void *)&v41[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", v41, 0xCu);
      return sub_1001D377C(*a1, 1);
    }

    if (a2 == 12) {
      return sub_1001A4FC0(a1);
    }
    if (a2 != 15) {
      return 4004LL;
    }
    return 1424LL;
  }

  uint64_t result = 1424LL;
  if (a2 > 11)
  {
    if (a2 == 15) {
      return result;
    }
    if (a2 != 12) {
      return 4004LL;
    }
    return sub_1001A4FC0(a1);
  }

  if (a2 != 5 && a2 != 8) {
    return 4004LL;
  }
  return result;
}

uint64_t sub_1001A4FC0(uint64_t *a1)
{
  char v31 = 0;
  uint64_t v2 = sub_1001C90B0(*a1, &v31);
  if ((_DWORD)v2)
  {
    uint64_t v3 = v2;
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to retrieve LTK size : %!.", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else if (v31 == 16)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Already using max key size. Erroring out.", v12, v13, v14, v15, v16, v17, v18, v30);
      uint64_t v19 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1424LL;
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"GATT is Asking to pair due to short encryption link",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  v30);
      uint64_t v27 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v28 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v33 = v28;
        _os_log_impl((void *)&_mh_execute_header, v27, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    return sub_1001D377C(*a1, 1);
  }

  return v3;
}

void sub_1001A5140(uint64_t a1, unsigned __int16 *a2, int a3)
{
  if (a3 != 702)
  {
    if (a3 || !sub_10012D5EC((uint64_t)a2))
    {
      if (sub_1000A86F0())
      {
        if (a2) {
          uint64_t v14 = *a2;
        }
        else {
          uint64_t v14 = 0LL;
        }
        sub_1001EE134( (uint64_t)"GATT connection notification from lmHandle 0x%x (%x) with status %!",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v14);
        uint64_t v15 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    else
    {
      uint64_t v4 = (unsigned __int16 **)*((void *)&xmmword_1008E8840 + 1);
      if (*((void *)&xmmword_1008E8840 + 1))
      {
        while (*v4 != a2)
        {
          uint64_t v4 = (unsigned __int16 **)v4[10];
          if (!v4) {
            goto LABEL_7;
          }
        }

        sub_1001EE134((uint64_t)"ATT already has a bearer for this !", v16, v17, v18, v19, v20, v21, v22, v32);
        uint64_t v23 = (os_log_s *)sub_100086554(0x44u);
        if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          goto LABEL_22;
        }
LABEL_21:
        sub_100657858();
LABEL_22:
        sub_1001EE2A0();
        return;
      }

void sub_1001A52BC(unsigned __int16 *a1, uint64_t a2)
{
  if (a1)
  {
    uint64_t v4 = sub_1001A23F4(a1);
    if ((_DWORD)v4)
    {
      uint64_t v5 = v4;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ATT Session destroy failed with %!", v6, v7, v8, v9, v10, v11, v12, v5);
        uint64_t v13 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    if (off_1008E8828) {
      off_1008E8828(a1, a2);
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"_GATT_LE_DisconnectedCB lmhandle 0x%x (0x%x) is not valid with reason %!",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  0LL);
    uint64_t v21 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

void sub_1001A53A4(unsigned __int16 *a1, int a2)
{
  if (a2)
  {
    if (sub_1000A86F0())
    {
      if (a1) {
        uint64_t v11 = *a1;
      }
      else {
        uint64_t v11 = 0LL;
      }
      sub_1001EE134( (uint64_t)"GATT ready notification from lmHandle 0x%x (%x) with error %!",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  v11);
      uint64_t v13 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  else
  {
    if (a1) {
      sub_1001A6B74((uint64_t)a1);
    }
    if (off_1008E8830)
    {
      uint64_t v12 = *((void *)&xmmword_1008E8840 + 1);
      if (*((void *)&xmmword_1008E8840 + 1))
      {
        while (*(unsigned __int16 **)v12 != a1)
        {
          uint64_t v12 = *(void *)(v12 + 80);
          if (!v12) {
            goto LABEL_13;
          }
        }

        int v14 = *(unsigned __int8 *)(v12 + 66);
        uint64_t v15 = sub_1001A46B8((uint64_t)a1);
        if (off_1008E8830) {
          ((void (*)(unsigned __int16 *, BOOL, uint64_t, void))off_1008E8830)(a1, v14 != 0, v15, 0LL);
        }
      }

      else
      {
LABEL_13:
        sub_1001EE2A0();
      }
    }
  }

void sub_1001A54C4(void *ptr)
{
  if (ptr)
  {
    uint64_t v2 = ptr[1];
    if (v2) {
      sub_1001EF45C(v2);
    }
    sub_1000B1838(ptr);
  }

void sub_1001A54FC(uint64_t a1)
{
  uint64_t v1 = **(uint64_t ***)(a1 + 8);
  uint64_t v2 = (uint64_t *)*((void *)&xmmword_1008E8840 + 1);
  if (v1) {
    BOOL v3 = *((void *)&xmmword_1008E8840 + 1) == 0LL;
  }
  else {
    BOOL v3 = 1;
  }
  if (v3)
  {
LABEL_7:
    sub_1001EE134((uint64_t)"Bearer is not valid", v4, v5, v6, v7, v8, v9, v10, v33);
    uint64_t v11 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_9;
  }

  while (v2 != v1)
  {
    uint64_t v2 = (uint64_t *)v2[10];
    if (!v2) {
      goto LABEL_7;
    }
  }

  uint64_t v12 = *v1;
  int v13 = sub_1000A86F0();
  if (!v12)
  {
    if (!v13) {
      return;
    }
    sub_1001EE134((uint64_t)"Bearer handle is not valid", v14, v15, v16, v17, v18, v19, v20, v33);
    uint64_t v23 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_9:
    sub_100657858();
    return;
  }

  if (v13)
  {
    sub_1001EE134( (uint64_t)"Timeout waiting for ATT response, forcing a disconnect.",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  v33);
    uint64_t v21 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  int v35 = *((_DWORD *)v1 + 2);
  __int16 v36 = *((_WORD *)v1 + 6);
  char v34 = *((_BYTE *)v1 + 14);
  if (*v1)
  {
    if (*(_BYTE *)(*v1 + 2))
    {
      if (*(_BYTE *)(*v1 + 2) != 4) {
        return;
      }
      uint64_t v22 = sub_1001BD774(&v34);
    }

    else
    {
      uint64_t v22 = sub_1000B29F0(((unint64_t)*((unsigned __int8 *)v1 + 8) << 40) | ((unint64_t)*((unsigned __int8 *)v1 + 9) << 32) | ((unint64_t)*((unsigned __int8 *)v1 + 10) << 24) | ((unint64_t)*((unsigned __int8 *)v1 + 11) << 16) | ((unint64_t)*((unsigned __int8 *)v1 + 12) << 8) | *((unsigned __int8 *)v1 + 13));
    }

    uint64_t v24 = v22;
    if ((_DWORD)v22)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ATT disconnect timedout with status %!", v25, v26, v27, v28, v29, v30, v31, v24);
        uint64_t v32 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

uint64_t sub_1001A56C0()
{
  int v0 = sub_1000B1814(0x10uLL);
  *((void *)&xmmword_1008E88B0 + 1) = v0;
  if (v0)
  {
    uint64_t v1 = v0;
    uint64_t result = 0LL;
    *uint64_t v1 = 1;
    word_1008E88C0 = 1;
    LOBYTE(xmmword_1008E88A0) = 1;
    LOBYTE(xmmword_1008E88B0) = 1;
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to allocate zero-index handle!", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4013LL;
  }

  return result;
}

double sub_1001A5758()
{
  double result = 0.0;
  xmmword_1008E88D0 = 0u;
  *(_OWORD *)&qword_1008E88E0 = 0u;
  xmmword_1008E88B0 = 0u;
  *(_OWORD *)&word_1008E88C0 = 0u;
  xmmword_1008E88A0 = 0u;
  xmmword_1008E8900 = 0u;
  xmmword_1008E8910 = 0u;
  xmmword_1008E8920 = 0u;
  off_1008E8930 = 0LL;
  dword_1008E8938 = 0;
  return result;
}

__n128 sub_1001A5790(uint64_t a1)
{
  result.n128_u64[0] = (unint64_t)vmovn_s32((int32x4_t)vmvnq_s8((int8x16_t)vuzp1q_s32( (int32x4_t)vceqzq_s64((int64x2_t)xmmword_1008E8900),  (int32x4_t)vceqzq_s64((int64x2_t)xmmword_1008E8910))));
  result.n128_u16[0] = vmaxv_u16((uint16x4_t)result.n128_u64[0]);
  if ((result.n128_u8[0] & 1) == 0 && *(void *)a1 && *(void *)(a1 + 8) && *(void *)(a1 + 16))
  {
    if (*(void *)(a1 + 24))
    {
      __n128 result = *(__n128 *)a1;
      __int128 v2 = *(_OWORD *)(a1 + 16);
      __int128 v3 = *(_OWORD *)(a1 + 32);
      off_1008E8930 = *(_UNKNOWN **)(a1 + 48);
      xmmword_1008E8910 = v2;
      xmmword_1008E8920 = v3;
      xmmword_1008E8900 = (__int128)result;
    }
  }

  return result;
}

uint64_t sub_1001A5808(uint64_t a1)
{
  __int128 v2 = (void *)&xmmword_1008E88A0 + 1;
  do
  {
    uint64_t v3 = *v2;
    __int128 v2 = (void *)(*v2 + 24LL);
  }

  while (v3 != a1 && v3 != 0);
  if (v3) {
    return *(unsigned __int16 *)(a1 + 8);
  }
  uint64_t result = sub_1000A86F0();
  if ((_DWORD)result)
  {
    sub_1001EE134((uint64_t)"Couldn't find active session %p!", v6, v7, v8, v9, v10, v11, v12, a1);
    int v13 = (os_log_s *)sub_100086554(0x44u);
    uint64_t result = os_log_type_enabled(v13, OS_LOG_TYPE_ERROR);
    if ((_DWORD)result)
    {
      sub_100657858();
      return 0LL;
    }
  }

  return result;
}

void *sub_1001A589C(uint64_t a1)
{
  uint64_t result = (void *)*((void *)&xmmword_1008E88A0 + 1);
  if (*((void *)&xmmword_1008E88A0 + 1))
  {
    do
    {
      if (*result == a1) {
        break;
      }
      uint64_t result = (void *)result[3];
    }

    while (result);
  }

  return result;
}

uint64_t sub_1001A58C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!*(void *)(a2 + 32)) {
    sub_1001EE2A0();
  }
  if (a3 >= 0x201)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Number of requested handles (%d) exceeds maximum allowed (%d)",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  a3);
      int v13 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4016LL;
  }

  if ((_DWORD)a1) {
    unsigned int v15 = *(unsigned __int16 *)(*(void *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * a1 + 8) + 24LL);
  }
  else {
    unsigned int v15 = 0xFFFF;
  }
  uint64_t v16 = (unsigned __int16)word_1008E88C0;
  unsigned int v17 = a1 + 1;
  if ((int)a1 + 1 < (unsigned __int16)word_1008E88C0 && v15 > a1)
  {
    uint64_t v19 = (void *)*((void *)&xmmword_1008E88B0 + 1);
    do
    {
      uint64_t v20 = (unsigned __int8 *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * v17);
      LODWORD(v21) = *v20;
      if ((_DWORD)v21 == 2)
      {
        LODWORD(v22) = *(unsigned __int16 *)(*((void *)v20 + 1) + 24LL);
      }

      else if (*v20)
      {
        LODWORD(v22) = v17;
      }

      else
      {
        if ((_DWORD)a3 && v17 < (unsigned __int16)word_1008E88C0)
        {
          LODWORD(v22) = v17;
          if (v17 <= v15)
          {
            uint64_t v21 = 0LL;
            uint64_t v23 = (unsigned __int8 *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * v17);
            while (1)
            {
              unint64_t v22 = v17 + v21;
              int v24 = *v23;
              v23 += 16;
              if (v24) {
                break;
              }
              if (++v21 + (unint64_t)v17 >= (unsigned __int16)word_1008E88C0
                || v22 >= v15
                || v21 >= a3)
              {
                LODWORD(v22) = v17 + v21;
                break;
              }
            }
          }
        }

        else
        {
          LODWORD(v22) = v17;
        }

        if ((_DWORD)v21 == (_DWORD)a3)
        {
          *uint64_t v20 = 2;
          LOWORD(v16) = v17;
          goto LABEL_48;
        }
      }

      unsigned int v17 = v22 + 1;
    }

    while ((int)v22 + 1 < (unsigned __int16)word_1008E88C0 && v22 < v15);
  }

  if ((_DWORD)a1)
  {
    sub_1001EE134( (uint64_t)"No room for %d attributes in group [0x%04x -> 0x%04x]",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  (a3 + 1));
    char v34 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      goto LABEL_53;
    }
    goto LABEL_52;
  }

  int v35 = sub_1000B1814(16 * ((unsigned __int16)word_1008E88C0 + a3) + 16);
  if (v35)
  {
    uint64_t v19 = v35;
    __int16 v36 = (const void *)*((void *)&xmmword_1008E88B0 + 1);
    if (!*((void *)&xmmword_1008E88B0 + 1))
    {
      sub_1001EE2A0();
      __int16 v36 = (const void *)*((void *)&xmmword_1008E88B0 + 1);
    }

    memmove(v19, v36, 16LL * (unsigned __int16)word_1008E88C0);
    sub_1000B1838(*((void **)&xmmword_1008E88B0 + 1));
    *((void *)&xmmword_1008E88B0 + 1) = v19;
    word_1008E88C0 += a3 + 1;
    *((_BYTE *)v19 + 16 * v16) = 2;
LABEL_48:
    if ((_WORD)v16)
    {
      uint64_t result = 0LL;
      *((void *)v19 + 2 * (unsigned __int16)v16 + 1) = a2;
      *(_WORD *)a2 = v16;
      *(_WORD *)(a2 + 24) = v16 + a3;
      return result;
    }

    goto LABEL_53;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Failed to allocate new handle map of size %d",  v37,  v38,  v39,  v40,  v41,  v42,  v43,  a3 + (unsigned __int16)word_1008E88C0 + 1);
    uint64_t v44 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
LABEL_52:
    }
      sub_100657858();
  }

void sub_1001A5BC8(unsigned int a1, int a2)
{
  uint64_t v2 = *((void *)&xmmword_1008E88B0 + 1);
  if (*(_BYTE *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * a1) == 2)
  {
    uint64_t v3 = *(unsigned __int16 **)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * a1 + 8);
    uint64_t v4 = v3[12];
    uint64_t v5 = *v3;
    if (v5 <= v4)
    {
      uint64_t v7 = 16 * v5;
      uint64_t v8 = v4 - v5 + 1;
      do
      {
        *(_BYTE *)(v2 + v7) = 3;
        if (a2)
        {
          uint64_t v9 = *(void **)(v2 + v7 + 8);
          if (v9)
          {
            sub_1000B1838(v9);
            uint64_t v2 = *((void *)&xmmword_1008E88B0 + 1);
          }
        }

        *(void *)(v2 + v7 + 8) = 0LL;
        v7 += 16LL;
        --v8;
      }

      while (v8);
    }
  }

void sub_1001A5C90()
{
  unsigned __int16 v0 = word_1008E88C0;
  if (word_1008E88C0)
  {
    int v1 = (unsigned __int16)word_1008E88C0 - 1;
    if (word_1008E88C0 == 1)
    {
LABEL_10:
      unsigned __int16 v6 = 0;
      unsigned __int16 v0 = 1;
    }

    else
    {
      unsigned __int16 v2 = word_1008E88C0 - 1;
      uint64_t v3 = (unsigned __int8 *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * (unsigned __int16)v1);
      while (1)
      {
        int v5 = *v3;
        v3 -= 16;
        int v4 = v5;
        unsigned __int16 v6 = v2;
        if (v5 != 3 && v4 != 0) {
          break;
        }
        --v2;
        unsigned __int16 v0 = v6;
        if (!v2) {
          goto LABEL_10;
        }
      }
    }

    if (v1 > v6)
    {
      uint64_t v8 = (char *)sub_1000B1814(16LL * v0);
      if (v8)
      {
        uint64_t v9 = v8;
        memmove(v8, *((const void **)&xmmword_1008E88B0 + 1), 16LL * v0);
        sub_1000B1838(*((void **)&xmmword_1008E88B0 + 1));
        *((void *)&xmmword_1008E88B0 + 1) = v9;
        word_1008E88C0 = v0;
        if (v6)
        {
          uint64_t v10 = v9 + 24;
          uint64_t v11 = v6;
          do
          {
            if (*((_BYTE *)v10 - 8) == 2)
            {
              uint64_t v12 = *v10;
              if (*v10)
              {
              }
            }

            v10 += 2;
            --v11;
          }

          while (v11);
        }
      }

      else if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to allocate new handle map of size %d", v13, v14, v15, v16, v17, v18, v19, v0);
        uint64_t v20 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

void sub_1001A5DE4(uint64_t a1, int a2, _WORD *a3)
{
  int v5 = (void *)&xmmword_1008E88A0 + 1;
  do
  {
    uint64_t v6 = *v5;
    int v5 = (void *)(*v5 + 24LL);
  }

  while (v6 != a1 && v6 != 0);
  if (v6)
  {
    if (a2)
    {
      if (*(_BYTE *)(a1 + 16)) {
        sub_1001EE2A0();
      }
      *(_BYTE *)(a1 + 16) = 1;
    }

    else
    {
      if (!a3) {
        sub_1001EE2A0();
      }
      *(_BYTE *)(a1 + 16) = 0;
      *(_WORD *)(a1 + 8) = *a3;
      (*(&xmmword_1008E8910 + 1))(a1);
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Couldn't find active session %p!", v8, v9, v10, v11, v12, v13, v14, a1);
    uint64_t v15 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_1001A5EBC(uint64_t a1, __int16 a2, int a3, const void *a4, int a5)
{
  BOOL v53 = 0;
  uint64_t v10 = (void *)&xmmword_1008E88A0 + 1;
  do
  {
    uint64_t v11 = *v10;
    uint64_t v10 = (void *)(*v10 + 24LL);
  }

  while (v11 != a1 && v11 != 0);
  if (v11)
  {
    if ((_BYTE)xmmword_1008E88B0)
    {
      if (*(_BYTE *)(a1 + 16))
      {
        return 146LL;
      }

      else
      {
        uint64_t v23 = (char *)sub_1000B1814(*(unsigned __int16 *)(a1 + 8));
        if (v23)
        {
          int v24 = v23;
          if (a3) {
            char v25 = 27;
          }
          else {
            char v25 = 29;
          }
          *uint64_t v23 = v25;
          *(_WORD *)(v23 + 1) = a2;
          memmove(v23 + 3, a4, (unsigned __int16)a5);
          if ((a3 & 1) == 0 && *(_DWORD *)(a1 + 12) && (sub_1001EE2A0(), *(_DWORD *)(a1 + 12)))
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Session 0x%x already has an outstanding indication!",  v26,  v27,  v28,  v29,  v30,  v31,  v32,  a1);
              uint64_t v33 = (os_log_s *)sub_100086554(0x44u);
              if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            sub_1000B1838(v24);
            return 4020LL;
          }

          else
          {
            uint64_t v13 = sub_1001A6168(*(__int128 **)a1, (char *)v24, (unsigned __int16)(a5 + 3), &v53);
            sub_1000B1838(v24);
            if ((_DWORD)v13)
            {
              if (sub_1000A86F0())
              {
                uint64_t v41 = "indication";
                if (a3) {
                  uint64_t v41 = "notification";
                }
                sub_1001EE134( (uint64_t)"Failed to send %s for session 0x%x with result %!",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  (uint64_t)v41);
                uint64_t v42 = (os_log_s *)sub_100086554(0x44u);
                if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
                  sub_100657858();
                }
              }
            }

            else
            {
              LOBYTE(xmmword_1008E88B0) = v53;
              if ((a3 & 1) == 0)
              {
                v52[1] = (const void *)a1;
                v52[0] = (const void *)8;
                sub_1001EE6E8((uint64_t)sub_1001A6214, v52, (unsigned __int16)dword_1008D8EB0, (int *)(a1 + 12));
              }

              return 0LL;
            }
          }
        }

        else
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Failed to allocate memory for update", v43, v44, v45, v46, v47, v48, v49, v51);
            uint64_t v50 = (os_log_s *)sub_100086554(0x44u);
            if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          return 4019LL;
        }
      }
    }

    else
    {
      return 410LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Couldn't find active session %p!", v14, v15, v16, v17, v18, v19, v20, a1);
      uint64_t v21 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4018LL;
  }

  return v13;
}

uint64_t sub_1001A6168(__int128 *a1, char *a2, size_t a3, BOOL *a4)
{
  uint64_t v8 = sub_1001EF520((uint64_t)v11, 1u);
  if (!(_DWORD)v8)
  {
    uint64_t v8 = sub_1001EFB10((unsigned __int8 *)v11, a2, a3, 2u);
    if (!(_DWORD)v8)
    {
      unsigned int v9 = sub_1001A2530(a1, (uint64_t)v11, 1, a4);
      if (v9 == 412) {
        uint64_t v8 = 0LL;
      }
      else {
        uint64_t v8 = v9;
      }
    }
  }

  sub_1001EF5E4((uint64_t)v11);
  return v8;
}

void sub_1001A6214(uint64_t a1)
{
  int v1 = (void *)*((void *)&xmmword_1008E88A0 + 1);
  if (!*((void *)&xmmword_1008E88A0 + 1)) {
    return;
  }
  uint64_t v2 = **(void **)(a1 + 8);
  while (*v1 != v2)
  {
    int v1 = (void *)v1[3];
    if (!v1) {
      return;
    }
  }

  if (!sub_1000A86F0()
    || (sub_1001EE134( (uint64_t)"Timed out waiting for indication response - disconnecting!",  v3,  v4,  v5,  v6,  v7,  v8,  v9,  v30),  uint64_t v10 = (os_log_s *)sub_100086554(0x44u),  !os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)))
  {
    if (v2) {
      goto LABEL_9;
    }
LABEL_22:
    if ((sub_1000A86F0() & 1) != 0)
    {
      BOOL v28 = 0LL;
LABEL_24:
      sub_1001EE134( (uint64_t)"Invalid transport %d in Indication Response Timeout Handler",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  v28);
      uint64_t v29 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

uint64_t sub_1001A63DC()
{
  uint64_t v0 = (unsigned __int16)word_1008E88C0;
  if ((unsigned __int16)word_1008E88C0 >= 0x100uLL)
  {
    LOBYTE(result) = 0;
    uint64_t v2 = (unsigned __int8 *)*((void *)&xmmword_1008E88B0 + 1);
    do
    {
      int v4 = *v2;
      v2 += 16;
      int v3 = v4;
      if ((result & 1) != 0)
      {
        uint64_t result = 1LL;
        if (v3 == 2) {
          return result;
        }
      }

      else
      {
        if (v3) {
          BOOL v5 = v3 == 3;
        }
        else {
          BOOL v5 = 1;
        }
        LOBYTE(result) = v5;
      }

      --v0;
    }

    while (v0);
  }

  return 0LL;
}

_WORD *sub_1001A642C(uint64_t a1, __int16 a2)
{
  int v4 = sub_1000B1814(0x28uLL);
  BOOL v5 = v4;
  if (v4)
  {
    uint64_t v6 = *((void *)&xmmword_1008E88A0 + 1);
    *(void *)int v4 = a1;
    v4[4] = a2;
    sub_10018A690(a1);
    while (v6)
    {
      uint64_t v7 = v6;
      uint64_t v6 = *(void *)(v6 + 24);
      if (!v6)
      {
        *(void *)(v7 + 24) = v5;
        *((void *)v5 + 4) = v7;
        goto LABEL_10;
      }
    }

    *((void *)&xmmword_1008E88A0 + 1) = v5;
LABEL_10:
    sub_1001A64F4(a1, 1);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Failed to allocate new DB session!", v8, v9, v10, v11, v12, v13, v14, v17);
    uint64_t v15 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return v5;
}

void sub_1001A64F4(uint64_t a1, int a2)
{
  unsigned __int16 v2 = word_1008E88E8;
  if (word_1008E88E8) {
    BOOL v3 = *((void *)&xmmword_1008E88D0 + 1) == 0LL;
  }
  else {
    BOOL v3 = 0;
  }
  if (v3)
  {
    uint64_t v6 = 0LL;
    uint64_t v7 = qword_1008E88E0;
    unint64_t v8 = 1LL;
    unsigned __int16 v9 = word_1008E88E8;
    do
    {
      uint64_t v10 = (void *)(v7 + v6);
      if (!a1 || *v10 == a1)
      {
        if (a2) {
          sub_1001A6F40(*(__int128 **)(v7 + v6), *(char **)(v7 + v6 + 8), *(unsigned __int16 *)(v7 + v6 + 16), 0);
        }
        sub_1000B1838(*(void **)(v7 + v6 + 8));
        void *v10 = 0LL;
        v10[1] = 0LL;
        _OWORD v10[2] = 0LL;
        --v9;
        unsigned __int16 v2 = word_1008E88E8;
        uint64_t v11 = *((void *)&xmmword_1008E88D0 + 1);
        uint64_t v7 = qword_1008E88E0;
      }

      else
      {
        uint64_t v11 = 0LL;
      }

      if (v8 >= v2) {
        break;
      }
      v6 += 24LL;
      ++v8;
    }

    while (!v11);
    if (v9 != v2)
    {
      if (!v9)
      {
        uint64_t v13 = 0LL;
        uint64_t v15 = (char *)qword_1008E88E0;
        goto LABEL_26;
      }

      uint64_t v12 = (char *)sub_1000B1814(24LL * v9);
      if (v12)
      {
        uint64_t v13 = v12;
        unsigned int v14 = (unsigned __int16)word_1008E88E8;
        uint64_t v15 = (char *)qword_1008E88E0;
        if (word_1008E88E8)
        {
          uint64_t v16 = 0LL;
          unint64_t v17 = 0LL;
          unsigned __int16 v18 = 0;
          do
          {
            uint64_t v19 = &v15[v16];
            if (*(void *)&v15[v16])
            {
              if (v18 >= v9)
              {
                if (sub_1000A86F0())
                {
                  sub_1001EE134( (uint64_t)"Not enough allocation to update stalled request",  v31,  v32,  v33,  v34,  v35,  v36,  v37,  v39);
                  uint64_t v38 = (os_log_s *)sub_100086554(0x44u);
                  if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
                    sub_100657858();
                  }
                }

                sub_1000B1838(v13);
                return;
              }

              int v20 = v18++;
              uint64_t v21 = &v13[24 * v20];
              __int128 v22 = *(_OWORD *)v19;
              *((void *)v21 + 2) = *((void *)v19 + 2);
              *(_OWORD *)uint64_t v21 = v22;
              uint64_t v15 = (char *)qword_1008E88E0;
              unsigned int v14 = (unsigned __int16)word_1008E88E8;
            }

            ++v17;
            v16 += 24LL;
          }

          while (v17 < v14);
        }

void sub_1001A6710(unsigned __int16 *a1)
{
  uint64_t v2 = *((void *)&xmmword_1008E88A0 + 1);
  uint64_t v3 = sub_1001A6818(a1);
  if (v3) {
    sub_1001A6960(v3);
  }
  if (v2)
  {
    while (*(unsigned __int16 **)v2 != a1)
    {
      uint64_t v2 = *(void *)(v2 + 24);
      if (!v2) {
        goto LABEL_6;
      }
    }
  }

  else
  {
LABEL_6:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Failed to find the DB session to destroy!", v4, v5, v6, v7, v8, v9, v10, v14);
      uint64_t v2 = sub_100086554(0x44u);
      if (os_log_type_enabled((os_log_t)v2, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    sub_1001EE2A0();
    __break(1u);
  }

  uint64_t v11 = *(unsigned int *)(v2 + 12);
  if ((_DWORD)v11)
  {
    sub_1001EEB14(v11);
    xmmword_1008E8910(v2);
  }

  if (xmmword_1008E8920) {
    xmmword_1008E8920(0LL, v2, 0LL, 0LL, 0LL);
  }
  sub_1001A64F4((uint64_t)a1, 0);
  uint64_t v13 = *(void *)(v2 + 24);
  uint64_t v12 = *(void *)(v2 + 32);
  if (!v12)
  {
    *((void *)&xmmword_1008E88A0 + 1) = *(void *)(v2 + 24);
    if (!v13) {
      goto LABEL_17;
    }
    goto LABEL_16;
  }

  *(void *)(v12 + 24) = v13;
  uint64_t v13 = *(void *)(v2 + 24);
  if (v13) {
LABEL_16:
  }
    *(void *)(v13 + 32) = v12;
LABEL_17:
  sub_1000B1838((void *)v2);
}

uint64_t sub_1001A6818(unsigned __int16 *a1)
{
  if (!sub_10012D5EC((uint64_t)a1) && !sub_10012D514((uint64_t)a1))
  {
    sub_1001EE134((uint64_t)"Invalid Handle", v5, v6, v7, v8, v9, v10, v11, v29);
    uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
    if (!os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      return 0LL;
    }
    goto LABEL_17;
  }

  uint64_t v2 = (unsigned __int16)xmmword_1008E88D0;
  if ((_WORD)xmmword_1008E88D0)
  {
    uint64_t result = qword_1008E88C8;
    if (!qword_1008E88C8)
    {
      sub_1001EE134( (uint64_t)"findResponseByHCIHandle response is NULL lmHandle=%d",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  *a1);
      int v20 = (os_log_s *)sub_100086554(0x44u);
      if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        return 0LL;
      }
      goto LABEL_17;
    }

    while (1)
    {
      uint64_t v4 = *(unsigned __int16 ***)(result + 24);
      if (!v4) {
        break;
      }
      if (*v4 == a1) {
        return result;
      }
      result += 72LL;
      if (!--v2) {
        return 0LL;
      }
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"findResponseByHCIHandle session is NULL lmHandle=%d",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  *a1);
      uint64_t v28 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
LABEL_17:
      }
        sub_100657858();
    }
  }

  return 0LL;
}

void sub_1001A6960(uint64_t a1)
{
  if ((_WORD)xmmword_1008E88D0)
  {
    uint64_t v2 = 0LL;
    size_t v3 = 72LL * (unsigned __int16)(xmmword_1008E88D0 - 1);
    for (uint64_t i = 72LL; qword_1008E88C8 + i - 72 != a1; i += 72LL)
    {
      ++v2;
      v3 -= 72LL;
    }

    unsigned __int16 v5 = xmmword_1008E88D0 - 1;
    if ((_WORD)xmmword_1008E88D0 == 1)
    {
      uint64_t v7 = 0LL;
    }

    else
    {
      uint64_t v6 = sub_1000B1814(72LL * (unsigned __int16)(xmmword_1008E88D0 - 1));
      uint64_t v7 = v6;
      if ((_WORD)v2) {
        memmove(v6, (const void *)qword_1008E88C8, i - 72);
      }
    }

    uint64_t v8 = *(void **)(a1 + 56);
    if (v8) {
      sub_1000B1838(v8);
    }
    uint64_t v9 = *(void **)(a1 + 40);
    if (v9) {
      sub_1000B1838(v9);
    }
    uint64_t v10 = *(unsigned int *)(a1 + 16);
    if ((_DWORD)v10) {
      sub_1001EEB14(v10);
    }
    sub_1000B1838((void *)qword_1008E88C8);
    qword_1008E88C8 = (uint64_t)v7;
    LOWORD(xmmword_1008E88D0) = v5;
  }

uint64_t sub_1001A6A8C()
{
  LOBYTE(xmmword_1008E88B0) = 1;
  return (*((uint64_t (**)(void))&xmmword_1008E8910 + 1))(0LL);
}

void sub_1001A6AA8(unsigned int a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Overriding ATT MTU to %d", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v11 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  word_1008E893C = a1;
}

uint64_t sub_1001A6B74(uint64_t a1)
{
  v59[2] = 0;
  *(_WORD *)uint64_t v59 = 3;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
    if (*(void *)i == a1) {
      break;
    }
  }

  if (!a1
    && sub_1000A86F0()
    && (sub_1001EE134((uint64_t)"LE ATT DB Handle MTU Change Request null hci handle", v3, v4, v5, v6, v7, v8, v9, v58),
        uint64_t v10 = (os_log_s *)sub_100086554(0x44u),
        os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)))
  {
    sub_100657F74();
    if (i) {
      goto LABEL_12;
    }
  }

  else if (i)
  {
    goto LABEL_12;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE ATT DB Handle MTU Change Request session not found",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v58);
    uint64_t v18 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  sub_1001EE2A0();
LABEL_12:
  unsigned int v19 = *(unsigned __int16 *)(i + 18);
  if (!*(_WORD *)(i + 18))
  {
    uint64_t v28 = 0LL;
    sub_1001EE134((uint64_t)"No pending ATT MTU requests", v21, v22, v23, v24, v25, v26, v27, v58);
    uint64_t v29 = (os_log_s *)sub_100086554(0x44u);
    uint64_t v28 = 0LL;
    if (!os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT)) {
      return v28;
    }
    *(_DWORD *)__int128 buf = 136446210;
    uint64_t v61 = sub_1001EDDCC();
    _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    return 0LL;
  }

  *(_WORD *)(i + 18) = 0;
  if (a1 && !*(_BYTE *)(a1 + 2))
  {
    uint64_t v20 = *(unsigned __int16 *)(i + 8);
  }

  else
  {
    uint64_t v20 = (unsigned __int16)word_1008E893C;
    if (!word_1008E893C) {
      uint64_t v20 = sub_1001A46B8(a1);
    }
  }

  else {
    uint64_t v30 = v19;
  }
  int v31 = *(unsigned __int16 *)(i + 8);
  if (v31 != 23 && (_DWORD)v30 != v31)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"The negotiated MTU is different from a previously negotiated one: %u != %u",  v32,  v33,  v34,  v35,  v36,  v37,  v38,  *(unsigned __int16 *)(i + 8));
      uint64_t v39 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  *(_WORD *)&v59[1] = v30;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"MTU response: desiredMTU %d, remoteMTU %d", v40, v41, v42, v43, v44, v45, v46, v20);
    uint64_t v47 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v61 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v47, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_1001A6168((__int128 *)a1, v59, 3uLL, 0LL))
  {
    *(_DWORD *)__int128 buf = 513;
    LOBYTE(v61) = 17;
    return sub_1001A6168((__int128 *)a1, (char *)buf, 5uLL, 0LL);
  }

  *(_WORD *)(i + 8) = v30;
  uint64_t v48 = sub_1001C031C(a1, v30);
  if (!(_DWORD)v48)
  {
    if (off_1008E8930) {
      off_1008E8930(i, v30);
    }
    return 0LL;
  }

  uint64_t v28 = v48;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"ATT DB failed to set GATT MTU", v49, v50, v51, v52, v53, v54, v55, v58);
    unsigned int v56 = (os_log_s *)sub_100086554(0x44u);
    if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

  return v28;
}

uint64_t sub_1001A6ED4(uint64_t a1)
{
  uint64_t v1 = *((void *)&xmmword_1008E88A0 + 1);
  if (!*((void *)&xmmword_1008E88A0 + 1)) {
    return 4202LL;
  }
  while (*(void *)v1 != a1)
  {
    uint64_t v1 = *(void *)(v1 + 24);
    if (!v1) {
      return 4202LL;
    }
  }

  uint64_t v3 = *(unsigned int *)(v1 + 12);
  if (!(_DWORD)v3) {
    return 4203LL;
  }
  sub_1001EEB14(v3);
  *(_DWORD *)(v1 + 12) = 0;
  xmmword_1008E8910(v1);
  return 0LL;
}

void sub_1001A6F40(__int128 *a1, char *a2, unsigned int a3, char a4)
{
  if ((sub_10012D5EC((uint64_t)a1) || sub_10012D514((uint64_t)a1)) && a2 && a3)
  {
    if ((_BYTE)xmmword_1008E88A0)
    {
      if ((*a2 | 0x80) == 0xD2 || !sub_1001A6818((unsigned __int16 *)a1))
      {
        uint64_t v8 = (__int128 **)*((void *)&xmmword_1008E88A0 + 1);
        if (*((void *)&xmmword_1008E88A0 + 1))
        {
          while (*v8 != a1)
          {
            uint64_t v8 = (__int128 **)v8[3];
            if (!v8) {
              goto LABEL_10;
            }
          }
        }

        else
        {
LABEL_10:
          if (sub_1000A86F0())
          {
            uint64_t v16 = a1 ? *(unsigned __int16 *)a1 : 0LL;
            sub_1001EE134( (uint64_t)"Couldn't find active session for ATT Request lmHandle 0x%x request %d",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v16);
            uint64_t v33 = (os_log_s *)sub_100086554(0x44u);
            if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          sub_1001EE2A0();
        }

        int v34 = *a2;
        if (!*((void *)&xmmword_1008E88D0 + 1))
        {
          switch(*a2)
          {
            case 2:
              int v42 = sub_1001A73E4((uint64_t)a1, (uint64_t)a2, a3);
              goto LABEL_55;
            case 3:
            case 5:
            case 7:
            case 9:
            case 11:
            case 13:
            case 15:
            case 17:
            case 19:
            case 20:
            case 21:
            case 23:
            case 25:
            case 26:
            case 27:
            case 28:
            case 29:
              goto LABEL_61;
            case 4:
              int v42 = sub_1001A7638(a1, a2, a3);
              goto LABEL_55;
            case 6:
              int v42 = sub_1001A798C(a1, a2, a3, a4);
              goto LABEL_55;
            case 8:
            case 16:
              int v42 = sub_1001A7CC4(a1, (unsigned __int8 *)a2, a3, a4);
              goto LABEL_55;
            case 10:
            case 12:
              int v42 = sub_1001A8190(a1, (unsigned __int8 *)a2, a3, a4);
              goto LABEL_55;
            case 14:
              int v42 = sub_1001A8500(a1, (unsigned __int8 *)a2, a3, a4);
              goto LABEL_55;
            case 18:
            case 22:
              goto LABEL_45;
            case 24:
              int v42 = sub_1001A8FAC(a1, a2, a3);
              goto LABEL_55;
            case 30:
              int v42 = sub_1001A6ED4((uint64_t)a1);
              goto LABEL_55;
            default:
              if (v34 != 82) {
                goto LABEL_61;
              }
LABEL_45:
              int v42 = sub_1001A88F0(a1, (unsigned __int8 *)a2, a3);
LABEL_55:
              if (v42 > 4309)
              {
                if (v42 == 4310) {
                  return;
                }
                int v67 = 4540;
              }

              else
              {
                if (!v42) {
                  return;
                }
                int v67 = 4300;
              }

              if (v42 == v67) {
                return;
              }
LABEL_61:
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"LE_ATT_DB_ProcessClientRequest opcode 0x%x failed with %!",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  *a2);
                uint64_t v75 = (os_log_s *)sub_100086554(0x44u);
                if (os_log_type_enabled(v75, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_63;
                }
              }

              return;
          }
        }

        if ((v34 | 0x80) != 0xD2)
        {
          uint64_t v35 = (unsigned __int16)word_1008E88E8;
          if (!word_1008E88E8)
          {
LABEL_30:
            uint64_t v37 = sub_1000B17F4(a3);
            if (v37)
            {
              uint64_t v38 = v37;
              memmove(v37, a2, a3);
              uint64_t v39 = (char *)sub_1000B1814(24LL * (unsigned __int16)word_1008E88E8 + 24);
              if (v39)
              {
                uint64_t v40 = (uint64_t)v39;
                uint64_t v41 = &v39[24 * (unsigned __int16)word_1008E88E8];
                *(void *)uint64_t v41 = a1;
                *((void *)v41 + 1) = v38;
                *((_WORD *)v41 + 8) = a3;
                *(_DWORD *)(v41 + 18) = 0;
                *((_WORD *)v41 + 11) = 0;
                if (qword_1008E88E0)
                {
                  memmove(v39, (const void *)qword_1008E88E0, 24LL * (unsigned __int16)word_1008E88E8);
                  sub_1000B1838((void *)qword_1008E88E0);
                }

                qword_1008E88E0 = v40;
                ++word_1008E88E8;
                return;
              }

              sub_1001EE134((uint64_t)"Failed to add new request to stall queue", v59, v60, v61, v62, v63, v64, v65, v76);
              uint64_t v66 = (os_log_s *)sub_100086554(0x44u);
              if (!os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
                return;
              }
            }

            else
            {
              sub_1001EE134((uint64_t)"Failed to backup stalled request", v51, v52, v53, v54, v55, v56, v57, v76);
              uint64_t v58 = (os_log_s *)sub_100086554(0x44u);
              if (!os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
                return;
              }
            }

uint64_t sub_1001A73E4(uint64_t a1, uint64_t a2, int a3)
{
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
    if (*(void *)i == a1) {
      break;
    }
  }

  if (a1)
  {
    if (!i)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"LE ATT DB Handle MTU Change Request session not found",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v44);
        uint64_t v14 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      sub_1001EE2A0();
    }

    if (a3 != 3)
    {
      *(_DWORD *)__int128 buf = 513;
      char v24 = 4;
LABEL_21:
      LOBYTE(v46) = v24;
      return sub_1001A6168((__int128 *)a1, (char *)buf, 5uLL, 0LL);
    }

    unsigned int v15 = *(unsigned __int16 *)(a2 + 1);
    *(_WORD *)(i + 18) = v15;
    if (v15 <= 0x16)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid requested MTU %d",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  *(unsigned __int16 *)(i + 18));
        uint64_t v23 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      *(_DWORD *)__int128 buf = 513;
      char v24 = 17;
      goto LABEL_21;
    }

    if (*(_DWORD *)(a1 + 132) == 7)
    {
      return sub_1001A6B74(a1);
    }

    else
    {
      int v41 = sub_1000A86F0();
      uint64_t result = 0LL;
      if (v41)
      {
        sub_1001EE134( (uint64_t)"Peer asked for MTU:%d while link is not ready, waiting for link to be ready",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  *(unsigned __int16 *)(i + 18));
        int v42 = (os_log_s *)sub_100086554(0x44u);
        BOOL v43 = os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT);
        uint64_t result = 0LL;
        if (v43)
        {
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v46 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v42, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          return 0LL;
        }
      }
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"LE ATT DB Handle MTU Change Request null hci handle",  v25,  v26,  v27,  v28,  v29,  v30,  v31,  v44);
      uint64_t v32 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return 414LL;
  }

  return result;
}

uint64_t sub_1001A7638(__int128 *a1, char *a2, unsigned int a3)
{
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  if (a3 <= 4)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not unpack Find Information Request", v5, v6, v7, v8, v9, v10, v11, v48);
      uint64_t v12 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    int v50 = 1025;
    char v13 = 4;
    goto LABEL_33;
  }

  char v14 = *a2;
  uint64_t v15 = *(unsigned __int16 *)(a2 + 1);
  unint64_t v16 = *(unsigned __int16 *)(a2 + 3);
  if (v16 <= (unsigned __int16)(v15 - 1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid handle(s) (0x%04x, 0x%04x) for Find Information Request",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  v15);
      uint64_t v37 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    char v13 = 1;
    LOBYTE(v50) = 1;
    BYTE1(v50) = v14;
    HIWORD(v50) = v15;
    goto LABEL_33;
  }

  uint64_t v17 = sub_1000B1814(*(unsigned __int16 *)(i + 8));
  if (!v17)
  {
    LOBYTE(v50) = 1;
    BYTE1(v50) = v14;
    HIWORD(v50) = v15;
    char v13 = 17;
    goto LABEL_33;
  }

  uint64_t v18 = v17;
  char v49 = v14;
  int v19 = *(unsigned __int16 *)(i + 8);
  *uint64_t v17 = 5;
  if (v15 > v16
    || (unsigned __int16 v20 = word_1008E88C0, v15 >= (unsigned __int16)word_1008E88C0))
  {
LABEL_27:
    sub_1000B1838(v18);
    LOBYTE(v50) = 1;
    BYTE1(v50) = v49;
    HIWORD(v50) = v15;
    char v13 = 10;
LABEL_33:
    char v51 = v13;
    return sub_1001A6168(a1, (char *)&v50, 5uLL, 0LL);
  }

  int v21 = 0;
  uint64_t v22 = *((void *)&xmmword_1008E88B0 + 1);
  uint64_t v23 = 16 * v15;
  unint64_t v24 = v15;
  int v25 = 1;
  do
  {
    if (*(_BYTE *)(v22 + v23) == 2)
    {
      int v26 = *(unsigned __int8 *)(*(void *)(v22 + v23 + 8) + 4LL);
      if (v21)
      {
        if (v21 != v26) {
          goto LABEL_35;
        }
      }

      else
      {
        if (v26 == 2) {
          char v27 = 1;
        }
        else {
          char v27 = 2;
        }
        uint64_t v28 = (unsigned __int16)v25++;
        *((_BYTE *)v18 + v28) = v27;
        int v21 = v26;
      }

      *((_BYTE *)v18 + (unsigned __int16)v25) = v24;
      *((_BYTE *)v18 + (unsigned __int16)(v25 + 1)) = BYTE1(v24);
      int v29 = v25 + 2;
      sub_1001BEF1C( (_BYTE *)v18 + (unsigned __int16)(v25 + 2),  (unsigned __int8 *)(*(void *)(*((void *)&xmmword_1008E88B0 + 1) + v23 + 8) + 4LL),  1);
      int v25 = v29 + v21;
      unsigned __int16 v20 = word_1008E88C0;
      uint64_t v22 = *((void *)&xmmword_1008E88B0 + 1);
    }

    if (v24 >= v16) {
      break;
    }
    ++v24;
    v23 += 16LL;
  }

  while (v24 < v20);
LABEL_35:
  if (!sub_1001A6168(a1, (char *)v18, (unsigned __int16)v25, 0LL))
  {
    sub_1000B1838(v18);
    return 0LL;
  }

  LOBYTE(v50) = 1;
  BYTE1(v50) = v49;
  HIWORD(v50) = v15;
  char v51 = 17;
  uint64_t v39 = sub_1001A6168(a1, (char *)&v50, 5uLL, 0LL);
  sub_1000B1838(v18);
  uint64_t result = 0LL;
  if ((_DWORD)v39)
  {
    if ((_DWORD)v39 != 412)
    {
      uint64_t result = sub_1000A86F0();
      if ((_DWORD)result)
      {
        sub_1001EE134((uint64_t)"ATT Send status %!", v40, v41, v42, v43, v44, v45, v46, v39);
        uint64_t v47 = (os_log_s *)sub_100086554(0x44u);
        uint64_t result = os_log_type_enabled(v47, OS_LOG_TYPE_ERROR);
        if ((_DWORD)result)
        {
          sub_100657F74();
          return 0LL;
        }
      }
    }
  }

  return result;
}

uint64_t sub_1001A798C(__int128 *a1, _DWORD *a2, unsigned int a3, char a4)
{
  __int16 v52 = 0;
  char v51 = 0LL;
  uint64_t v49 = 0LL;
  *(_OWORD *)ptr = 0u;
  __int128 v48 = 0u;
  __int128 v45 = 0u;
  __int128 v46 = 0u;
  LODWORD(v45) = dword_1008E8938;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  *((void *)&v46 + 1) = i;
  if (a3 <= 6)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not unpack Find By Type Value Request", v9, v10, v11, v12, v13, v14, v15, v42);
      unint64_t v16 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    LODWORD(v43[0]) = 1537;
    char v17 = 4;
    goto LABEL_9;
  }

  *(_DWORD *)int v50 = *a2;
  *(_DWORD *)&v50[3] = *(_DWORD *)((char *)a2 + 3);
  __int16 v18 = *(_WORD *)&v50[1];
  if (*(unsigned __int16 *)&v50[3] <= (unsigned __int16)(*(_WORD *)&v50[1] - 1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid handle(s) (0x%04x, 0x%04x) for Find By Type Value Request",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  *(unsigned __int16 *)&v50[1]);
      uint64_t v30 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    LOBYTE(v43[0]) = 1;
    BYTE1(v43[0]) = v50[0];
    WORD1(v43[0]) = *(_WORD *)&v50[1];
    BYTE4(v43[0]) = 1;
    return sub_1001A6168(a1, (char *)v43, 5uLL, 0LL);
  }

  if (a3 != 7)
  {
    char v51 = (char *)a2 + 7;
    __int16 v52 = a3 - 7;
  }

  int v19 = sub_1000B1814(*(unsigned __int16 *)(i + 8));
  ptr[1] = v19;
  if (!v19)
  {
    LOBYTE(v43[0]) = 1;
    BYTE1(v43[0]) = v50[0];
    WORD1(v43[0]) = *(_WORD *)&v50[1];
    char v17 = 17;
LABEL_9:
    BYTE4(v43[0]) = v17;
    return sub_1001A6168(a1, (char *)v43, 5uLL, 0LL);
  }

  LOWORD(v48) = *(_WORD *)(i + 8);
  WORD1(v48) = 1;
  *int v19 = 7;
  int v20 = sub_1001A9268((uint64_t)v50, (unsigned int *)&v45, a4);
  int v21 = v20;
  if (v20 == 240)
  {
    *((void *)&v45 + 1) = sub_1001A9494;
    uint64_t v32 = sub_1000B17F4(a3);
    *((void *)&v48 + 1) = v32;
    LOWORD(v49) = a3;
    if (v32)
    {
      memmove(v32, a2, a3);
      v43[2] = *(_OWORD *)ptr;
      v43[3] = v48;
      uint64_t v44 = v49;
      v43[0] = v45;
      v43[1] = v46;
      sub_1001A96E8(v43);
      return 4540LL;
    }

    goto LABEL_27;
  }

  if (v20)
  {
    LOBYTE(v43[0]) = 1;
    BYTE1(v43[0]) = v50[0];
    WORD1(v43[0]) = v18;
    BYTE4(v43[0]) = v20;
LABEL_28:
    uint64_t v33 = sub_1001A6168(a1, (char *)v43, 5uLL, 0LL);
    sub_1000B1838(ptr[1]);
    if ((_DWORD)v33)
    {
      if ((_DWORD)v33 != 412)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"ATT Send status %!", v34, v35, v36, v37, v38, v39, v40, v33);
          uint64_t v41 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }
      }
    }

    goto LABEL_33;
  }

  uint64_t v22 = ptr[1];
  if (sub_1001A6168(a1, (char *)ptr[1], WORD1(v48), 0LL))
  {
LABEL_27:
    LOBYTE(v43[0]) = 1;
    BYTE1(v43[0]) = v50[0];
    WORD1(v43[0]) = v18;
    BYTE4(v43[0]) = 17;
    goto LABEL_28;
  }

  sub_1000B1838(v22);
LABEL_33:
  if (v21) {
    return (v21 + 4300);
  }
  else {
    return 0LL;
  }
}

uint64_t sub_1001A7CC4(__int128 *a1, unsigned __int8 *a2, unsigned int a3, char a4)
{
  int v7 = *a2;
  uint64_t v70 = 0LL;
  *(_OWORD *)ptr = 0u;
  __int128 v69 = 0u;
  __int128 v66 = 0u;
  __int128 v67 = 0u;
  LODWORD(v66) = dword_1008E8938;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  *((void *)&v67 + 1) = i;
  if (a3 != 7 && a3 != 21)
  {
    if (sub_1000A86F0())
    {
      uint64_t v26 = "Type";
      if (v7 == 16) {
        uint64_t v26 = "Group Type";
      }
      sub_1001EE134((uint64_t)"Could not unpack Read By %s Request", v19, v20, v21, v22, v23, v24, v25, (uint64_t)v26);
      uint64_t v27 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    char v28 = *a2;
    v71[0] = 1;
    v71[1] = v28;
    *(_WORD *)&v71[2] = 0;
    char v29 = 4;
    goto LABEL_50;
  }

  uint64_t v9 = *(unsigned __int16 *)(a2 + 1);
  unsigned int v10 = *(unsigned __int16 *)(a2 + 3);
  sub_1001BEE18((int8x16_t *)(a2 + 5), (a3 - 5), 1, (uint64_t)v71);
  int v11 = *(_DWORD *)v71;
  uint64_t v12 = *(unsigned __int16 *)&v71[4];
  v78[0] = *(void *)&v71[6];
  *(void *)((char *)v78 + 6) = *(void *)&v71[12];
  if (v10 <= (unsigned __int16)(v9 - 1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid handle(s) (0x%04x, 0x%04x) for Read By %s Request",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  v9);
      uint64_t v37 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    char v29 = 1;
    v71[0] = 1;
    v71[1] = v7;
    *(_WORD *)&v71[2] = v9;
    goto LABEL_50;
  }

  if (v7 == 16)
  {
    uint64_t v13 = (uint64_t (*)(_BYTE *))xmmword_1008E8900;
    if (!(void)xmmword_1008E8900)
    {
      sub_1001EE2A0();
      uint64_t v13 = (uint64_t (*)(_BYTE *))xmmword_1008E8900;
    }

    *(_DWORD *)uint64_t v71 = v11;
    *(_WORD *)&v71[4] = v12;
    *(void *)&v71[6] = v78[0];
    *(void *)&v71[12] = *(void *)((char *)v78 + 6);
    if ((v13(v71) & 1) == 0)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid grouping type 0x%x for Read By Group Type Request",  v46,  v47,  v48,  v49,  v50,  v51,  v52,  v12);
        uint64_t v53 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      *(_WORD *)uint64_t v71 = 4097;
      *(_WORD *)&v71[2] = v9;
      char v29 = 16;
      goto LABEL_50;
    }
  }

  if (!i)
  {
    if (sub_1000A86F0())
    {
      uint64_t v45 = a1 ? *(unsigned __int16 *)a1 : 0LL;
      sub_1001EE134( (uint64_t)"Couldn't find active session for lmHandle 0x%x, Read By Type Request failed",  v38,  v39,  v40,  v41,  v42,  v43,  v44,  v45);
      uint64_t v64 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    v71[0] = 1;
    v71[1] = v7;
    *(_WORD *)&v71[2] = v9;
    char v29 = 14;
    goto LABEL_50;
  }

  LOWORD(ptr[0]) = v9;
  uint64_t v14 = sub_1000B1814(*(unsigned __int16 *)(i + 8));
  ptr[1] = v14;
  if (!v14)
  {
    v71[0] = 1;
    v71[1] = v7;
    *(_WORD *)&v71[2] = v9;
    char v29 = 17;
LABEL_50:
    v71[4] = v29;
    return sub_1001A6168(a1, v71, 5uLL, 0LL);
  }

  LOWORD(v69) = *(_WORD *)(i + 8);
  if (v7 == 16) {
    char v15 = 17;
  }
  else {
    char v15 = 9;
  }
  WORD1(v69) = 1;
  *uint64_t v14 = v15;
  int v75 = v11;
  __int16 v76 = v12;
  *(void *)uint64_t v77 = v78[0];
  *(void *)&v77[6] = *(void *)((char *)v78 + 6);
  int v16 = sub_1001A98C4(v7, v9, v10, (unsigned __int8 *)&v75, 0, (unsigned int *)&v66, a4);
  if (v16 == 240)
  {
    *((void *)&v66 + 1) = sub_1001A9ADC;
    char v17 = sub_1000B17F4(a3);
    *((void *)&v69 + 1) = v17;
    LOWORD(v70) = a3;
    if (v17)
    {
      memmove(v17, a2, a3);
      __int128 v72 = *(_OWORD *)ptr;
      __int128 v73 = v69;
      uint64_t v74 = v70;
      *(_OWORD *)uint64_t v71 = v66;
      *(_OWORD *)&v71[16] = v67;
      sub_1001A96E8(v71);
      return 4540LL;
    }

    v71[0] = 1;
    v71[1] = v7;
    *(_WORD *)&v71[2] = ptr[0];
    v71[4] = 17;
    uint64_t v55 = sub_1001A6168(a1, v71, 5uLL, 0LL);
    sub_1000B1838(ptr[1]);
    uint64_t result = 4540LL;
    if ((_DWORD)v55 && (_DWORD)v55 != 412)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ATT Send status %!", v56, v57, v58, v59, v60, v61, v62, v55);
        uint64_t v63 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      return 4540LL;
    }
  }

  else
  {
    int v54 = sub_1001A9D94(*a2, (uint64_t)&v66, v16);
    sub_1000B1838(ptr[1]);
    if (v54) {
      return (v54 + 4300);
    }
    else {
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001A8190(__int128 *a1, unsigned __int8 *a2, unsigned int a3, char a4)
{
  int v8 = *a2;
  memset(v53, 0, 5);
  uint64_t v52 = 0LL;
  *(_OWORD *)ptr = 0u;
  __int128 v51 = 0u;
  __int128 v48 = 0u;
  __int128 v49 = 0u;
  LODWORD(v48) = dword_1008E8938;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  *((void *)&v49 + 1) = i;
  if (v8 == 12) {
    int v10 = 5;
  }
  else {
    int v10 = 3;
  }
  if (v10 != a3)
  {
    if (sub_1000A86F0())
    {
      char v28 = "Read";
      if (v8 == 12) {
        char v28 = "Read Blob";
      }
      sub_1001EE134((uint64_t)"Could not unpack %s Request", v21, v22, v23, v24, v25, v26, v27, (uint64_t)v28);
      char v29 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    unsigned __int8 v30 = *a2;
    LOBYTE(v46[0]) = 1;
    BYTE1(v46[0]) = v30;
    WORD1(v46[0]) = 0;
    char v20 = 4;
    goto LABEL_23;
  }

  if (v8 == 12) {
    uint64_t v11 = 5LL;
  }
  else {
    uint64_t v11 = 3LL;
  }
  __memmove_chk(v53, a2, v11, 5LL);
  if (v8 == 12 && *(unsigned __int16 *)((char *)v53 + 3) >= 0x201u)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid offset (%u) for Read By Group Type Request",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  *(unsigned __int16 *)((char *)v53 + 3));
      uint64_t v19 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    LOBYTE(v46[0]) = 1;
    BYTE1(v46[0]) = v53[0];
    WORD1(v46[0]) = *(_WORD *)((char *)v53 + 1);
    char v20 = 7;
    goto LABEL_23;
  }

  uint64_t v32 = sub_1000B1814(*(unsigned __int16 *)(i + 8));
  ptr[1] = v32;
  if (!v32)
  {
    LOBYTE(v46[0]) = 1;
    BYTE1(v46[0]) = v53[0];
    WORD1(v46[0]) = *(_WORD *)((char *)v53 + 1);
    char v20 = 17;
LABEL_23:
    BYTE4(v46[0]) = v20;
    return sub_1001A6168(a1, (char *)v46, 5uLL, 0LL);
  }

  LOWORD(v51) = *(_WORD *)(i + 8);
  if (v8 == 12) {
    char v33 = 13;
  }
  else {
    char v33 = 11;
  }
  WORD1(v51) = 1;
  _BYTE *v32 = v33;
  int v34 = sub_1001A98C4( LOBYTE(v53[0]),  *(unsigned __int16 *)((char *)v53 + 1),  *(unsigned __int16 *)((char *)v53 + 1),  0LL,  *(unsigned __int16 *)((char *)v53 + 3),  (unsigned int *)&v48,  a4);
  if (v34 == 240)
  {
    *((void *)&v48 + 1) = sub_1001A9ADC;
    uint64_t v35 = sub_1000B17F4(a3);
    *((void *)&v51 + 1) = v35;
    LOWORD(v52) = a3;
    if (v35)
    {
      memmove(v35, a2, a3);
      v46[2] = *(_OWORD *)ptr;
      v46[3] = v51;
      uint64_t v47 = v52;
      v46[0] = v48;
      v46[1] = v49;
      sub_1001A96E8(v46);
      return 4540LL;
    }

    LOBYTE(v46[0]) = 1;
    BYTE1(v46[0]) = v53[0];
    WORD1(v46[0]) = *(_WORD *)((char *)v53 + 1);
    BYTE4(v46[0]) = 17;
    uint64_t v37 = sub_1001A6168(a1, (char *)v46, 5uLL, 0LL);
    sub_1000B1838(ptr[1]);
    uint64_t result = 4540LL;
    if ((_DWORD)v37 && (_DWORD)v37 != 412)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ATT Send status %!", v38, v39, v40, v41, v42, v43, v44, v37);
        uint64_t v45 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      return 4540LL;
    }
  }

  else
  {
    int v36 = sub_1001A9D94(*a2, (uint64_t)&v48, v34);
    sub_1000B1838(ptr[1]);
    if (v36) {
      return (v36 + 4300);
    }
    else {
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001A8500(__int128 *a1, unsigned __int8 *a2, unsigned int a3, char a4)
{
  uint64_t v66 = 0LL;
  *(_OWORD *)ptr = 0u;
  __int128 v65 = 0u;
  __int128 v62 = 0u;
  __int128 v63 = 0u;
  LODWORD(v62) = dword_1008E8938;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  *((void *)&v63 + 1) = i;
  if (a3 < 5 || (unsigned int v7 = a3 - 1, ((a3 - 1) & 1) != 0))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not unpack Read Multiple Request", v16, v17, v18, v19, v20, v21, v22, v55);
      uint64_t v23 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    LODWORD(v60[0]) = 3585;
    char v24 = 4;
LABEL_20:
    BYTE4(v60[0]) = v24;
    return sub_1001A6168(a1, (char *)v60, 5uLL, 0LL);
  }

  else
  {
    unsigned int v8 = 0;
    uint64_t v9 = a2 + 1;
    int v59 = *a2;
    unsigned int v56 = v7 >> 1;
    unsigned int v10 = (unsigned __int16)(v7 >> 1);
    do
    {
      uint64_t v11 = *(unsigned __int16 *)&v9[2 * v8];
      if (v11 >= (unsigned __int16)word_1008E88C0
        || *(_BYTE *)(*((void *)&xmmword_1008E88B0 + 1) + 16 * v11) != 2)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Handle 0x%04x is invalid!", v26, v27, v28, v29, v30, v31, v32, v11);
          char v33 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        char v24 = 1;
        LOBYTE(v60[0]) = 1;
        BYTE1(v60[0]) = v59;
        WORD1(v60[0]) = v11;
        goto LABEL_20;
      }

      int v12 = sub_1001A9E88( (uint64_t)a1,  *(unsigned __int8 *)(*(void *)(*((void *)&xmmword_1008E88B0 + 1) + 16 * v11 + 8) + 26LL),  1);
      if (v12)
      {
        char v34 = v12;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Handle 0x%04x does not have read permissions!",  v35,  v36,  v37,  v38,  v39,  v40,  v41,  v11);
          uint64_t v42 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        LOBYTE(v60[0]) = 1;
        BYTE1(v60[0]) = v59;
        WORD1(v60[0]) = v11;
        BYTE4(v60[0]) = v34;
        return sub_1001A6168(a1, (char *)v60, 5uLL, 0LL);
      }

      ++v8;
    }

    while (v8 < v10);
    uint64_t v13 = sub_1000B1814(*(unsigned __int16 *)(i + 8));
    ptr[1] = v13;
    if (!v13)
    {
      LOBYTE(v60[0]) = 1;
      BYTE1(v60[0]) = v59;
      WORD1(v60[0]) = 0;
      char v24 = 17;
      goto LABEL_20;
    }

    uint64_t v14 = 0LL;
    LOWORD(v65) = *(_WORD *)(i + 8);
    WORD1(v65) = 1;
    *uint64_t v13 = 15;
    while (1)
    {
      LOWORD(ptr[0]) = *(_WORD *)&a2[v14 + 1];
      int v15 = sub_1001A98C4(v59, LOWORD(ptr[0]), LOWORD(ptr[0]), 0LL, 0, (unsigned int *)&v62, a4);
      if (v15) {
        break;
      }
      v14 += 2LL;
      if (2LL * v56 == v14) {
        goto LABEL_35;
      }
    }

    if (v15 == 240)
    {
      *((void *)&v62 + 1) = sub_1001A9ADC;
      uint64_t v43 = sub_1000B17F4(a3);
      *((void *)&v65 + 1) = v43;
      LOWORD(v66) = a3;
      if (v43)
      {
        memmove(v43, a2, a3);
        v60[2] = *(_OWORD *)ptr;
        v60[3] = v65;
        uint64_t v61 = v66;
        v60[0] = v62;
        v60[1] = v63;
        sub_1001A96E8(v60);
        return 4540LL;
      }

      LOBYTE(v60[0]) = 1;
      BYTE1(v60[0]) = v59;
      WORD1(v60[0]) = ptr[0];
      BYTE4(v60[0]) = 17;
      uint64_t v46 = sub_1001A6168(a1, (char *)v60, 5uLL, 0LL);
      sub_1000B1838(ptr[1]);
      uint64_t result = 4540LL;
      if ((_DWORD)v46 && (_DWORD)v46 != 412)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"ATT Send status %!", v47, v48, v49, v50, v51, v52, v53, v46);
          int v54 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        return 4540LL;
      }
    }

    else
    {
LABEL_35:
      uint64_t v44 = ptr[1];
      int v45 = sub_1001A9D94(*a2, (uint64_t)&v62, v15);
      sub_1000B1838(v44);
      if (v45) {
        return (v45 + 4300);
      }
      else {
        return 0LL;
      }
    }
  }

  return result;
}

uint64_t sub_1001A88F0(__int128 *a1, unsigned __int8 *a2, unsigned int a3)
{
  int v6 = *a2;
  for (uint64_t i = *((void *)&xmmword_1008E88A0 + 1); i; uint64_t i = *(void *)(i + 24))
  {
  }

  unsigned int v8 = dword_1008E8938;
  if (v6 == 82)
  {
    BOOL v11 = 0;
    unsigned int v10 = "Write Command";
  }

  else
  {
    uint64_t v9 = "Prepare Write Request";
    if (v6 == 18) {
      uint64_t v9 = "Write Request";
    }
    if (v6 == 210) {
      unsigned int v10 = "Signed Write Command";
    }
    else {
      unsigned int v10 = v9;
    }
    BOOL v11 = v6 == 210;
    if (a3 <= 0xE && v6 == 210) {
      goto LABEL_31;
    }
  }

  BOOL v13 = a3 < 5 && v6 == 22;
  if (a3 < 3 || v13)
  {
LABEL_31:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not unpack %s", v27, v28, v29, v30, v31, v32, v33, (uint64_t)v10);
      char v34 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    if ((v6 | 4) != 0x16) {
      return 4021LL;
    }
    LODWORD(v92[0]) = 1;
    char v26 = 4;
LABEL_38:
    BYTE4(v92[0]) = v26;
    return sub_1001A6168(a1, (char *)v92, 5uLL, 0LL);
  }

  uint64_t v14 = *(unsigned __int16 *)(a2 + 1);
  if (v6 == 22)
  {
    __int16 v15 = 5;
    if (!v11) {
      goto LABEL_24;
    }
    goto LABEL_37;
  }

  __int16 v15 = 3;
  if (v11)
  {
LABEL_37:
    LOBYTE(v92[0]) = 1;
    BYTE1(v92[0]) = v6;
    WORD1(v92[0]) = v14;
    char v26 = 6;
    goto LABEL_38;
  }

uint64_t sub_1001A8FAC(__int128 *a1, char *a2, int a3)
{
  uint64_t v53 = 0LL;
  __int128 v51 = 0u;
  __int128 v52 = 0u;
  __int128 v49 = 0u;
  __int128 v50 = 0u;
  LODWORD(v49) = dword_1008E8938;
  uint64_t v5 = (__int128 **)*((void *)&xmmword_1008E88A0 + 1);
  if (*((void *)&xmmword_1008E88A0 + 1))
  {
    do
    {
      if (*v5 == a1) {
        break;
      }
      uint64_t v5 = (__int128 **)v5[3];
    }

    while (v5);
  }

  *((void *)&v50 + 1) = v5;
  if (a3 != 2)
  {
    LODWORD(v48[0]) = 6145;
    BYTE4(v48[0]) = 4;
    return sub_1001A6168(a1, (char *)v48, 5uLL, 0LL);
  }

  if (xmmword_1008E8920)
  {
    xmmword_1008E8920();
    v48[0] = 0LL;
    if (*((void *)&xmmword_1008E88D0 + 1)) {
      sub_1001EE2A0();
    }
    int v6 = sub_1000B17F4(0x48uLL);
    *((void *)&xmmword_1008E88D0 + 1) = v6;
    if (!v6)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Failed to backup Execute Write Request", v39, v40, v41, v42, v43, v44, v45, v47);
        __int16 v46 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 17LL;
    }

    *(_OWORD *)int v6 = v49;
    __int128 v7 = v50;
    __int128 v8 = v51;
    __int128 v9 = v52;
    v6[8] = v53;
    *((_OWORD *)v6 + 2) = v8;
    *((_OWORD *)v6 + 3) = v9;
    *((_OWORD *)v6 + 1) = v7;
    v48[1] = &v49;
    LOWORD(v48[0]) = 4;
    unsigned __int8 v10 = sub_1001EE6E8((uint64_t)sub_1001AA384, v48, 100, (int *)(*((void *)&xmmword_1008E88D0 + 1) + 16LL));
    uint64_t v11 = v10;
    if (v10)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Failed to create dispatch timer for execute write with result %!",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v11);
        uint64_t v19 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_1000B1838(*((void **)&xmmword_1008E88D0 + 1));
      *((void *)&xmmword_1008E88D0 + 1) = 0LL;
      return 17LL;
    }

    uint64_t result = 0LL;
    ++dword_1008E8938;
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"No callback provided to handle Execute Writes", v21, v22, v23, v24, v25, v26, v27, v47);
      uint64_t v28 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    char v29 = *a2;
    LOBYTE(v48[0]) = 1;
    BYTE1(v48[0]) = v29;
    WORD1(v48[0]) = 0;
    BYTE4(v48[0]) = 6;
    uint64_t v30 = sub_1001A6168(a1, (char *)v48, 5uLL, 0LL);
    uint64_t result = 4306LL;
    if ((_DWORD)v30 && (_DWORD)v30 != 412)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ATT Send status %!", v31, v32, v33, v34, v35, v36, v37, v30);
        uint64_t v38 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      return 4306LL;
    }
  }

  return result;
}

uint64_t sub_1001A9268(uint64_t a1, unsigned int *a2, char a3)
{
  __n_2[1] = 0LL;
  int v31 = 0;
  __n_2[0] = 2LL;
  WORD2(__n_2[0]) = *(_WORD *)(a1 + 5);
  unint64_t v4 = *(unsigned __int16 *)(a1 + 1);
  if (*(_WORD *)(a1 + 1))
  {
    BOOL v6 = v4 > *(unsigned __int16 *)(a1 + 3) || v4 >= (unsigned __int16)word_1008E88C0;
    if (!v6)
    {
      uint64_t v8 = 16 * v4;
      do
      {
        if (*(_BYTE *)(*((void *)&xmmword_1008E88B0 + 1) + v8) == 2)
        {
          __int128 v9 = *(char **)(*((void *)&xmmword_1008E88B0 + 1) + v8 + 8);
          if (sub_1001BEC7C((unsigned __int8 *)v9 + 4, (unsigned __int8 *)__n_2))
          {
            *((_WORD *)a2 + 16) = v4;
            if (!*(void *)(a1 + 7)) {
              goto LABEL_17;
            }
            unsigned __int8 v10 = sub_1000B17F4(0x200uLL);
            unsigned __int16 __n = 0;
            if (!v10) {
              return 17LL;
            }
            uint64_t v11 = v10;
            LOBYTE(v28) = a3;
            uint64_t v12 = (*((uint64_t (**)(char *, void, void *, uint64_t, unsigned __int16 *, void, void, void (*)(int, int, void *, size_t), int))v9
                   + 4))( v9,  0LL,  v10,  512LL,  &__n,  *a2,  *((void *)a2 + 3),  sub_1001A9494,  v28);
            if ((_DWORD)v12)
            {
              uint64_t v26 = v12;
              sub_1000B1838(v11);
              return v26;
            }

            if (__n == *(unsigned __int16 *)(a1 + 15) && !memcmp(v11, *(const void **)(a1 + 7), __n))
            {
              sub_1000B1838(v11);
LABEL_17:
              char v13 = *v9;
              uint64_t v14 = *((void *)a2 + 5);
              uint64_t v15 = *((unsigned __int16 *)a2 + 25);
              *((_WORD *)a2 + 25) = v15 + 1;
              *(_BYTE *)(v14 + v15) = v13;
              char v16 = v9[1];
              uint64_t v17 = *((void *)a2 + 5);
              uint64_t v18 = *((unsigned __int16 *)a2 + 25);
              *((_WORD *)a2 + 25) = v18 + 1;
              *(_BYTE *)(v17 + v18) = v16;
              char v19 = v9[24];
              uint64_t v20 = *((void *)a2 + 5);
              uint64_t v21 = *((unsigned __int16 *)a2 + 25);
              *((_WORD *)a2 + 25) = v21 + 1;
              *(_BYTE *)(v20 + v21) = v19;
              char v22 = v9[25];
              uint64_t v23 = *((void *)a2 + 5);
              uint64_t v24 = *((unsigned __int16 *)a2 + 25);
              *((_WORD *)a2 + 25) = v24 + 1;
              *(_BYTE *)(v23 + v24) = v22;
              goto LABEL_18;
            }

            sub_1000B1838(v11);
          }
        }

void sub_1001A9494(int a1, int a2, void *__s1, size_t __n)
{
  uint64_t v4 = (unsigned __int16)xmmword_1008E88D0;
  if ((_WORD)xmmword_1008E88D0)
  {
    unsigned int v5 = __n;
    for (uint64_t i = qword_1008E88C8; *(_DWORD *)i != a1; i += 72LL)
    {
      if (!--v4) {
        return;
      }
    }

    __int128 v9 = *(_DWORD **)(i + 56);
    if (!v9 || (unsigned int v10 = *(unsigned __int16 *)(i + 64), v10 <= 7))
    {
      sub_1001EE2A0();
      __int128 v9 = *(_DWORD **)(i + 56);
      LOWORD(v10) = *(_WORD *)(i + 64);
    }

    *(_DWORD *)uint64_t v35 = *v9;
    *(_DWORD *)&v35[3] = *(_DWORD *)((char *)v9 + 3);
    uint64_t v36 = (char *)v9 + 7;
    __int16 v37 = v10 - 7;
    if (a2)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Failed to read value at attribute handle 0x%04x with result %d",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  *(unsigned __int16 *)(i + 32));
        uint64_t v18 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      char v19 = **(__int128 ***)(i + 24);
      char v38 = 1;
      char v39 = v35[0];
      __int16 v40 = *(_WORD *)&v35[1];
      char v41 = a2;
      goto LABEL_14;
    }

    if (v5 == (unsigned __int16)(v10 - 7) && !memcmp(__s1, (char *)v9 + 7, v5))
    {
      uint64_t v20 = *(char **)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * *(unsigned __int16 *)(i + 32) + 8);
      char v21 = *v20;
      uint64_t v22 = *(void *)(i + 40);
      uint64_t v23 = *(unsigned __int16 *)(i + 50);
      *(_WORD *)(i + 50) = v23 + 1;
      *(_BYTE *)(v22 + v23) = v21;
      char v24 = v20[1];
      uint64_t v25 = *(void *)(i + 40);
      uint64_t v26 = *(unsigned __int16 *)(i + 50);
      *(_WORD *)(i + 50) = v26 + 1;
      *(_BYTE *)(v25 + v26) = v24;
      char v27 = v20[24];
      uint64_t v28 = *(void *)(i + 40);
      uint64_t v29 = *(unsigned __int16 *)(i + 50);
      *(_WORD *)(i + 50) = v29 + 1;
      *(_BYTE *)(v28 + v29) = v27;
      LOBYTE(v20) = v20[25];
      uint64_t v30 = *(void *)(i + 40);
      uint64_t v31 = *(unsigned __int16 *)(i + 50);
      *(_WORD *)(i + 50) = v31 + 1;
      *(_BYTE *)(v30 + v31) = (_BYTE)v20;
    }

    __int16 v32 = *(_WORD *)(i + 32) + 1;
    *(_WORD *)&v35[1] = v32;
    int v33 = sub_1001A9268(v35, i, 0LL);
    if (v33 != 240)
    {
      if (v33)
      {
        uint64_t v34 = **(__int128 ***)(i + 24);
        char v38 = 1;
        char v39 = v35[0];
        __int16 v40 = v32;
        char v41 = v33;
        char v19 = v34;
      }

      else
      {
        if (!sub_1001A6168( **(__int128 ***)(i + 24),  *(char **)(i + 40),  *(unsigned __int16 *)(i + 50),  0LL)) {
          goto LABEL_15;
        }
        char v19 = **(__int128 ***)(i + 24);
        char v38 = 1;
        char v39 = v35[0];
        __int16 v40 = v32;
        char v41 = 17;
      }

void sub_1001A96E8(void *a1)
{
  uint64_t v2 = (char *)sub_1000B1814(72LL * (unsigned __int16)xmmword_1008E88D0 + 72);
  if (v2)
  {
    uint64_t v3 = v2;
    v18[0] = 0LL;
    uint64_t v4 = &v2[72 * (unsigned __int16)xmmword_1008E88D0];
    *(_OWORD *)uint64_t v4 = *(_OWORD *)a1;
    uint64_t v5 = a1[8];
    __int128 v7 = *((_OWORD *)a1 + 2);
    __int128 v6 = *((_OWORD *)a1 + 3);
    *((_OWORD *)v4 + 1) = *((_OWORD *)a1 + 1);
    *((_OWORD *)v4 + 2) = v7;
    *((_OWORD *)v4 + 3) = v6;
    *((void *)v4 + 8) = v5;
    v18[1] = a1;
    LOWORD(v18[0]) = 4;
    uint64_t v8 = sub_1001EE6E8((uint64_t)sub_1001A9838, v18, 100, (int *)&v2[72 * (unsigned __int16)xmmword_1008E88D0 + 16]);
    if ((_DWORD)v8)
    {
      uint64_t v9 = v8;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Failed to create dispatch timer for async response with result %!",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v9);
        uint64_t v17 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      sub_1000B1838(v3);
    }

    else
    {
      if (qword_1008E88C8)
      {
        memmove(v3, (const void *)qword_1008E88C8, 72LL * (unsigned __int16)xmmword_1008E88D0);
        sub_1000B1838((void *)qword_1008E88C8);
      }

      qword_1008E88C8 = (uint64_t)v3;
      LOWORD(xmmword_1008E88D0) = xmmword_1008E88D0 + 1;
      ++dword_1008E8938;
    }
  }

uint64_t sub_1001A9838(uint64_t result)
{
  uint64_t v1 = (unsigned __int16)xmmword_1008E88D0;
  if ((_WORD)xmmword_1008E88D0)
  {
    uint64_t result = **(unsigned int **)(result + 8);
    for (uint64_t i = (unsigned int *)qword_1008E88C8; *i != (_DWORD)result; i += 18)
    {
      if (!--v1) {
        return result;
      }
    }

    i[4] = 0;
    uint64_t v3 = (void (*)(uint64_t))*((void *)&xmmword_1008E8900 + 1);
    if (!*((void *)&xmmword_1008E8900 + 1))
    {
      sub_1001EE2A0();
      uint64_t v3 = (void (*)(uint64_t))*((void *)&xmmword_1008E8900 + 1);
      uint64_t result = *i;
    }

    v3(result);
    return (*((uint64_t (**)(void, uint64_t, void, void))i + 1))(*i, 241LL, 0LL, 0LL);
  }

  return result;
}

uint64_t sub_1001A98C4( int a1, unsigned int a2, unsigned int a3, unsigned __int8 *a4, unsigned int a5, unsigned int *a6, char a7)
{
  if (a1 == 8
    || a1 == 16
    || (uint64_t v9 = 1LL, a2)
    && (unsigned __int16)word_1008E88C0 > a2
    && *(_BYTE *)(*((void *)&xmmword_1008E88B0 + 1) + 16LL * a2) == 2)
  {
    uint64_t v9 = 0LL;
    if (a2 - 1 < a3 && (unsigned __int16)word_1008E88C0 > a2)
    {
      unint64_t v10 = a2;
      uint64_t v11 = 16LL * a2;
      unint64_t v12 = a3;
      while (1)
      {
        *((_WORD *)a6 + 16) = v10;
        if (*(_BYTE *)(*((void *)&xmmword_1008E88B0 + 1) + v11) == 2)
        {
          uint64_t v13 = *(void *)(*((void *)&xmmword_1008E88B0 + 1) + v11 + 8);
          unsigned __int16 v23 = 0;
          if (!a4 || sub_1001BEC7C((unsigned __int8 *)(v13 + 4), a4))
          {
            if (*((void *)&xmmword_1008E8920 + 1)
              && !sub_1001BEC7C((unsigned __int8 *)(v13 + 4), (unsigned __int8 *)&xmmword_1006BD89C)
              && !sub_1001BEC7C((unsigned __int8 *)(v13 + 4), (unsigned __int8 *)&xmmword_1006BD8B0)
              && !sub_1001BEC7C((unsigned __int8 *)(v13 + 4), (unsigned __int8 *)&xmmword_1006BD8C4))
            {
              (*((void (**)(uint64_t, void))&xmmword_1008E8920 + 1))(v13, *((void *)a6 + 3));
            }

            uint64_t v14 = sub_1001A9E88(**((void **)a6 + 3), *(unsigned __int8 *)(v13 + 26), 1);
            if ((_DWORD)v14) {
              return v14;
            }
            uint64_t v15 = sub_1000B17F4(0x200uLL);
            if (!v15) {
              return 17LL;
            }
            uint64_t v16 = v15;
            LOBYTE(v19) = a7;
            uint64_t v17 = (*(uint64_t (**)(uint64_t, void, void *, uint64_t, unsigned __int16 *, void, void, void (*)(int, int, void *, int), int))(v13 + 32))( v13,  a5,  v15,  512LL,  &v23,  *a6,  *((void *)a6 + 3),  sub_1001A9ADC,  v19);
            if ((_DWORD)v17 || (uint64_t v17 = sub_1001A9FF8(a1, (char *)v13, v16, v23, (uint64_t)a6), (_DWORD)v17))
            {
              uint64_t v9 = v17;
              sub_1000B1838(v16);
              return v9;
            }

            sub_1000B1838(v16);
          }
        }

        uint64_t v9 = 0LL;
        if (v10 < v12)
        {
          ++v10;
          v11 += 16LL;
        }

        return v9;
      }
    }
  }

  return v9;
}

void sub_1001A9ADC(int a1, int a2, void *a3, int a4)
{
  uint64_t v4 = (unsigned __int16)xmmword_1008E88D0;
  if (!(_WORD)xmmword_1008E88D0) {
    return;
  }
  for (uint64_t i = qword_1008E88C8; *(_DWORD *)i != a1; i += 72LL)
  {
    if (!--v4) {
      return;
    }
  }

  uint64_t v7 = **(unsigned __int8 **)(i + 56);
  uint64_t v8 = *(unsigned __int16 *)(i + 32);
  if (v8 >= (unsigned __int16)word_1008E88C0
    || (uint64_t v9 = *(char **)(*((void *)&xmmword_1008E88B0 + 1) + 16 * v8 + 8)) == 0LL)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Attribute handle 0x%04x is no longer available for transaction ID %d",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  *(unsigned __int16 *)(i + 32));
      uint64_t v20 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    a2 = 14;
    goto LABEL_21;
  }

  if (a2 || (a2 = sub_1001A9FF8(**(unsigned __int8 **)(i + 56), v9, a3, a4, i)) != 0)
  {
LABEL_21:
    sub_1001A9D94(v7, i, a2);
    sub_1001A6960(i);
    return;
  }

  a2 = 0;
  switch((int)v7)
  {
    case 8:
    case 16:
      uint64_t v10 = *(void *)(i + 56);
      if (!v10 || (unsigned int v11 = *(unsigned __int16 *)(i + 64), v11 <= 5))
      {
        sub_1001EE2A0();
        uint64_t v10 = *(void *)(i + 56);
        LOBYTE(v11) = *(_BYTE *)(i + 64);
      }

      __int128 v30 = 0uLL;
      int v31 = 0;
      uint64_t v12 = *(unsigned __int16 *)(v10 + 3);
      sub_1001BEE18((int8x16_t *)(v10 + 5), (v11 - 5), 1, (uint64_t)&v30);
      __int128 v28 = v30;
      int v29 = v31;
      a2 = sub_1001A98C4(v7, (unsigned __int16)(*(_WORD *)(i + 32) + 1), v12, &v28, 0LL, i, 0LL);
      goto LABEL_15;
    case 10:
    case 12:
      goto LABEL_21;
    default:
      uint64_t v21 = *(void *)(i + 56);
      if (!v21 || (int v22 = *(unsigned __int16 *)(i + 64), v22 <= 1))
      {
        sub_1001EE2A0();
        int v22 = *(unsigned __int16 *)(i + 64);
        uint64_t v21 = *(void *)(i + 56);
      }

      int v23 = v22 - 1;
      if (v22 < 1) {
        int v23 = v22;
      }
      unsigned int v24 = v23 >> 1;
      uint64_t v25 = v21 + 1;
      if (v22 < 3)
      {
        LOWORD(v26) = 0;
        goto LABEL_34;
      }

      LOWORD(v26) = 0;
      break;
  }

  while (*(unsigned __int16 *)(v25 + 2LL * (unsigned __int16)v26) != *(unsigned __int16 *)(i + 32))
  {
    LOWORD(v26) = v26 + 1;
    if ((unsigned __int16)v26 >= (unsigned __int16)v24)
    {
      int v26 = v23 >> 1;
      break;
    }
  }

uint64_t sub_1001A9D94(int a1, uint64_t a2, int a3)
{
  char v4 = a1;
  if ((a1 == 16 || a1 == 8) && a3 == 0)
  {
    if (*(_WORD *)(a2 + 50) != 1) {
      goto LABEL_16;
    }
    LOBYTE(a3) = 10;
  }

  else if (!a3 || a3 == 243)
  {
    goto LABEL_16;
  }

  if (a1 != 16 && a1 != 8 || *(unsigned __int16 *)(a2 + 50) < 2u)
  {
    __int16 v11 = *(_WORD *)(a2 + 32);
    uint64_t v9 = **(__int128 ***)(a2 + 24);
    v15[0] = 1;
    v15[1] = v4;
    __int16 v16 = v11;
    char v17 = a3;
    uint64_t v10 = v15;
    goto LABEL_19;
  }

uint64_t sub_1001A9E88(uint64_t a1, int a2, int a3)
{
  char v19 = 0;
  if ((a2 & 0x15) == 0 && (a3 & 1) != 0) {
    return 2LL;
  }
  if ((a2 & 0x2A) == 0 && !a3) {
    return 3LL;
  }
  if (a3) {
    int v5 = 20;
  }
  else {
    int v5 = 40;
  }
  if ((v5 & a2) == 0) {
    return 0LL;
  }
  int v6 = a2 & 0x30;
  int v7 = a2 & 0xC;
  if (!a1) {
    goto LABEL_33;
  }
  if (*(_BYTE *)(a1 + 2) == 4)
  {
    int v8 = sub_1001C902C(a1);
    int v9 = sub_1001C8ECC(a1);
    char v19 = sub_1001C8F50(a1);
    goto LABEL_20;
  }

  if (*(_BYTE *)(a1 + 2))
  {
LABEL_33:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid physical link at permission check", v10, v11, v12, v13, v14, v15, v16, v18);
      char v17 = (os_log_s *)sub_100086554(0x44u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    int v8 = 0;
    int v9 = 0;
  }

  else
  {
    int v8 = sub_1001E6578(a1, &v19);
    int v9 = sub_1001E64D0(a1);
  }

uint64_t sub_1001A9FF8(int a1, char *a2, void *__src, int a4, uint64_t a5)
{
  unsigned __int16 v6 = 0;
  switch(a1)
  {
    case 8:
      unsigned int v9 = *(unsigned __int16 *)(a5 + 48);
      if (v9 >= 0x101) {
        unsigned __int16 v6 = 253;
      }
      else {
        unsigned __int16 v6 = v9 - 4;
      }
      int v7 = 2;
      goto LABEL_16;
    case 10:
    case 12:
    case 14:
      unsigned __int16 v6 = *(_WORD *)(a5 + 48) - 1;
      goto LABEL_3;
    case 16:
      unsigned int v10 = *(unsigned __int16 *)(a5 + 48);
      if (v10 >= 0x101) {
        unsigned __int16 v6 = 251;
      }
      else {
        unsigned __int16 v6 = v10 - 6;
      }
      int v7 = 4;
      goto LABEL_16;
    default:
LABEL_3:
      int v7 = 0;
      if (a1 == 16 || a1 == 8)
      {
LABEL_16:
        else {
          int v8 = a4;
        }
        uint64_t v11 = *(unsigned __int16 *)(a5 + 50);
        int v12 = v7 + v8;
        uint64_t v14 = *(void *)(a5 + 40);
        if (v11 >= 2 && *(_BYTE *)(v14 + 1))
        {
        }

        else
        {
          *(_WORD *)(a5 + 50) = v11 + 1;
          *(_BYTE *)(v14 + v11) = v12;
          uint64_t v14 = *(void *)(a5 + 40);
          LODWORD(v11) = *(unsigned __int16 *)(a5 + 50);
        }

        char v15 = *a2;
        *(_WORD *)(a5 + 50) = v11 + 1;
        *(_BYTE *)(v14 + v11) = v15;
        char v16 = a2[1];
        uint64_t v17 = *(void *)(a5 + 40);
        uint64_t v18 = *(unsigned __int16 *)(a5 + 50);
        *(_WORD *)(a5 + 50) = v18 + 1;
        *(_BYTE *)(v17 + v18) = v16;
        if (a1 == 16)
        {
          char v19 = a2[24];
          uint64_t v20 = *(void *)(a5 + 40);
          uint64_t v21 = *(unsigned __int16 *)(a5 + 50);
          *(_WORD *)(a5 + 50) = v21 + 1;
          *(_BYTE *)(v20 + v21) = v19;
          char v22 = a2[25];
          uint64_t v23 = *(void *)(a5 + 40);
          uint64_t v24 = *(unsigned __int16 *)(a5 + 50);
          *(_WORD *)(a5 + 50) = v24 + 1;
          *(_BYTE *)(v23 + v24) = v22;
        }
      }

      else if (*(unsigned __int16 *)(a5 + 48) - *(unsigned __int16 *)(a5 + 50) >= a4)
      {
        LOWORD(v8) = a4;
      }

      else
      {
        LOWORD(v8) = *(_WORD *)(a5 + 48) - *(_WORD *)(a5 + 50);
      }

      memmove((void *)(*(void *)(a5 + 40) + *(unsigned __int16 *)(a5 + 50)), __src, (unsigned __int16)v8);
      unsigned __int16 v25 = *(_WORD *)(a5 + 50) + v8;
      *(_WORD *)(a5 + 50) = v25;
      else {
        return 0;
      }
  }

void sub_1001AA1A4(int a1, int a2)
{
  uint64_t v2 = (unsigned __int16)xmmword_1008E88D0;
  if ((_WORD)xmmword_1008E88D0)
  {
    for (uint64_t i = qword_1008E88C8; *(_DWORD *)i != a1; i += 72LL)
    {
      if (!--v2) {
        return;
      }
    }

    int v5 = *(unsigned __int8 **)(i + 56);
    int v6 = *v5;
    if (v6 == 22)
    {
      size_t v7 = *(unsigned __int16 *)(i + 64) - 1LL;
      uint64_t v8 = *(unsigned __int16 *)(i + 50);
      if ((int)v7 > *(unsigned __int16 *)(i + 48) - (int)v8)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Write rejected: response->responseBuffer buffer space (%d) is too small for response->context (%d).",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  *(unsigned __int16 *)(*(void *)(i + 24) + 8LL) - *(unsigned __int16 *)(i + 50));
          char v16 = (os_log_s *)sub_100086554(0x44u);
          if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        LOBYTE(a2) = -11;
        goto LABEL_14;
      }

      memmove((void *)(*(void *)(i + 40) + v8), v5 + 1, v7);
      *(_WORD *)(i + 50) = *(_WORD *)(i + 64) + *(_WORD *)(i + 50) - 1;
    }

    if (!a2)
    {
      if (!sub_1001A6168( **(__int128 ***)(i + 24),  *(char **)(i + 40),  *(unsigned __int16 *)(i + 50),  0LL)) {
        goto LABEL_19;
      }
      __int16 v28 = *(_WORD *)(i + 32);
      int v26 = **(__int128 ***)(i + 24);
      v29[0] = 1;
      v29[1] = v6;
      __int16 v30 = v28;
      char v31 = 17;
      unsigned __int16 v27 = v29;
LABEL_18:
      sub_1001A6168(v26, v27, 5uLL, 0LL);
LABEL_19:
      sub_1001A6960(i);
      return;
    }

uint64_t sub_1001AA384(uint64_t result)
{
  uint64_t v1 = (unsigned int *)*((void *)&xmmword_1008E88D0 + 1);
  if (*((void *)&xmmword_1008E88D0 + 1))
  {
    uint64_t result = **(unsigned int **)(result + 8);
    if (**((_DWORD **)&xmmword_1008E88D0 + 1) == (_DWORD)result)
    {
      *(_DWORD *)(*((void *)&xmmword_1008E88D0 + 1) + 16LL) = 0;
      uint64_t v2 = (void (*)(uint64_t))*((void *)&xmmword_1008E8900 + 1);
      if (!*((void *)&xmmword_1008E8900 + 1))
      {
        sub_1001EE2A0();
        uint64_t v2 = (void (*)(uint64_t))*((void *)&xmmword_1008E8900 + 1);
        uint64_t result = *v1;
      }

      v2(result);
      return sub_1001AA3F4(*v1, 241, 0LL);
    }
  }

  return result;
}

uint64_t sub_1001AA3F4(uint64_t result, int a2, uint64_t a3)
{
  uint64_t v3 = *((void *)&xmmword_1008E88D0 + 1);
  if (*((void *)&xmmword_1008E88D0 + 1) && **((_DWORD **)&xmmword_1008E88D0 + 1) == (_DWORD)result)
  {
    char v4 = a2;
    if (a2)
    {
      if (word_1008E88C0)
      {
        uint64_t v5 = 0LL;
        int v6 = (void *)(*((void *)&xmmword_1008E88B0 + 1) + 8LL);
        while (*((_BYTE *)v6 - 8) != 2 || *v6 != a3)
        {
          v6 += 2;
        }
      }

      else
      {
LABEL_9:
        LOWORD(v5) = 0;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Execute write failed at attribute handle 0x%04x with result %d",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  *(unsigned __int16 *)(v3 + 32));
        uint64_t v14 = (os_log_s *)sub_100086554(0x44u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      uint64_t v15 = **(__int128 ***)(v3 + 24);
      v20[0] = 6145;
      v20[1] = v5;
      char v21 = v4;
      char v16 = (char *)v20;
    }

    else
    {
      char v17 = 25;
      if (!sub_1001A6168( **(__int128 ***)(*((void *)&xmmword_1008E88D0 + 1) + 24LL),  &v17,  1uLL,  0LL))
      {
LABEL_17:
        sub_1000B1838(*((void **)&xmmword_1008E88D0 + 1));
        *((void *)&xmmword_1008E88D0 + 1) = 0LL;
        return sub_1001A64F4(0LL, 1LL);
      }

      uint64_t v15 = **(__int128 ***)(v3 + 24);
      int v18 = 6145;
      char v19 = 17;
      char v16 = (char *)&v18;
    }

    sub_1001A6168(v15, v16, 5uLL, 0LL);
    goto LABEL_17;
  }

  return result;
}

const char *sub_1001AA55C(unsigned int a1)
{
  if (a1 > 7) {
    return "unknown";
  }
  else {
    return off_100885F98[a1];
  }
}

void sub_1001AA580()
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Resetting LE_Connection state", v0, v1, v2, v3, v4, v5, v6, *(uint64_t *)v8);
    uint64_t v7 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v8 = 136446210;
      *(void *)&v8[4] = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", v8, 0xCu);
    }
  }

  byte_1008E8940 = 0;
  byte_1008E8964 = 0;
  byte_1008E8941 = 0;
  byte_1008E8968 = 0;
  qword_1008E8954 = 0LL;
  *(void *)&word_1008E895C = 0LL;
  qword_1008E894C = 0LL;
}

void sub_1001AA668()
{
  byte_1008E8940 = 0;
  byte_1008E8964 = 0;
  byte_1008E8941 = 0;
  byte_1008E8968 = 0;
  qword_1008E8954 = 0LL;
  *(void *)&word_1008E895C = 0LL;
  qword_1008E894C = 0LL;
}

void sub_1001AA69C(uint64_t a1)
{
  if (!sub_10012D5EC(a1)) {
    sub_1001EE2A0();
  }
  if (sub_10012D5EC(a1))
  {
    uint64_t v2 = (unsigned int *)(a1 + 204);
    if (*(int *)(a1 + 204) <= 254)
    {
      do
        unsigned int v11 = __ldxr(v2);
      while (__stxr(v11 + 1, v2));
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Reached max connection retain count. Not incrementing ref count",  v3,  v4,  v5,  v6,  v7,  v8,  v9,  v20);
        uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"This command is only available to LE devices.", v12, v13, v14, v15, v16, v17, v18, v20);
    char v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

void sub_1001AA788(uint64_t a1)
{
  if (!sub_10012D5EC(a1)) {
    sub_1001EE2A0();
  }
  if (sub_10012D5EC(a1))
  {
    uint64_t v3 = (unsigned int *)(a1 + 204);
    int v2 = *(_DWORD *)(a1 + 204);
    if (v2 < 255)
    {
      if (v2 <= 0) {
        sub_1001EE2A0();
      }
      do
        unsigned int v20 = __ldxr(v3);
      while (__stxr(v20 - 1, v3));
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Reached max connection retain count. Not decrementing ref count",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  v21);
        unsigned int v11 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE connection is invalid, can't decrement", v12, v13, v14, v15, v16, v17, v18, v21);
    char v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

uint64_t sub_1001AA87C( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, __int16 a6, uint64_t a7, uint64_t a8, unsigned __int8 a9)
{
  if (byte_1008E8940 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, pending attempt already in progress.",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v136);
      uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1309LL;
  }

  if (byte_1008E8941 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, pending cancel connection already in progress.",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  v136);
      __int16 v25 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1319LL;
  }

  if ((a9 & a8) != 0xFF && !byte_1008E8942)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, V2 command not supported.",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  v136);
      char v41 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 152LL;
  }

  if (sub_10012D98C((_DWORD *)a1))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Already connected to this address.", v42, v43, v44, v45, v46, v47, v48, v136);
      __int128 v49 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 133LL;
  }

  if ((a8 + 16) <= 0xEu)
  {
    sub_1001EE134((uint64_t)"Invalid advertising handle %x", v50, v51, v52, v53, v54, v55, v56, a8);
    uint64_t v57 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if ((char)a9 <= -2)
  {
    sub_1001EE134((uint64_t)"Invalid subevent %x", v58, v59, v60, v61, v62, v63, v64, a9);
    uint64_t v65 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if ((a2 - 16385) <= 0xFFFFC002)
  {
    sub_1001EE134((uint64_t)"Invalid scan interval %d", v66, v67, v68, v69, v70, v71, v72, a2);
    __int128 v73 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if ((a3 - 16385) <= 0xFFFFC002)
  {
    sub_1001EE134((uint64_t)"Invalid scan window %d", v74, v75, v76, v77, v78, v79, v80, a3);
    uint64_t v81 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v81, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if (a5 >= 0x1F5)
  {
    sub_1001EE134((uint64_t)"Invalid connection latency %d", v82, v83, v84, v85, v86, v87, v88, a5);
    uint64_t v89 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v89, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  unsigned int v90 = (int)((double)a4 / 1.25);
  if ((unsigned __int16)(v90 - 3201) <= 0xF384u)
  {
    sub_1001EE134((uint64_t)"Invalid connection interval %dms", v91, v92, v93, v94, v95, v96, v97, a4);
    __int16 v98 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v98, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if (v90 - 8 <= 8) {
    int v99 = 8;
  }
  else {
    int v99 = (unsigned __int16)(v90 - 8);
  }
  unsigned int v100 = (3 * a5 + 3) * v90;
  if (v100 >= 0x259)
  {
    sub_1001EE134( (uint64_t)"Connection latency (%d) and connection interval (%d ms) are in a range taht will cause issues",  v101,  v102,  v103,  v104,  v105,  v106,  v107,  a5);
    uint64_t v108 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v108, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_56;
  }

  if ((a7 - 8) <= 0xFFFFFFF8)
  {
    sub_1001EE134((uint64_t)"Invalid initPHYs %x", v109, v110, v111, v112, v113, v114, v115, a7);
    uint64_t v116 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v116, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
LABEL_56:
    sub_100657858();
    return 101LL;
  }

  unsigned int v138 = v99;
  __int16 v139 = v100;
  sub_1001BDFB4((uint64_t)&dword_1008E8943);
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Connecting with interval:%dms-%dms, latency=%d, timeout=%dms, initPHYs=%x connectingAddress=%s:%:, advHan dle=%x subevent=%x",  v118,  v119,  v120,  v121,  v122,  v123,  v124,  ((double)v138 * 1.25));
    log = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(log, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v141 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, log, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  *(_WORD *)__int128 buf = a2;
  *(_WORD *)&buf[2] = a2;
  LOWORD(v141) = a2;
  if (byte_1008E8942)
  {
    uint64_t v125 = 256LL;
  }

  else if (byte_1008E894A)
  {
    uint64_t v125 = 217LL;
  }

  else
  {
    uint64_t v125 = 173LL;
  }

  uint64_t v17 = sub_100128D24(v125);
  if ((_DWORD)v17)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Could not connect to device %!", v126, v127, v128, v129, v130, v131, v132, v17);
      uint64_t v133 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v133, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }
  }

  else
  {
    byte_1008E8940 = 1;
    LOBYTE(qword_1008E894C) = 1;
    __int16 v134 = *(_WORD *)(a1 + 4);
    char v135 = *(_BYTE *)(a1 + 6);
    *(_DWORD *)((char *)&qword_1008E894C + 3) = *(_DWORD *)a1;
    BYTE1(qword_1008E8954) = v135;
    *(_WORD *)((char *)&qword_1008E894C + 7) = v134;
    WORD1(qword_1008E8954) = a2;
    WORD2(qword_1008E8954) = a3;
    HIWORD(qword_1008E8954) = a4;
    word_1008E895C = a5;
    word_1008E895E = v139;
    word_1008E8960 = a6;
    byte_1008E8962 = a7;
    BYTE1(qword_1008E894C) = a8;
    BYTE2(qword_1008E894C) = a9;
  }

  return v17;
}

uint64_t sub_1001AB0A4( uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4, uint64_t a5, __int16 a6, uint64_t a7, uint64_t a8, unsigned __int8 a9, unsigned __int8 a10)
{
  __int16 v166 = 0;
  v165[1] = 0;
  if (byte_1008E8940 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, pending attempt already in progress.",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v159);
      uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1309LL;
  }

  if (byte_1008E8941 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, pending cancel connection already in progress.",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  v159);
      int v26 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1319LL;
  }

  if ((a10 & a9) != 0xFF && byte_1008E8942 == 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Cannot connect to device, V2 command not supported.",  v45,  v46,  v47,  v48,  v49,  v50,  v51,  v159);
      uint64_t v52 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 152LL;
  }

  v165[0] = 0;
  uint64_t v34 = sub_1001D5C38(v165);
  if (!v165[0])
  {
LABEL_19:
    if ((a9 + 16) <= 0xEu)
    {
      sub_1001EE134((uint64_t)"Invalid advertising handle %x", v37, v38, v39, v40, v41, v42, v43, a9);
      uint64_t v44 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_80;
    }

    if ((char)a10 <= -2)
    {
      sub_1001EE134((uint64_t)"Invalid subevent %x", v53, v54, v55, v56, v57, v58, v59, a10);
      uint64_t v60 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v60, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_80;
    }

    if ((a1 - 16385) <= 0xFFFFC002)
    {
      sub_1001EE134((uint64_t)"Invalid scan interval %d", v69, v70, v71, v72, v73, v74, v75, a1);
      uint64_t v76 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v76, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_80;
    }

    if ((a2 - 16385) <= 0xFFFFC002)
    {
      sub_1001EE134((uint64_t)"Invalid scan window %d", v77, v78, v79, v80, v81, v82, v83, a2);
      uint64_t v84 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v84, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_80;
    }

    if (a5 >= 0x1F5)
    {
      sub_1001EE134((uint64_t)"Invalid connection latency %d", v85, v86, v87, v88, v89, v90, v91, a5);
      uint64_t v92 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v92, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
      goto LABEL_80;
    }

    unsigned int v93 = a3;
    if (a4 <= (unsigned __int16)(a3 - 1))
    {
      if (!(_DWORD)a3 || a4 != (_DWORD)a3 && a4)
      {
        sub_1001EE134( (uint64_t)"Invalid min/max connection interval %d/%d",  v112,  v113,  v114,  v115,  v116,  v117,  v118,  a3);
        uint64_t v119 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v119, OS_LOG_TYPE_ERROR)) {
          return 101LL;
        }
        goto LABEL_80;
      }

      double v128 = (double)a3 / 1.25;
      unsigned int v94 = (int)v128;
      if (((int)v128 - 6) >= 0xC7B)
      {
        sub_1001EE134((uint64_t)"Invalid connection interval %dms", v141, v142, v143, v144, v145, v146, v147, a3);
        uint64_t v148 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v148, OS_LOG_TYPE_ERROR)) {
          return 101LL;
        }
        goto LABEL_80;
      }

      if (v94 < 0xC78)
      {
        if (v94 > 0xE)
        {
          LOWORD(a4) = v94 + 8;
          LOWORD(v94) = v94 - 8;
        }

        else
        {
          LOWORD(a4) = v94 + 16;
        }
      }

      else
      {
        a4 = (int)v128;
        LOWORD(v94) = v94 - 16;
      }
    }

    else
    {
      LOWORD(v94) = a3;
      unsigned int v93 = (a4 + a3) >> 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"overriding min/max connection intervals to %d-%dms (%dms)",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  a3);
        log = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(log, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v102 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v168 = v102;
          _os_log_impl((void *)&_mh_execute_header, log, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }

    unsigned int v103 = (3 * a5 + 3) * (unsigned __int16)a4;
    if (v103 < 0x259)
    {
      if ((a7 - 8) > 0xFFFFFFF8)
      {
        unsigned __int16 loga = v94;
        __int16 v164 = v93;
        else {
          __int16 v129 = v103;
        }
        sub_1001BDFB4((uint64_t)&dword_1008E8943);
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Connecting with interval:%dms-%dms, latency=%d, timeout=%dms, initPHYs=%x connectingAddress=%s:%:, advHandle=%x subevent=%x",  v130,  v131,  v132,  v133,  v134,  v135,  v136,  ((double)loga * 1.25));
          uint64_t v137 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v137, OS_LOG_TYPE_DEFAULT))
          {
            unsigned int v138 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v168 = v138;
            _os_log_impl((void *)&_mh_execute_header, v137, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        *(_WORD *)__int128 buf = a1;
        *(_WORD *)&buf[2] = a1;
        LOWORD(v168) = a1;
        __int16 v160 = v129;
        if (byte_1008E8942)
        {
          unsigned __int8 v139 = a9;
          uint64_t v18 = sub_100128D24(256LL);
          __int16 v140 = v164;
        }

        else
        {
          __int16 v140 = v164;
          unsigned __int8 v139 = a9;
          if (byte_1008E894A) {
            uint64_t v150 = 217LL;
          }
          else {
            uint64_t v150 = 173LL;
          }
          uint64_t v18 = sub_100128D24(v150);
        }

        if ((_DWORD)v18)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134((uint64_t)"Could not start auto-connect : %!", v151, v152, v153, v154, v155, v156, v157, v18);
            uint64_t v158 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v158, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }
        }

        else
        {
          byte_1008E8940 = 1;
          LOBYTE(qword_1008E894C) = 0;
          WORD1(qword_1008E8954) = a1;
          WORD2(qword_1008E8954) = a2;
          HIWORD(qword_1008E8954) = v140;
          word_1008E895C = a5;
          word_1008E895E = v160;
          word_1008E8960 = a6;
          byte_1008E8962 = a7;
          BYTE1(qword_1008E894C) = v139;
          BYTE2(qword_1008E894C) = a10;
        }

        return v18;
      }

      sub_1001EE134((uint64_t)"Invalid initPHYs %x", v120, v121, v122, v123, v124, v125, v126, a7);
      uint64_t v127 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v127, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
    }

    else
    {
      sub_1001EE134( (uint64_t)"Connection latency (%d) and connection interval (%d ms) are in a range taht will cause issues",  v104,  v105,  v106,  v107,  v108,  v109,  v110,  a5);
      uint64_t v111 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v111, OS_LOG_TYPE_ERROR)) {
        return 101LL;
      }
    }

uint64_t sub_1001AB9FC()
{
  return byte_1008E8940;
}

BOOL sub_1001ABA08(int a1, int a2)
{
  if (byte_1008E8940 != 1) {
    return 0LL;
  }
  return WORD1(qword_1008E8954) == a1 && WORD2(qword_1008E8954) == a2;
}

uint64_t sub_1001ABA40(uint64_t a1)
{
  if (sub_10012D5EC(a1))
  {
    if (*(_BYTE *)(a1 + 124) == 7)
    {
      return 0LL;
    }

    else
    {
      uint64_t v18 = sub_100128D24(5u, v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = sub_100136C78(a1, v18);
      if ((_DWORD)v9)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Could not disconnect LE device %!", v20, v21, v22, v23, v24, v25, v26, v9);
          unsigned __int16 v27 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      else
      {
        *(_BYTE *)(a1 + 124) = 7;
      }

      sub_10012F008(a1, v19);
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"This handle is not a LE connection.", v10, v11, v12, v13, v14, v15, v16, v29);
      uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1310LL;
  }

  return v9;
}

uint64_t sub_1001ABB4C( char a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((byte_1008E8940 & 1) != 0)
  {
    if (byte_1008E8941 != 1 || (a1 & 1) != 0)
    {
      byte_1008E8964 = a1;
      uint64_t v8 = sub_1001214B4(174, (uint64_t)sub_1001ABC3C, a3, a4, a5, a6, a7, a8, v18);
      if ((_DWORD)v8)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Failed to cancel a connection : %!", v9, v10, v11, v12, v13, v14, v15, v8);
          uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }
      }

      else
      {
        byte_1008E8941 = 1;
      }
    }

    else
    {
      uint64_t v8 = 0LL;
      byte_1008E8964 = 0;
    }
  }

  else
  {
    uint64_t v19 = 0LL;
    while (sub_10012ECBC(&v19))
    {
      if (*(_DWORD *)(v19 + 132) != 7) {
        return 1302LL;
      }
    }

    return 1301LL;
  }

  return v8;
}

void sub_1001ABC3C(uint64_t a1)
{
  uint64_t v1 = a1;
  int v19 = a1;
  int v2 = byte_1008E8964;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"connectionCancelCb lConnectionInProgress %d, lRestartConnectionInProgress %d, lCancelConnectionInProgress %d lCancelConnectionDeferInProgress %d - %!",  v3,  v4,  v5,  v6,  v7,  v8,  v9,  byte_1008E8940);
    uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      LODWORD(buf) = 136446210;
      *(void *)((char *)&buf + 4) = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&buf, 0xCu);
    }
  }

  if ((_DWORD)v1 == 712)
  {
    if (byte_1008E8941 == 1 && (byte_1008E8968 & 1) == 0)
    {
      *((void *)&buf + 1) = &v19;
      *(void *)&__int128 buf = 4LL;
      byte_1008E8968 = 1;
      sub_1001EE6E8((uint64_t)sub_1001B01E4, (const void **)&buf, 1, 0LL);
      return;
    }

    byte_1008E8941 = 0;
    byte_1008E8968 = 0;
    byte_1008E8940 = 0;
    uint64_t v1 = 712LL;
  }

  else
  {
    byte_1008E8941 = 0;
    byte_1008E8968 = 0;
    if ((_DWORD)v1 == 702)
    {
      if ((byte_1008E8940 & 1) == 0) {
        sub_1001EE2A0();
      }
      byte_1008E8940 = 0;
      if (byte_1008E8964)
      {
        if ((_BYTE)qword_1008E894C) {
          sub_1001AA87C( (uint64_t)&qword_1008E894C + 3,  WORD1(qword_1008E8954),  WORD2(qword_1008E8954),  HIWORD(qword_1008E8954),  (unsigned __int16)word_1008E895C,  word_1008E8960,  byte_1008E8962,  BYTE1(qword_1008E894C),  BYTE2(qword_1008E894C));
        }
        else {
          sub_1001AB0A4( WORD1(qword_1008E8954),  WORD2(qword_1008E8954),  HIWORD(qword_1008E8954),  0,  (unsigned __int16)word_1008E895C,  word_1008E8960,  byte_1008E8962,  0LL,  BYTE1(qword_1008E894C),  BYTE2(qword_1008E894C));
        }
      }

      else if ((_BYTE)qword_1008E894C)
      {
        uint64_t v1 = 0LL;
        LOBYTE(qword_1008E894C) = 0;
        goto LABEL_25;
      }
    }

    else
    {
      if ((_DWORD)v1)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Unexpected error code %! for connection cancel.",  v11,  v12,  v13,  v14,  v15,  v16,  v17,  v1);
          uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        goto LABEL_25;
      }

      if ((byte_1008E8940 & 1) == 0) {
        sub_1001EE2A0();
      }
    }

    uint64_t v1 = 0LL;
  }

uint64_t sub_1001ABEBC()
{
  return byte_1008E8941;
}

uint64_t sub_1001ABEC8( char a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((a1 & 1) == 0 && (byte_1008E8940 == 1 ? (BOOL v8 = byte_1008E8964 == 0) : (BOOL v8 = 0), v8)) {
    return sub_1001ABB4C(1, a2, a3, a4, a5, a6, a7, a8);
  }
  else {
    return 0LL;
  }
}

BOOL sub_1001ABEF8(unsigned int a1)
{
  uint64_t v13 = 0LL;
  for (BOOL result = sub_10012ECBC((uint64_t *)&v13); result; BOOL result = sub_10012ECBC((uint64_t *)&v13))
  {
    if (v13[52] > 0x1Bu || v13[54] >= 0x1Cu)
    {
      uint64_t v3 = sub_1001ABFFC(v13, a1);
      if ((_DWORD)v3)
      {
        uint64_t v4 = v3;
        if ((_DWORD)v3 != 4000)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"ClassicSynchronousConfigChanged LE scaling completed with error %!",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v4);
            uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
              sub_10065BAC0();
            }
          }
        }
      }
    }
  }

  return result;
}

uint64_t sub_1001ABFFC(unsigned __int16 *a1, unsigned int a2)
{
  unsigned __int16 v153 = a1[54];
  unsigned __int16 v3 = a1[43];
  uint64_t v152 = 0LL;
  if (sub_10012EEA0(&v152))
  {
    char v150 = 0;
    unsigned __int16 v4 = 0;
    do
    {
      unsigned int v5 = *(unsigned __int8 *)(v152 + 60);
      if (*(_BYTE *)(v152 + 60) && !*(_BYTE *)(v152 + 56))
      {
        if (v5 <= 6) {
          __int16 v6 = 2500;
        }
        else {
          __int16 v6 = 625 * v5 - 1250;
        }
        if (v5 <= 0xC)
        {
          if (sub_1000A86F0())
          {
            uint64_t v7 = *a1;
            sub_100112940();
            sub_1001EE134( (uint64_t)"LE_ScaleDataLength lmHandle 0x%x SCO found voicelmHandle 0x%x _ceClassicAllowance %d interval %d piconets %d",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  v7);
            uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
            {
              uint64_t v16 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446210;
              uint64_t v155 = v16;
              _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }

            char v150 = 1;
          }

          else
          {
            char v150 = 1;
          }
        }

        unsigned int v17 = sub_100112940();
        unsigned __int16 v18 = v6 - 625;
        if (v17 <= 1) {
          unsigned __int16 v18 = v6;
        }
      }
    }

    while (sub_10012EEA0(&v152));
  }

  else
  {
    unsigned __int16 v4 = 0;
    char v150 = 0;
  }

  unsigned __int16 v19 = 625 * v3;
  uint64_t v151 = 0LL;
  char v21 = 0;
  while (sub_10012ECBC(&v151))
  {
    if (*(_BYTE *)(v151 + 124) != 7 && *(_BYTE *)(v151 + 128))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"LE_ScaleDataLength lmHandle 0x%x LEA streaming found voicelmHandle 0x%x",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  *a1);
        uint64_t v29 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
        {
          __int16 v30 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v155 = v30;
          _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      char v21 = 1;
    }
  }

  unsigned __int16 v31 = 625 * v3;
  if (v4) {
    unsigned __int16 v32 = v31;
  }
  else {
    unsigned __int16 v32 = 625 * v3;
  }
  int v33 = *((_DWORD *)a1 + 36);
  int v34 = *((_DWORD *)a1 + 37);
  if (v34 == 2)
  {
    int v35 = 360;
    char v36 = 2;
  }

  else if (v34 == 3)
  {
    int v35 = 1276;
    char v36 = 6;
  }

  else
  {
    int v35 = 412;
    char v36 = 3;
  }

  unsigned int v37 = a1[54];
  if (v33 == 2)
  {
    int v38 = 60;
    char v39 = 2;
  }

  else if (v33 == 3)
  {
    int v38 = 976;
    char v39 = 6;
  }

  else
  {
    int v38 = 112;
    char v39 = 3;
  }

  if (v35 + v38 + (a1[52] << v36) + (v37 << v39) > v32 || *((_BYTE *)a1 + 265) || *((_BYTE *)a1 + 266))
  {
    if (a1[56] <= v37) {
      unsigned int v40 = a1[54];
    }
    else {
      unsigned int v40 = a1[56];
    }
    LOWORD(v20) = a1[40];
    uint64_t v41 = sub_1001ACD4C(v40, &v153, v32, (int)((double)v20 * 1.25), 1LL, v33, v34);
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"lmHandle 0x%x CE %d is larger than calculated symmetric pair, do not scale",  v78,  v79,  v80,  v81,  v82,  v83,  v84,  *a1);
      uint64_t v85 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v85, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v86 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v155 = v86;
        _os_log_impl((void *)&_mh_execute_header, v85, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    uint64_t v41 = a1[52];
    unsigned __int16 v153 = a1[54];
  }

  if (*((_BYTE *)a1 + 70) == 1 && a1[57] == v4 && (v41 > a1[52] || v153 > a1[54]))
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Peripheral optimal[tx %d, rx %d] is larger than connection[tx %d, rx %d], scaling down lmHandle 0x%x ",  v42,  v43,  v44,  v45,  v46,  v47,  v48,  v41);
      uint64_t v49 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v50 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v155 = v50;
        _os_log_impl((void *)&_mh_execute_header, v49, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    unsigned __int16 v51 = v153;
    unsigned __int16 v153 = v51;
  }

  a1[57] = v4;
  if (word_1008E8966)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"EDL: Tx length override to %d",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  (unsigned __int16)word_1008E8966);
      uint64_t v59 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v60 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v155 = v60;
        _os_log_impl((void *)&_mh_execute_header, v59, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    int v61 = (unsigned __int16)word_1008E8966;
    LODWORD(v41) = (unsigned __int16)word_1008E8966;
  }

  else
  {
    int v61 = 0;
  }

  int v62 = *((_DWORD *)a1 + 36);
  __int16 v63 = 4 * v41 + 60;
  else {
    __int16 v64 = 8 * v41 + 112;
  }
  if (v62 != 1) {
    __int16 v64 = ((_WORD)v41 << 6) + 976;
  }
  if (v62 == 2) {
    unsigned __int16 v65 = v63;
  }
  else {
    unsigned __int16 v65 = v64;
  }
  if ((v21 & 1) != 0) {
    LOBYTE(v66) = 28;
  }
  else {
    LOBYTE(v66) = byte_1008D8EA0;
  }
  if ((v21 & 1) != 0) {
    unsigned __int8 v67 = 63;
  }
  else {
    unsigned __int8 v67 = byte_1008D8EA1;
  }
  if (v62 == 2)
  {
    unsigned int v87 = 4 * v67 + 60;
    if (v67 <= 0x42u) {
      unsigned int v87 = 328;
    }
    int v148 = v67;
    if (!sub_1000A86F0()
      || (sub_1001EE134( (uint64_t)"LE_ScaleDataLength Capping Tx with 2M for lmHandle 0x%x ceClassicAllowance %d txTime %d >= %d optim alTxBytes %d Cap txTime and optimalTxBytes rxPhy %d",  v89,  v90,  v91,  v92,  v93,  v94,  v95,  *a1),  uint64_t v77 = (os_log_s *)sub_100086554(0x42u),  !os_log_type_enabled(v77, OS_LOG_TYPE_DEFAULT)))
    {
LABEL_114:
      char v97 = 1;
      LODWORD(v41) = v148;
      goto LABEL_116;
    }

LABEL_115:
  char v97 = 0;
LABEL_116:
  *((_BYTE *)a1 + 266) = v97;
  int v98 = *((_DWORD *)a1 + 37);
  if (v98 == 2)
  {
    unsigned int v99 = v153;
    unsigned __int16 v100 = 4 * v153 + 60;
    BOOL v101 = v153 > 0x42u;
  }

  else
  {
    if (v98 != 1)
    {
      unsigned int v99 = v153;
      unsigned __int16 v102 = (v153 << 6) + 976;
      goto LABEL_124;
    }

    unsigned int v99 = v153;
    unsigned __int16 v100 = 8 * v153 + 112;
    BOOL v101 = v153 > 0x1Au;
  }

  if (v101) {
    unsigned __int16 v102 = v100;
  }
  else {
    unsigned __int16 v102 = 328;
  }
LABEL_124:
  if (v98 != 2)
  {
    if (v98 == 1)
    {
      int v66 = v66;
      unsigned int v103 = v66 <= 0x1Au ? 328 : 8 * v66 + 112;
      if (v103 < v102 || v99 > v66)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"LE_ScaleDataLength Capping Rx with 1M for lmHandle 0x%x ceClassicAllowance %d rxTime %d >= %d optim alRxBytes %d Cap rxTime and optimalRxBytes txPhy %d",  v104,  v105,  v106,  v107,  v108,  v109,  v110,  *a1);
          uint64_t v111 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v111, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v112 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v155 = v112;
            _os_log_impl((void *)&_mh_execute_header, v111, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        unsigned __int16 v153 = v66;
        char v113 = 1;
        goto LABEL_143;
      }
    }

  unsigned int v103 = v26;
  sub_100242CD0(&v105);
  if ((a3 & 1) == 0)
  {
    uint64_t v77 = *(void **)(a1 + 368);
    uint64_t v76 = *(void *)(a1 + 376);
    if ((unint64_t)v77 >= v76)
    {
      uint64_t v86 = *(void *)(a1 + 360);
      unsigned int v87 = ((uint64_t)v77 - v86) >> 3;
      uint64_t v88 = v76 - v86;
      uint64_t v89 = v88 >> 2;
      else {
        uint64_t v90 = v89;
      }
      if (v90) {
        uint64_t v91 = (char *)sub_100008BA0(a1 + 376, v90);
      }
      else {
        uint64_t v91 = 0LL;
      }
      uint64_t v92 = &v91[8 * v87];
      uint64_t v93 = &v91[8 * v90];
      *(void *)uint64_t v92 = a2;
      uint64_t v78 = v92 + 8;
      uint64_t v95 = *(char **)(a1 + 360);
      uint64_t v94 = *(char **)(a1 + 368);
      if (v94 != v95)
      {
        do
        {
          uint64_t v96 = *((void *)v94 - 1);
          v94 -= 8;
          *((void *)v92 - 1) = v96;
          v92 -= 8;
        }

        while (v94 != v95);
        uint64_t v94 = *(char **)(a1 + 360);
      }

      *(void *)(a1 + 360) = v92;
      *(void *)(a1 + 368) = v78;
      *(void *)(a1 + 376) = v93;
      if (v94) {
        operator delete(v94);
      }
    }

    else
    {
      *uint64_t v77 = a2;
      uint64_t v78 = v77 + 1;
    }

    *(void *)(a1 + 368) = v78;
  }

  sub_1003850D0(a1, 0LL, **(unsigned __int16 **)(a2 + 8), *(unsigned __int16 *)(*(void *)(a2 + 8) + 24LL));
  sub_100242CD8(&v105);
  uint64_t v14 = 0LL;
  unsigned int v17 = v103;
LABEL_30:
  sub_100242FAC((uint64_t)v107);
  if (v17) {
    operator delete(v17);
  }
LABEL_133:
  if (__p)
  {
    uint64_t v109 = (char *)__p;
    operator delete(__p);
  }

  if (v111)
  {
    uint64_t v112 = (char *)v111;
    operator delete(v111);
  }

  return v14;
}

void sub_1001ACBDC(unsigned __int16 *a1, uint64_t a2)
{
  if ((a2 - 5) >= 3)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE_LEAConfigChanged Unexpected reason %d", v15, v16, v17, v18, v19, v20, v21, a2);
      uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  else
  {
    uint64_t v23 = 0LL;
    while (sub_10012ECBC((uint64_t *)&v23))
    {
      if ((v23[52] > 0x1Bu || v23[54] >= 0x1Cu) && v23 != a1 && *((_BYTE *)v23 + 127) == 0)
      {
        uint64_t v5 = sub_1001ABFFC(v23, a2);
        if ((_DWORD)v5)
        {
          uint64_t v6 = v5;
          if ((_DWORD)v5 != 4000)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"LE_LEAConfigChanged LE scaling completed with error %!",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v6);
              uint64_t v14 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
                sub_10065BAC0();
              }
            }
          }
        }
      }
    }
  }

uint64_t sub_1001ACD4C( unsigned int a1, unsigned __int16 *a2, unsigned int a3, unsigned int a4, uint64_t a5, int a6, int a7)
{
  if (sub_1000A86F0())
  {
    uint64_t v17 = "dynamic";
    if ((_DWORD)a5) {
      uint64_t v17 = "static";
    }
    sub_1001EE134( (uint64_t)"Finding bestfit for %s-rx %d, ce %d, interval %d",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  (uint64_t)v17);
    uint64_t v18 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v44 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  unsigned int v19 = 0;
  unsigned __int16 v20 = 251;
  int v21 = 23;
  unsigned __int16 v22 = a1;
  unsigned __int16 v23 = 251;
  do
  {
    if (v23 >= a1) {
      unsigned __int16 v24 = a1;
    }
    else {
      unsigned __int16 v24 = v23;
    }
    uint64_t v25 = a5;
    if ((_DWORD)a5) {
      unsigned __int16 v26 = v24;
    }
    else {
      unsigned __int16 v26 = v23;
    }
    unsigned int v27 = 8 * sub_1001ACFFC(v26, v23, a3, a6, a7);
    if (v27) {
      unsigned int v27 = v27 * (0x3E8 / a4) / 0x3E8;
    }
    if (v27 > v19)
    {
      unsigned int v19 = v27;
      unsigned __int16 v20 = v23;
      unsigned __int16 v22 = v26;
    }

    if (v23 == 251) {
      unsigned __int16 v23 = 240;
    }
    else {
      v23 -= 10;
    }
    --v21;
    a5 = v25;
  }

  while (v21);
  if (a2) {
    *a2 = v22;
  }
  if (a1 >= v22) {
    char v28 = v25;
  }
  else {
    char v28 = 0;
  }
  if ((v28 & 1) == 0 && (_DWORD)v25) {
    sub_1001EE2A0();
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Optimal length is [tx %d, rx %d] yielding %d kbps", v29, v30, v31, v32, v33, v34, v35, v20);
    char v36 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      unsigned int v37 = sub_1001EDDCC();
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v44 = v37;
      _os_log_impl((void *)&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return v20;
}

unint64_t sub_1001ACF9C(int a1, int a2, unsigned int a3, unsigned int a4, int a5, int a6)
{
  int v7 = 8 * sub_1001ACFFC(a1, a2, a3, a5, a6);
  if (v7) {
    return v7 * (0x3E8 / a4) / 0x3E8uLL;
  }
  else {
    return 0LL;
  }
}

uint64_t sub_1001ACFF0(uint64_t result)
{
  word_1008E8966 = result;
  return result;
}

uint64_t sub_1001ACFFC(int a1, int a2, unsigned int a3, int a4, int a5)
{
  if (a5 == 3) {
    char v5 = 6;
  }
  else {
    char v5 = 3;
  }
  if (a5 == 3) {
    int v6 = 976;
  }
  else {
    int v6 = 112;
  }
  if (a5 == 2)
  {
    char v5 = 2;
    int v7 = 60;
  }

  else
  {
    int v7 = v6;
  }

  int v8 = (a2 << v5) + v7;
  if (a4 == 3) {
    int v9 = 720;
  }
  else {
    int v9 = 80;
  }
  if (a4 == 3) {
    char v10 = 6;
  }
  else {
    char v10 = 3;
  }
  if (a4 == 3) {
    int v11 = 976;
  }
  else {
    int v11 = 112;
  }
  if (a4 == 2) {
    int v12 = 44;
  }
  else {
    int v12 = v9;
  }
  if (a4 == 2)
  {
    char v10 = 2;
    int v13 = 60;
  }

  else
  {
    int v13 = v11;
  }

  if (v8 + (a1 << v10) + v13 + 300 <= a3)
  {
    if (a2 == 27 && a1 == 27) {
      unsigned int v24 = v8 + (a1 << v10) + v13 + 300;
    }
    else {
      unsigned int v24 = v8 + v12 + 300;
    }
    return a3 / v24 * a2;
  }

  else
  {
    uint64_t v21 = 27LL;
    sub_1001EE134( (uint64_t)"CE length is smaller than one pair of max Tx/Rx. BytesPerInterval %d: # pkts %d, asym %d us, sym %d us, t otalTime %d, remainder %d. Input: tx %d, ce %d",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  27LL);
    unsigned __int16 v22 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      unsigned int v27 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      return 27LL;
    }
  }

  return v21;
}

void sub_1001AD18C(uint64_t a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"_setTxDataLengthExtendedCB %!", v2, v3, v4, v5, v6, v7, v8, a1);
    int v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v19 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((_DWORD)a1 && sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Set data length extended error status %!", v10, v11, v12, v13, v14, v15, v16, a1);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

uint64_t sub_1001AD294( uint64_t a1, uint64_t a2, int a3, unsigned int a4, int a5, int a6, int a7, int a8, unsigned __int16 a9)
{
  if (a1 && sub_10012D5EC(a1))
  {
    if (a3)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"new connection parameters interval %dms-%dms, timeout=%dms, CE %d-%d latency=%d",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  (int)((double)a4 * 1.25));
        uint64_t v29 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v69 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      if (sub_1000A86F0())
      {
        LOWORD(v37) = *(_WORD *)(a1 + 90);
        sub_1001EE134( (uint64_t)"current connection params interval %dms-%dms, timeout=%dms, CE %d-%d latency=%d",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  (int)((double)v37 * 1.25));
        int v38 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          char v39 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v69 = v39;
          _os_log_impl((void *)&_mh_execute_header, v38, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      if (*(unsigned __int16 *)(a1 + 88) == a8
        && *(unsigned __int16 *)(a1 + 86) == a9
        && *(unsigned __int16 *)(a1 + 92) == a5
        && *(unsigned __int16 *)(a1 + 90) == a4
        && *(unsigned __int16 *)(a1 + 84) == a7
        && *(unsigned __int16 *)(a1 + 82) == a6)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Ignoring request to update parameters since we are already configured for the same values",  v40,  v41,  v42,  v43,  v44,  v45,  v46,  v67);
          uint64_t v47 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v48 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v69 = v48;
            _os_log_impl((void *)&_mh_execute_header, v47, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        return 4170LL;
      }

      else
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Sending parameters to controller", v58, v59, v60, v61, v62, v63, v64, v67);
          unsigned __int16 v65 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
          {
            int v66 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v69 = v66;
            _os_log_impl((void *)&_mh_execute_header, v65, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        uint64_t result = sub_1001214B4(192, (uint64_t)sub_1001AD668, v59, v60, v61, v62, v63, v64, a1);
        if (!(_DWORD)result)
        {
          uint64_t result = 0LL;
          *(_WORD *)(a1 + 98) = a8;
          *(_WORD *)(a1 + 100) = a5;
          *(_WORD *)(a1 + 102) = a4;
          *(_BYTE *)(a1 + 153) = 1;
        }
      }
    }

    else
    {
      return sub_1001214B4(193, (uint64_t)sub_1001AD6D4, v16, v17, v18, v19, v20, v21, a1);
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Connection handle is invalid.", v50, v51, v52, v53, v54, v55, v56, v67);
      uint64_t v57 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1310LL;
  }

  return result;
}

void sub_1001AD668(uint64_t a1)
{
  if ((_DWORD)a1 && sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE Remote Connection Parameter Request Reply HCI command failed with result %!",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  a1);
    int v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

void sub_1001AD6D4(uint64_t a1)
{
  if ((_DWORD)a1 && sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"LE Remote Connection Parameter Request Negative Reply HCI command failed with result %!",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  a1);
    int v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

uint64_t sub_1001AD740(uint64_t a1, unsigned int a2, unsigned int a3, int a4, int a5, int a6, int a7)
{
  if (a1 && sub_10012D5EC(a1))
  {
    if (*(_BYTE *)(a1 + 70) == 1)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Can't send a connection update as a peripheral.",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  v85);
        uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 132LL;
    }

    else if (a2 <= a3 && 10 * a5 >= a3)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"new connection parameters interval %dms-%dms, timeout=%dms, CE %d-%d latency=%d",  v39,  v40,  v41,  v42,  v43,  v44,  v45,  (int)((double)a2 * 1.25));
        uint64_t v46 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)__int128 buf = 136446210;
          unsigned int v87 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v46, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      if (sub_1000A86F0())
      {
        LOWORD(v54) = *(_WORD *)(a1 + 90);
        sub_1001EE134( (uint64_t)"current connection params interval %dms-%dms, timeout=%dms, CE %d-%d latency=%d connectionInterval:%dms",  v47,  v48,  v49,  v50,  v51,  v52,  v53,  (int)((double)v54 * 1.25));
        uint64_t v55 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v56 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          unsigned int v87 = v56;
          _os_log_impl((void *)&_mh_execute_header, v55, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      if (*(_BYTE *)(a1 + 153))
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Controller connection update pending, saving: interval %dms-%dms, timeout=%dms, CE %d-%d",  v57,  v58,  v59,  v60,  v61,  v62,  v63,  (int)((double)a2 * 1.25));
          uint64_t v64 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
          {
            unsigned __int16 v65 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            unsigned int v87 = v65;
            _os_log_impl((void *)&_mh_execute_header, v64, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        uint64_t result = 0LL;
        *(_WORD *)(a1 + 154) = a2;
        *(_WORD *)(a1 + 156) = a3;
        *(_WORD *)(a1 + 158) = a4;
        *(_WORD *)(a1 + 160) = a5;
        *(_WORD *)(a1 + 162) = a6;
        *(_WORD *)(a1 + 164) = a7;
      }

      else if (*(unsigned __int16 *)(a1 + 88) == a6 {
             && *(unsigned __int16 *)(a1 + 86) == a7
      }
             && (*(unsigned __int16 *)(a1 + 92) == a3 && *(unsigned __int16 *)(a1 + 90) == a2
              || (unsigned int v66 = *(unsigned __int16 *)(a1 + 80), v66 >= a2) && v66 <= a3)
             && *(unsigned __int16 *)(a1 + 84) == a5
             && *(unsigned __int16 *)(a1 + 82) == a4)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Ignoring request to update parameters since we are already configured for the same values, and curr ent CI is within range",  v67,  v68,  v69,  v70,  v71,  v72,  v73,  v85);
          uint64_t v74 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v75 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            unsigned int v87 = v75;
            _os_log_impl((void *)&_mh_execute_header, v74, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        return 4170LL;
      }

      else
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Sending parameters to controller", v76, v77, v78, v79, v80, v81, v82, v85);
          uint64_t v83 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v83, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v84 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            unsigned int v87 = v84;
            _os_log_impl((void *)&_mh_execute_header, v83, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        *(_WORD *)(a1 + 98) = a6;
        *(_WORD *)(a1 + 100) = a3;
        *(_WORD *)(a1 + 102) = a2;
        uint64_t result = sub_100128D24(0xB3u, v76, v77, v78, v79, v80, v81, v82, a1);
        if (!(_DWORD)result) {
          *(_BYTE *)(a1 + 153) = 1;
        }
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Max interval should not be lower than min or larger than timeout",  v31,  v32,  v33,  v34,  v35,  v36,  v37,  v85);
        int v38 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 101LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Connection handle is invalid.", v23, v24, v25, v26, v27, v28, v29, v85);
      uint64_t v30 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1310LL;
  }

  return result;
}

uint64_t sub_1001ADC7C( uint64_t a1, unsigned int a2, unsigned int a3, unsigned int a4, unsigned int a5, int a6)
{
  if (a1 && sub_10012D5EC(a1))
  {
    if (*(_BYTE *)(a1 + 290))
    {
      uint64_t result = 718LL;
      if (a2 - 501 >= 0xFFFFFE0C
        && a3 - 501 >= 0xFFFFFE0C
        && a2 <= a3
        && a4 <= 0x1F3
        && a5 <= 0x1F3
        && a5 <= a3
        && (a6 - 3201) >= 0xFFFFF389)
      {
        uint64_t result = sub_100128D24(0xFBu, v12, v13, v14, v15, v16, v17, v18, a1);
        if (!(_DWORD)result) {
          *(_BYTE *)(a1 + 153) = 1;
        }
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Remote device does not support connection subrating.",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v36);
        uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 1330LL;
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Connection handle is invalid", v20, v21, v22, v23, v24, v25, v26, v36);
      uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1310LL;
  }

  return result;
}

uint64_t sub_1001ADDD4()
{
  return sub_100128D24(23LL);
}

uint64_t sub_1001ADDF8()
{
  return sub_100128D24(182LL);
}

uint64_t sub_1001ADE1C(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  uint64_t v10 = sub_10012D6D8(a2);
  *((_WORD *)v10 + 141) = a3;
  *((_WORD *)v10 + 142) = a4;
  *((_WORD *)v10 + 143) = a5;
  *((_WORD *)v10 + 1memset(v132, 0, 44) = a6;
  return sub_1001B8FFC((uint64_t)v10, a3, a4, a5, a6);
}

void sub_1001ADE74( uint64_t a1, unsigned int a2, int a3, unsigned __int8 *a4, _DWORD *a5, unsigned int a6, unsigned __int16 a7, unsigned __int16 a8, char a9, __int16 a10, unsigned __int8 a11)
{
  unsigned int v19 = sub_10016F5B0(a1);
  else {
    uint64_t v21 = v19;
  }
  if (byte_1008E8964) {
    BOOL v22 = (_DWORD)v21 == 0;
  }
  else {
    BOOL v22 = 1;
  }
  if (!v22)
  {
    sub_1001ABC3C(2LL);
    return;
  }

  char v23 = byte_1008E8940;
  memset(v132, 0, 7);
  if (a3) {
    BOOL v24 = (_DWORD)v21 == 0;
  }
  else {
    BOOL v24 = 0;
  }
  char v25 = v24;
  if (!v24)
  {
    byte_1008E8940 = 0;
    byte_1008E8964 = 0;
    LOBYTE(qword_1008E894C) = 0;
    if ((_DWORD)v21)
    {
      switch((int)v21)
      {
        case 702:
        case 712:
          goto LABEL_25;
        case 703:
        case 704:
        case 705:
        case 706:
        case 707:
        case 708:
        case 710:
          goto LABEL_90;
        case 709:
        case 713:
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"LE Connection Complete with result %!. Lets tell the upper layer about this.",  v26,  v27,  v28,  v29,  v30,  v31,  v32,  a1);
            uint64_t v33 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
              sub_100657F74();
            }
          }

          sub_10012F3D4();
LABEL_25:
          uint64_t v34 = a4;
          uint64_t v35 = 0LL;
          uint64_t v36 = v21;
          break;
        case 711:
          uint64_t v105 = sub_10012D6D8(a2);
          if (v105)
          {
            uint64_t v35 = (uint64_t)v105;
            uint64_t v34 = a4;
          }

          else
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"%s connection with %: failed with result %!",  v106,  v107,  v108,  v109,  v110,  v111,  v112,  (uint64_t)"Outgoing");
              char v113 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v113, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            uint64_t v34 = a4;
            uint64_t v35 = 0LL;
          }

          uint64_t v36 = 711LL;
          break;
        default:
          if ((_DWORD)v21 != 766) {
            goto LABEL_90;
          }
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"LE Connection Complete %: failed with result %!",  v97,  v98,  v99,  v100,  v101,  v102,  v103,  (uint64_t)(a4 + 1));
            uint64_t v104 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v104, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          uint64_t v34 = a4;
          uint64_t v35 = 0LL;
          uint64_t v36 = 766LL;
          break;
      }

void sub_1001AE638(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  int v9 = sub_10012D6D8(a2);
  if (v9)
  {
    uint64_t v10 = (uint64_t)v9;
    *((_WORD *)v9 + 40) = a3;
    *((_WORD *)v9 + 41) = a4;
    *((_WORD *)v9 + 42) = a5;
    *((_BYTE *)v9 + 153) = 0;
    uint64_t v11 = sub_10016F5B0(a1);
    if ((_DWORD)v11)
    {
      uint64_t v12 = v11;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Connection Update Completed with error %!", v13, v14, v15, v16, v17, v18, v19, v12);
        uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    else
    {
      __int16 v29 = *(_WORD *)(v10 + 96);
      if (v29)
      {
        *(_WORD *)(v10 + 86) = v29;
        *(_WORD *)(v10 + 96) = 0;
        unsigned int v30 = *(unsigned __int16 *)(v10 + 104);
        if (v30 <= 0x1B && (unsigned int v31 = *(unsigned __int16 *)(v10 + 108), v31 < 0x1C))
        {
          unsigned int v42 = *(unsigned __int16 *)(v10 + 80);
          unsigned int v43 = 8
              * sub_1001ACFFC(v31, v30, (unsigned __int16)(625 * v29), *(_DWORD *)(v10 + 144), *(_DWORD *)(v10 + 148));
          if (v43) {
            unsigned int v43 = v43 * (0x3E8u / (int)((double)v42 * 1.25)) / 0x3E8;
          }
          *(_DWORD *)(v10 + 212) = v43;
          *(_DWORD *)(v10 + 216) = sub_1001ACFFC( *(unsigned __int16 *)(v10 + 108),  *(unsigned __int16 *)(v10 + 104),  (unsigned __int16)(625 * *(_WORD *)(v10 + 86)),  *(_DWORD *)(v10 + 144),  *(_DWORD *)(v10 + 148));
        }

        else
        {
          uint64_t v32 = sub_1001ABFFC((unsigned __int16 *)v10, 2u);
          if ((_DWORD)v32)
          {
            uint64_t v33 = v32;
            if ((_DWORD)v32 != 4000)
            {
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Connection Update Completed with error %!",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  v33);
                uint64_t v41 = (os_log_s *)sub_100086554(0x42u);
                if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
                  sub_100657F74();
                }
              }
            }
          }
        }
      }

      if (*(_WORD *)(v10 + 98))
      {
        *(_WORD *)(v10 + 88) = *(_WORD *)(v10 + 98);
        *(_WORD *)(v10 + 98) = 0;
      }

      if (*(_WORD *)(v10 + 100))
      {
        *(_WORD *)(v10 + 92) = *(_WORD *)(v10 + 100);
        *(_WORD *)(v10 + 100) = 0;
      }

      if (*(_WORD *)(v10 + 102))
      {
        *(_WORD *)(v10 + 90) = *(_WORD *)(v10 + 102);
        *(_WORD *)(v10 + 102) = 0;
      }
    }

    if (*(_WORD *)(v10 + 160))
    {
      sub_1001AD740( v10,  *(unsigned __int16 *)(v10 + 154),  *(unsigned __int16 *)(v10 + 156),  *(unsigned __int16 *)(v10 + 158),  *(unsigned __int16 *)(v10 + 160),  *(unsigned __int16 *)(v10 + 162),  *(unsigned __int16 *)(v10 + 164));
      if ((_DWORD)a1 && sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Error executing pending connection update with %!",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  a1);
        uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      *(_DWORD *)(v10 + 162) = 0;
      *(void *)(v10 + 154) = 0LL;
    }

    sub_1001B8F64(v10, a3, a4, a5, *(unsigned __int16 *)(v10 + 86));
    sub_10012F008(v10, v52);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"We are not tracking this LM handle...", v21, v22, v23, v24, v25, v26, v27, v53);
    uint64_t v28 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

void sub_1001AE924(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (a2)
  {
    if (!sub_10012D5EC(a2)) {
      sub_1001EE2A0();
    }
    int v9 = *(_DWORD *)(a2 + 204);
    sub_1000BAFE4(*(_WORD *)a2 & 0xFFF);
    sub_100173630(a2, a3);
    sub_1001B8D50(a2, a3, a4, a5);
    if (v9)
    {
      if (!*(_DWORD *)(a2 + 204)) {
        sub_10012E320((unsigned __int16 *)a2);
      }
    }

    sub_1000AE718(a2);
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"OI_HCIEventHandler_DisconnectionComplete no connection handle: reason %! ignoring",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  a3);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

void sub_1001AEA1C(uint64_t a1, unsigned int a2, void *a3)
{
  uint64_t v6 = sub_10012D6D8(a2);
  uint64_t v7 = (uint64_t)v6;
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Remote used features error: %!", v8, v9, v10, v11, v12, v13, v14, a1);
      uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

uint64_t sub_1001AEB2C(uint64_t a1, uint64_t a2)
{
  if (!a1 || !sub_10012D5EC(a1)) {
    return 149LL;
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Setting Connection Data Length to Tx %d bytes and %d us", v4, v5, v6, v7, v8, v9, v10, a2);
    uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v23 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v12 = sub_1001214B4(194, (uint64_t)sub_1001AEC7C, v5, v6, v7, v8, v9, v10, a1);
  if ((_DWORD)v12)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Set Data Length failed with status %!", v13, v14, v15, v16, v17, v18, v19, v12);
      uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v12;
}

void sub_1001AEC7C(uint64_t a1, unsigned __int16 *a2)
{
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Write data length complete with %!, triggering changed", v4, v5, v6, v7, v8, v9, v10, a1);
      uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    sub_1001AEE34(*a2, a2[52], a2[53], a2[54], a2[55]);
  }

void sub_1001AED04(uint64_t a1, int a2, int a3, uint64_t a4)
{
  if (a3 && !*(_BYTE *)(a1 + 152))
  {
    int v13 = 4;
  }

  else
  {
    if (!a2) {
      return;
    }
    if (*(_DWORD *)(a1 + 136) == 1)
    {
      if (!*(_BYTE *)(a1 + 125) || !*(_BYTE *)(a1 + 316))
      {
        sub_1001B7AA0(a1, a4);
        return;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"FastLEConnection:pendingAuth and fastLEConnectEnabled, waiting for encryption started",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  *(uint64_t *)v14);
        uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)uint64_t v14 = 136446210;
          *(void *)&v14[4] = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", v14, 0xCu);
        }
      }

      int v13 = 5;
    }

    else
    {
      int v13 = 3;
    }
  }

  *(_DWORD *)(a1 + 132) = v13;
}

void sub_1001AEE34(unsigned int a1, int a2, int a3, unsigned int a4, int a5)
{
  uint64_t v10 = sub_10012D6D8(a1);
  if (v10)
  {
    uint64_t v11 = (uint64_t)v10;
    if (sub_10012D5EC((uint64_t)v10))
    {
      unsigned int v12 = *(unsigned __int16 *)(v11 + 112);
      if (v12 <= a4) {
        LOWORD(v12) = a4;
      }
      *(_WORD *)(v11 + 112) = v12;
      if (sub_1000A86F0())
      {
        uint64_t v20 = "peripheral";
        if (!*(_BYTE *)(v11 + 70)) {
          uint64_t v20 = "central";
        }
        sub_1001EE134( (uint64_t)"Data Length Changed for %s lmhandle %x: Tx [%d -> %d, %d], Rx [%d -> %d, %d], ready-state: %s, mfgrNa me 0x%x, probe: %s, phy-ready %d",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  (uint64_t)v20);
        uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)__int128 buf = 136446210;
          unsigned int v42 = sub_1001EDDCC();
          _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      if (*(unsigned __int16 *)(v11 + 104) != a2
        || *(unsigned __int16 *)(v11 + 106) != a3
        || *(unsigned __int16 *)(v11 + 108) != a4
        || *(unsigned __int16 *)(v11 + 110) != a5)
      {
        *(_WORD *)(v11 + 104) = a2;
        *(_WORD *)(v11 + 106) = a3;
        *(_WORD *)(v11 + 108) = a4;
        *(_WORD *)(v11 + 110) = a5;
        uint64_t v22 = sub_1001ABFFC((unsigned __int16 *)v11, 3u);
        uint64_t v23 = v22;
        if (!(_DWORD)v22)
        {
LABEL_25:
          if (*(_DWORD *)(v11 + 132) == 3 && *(_DWORD *)(v11 + 136) == 1)
          {
            else {
              int v40 = 0;
            }
            else {
              sub_1001B7AA0(v11, v23);
            }
          }

          return;
        }

        if ((_DWORD)v22 != 4000)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Scaling Data Length completed with error %!",  v32,  v33,  v34,  v35,  v36,  v37,  v38,  v23);
            uint64_t v39 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
              sub_100657F74();
            }
          }

          goto LABEL_25;
        }
      }

      if (!*(_DWORD *)(v11 + 136)) {
        sub_1001AF124(v11);
      }
      uint64_t v23 = 0LL;
      goto LABEL_25;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Invalid LM handle %x", v24, v25, v26, v27, v28, v29, v30, a1);
    unsigned int v31 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

void sub_1001AF124(uint64_t a1)
{
  if (sub_1000A86F0())
  {
    int v9 = *(_DWORD *)(a1 + 136);
    uint64_t v10 = "unknown";
    if (v9 == 1) {
      uint64_t v10 = "complete";
    }
    if (v9) {
      uint64_t v11 = v10;
    }
    else {
      uint64_t v11 = "idle";
    }
    sub_1001EE134((uint64_t)"Updating Probe-State: %s -> %s", v2, v3, v4, v5, v6, v7, v8, (uint64_t)v11);
    unsigned int v12 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v14 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  *(_DWORD *)(a1 + 136) = 1;
}

void sub_1001AF218(uint64_t a1, uint64_t a2, int a3, int a4)
{
  int v5 = a3;
  if (a2)
  {
    *(_BYTE *)(a2 + 152) = 1;
    if ((_DWORD)a1)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Phy update returned status %! and lmhandle 0x%4x", v8, v9, v10, v11, v12, v13, v14, a1);
        uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }

      if ((_DWORD)a1 == 42 || (_DWORD)a1 == 35)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Transaction collision occured, default to 1M PHY and continue as success",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  v61);
          uint64_t v23 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v63 = sub_1001EDDCC();
            _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        a1 = 0LL;
      }

      int v5 = 1;
      a4 = 1;
    }

    if ((*(_BYTE *)(a2 + 170) & 0x20) != 0) {
      int v24 = sub_10010F290();
    }
    else {
      int v24 = 0;
    }
    *(_DWORD *)(a2 + 1memset(v132, 0, 44) = a4;
    *(_DWORD *)(a2 + 148) = v5;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"PhyUpdateComplete: status %!, lmhandle 0x%4x, txPhy 0x%4x, rxPhy 0x%4x, readystate %s",  v33,  v34,  v35,  v36,  v37,  v38,  v39,  a1);
      int v40 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v41 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v63 = v41;
        _os_log_impl((void *)&_mh_execute_header, v40, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    if (*(_DWORD *)(a2 + 132) == 4)
    {
      uint64_t v42 = sub_1001ABFFC((unsigned __int16 *)a2, 4u);
      if ((_DWORD)v42
        && (uint64_t v43 = v42, (_DWORD)v42 != 4000)
        && sub_1000A86F0()
        && (sub_1001EE134( (uint64_t)"PhyUpdateComplete LE scaling completed with error %!",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  v43),  uint64_t v51 = (os_log_s *)sub_100086554(0x42u),  os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)))
      {
        sub_100657F74();
        if (v24) {
          goto LABEL_32;
        }
      }

      else if (v24)
      {
LABEL_32:
        sub_1001AED04(a2, 1, 1, a1);
        return;
      }

      if (*(_BYTE *)(a2 + 125) && *(_BYTE *)(a2 + 316))
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"FastLEConnection:pendingAuth and fastLEConnectEnabled, waiting for encryption started",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  v61);
          uint64_t v59 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v60 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v63 = v60;
            _os_log_impl((void *)&_mh_execute_header, v59, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        *(_DWORD *)(a2 + 132) = 5;
      }

      else
      {
        sub_1001B7AA0(a2, a1);
      }
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Connection handle invalid for phy update %p, status %!",  v25,  v26,  v27,  v28,  v29,  v30,  v31,  0LL);
    uint64_t v32 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

__n128 sub_1001AF5A4(uint64_t a1, _OWORD *a2)
{
  __int128 v2 = a2[3];
  _DWORD v5[2] = a2[2];
  v5[3] = v2;
  v5[4] = a2[4];
  __int128 v3 = a2[1];
  v5[0] = *a2;
  v5[1] = v3;
  sub_1001BF340(a1, (unsigned __int16 **)v5);
  return result;
}

void sub_1001AF608(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if ((_DWORD)a4)
  {
    uint64_t v10 = a4;
    uint64_t v11 = (unint64_t *)a5;
    do
    {
      *(int *)((char *)v14 + 3) = 0;
      v14[0] = 0;
      unint64_t v12 = *v11++;
      uint64_t v13 = sub_1001BCDB0(v12);
      v14[0] = v13;
      BYTE2(v14[1]) = BYTE6(v13);
      LOWORD(v14[1]) = WORD2(v13);
      sub_1001D5C50(v14);
      --v10;
    }

    while (v10);
    if ((byte_1008E8940 & 1) == 0) {
      byte_1008E8940 = 1;
    }
  }

  sub_1001BF7E8(a1, a2, a3, a4, a5);
}

void sub_1001AF6C0(uint64_t a1, uint64_t a2, unsigned int a3, __int16 a4, __int16 a5)
{
  if ((_DWORD)a1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"LE_ReadRemoteVersionInformationComplete with error %!",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  a1);
      uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  else
  {
    if (!sub_10012D5EC(a2)) {
      sub_1001EE2A0();
    }
    *(_BYTE *)(a2 + 24) = a3;
    *(_WORD *)(a2 + 20) = a4;
    *(_WORD *)(a2 + 22) = a5;
  }

  sub_1001B9094(a1, a2, a3);
}

BOOL sub_1001AF780(unsigned __int16 *a1, int a2, int a3, int a4)
{
  BOOL result = sub_10012D5EC((uint64_t)a1);
  if (result) {
    return a1[40] == a2 && a1[44] == a3 && a1[43] == a4;
  }
  return result;
}

uint64_t sub_1001AF7E4( _WORD *a1, _WORD *a2, _WORD *a3, _WORD *a4, _WORD *a5, _WORD *a6, _WORD *a7, _WORD *a8)
{
  if (a2) {
    *a2 = a1[40];
  }
  if (a3) {
    *a3 = a1[41];
  }
  if (a4) {
    *a4 = a1[44];
  }
  if (a5) {
    *a5 = a1[43];
  }
  if (a6) {
    *a6 = a1[42];
  }
  if (a7) {
    *a7 = a1[45];
  }
  uint64_t result = 0LL;
  if (a8) {
    *a8 = a1[46];
  }
  return result;
}

uint64_t sub_1001AF89C()
{
  int v0 = (unsigned __int16)word_1008D8EA2;
  uint64_t result = (unsigned __int16)word_1008D8EA2;
  if (word_1008D8EA2 != word_1008D8EA6)
  {
    sub_1001EE2A0();
    uint64_t result = (unsigned __int16)word_1008D8EA2;
    int v0 = (unsigned __int16)word_1008D8EA6;
  }

  if ((_DWORD)result) {
    BOOL v2 = v0 == 0;
  }
  else {
    BOOL v2 = 1;
  }
  if (v2)
  {
    sub_1001EE2A0();
    return (unsigned __int16)word_1008D8EA2;
  }

  return result;
}

uint64_t sub_1001AF8F0(int a1, int a2, unsigned int a3, int a4)
{
  if (sub_10018BE60() == 11)
  {
    word_1008D8EA2 = 27;
    word_1008D8EA4 = 328;
    word_1008D8EA6 = 27;
    word_1008D8EA8 = 328;
  }

  if (sub_1000A86F0())
  {
    uint64_t v15 = (BYTE4(xmmword_1008F6D38) & 0x20) != 0 ? "supported" : "not supported";
    sub_1001EE134( (uint64_t)"Local EDL %s; TxOctets %d, TxTime %d, RxOctets %d, RxTime %d\n",
      v8,
      v9,
      v10,
      v11,
      v12,
      v13,
      v14,
      (uint64_t)v15);
    uint64_t v16 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v35 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v16, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (a1 != a3) {
    sub_1001EE2A0();
  }
  if (a2 != a4) {
    sub_1001EE2A0();
  }
  word_1008D8EA2 = a1;
  word_1008D8EA4 = a2;
  word_1008D8EA6 = a3;
  word_1008D8EA8 = a4;
  if ((BYTE4(xmmword_1008F6D38) & 0x20) == 0) {
    return 0LL;
  }
  unsigned int v18 = sub_1001ACD4C(a3, 0LL, 0x186Au, 0x1Eu, 0LL, 1, 1);
  word_1008D8EAA = v18;
  uint64_t v17 = sub_1001214B4(196, (uint64_t)sub_1001AFB30, v19, v20, v21, v22, v23, v24, v18);
  if ((_DWORD)v17)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Write Suggested default failed with %!", v25, v26, v27, v28, v29, v30, v31, v17);
      uint64_t v32 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v17;
}

void sub_1001AFB30(uint64_t a1)
{
  if ((_DWORD)a1 && sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Write Suggested default failed with %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

uint64_t sub_1001AFB9C(uint64_t result)
{
  byte_1008E894A = result;
  return result;
}

uint64_t sub_1001AFBA8(uint64_t result)
{
  byte_1008E8942 = result;
  return result;
}

uint64_t sub_1001AFBB4(uint64_t a1, uint64_t a2)
{
  if (!a1 || !sub_10012D5EC(a1)) {
    return 149LL;
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Set PHY allPhys=%x txPhys=%x rxPhys=%x phyOptions=%x", v4, v5, v6, v7, v8, v9, v10, a2);
    uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v23 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  uint64_t v12 = sub_100128D24(0xC8u, v4, v5, v6, v7, v8, v9, v10, a1);
  if ((_DWORD)v12)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Set PHY failed with status %!", v13, v14, v15, v16, v17, v18, v19, v12);
      uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  return v12;
}

uint64_t sub_1001AFD1C()
{
  if ((_BYTE)dword_1008E8943) {
    int v0 = "Random";
  }
  else {
    int v0 = "Public";
  }
  sub_1001EE0E4( "gLocalConnectableAddress.Type:%s gLocalConnectableAddress.address:%:",  v0,  (char *)&dword_1008E8943 + 1);
  sub_1001EE0E4( "ConnectionInProgressStruct: directed: address:%: scanInterval:%x scanWin:%x connectionInt:%x ConnectionLatency:%x su pervisionTO:%x CELen:%x initPHYs:%x advHandle:%x subevent:%x\n",  qword_1008E894C,  (char *)&qword_1008E894C + 4,  WORD1(qword_1008E8954),  WORD2(qword_1008E8954),  HIWORD(qword_1008E8954),  (unsigned __int16)word_1008E895C,  (unsigned __int16)word_1008E895E,  (unsigned __int16)word_1008E8960,  byte_1008E8962,  BYTE1(qword_1008E894C),  BYTE2(qword_1008E894C));
  sub_1001EE0E4( "Local EDL support: maxTxOctets %d, maxTxTime %d, maxRxOctets %d, maxRxTime %d\n\n",  (unsigned __int16)word_1008D8EA2,  (unsigned __int16)word_1008D8EA4,  (unsigned __int16)word_1008D8EA6,  (unsigned __int16)word_1008D8EA8);
  sub_1001EE0E4("gEnableExtendedCreateConnectionCommand:%d", byte_1008E894A);
  return sub_1001EE0E4("gEnableExtendedCreateConnectionCommandV2:%d", byte_1008E8942);
}

void sub_1001AFE5C(int a1, int a2)
{
  if (a1)
  {
    char v3 = a1;
    sub_1001EE0E4("LE_SetCappedLength for 1M: %d -> %d", byte_1008D8EA0, a1);
    byte_1008D8EA0 = v3;
  }

  if (a2)
  {
    sub_1001EE0E4("LE_SetCappedLength for 2M: %d -> %d", byte_1008D8EA1, a2);
    byte_1008D8EA1 = a2;
  }

uint64_t sub_1001AFED4(char a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t result = 0LL;
  for (char i = 1; ; char i = 0)
  {
    char v7 = i;
    uint64_t v8 = (char *)&unk_1008E8970 + 32 * result;
    if (!v8[2]) {
      break;
    }
    uint64_t v9 = *((void *)v8 + 1);
    if (!v9) {
      break;
    }
    if (v9 == a2) {
      return result;
    }
    uint64_t result = 1LL;
    if ((v7 & 1) == 0) {
      return 0xFFFFFFFFLL;
    }
  }

  v8[2] = 1;
  *((void *)v8 + 1) = a2;
  *((void *)v8 + 2) = a3;
  v8[1] = a1;
  *((_DWORD *)v8 + 6) = a4;
  return result;
}

uint64_t sub_1001AFF38(uint64_t result)
{
  if ((_DWORD)result == 1) {
    byte_1008E8992 = 0;
  }
  return result;
}

uint64_t sub_1001AFF4C(uint64_t result, __int16 a2, char a3, char a4, char a5, char a6, char a7)
{
  uint64_t v12 = result;
  uint64_t v13 = 0LL;
  uint64_t v23 = 0LL;
  char v14 = 1;
  do
  {
    char v15 = v14;
    uint64_t v16 = (char *)&unk_1008E8970 + 32 * v13;
    int v18 = v16[2];
    uint64_t v17 = v16 + 2;
    if (v18)
    {
      uint64_t v19 = (uint64_t (*)(uint64_t))*((void *)&unk_1008E8970 + 4 * v13 + 1);
      if (v19)
      {
        uint64_t v20 = (char *)&unk_1008E8970 + 32 * v13;
        if (*((void *)v20 + 2)) {
          uint64_t v21 = (uint64_t *)*((void *)v20 + 2);
        }
        else {
          uint64_t v21 = &v23;
        }
        *((_BYTE *)v21 + 3) = a3;
        *(_WORD *)uint64_t v21 = a2;
        *((_BYTE *)v21 + 2) = v12;
        *((_BYTE *)v21 + 4) = a4;
        *((_BYTE *)v21 + 5) = a5;
        *((_BYTE *)v21 + 6) = a6;
        *((_BYTE *)v21 + 7) = a7;
        uint64_t result = v19(v12);
        if (v20[1]) {
          *uint64_t v17 = 0;
        }
      }
    }

    char v14 = 0;
    uint64_t v13 = 1LL;
  }

  while ((v15 & 1) != 0);
  return result;
}

void sub_1001B002C( unsigned int a1, uint64_t a2, int a3, int a4, int a5, int a6, int a7, int a8, unsigned __int8 a9, unsigned __int8 a10, unsigned __int8 a11, unsigned __int8 a12, unsigned __int16 a13, unsigned __int16 a14, unsigned __int16 a15, unsigned __int16 a16, unsigned __int16 a17, unsigned __int8 a18)
{
  uint64_t v26 = sub_10012D6D8(a1);
  if ((_DWORD)a2)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"CS read remote supported capabilities error: %!", v27, v28, v29, v30, v31, v32, v33, a2);
      uint64_t v34 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
LABEL_10:
      }
        sub_100657F74();
    }
  }

  else
  {
    uint64_t v35 = v26;
    if (v26 && sub_10012D5EC((uint64_t)v26))
    {
      *((_BYTE *)v35 + 292) = a3;
      *((_WORD *)v35 + 147) = a4;
      *((_BYTE *)v35 + 296) = a5;
      *((_BYTE *)v35 + 297) = a6;
      *((_BYTE *)v35 + 298) = a7;
      *((_BYTE *)v35 + 299) = a8;
      *((_BYTE *)v35 + 300) = a9;
      *((_BYTE *)v35 + 301) = a10;
      *((_BYTE *)v35 + 302) = a11;
      *((_BYTE *)v35 + 303) = a12;
      *((_WORD *)v35 + 152) = a13;
      *((_WORD *)v35 + 153) = a14;
      *((_WORD *)v35 + 154) = a15;
      *((_WORD *)v35 + 155) = a16;
      *((_WORD *)v35 + 156) = a17;
      *((_BYTE *)v35 + 314) = a18;
      sub_1001EE0E4( "Channel Sounding numConfigSupported: %d maxProceduresSupported: %d numAntennasSupported: %d rolesSupported: %d m odes_Supported: %d rttCapability: %d rttCoarseN: %d rttSoundingN: %d rttRandomPayloadN: %d csSyncPHYsSupported: %d subfeaturesSupported: %d tIP1TimesSupported: %d tIP2TimesSupported: %d tFcsTimesSupported: %d tPMTimesSupport ed: %d tSWTimesSupported: %d ",  a3,  a4,  a5,  a6,  a7,  a8,  a9,  a10,  a11,  a12,  a13,  a14,  a15,  a16,  a17,  a18);
      return;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invaid LM handle %x from CS read remote supported capabilities",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  a1);
      uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        goto LABEL_10;
      }
    }
  }

uint64_t sub_1001B01E4(uint64_t a1)
{
  uint64_t v1 = **(unsigned int **)(a1 + 8);
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"_connectionCancelDefer lConnectionInProgress %d, lRestartConnectionInProgress %d, lCancelConnectionInProg ress %d lCancelConnectionDeferInProgress %d - %!",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  byte_1008E8940);
    uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v12 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return sub_1001ABC3C(v1);
}

void sub_1001B02D8(uint64_t a1, uint64_t a2, uint64_t a3, char a4)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
  }

  else
  {
    unsigned int v5 = *(unsigned __int16 *)(a1 + 10);
    uint64_t v6 = *(unsigned __int16 *)(a1 + 12);
    if (v5 != (_DWORD)v6)
    {
      if (*(_BYTE *)(a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1564,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      if (v5 <= v6)
      {
        *(_BYTE *)(a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Error retreiving the subevent code.", v17, v18, v19, v20, v21, v22, v23, v37);
          uint64_t v24 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
            goto LABEL_6;
          }
        }
      }

      else
      {
        uint64_t v15 = *(void *)a1;
        *(_WORD *)(a1 + 12) = v6 + 1;
        uint64_t v16 = *(unsigned __int8 *)(v15 + v6);
        switch(*(_BYTE *)(v15 + v6))
        {
          case 1:
            sub_1001B069C((uint64_t *)a1, a4);
            return;
          case 2:
            sub_1001B0B90((uint64_t *)a1, a4);
            return;
          case 3:
            sub_1001B1164((uint64_t *)a1);
            return;
          case 4:
            sub_1001B143C((uint64_t *)a1);
            return;
          case 5:
            sub_1001B168C((uint64_t *)a1);
            return;
          case 6:
            sub_1001B1888(a1);
            return;
          case 7:
            sub_1001B1AD8((uint64_t *)a1);
            return;
          case 0xA:
            int v36 = 1;
            goto LABEL_48;
          case 0xC:
            sub_1001B1CA4((uint64_t *)a1);
            return;
          case 0xD:
            sub_1001B2004((uint64_t *)a1, a4);
            return;
          case 0xE:
            int v25 = 1;
            goto LABEL_23;
          case 0xF:
            int v26 = 1;
            goto LABEL_46;
          case 0x10:
            sub_1001B426C(a1);
            return;
          case 0x12:
            sub_1001B2B64((uint64_t *)a1);
            return;
          case 0x14:
            sub_1001B1E58((uint64_t *)a1);
            return;
          case 0x18:
            int v27 = 1;
            goto LABEL_43;
          case 0x21:
            sub_1001B4AF8((uint64_t *)a1);
            return;
          case 0x23:
            sub_1001B6A64((uint64_t *)a1);
            return;
          case 0x24:
            int v25 = 2;
LABEL_23:
            sub_1001B355C(v25, (uint64_t *)a1);
            break;
          case 0x25:
            int v26 = 2;
LABEL_46:
            sub_1001B3BF0(v26, (uint64_t *)a1);
            break;
          case 0x26:
            int v27 = 2;
LABEL_43:
            sub_1001B4358(v27, (uint64_t *)a1);
            break;
          case 0x27:
            sub_1001B6DF0((uint64_t *)a1);
            break;
          case 0x28:
            sub_1001B6FE4((uint64_t *)a1);
            break;
          case 0x29:
            int v36 = 2;
LABEL_48:
            sub_1001B2DE8(v36, (uint64_t *)a1, a4);
            break;
          case 0x2D:
            sub_1001B4E60((uint64_t *)a1);
            break;
          case 0x2E:
            sub_1001B5510((uint64_t *)a1);
            break;
          case 0x2F:
          case 0x34:
            sub_1001B533C((uint64_t *)a1);
            break;
          case 0x30:
            sub_1001B5674((uint64_t *)a1);
            break;
          case 0x31:
            sub_1001B5B84((uint64_t *)a1);
            break;
          case 0x32:
            sub_1001B63CC((uint64_t *)a1);
            break;
          case 0x33:
            return;
          default:
            if (sub_1000A86F0())
            {
              sub_1001EE134((uint64_t)"Unknown LE event code 0x%x", v28, v29, v30, v31, v32, v33, v34, v16);
              uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
                goto LABEL_6;
              }
            }

            break;
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Error, the LE command is %d bytes.", v7, v8, v9, v10, v11, v12, v13, 0LL);
    char v14 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
LABEL_6:
    }
      sub_100657858();
  }

void sub_1001B069C(uint64_t *a1, unsigned __int8 a2)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v2 = 0LL;
    goto LABEL_14;
  }

  unsigned int v4 = *((unsigned __int16 *)a1 + 5);
  uint64_t v5 = *((unsigned __int16 *)a1 + 6);
  uint64_t v2 = v4 - v5;
  __int16 v104 = 0;
  int v103 = 0;
  if ((_DWORD)v2 != 18)
  {
LABEL_14:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid connection complete event packet size : %d, expecting %d",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  v2);
      uint64_t v29 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  67,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (v4 <= v5)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the status of the LE connection complete event",  v30,  v31,  v32,  v33,  v34,  v35,  v36,  v101);
    uint64_t v37 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_29:
    sub_100657858();
    return;
  }

  uint64_t v6 = *a1;
  *((_WORD *)a1 + 6) = v5 + 1;
  if ((int)(v4 - (v5 + 1)) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the connection handle of the LE connection complete event",  v38,  v39,  v40,  v41,  v42,  v43,  v44,  v101);
    uint64_t v45 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_29;
  }

  uint64_t v7 = *(unsigned __int8 *)(v6 + v5);
  unsigned __int16 v8 = *(_WORD *)(v6 + v5 + 1);
  *((_WORD *)a1 + 6) = v5 + 3;
  if (v4 <= (unsigned __int16)(v5 + 3))
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the connection role of the LE connection complete event",  v46,  v47,  v48,  v49,  v50,  v51,  v52,  v101);
    uint64_t v53 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_29;
  }

  unsigned __int16 v9 = v5 + 4;
  *((_WORD *)a1 + 6) = v5 + 4;
  if (v4 <= (unsigned __int16)(v5 + 4))
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the peer address type of the LE connection complete event",  v54,  v55,  v56,  v57,  v58,  v59,  v60,  v101);
    uint64_t v61 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v61, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_29;
  }

  int v10 = *(unsigned __int8 *)(v6 + (unsigned __int16)(v5 + 3));
  unsigned __int16 v11 = v5 + 5;
  *((_WORD *)a1 + 6) = v11;
  unsigned __int8 v102 = *(_BYTE *)(v6 + v9);
  if ((int)(v4 - v11) <= 5) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  75,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
  }
  sub_1001F0050((uint64_t)&v103, v6 + v11, 6uLL);
  __int16 v13 = *((_WORD *)a1 + 6);
  *((_WORD *)a1 + 6) = v13 + 6;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001EE134( (uint64_t)"Could not get the peer address of the LE connection complete event",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  v101);
    uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_47;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  77,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  unsigned int v62 = *((unsigned __int16 *)a1 + 5);
  if ((int)(v62 - (unsigned __int16)(v13 + 6)) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the connection interval of the LE connection complete event",  v69,  v70,  v71,  v72,  v73,  v74,  v75,  v101);
    uint64_t v76 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v76, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_47:
    sub_100657858();
    return;
  }

  uint64_t v63 = *a1;
  unsigned __int16 v64 = *(_WORD *)(*a1 + (unsigned __int16)(v13 + 6));
  *((_WORD *)a1 + 6) = v13 + 8;
  if ((int)(v62 - (unsigned __int16)(v13 + 8)) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the connection latency  of the LE connection complete event",  v77,  v78,  v79,  v80,  v81,  v82,  v83,  v101);
    uint64_t v84 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v84, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_47;
  }

  unsigned __int16 v65 = *(_WORD *)(v63 + (unsigned __int16)(v13 + 8));
  *((_WORD *)a1 + 6) = v13 + 10;
  if ((int)(v62 - (unsigned __int16)(v13 + 10)) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the supervision timeout of the LE connection complete event",  v85,  v86,  v87,  v88,  v89,  v90,  v91,  v101);
    uint64_t v92 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v92, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_47;
  }

  uint64_t v66 = (unsigned __int8 *)(v63 + (unsigned __int16)(v13 + 10));
  __int16 v67 = *v66;
  __int16 v68 = v66[1];
  *((_WORD *)a1 + 6) = v13 + 12;
  if (v62 > (unsigned __int16)(v13 + 12))
  {
    *((_WORD *)a1 + 6) = v13 + 13;
    sub_1001ADE74( v7,  v8,  v10,  &v102,  0LL,  v64,  v65,  v67 | (v68 << 8),  *(_BYTE *)(v63 + (unsigned __int16)(v13 + 12)),  0xFFFF,  a2);
    return;
  }

  *((_BYTE *)a1 + 15) = 1;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Could not get the central clock accuracy of the LE connection complete event",  v93,  v94,  v95,  v96,  v97,  v98,  v99,  v101);
    uint64_t v100 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v100, OS_LOG_TYPE_ERROR)) {
      goto LABEL_47;
    }
  }

void sub_1001B0B90(uint64_t *a1, char a2)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v2 = 0LL;
LABEL_4:
    sub_1001EE134( (uint64_t)"Not enough data in the packet : %d, expecting at least %d",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  v2);
    __int16 v13 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_6;
  }

  unsigned int v4 = *((unsigned __int16 *)a1 + 5);
  uint64_t v5 = *((unsigned __int16 *)a1 + 6);
  uint64_t v2 = v4 - v5;
  *(_OWORD *)ptr = 0u;
  memset(v106, 0, sizeof(v106));
  __int128 v104 = 0u;
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  104,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (v4 <= v5)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the number of reports of the LE advertising report event",  v39,  v40,  v41,  v42,  v43,  v44,  v45,  v103);
    uint64_t v46 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_6:
    sub_100657858();
    return;
  }

  uint64_t v14 = *a1;
  *((_WORD *)a1 + 6) = v5 + 1;
  int v15 = *(unsigned __int8 *)(v14 + v5);
  BYTE1(ptr[1]) = a2;
  if (!v15) {
    return;
  }
  int v16 = 0;
  while (1)
  {
    if (*((_BYTE *)a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  111,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_45:
      *((_BYTE *)a1 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get the event type of the LE advertising report event",  v47,  v48,  v49,  v50,  v51,  v52,  v53,  v103);
      uint64_t v54 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_67;
    }

    unsigned int v17 = *((unsigned __int16 *)a1 + 5);
    uint64_t v18 = *((unsigned __int16 *)a1 + 6);
    uint64_t v19 = *a1;
    uint64_t v20 = v18 + 1;
    *((_WORD *)a1 + 6) = v18 + 1;
    LOBYTE(v104) = *(_BYTE *)(v19 + v18);
    uint64_t v21 = v18 + 2;
    *((_WORD *)a1 + 6) = v21;
    BYTE1(v104) = *(_BYTE *)(v19 + v20);
    if ((int)(v17 - v21) <= 5) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  115,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
    }
    sub_1001F0050((uint64_t)&v104 + 2, v19 + v21, 6uLL);
    __int16 v22 = *((_WORD *)a1 + 6);
    *((_WORD *)a1 + 6) = v22 + 6;
    if (*((_BYTE *)a1 + 15))
    {
      sub_1001EE134( (uint64_t)"Could not get the address of the LE advertising report event",  v63,  v64,  v65,  v66,  v67,  v68,  v69,  v103);
      uint64_t v70 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v70, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_67;
    }

    if (*((_BYTE *)a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  117,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v22 + 6))
    {
      *((_BYTE *)a1 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get the dataLength of the LE advertising report event",  v71,  v72,  v73,  v74,  v75,  v76,  v77,  v103);
      uint64_t v78 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_67;
    }

    uint64_t v23 = *a1;
    *((_WORD *)a1 + 6) = v22 + 7;
    uint64_t v24 = (unsigned __int16)(v22 + 6);
    size_t v25 = *(unsigned __int8 *)(v23 + v24);
    WORD4(v104) = *(unsigned __int8 *)(v23 + v24);
    if (v25 >= 0x20)
    {
      sub_1001EE134( (uint64_t)"Too many info bytes in the LE advertising report event.",  v79,  v80,  v81,  v82,  v83,  v84,  v85,  v103);
      uint64_t v86 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v86, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_67;
    }

    uint64_t v26 = sub_1000B17F4(v25);
    ptr[0] = v26;
    uint64_t v27 = WORD4(v104);
    int v28 = *((unsigned __int8 *)a1 + 14);
    if (v26) {
      BOOL v29 = WORD4(v104) == 0;
    }
    else {
      BOOL v29 = 1;
    }
    if (!v29)
    {
      if (v28 != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  125,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v30 = v26;
      uint64_t v31 = *a1;
      uint64_t v32 = *((unsigned __int16 *)a1 + 6);
      if (*((_BYTE *)a1 + 15))
      {
        sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
        int v33 = 0;
      }

      else
      {
        int v33 = *((unsigned __int16 *)a1 + 5) - (_DWORD)v32;
      }

      if (v33 < WORD4(v104))
      {
        *((_BYTE *)a1 + 15) = 1;
LABEL_65:
        sub_1001EE134( (uint64_t)"Could not get the dataLength of the LE advertising report event",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  v103);
        unsigned __int8 v102 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
          return;
        }
LABEL_67:
        sub_100657858();
        return;
      }

      uint64_t v34 = (char *)(v31 + v32);
      uint64_t v35 = &v30[v27];
      do
      {
        char v36 = *v34++;
        *v30++ = v36;
      }

      while (v30 < v35);
      *((_WORD *)a1 + 6) += WORD4(v104);
      if (*((_BYTE *)a1 + 15)) {
        goto LABEL_65;
      }
      int v28 = *((unsigned __int8 *)a1 + 14);
    }

    if (v28 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  128,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_61:
      *((_BYTE *)a1 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get the rssi of the LE advertising report event",  v87,  v88,  v89,  v90,  v91,  v92,  v93,  v103);
      uint64_t v94 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_67;
    }

    uint64_t v37 = *((unsigned __int16 *)a1 + 6);
    uint64_t v38 = *a1;
    *((_WORD *)a1 + 6) = v37 + 1;
    LOBYTE(ptr[1]) = *(_BYTE *)(v38 + v37);
    if (BYTE1(v104) >= 2u) {
      BYTE1(v104) -= 2;
    }
    BYTE12(v106[0]) = 0;
    *(_DWORD *)((char *)v106 + 15) = 256;
    sub_1001C5618((unsigned __int16 *)&v104);
    sub_1000B1838(ptr[0]);
    if (++v16 == v15) {
      return;
    }
  }

  *((_BYTE *)a1 + 15) = 1;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Could not get the address type of the LE advertising report event",  v55,  v56,  v57,  v58,  v59,  v60,  v61,  v103);
    unsigned int v62 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR)) {
      goto LABEL_67;
    }
  }

void sub_1001B1164(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    if ((_DWORD)v1 == 9)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  175,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      if (v2 <= v3)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the status of the LE connection update event",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  v60);
          uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
            goto LABEL_13;
          }
        }
      }

      else
      {
        uint64_t v4 = *a1;
        *((_WORD *)a1 + 6) = v3 + 1;
        if ((int)(v2 - (v3 + 1)) <= 1)
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the connection handle of the LE connection update event",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v60);
            uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
              goto LABEL_13;
            }
          }
        }

        else
        {
          uint64_t v5 = *(unsigned __int8 *)(v4 + v3);
          unsigned __int16 v6 = *(_WORD *)(v4 + v3 + 1);
          *((_WORD *)a1 + 6) = v3 + 3;
          if ((int)(v2 - (unsigned __int16)(v3 + 3)) <= 1)
          {
            *((_BYTE *)a1 + 15) = 1;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not get the connection interval of the LE connection update event",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v60);
              uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
                goto LABEL_13;
              }
            }
          }

          else
          {
            unsigned __int16 v7 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 3));
            *((_WORD *)a1 + 6) = v3 + 5;
            if ((int)(v2 - (unsigned __int16)(v3 + 5)) <= 1)
            {
              *((_BYTE *)a1 + 15) = 1;
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Could not get the connection latency  of the LE connection update event",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  v60);
                uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_13;
                }
              }
            }

            else
            {
              uint64_t v8 = (unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 5));
              int v9 = *v8;
              int v10 = v8[1];
              *((_WORD *)a1 + 6) = v3 + 7;
              if ((int)(v2 - (unsigned __int16)(v3 + 7)) > 1)
              {
                uint64_t v11 = *(unsigned __int16 *)(v4 + (unsigned __int16)(v3 + 7));
                *((_WORD *)a1 + 6) = v3 + 9;
                sub_1001AE638(v5, v6, v7, v9 | (v10 << 8), v11);
                return;
              }

              *((_BYTE *)a1 + 15) = 1;
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Could not get the supervision timeout of the LE connection update event",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  v60);
                uint64_t v59 = (os_log_s *)sub_100086554(0x42u);
                if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_13;
                }
              }
            }
          }
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the connection update packet : %d expecting at least %d",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v1);
    uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
LABEL_13:
    }
      sub_100657858();
  }

void sub_1001B143C(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
    goto LABEL_11;
  }

  unsigned int v2 = *((unsigned __int16 *)a1 + 5);
  uint64_t v3 = *((unsigned __int16 *)a1 + 6);
  uint64_t v1 = v2 - v3;
  uint64_t v43 = 0LL;
  if ((_DWORD)v1 != 11)
  {
LABEL_11:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Not enough data in the feature packet : %d expecting at least %d",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v1);
      uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  205,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (v2 <= v3)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the status of the read remote used features event",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  v42);
    uint64_t v25 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_23:
    sub_100657858();
    return;
  }

  uint64_t v4 = *a1;
  *((_WORD *)a1 + 6) = v3 + 1;
  if ((int)(v2 - (v3 + 1)) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the connection handle of the read remote used features event",  v26,  v27,  v28,  v29,  v30,  v31,  v32,  v42);
    uint64_t v33 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_23;
  }

  unsigned int v5 = *(unsigned __int8 *)(v4 + v3);
  unsigned __int16 v6 = *(_WORD *)(v4 + v3 + 1);
  *((_WORD *)a1 + 6) = v3 + 3;
  if ((int)(v2 - (unsigned __int16)(v3 + 3)) >= 8)
  {
    uint64_t v7 = 0LL;
    uint64_t v8 = v4 + (unsigned __int16)(v3 + 3);
    do
    {
      *((_BYTE *)&v43 + v7) = *(_BYTE *)(v8 + v7);
      ++v7;
    }

    while (v7 != 8);
    *((_WORD *)a1 + 6) = v3 + 11;
    uint64_t v9 = sub_10016F5B0(v5);
    sub_1001AEA1C(v9, v6, &v43);
    return;
  }

  *((_BYTE *)a1 + 15) = 1;
  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Could not get the features of the read remote used features event",  v34,  v35,  v36,  v37,  v38,  v39,  v40,  v42);
    uint64_t v41 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
      goto LABEL_23;
    }
  }

void sub_1001B168C(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = (v2 - v3);
    uint64_t v33 = 0LL;
    if ((_DWORD)v1 == 12)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  228,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v4 = *a1;
      unsigned __int16 v5 = *(_WORD *)(*a1 + v3);
      *((_WORD *)a1 + 6) = v3 + 2;
      if (v2 - (unsigned __int16)(v3 + 2) < 8)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the random number of the long term key request event",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  v32);
          uint64_t v23 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            goto LABEL_12;
          }
        }
      }

      else
      {
        for (uint64_t i = 0LL; i != 8; ++i)
          *((_BYTE *)&v33 + i) = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 2) + i);
        *((_WORD *)a1 + 6) = v3 + 10;
        if (v2 - (unsigned __int16)(v3 + 10) <= 1)
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the encryption diversifier of the long term key request event",  v24,  v25,  v26,  v27,  v28,  v29,  v30,  v32);
            uint64_t v31 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }
        }

        else
        {
          uint64_t v7 = *(unsigned __int16 *)(v4 + (unsigned __int16)(v3 + 10));
          *((_WORD *)a1 + 6) = v3 + 12;
          sub_1001C76B8(v5, &v33, v7);
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the long term key request packet : %d expecting at least %d",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  v1);
    uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
LABEL_12:
    }
      sub_100657858();
  }

void sub_1001B1888(uint64_t a1)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    int v2 = *(unsigned __int16 *)(a1 + 10);
    uint64_t v3 = *(unsigned __int16 *)(a1 + 12);
    uint64_t v1 = (v2 - v3);
    if ((_DWORD)v1 == 10)
    {
      if (*(_BYTE *)(a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  255,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v4 = *(unsigned __int16 *)(*(void *)a1 + v3);
      *(_WORD *)(a1 + 12) = v3 + 2;
      if (v2 - (unsigned __int16)(v3 + 2) <= 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  256,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *(_WORD *)(a1 + 12) = v3 + 4;
      if (v2 - (unsigned __int16)(v3 + 4) <= 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  257,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *(_WORD *)(a1 + 12) = v3 + 6;
      if (v2 - (unsigned __int16)(v3 + 6) <= 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  258,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *(_WORD *)(a1 + 12) = v3 + 8;
      if (v2 - (unsigned __int16)(v3 + 8) <= 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  259,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *(_WORD *)(a1 + 12) = v3 + 10;
      if (sub_10012D6D8(v4))
      {
        sub_1001B9C24();
        return;
      }

      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"LE_HCIEventHandler_RemoteConnectionParameterRequest: Invalid connectionHandle for lmHandle 0x%2x",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v4);
        uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          goto LABEL_13;
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the Remote Connection Parameter Request message: %d expecting at least %d",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v1);
    uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
LABEL_13:
    }
      sub_100657858();
  }

void sub_1001B1AD8(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
    goto LABEL_10;
  }

  int v2 = *((unsigned __int16 *)a1 + 5);
  uint64_t v3 = *((unsigned __int16 *)a1 + 6);
  uint64_t v1 = (v2 - v3);
  if ((_DWORD)v1 != 10)
  {
LABEL_10:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Not enough data for data length changed: %d expecting at least %d",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v1);
      uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  284,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v4 = *a1;
  unsigned __int16 v5 = *(_WORD *)(*a1 + v3);
  *((_WORD *)a1 + 6) = v3 + 2;
  if (v2 - (unsigned __int16)(v3 + 2) <= 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  285,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  unsigned __int16 v6 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 2));
  *((_WORD *)a1 + 6) = v3 + 4;
  if (v2 - (unsigned __int16)(v3 + 4) <= 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  286,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  unsigned __int16 v7 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 4));
  *((_WORD *)a1 + 6) = v3 + 6;
  if (v2 - (unsigned __int16)(v3 + 6) <= 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  287,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v8 = (unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 6));
  int v9 = *v8;
  int v10 = v8[1];
  *((_WORD *)a1 + 6) = v3 + 8;
  if (v2 - (unsigned __int16)(v3 + 8) <= 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  288,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v11 = *(unsigned __int16 *)(v4 + (unsigned __int16)(v3 + 8));
  *((_WORD *)a1 + 6) = v3 + 10;
  sub_1001AEE34(v5, v6, v7, v9 | (v10 << 8), v11);
}

void sub_1001B1CA4(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
    goto LABEL_10;
  }

  unsigned int v2 = *((unsigned __int16 *)a1 + 5);
  uint64_t v3 = *((unsigned __int16 *)a1 + 6);
  uint64_t v1 = v2 - v3;
  if ((_DWORD)v1 != 5)
  {
LABEL_10:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Not enough data for phy update complete: %d expecting at least 6",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v1);
      uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (v2 <= v3)
  {
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_16;
  }

  if (*((_BYTE *)a1 + 14) != 1)
  {
    uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_1000E6B88("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c", 300, v18);
  }

  uint64_t v4 = *a1;
  *((_WORD *)a1 + 6) = v3 + 1;
  if ((int)(v2 - (v3 + 1)) <= 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  301,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v5 = *(unsigned __int8 *)(v4 + v3);
  unsigned __int16 v6 = *(_WORD *)(v4 + v3 + 1);
  *((_WORD *)a1 + 6) = v3 + 3;
  if (v2 <= (unsigned __int16)(v3 + 3)) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  302,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a1 + 6) = v3 + 4;
  if (v2 <= (unsigned __int16)(v3 + 4)) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  303,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  int v7 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 3));
  *((_WORD *)a1 + 6) = v3 + 5;
  int v8 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 4));
  int v9 = sub_10012D6D8(v6);
  sub_1001AF218(v5, (uint64_t)v9, v7, v8);
}

void sub_1001B1E58(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
    goto LABEL_11;
  }

  unsigned int v2 = *((unsigned __int16 *)a1 + 5);
  int v3 = *((unsigned __int16 *)a1 + 6);
  uint64_t v1 = v2 - v3;
  if ((_DWORD)v1 != 3)
  {
LABEL_11:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Not enough data for phy update complete: %d expecting at least 3",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  v1);
      uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  320,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  *((_WORD *)a1 + 6) = v3 + 2;
  if (v2 <= (unsigned __int16)(v3 + 2)) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  321,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v4 = *a1;
  *((_WORD *)a1 + 6) = v3 + 3;
  uint64_t v5 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 2));
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE channel Selection algorithm %d", v6, v7, v8, v9, v10, v11, v12, v5);
    uint64_t v13 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v23 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

void sub_1001B2004(uint64_t *a1, char a2)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v2 = 0LL;
    __int128 v185 = 0u;
    __int128 v186 = 0u;
    *(_OWORD *)ptr = 0u;
    __int128 v184 = 0u;
    __int128 v182 = 0u;
LABEL_4:
    sub_1001EE134( (uint64_t)"Not enough data in the packet : %d, expecting at least %d",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  v2);
    uint64_t v13 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_6;
  }

  unsigned int v4 = *((unsigned __int16 *)a1 + 5);
  uint64_t v5 = *((unsigned __int16 *)a1 + 6);
  uint64_t v2 = v4 - v5;
  __int128 v185 = 0u;
  __int128 v186 = 0u;
  *(_OWORD *)ptr = 0u;
  __int128 v184 = 0u;
  __int128 v182 = 0u;
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  344,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (v4 <= v5)
  {
    *((_BYTE *)a1 + 15) = 1;
    sub_1001EE134( (uint64_t)"Could not get the number of reports of the LE extended advertising report event",  v61,  v62,  v63,  v64,  v65,  v66,  v67,  v181);
    uint64_t v68 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v68, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_6:
    sub_100657858();
    return;
  }

  uint64_t v14 = *a1;
  *((_WORD *)a1 + 6) = v5 + 1;
  int v15 = *(unsigned __int8 *)(v14 + v5);
  BYTE1(ptr[1]) = a2;
  if (!v15) {
    return;
  }
  int v16 = 0;
  while (1)
  {
    if (*((_BYTE *)a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  351,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a1 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_73:
      *((_BYTE *)a1 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get the event type of the LE extended advertising report event",  v69,  v70,  v71,  v72,  v73,  v74,  v75,  v181);
      uint64_t v76 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v76, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_116;
    }

    uint64_t v17 = *((unsigned __int16 *)a1 + 6);
    uint64_t v18 = (unsigned __int8 *)(*a1 + v17);
    unsigned int v19 = *v18;
    LODWORD(v18) = v18[1];
    *((_WORD *)a1 + 6) = v17 + 2;
    char v20 = v19 & 0x1F;
    WORD1(ptr[1]) = v19 & 0x1F;
    BYTE4(ptr[1]) = (v19 >> 5) & 3;
    BYTE14(v184) = v19 >> 7;
    BYTE13(v184) = v18 & 0x3F;
    BYTE12(v184) = (v18 & 0x40) != 0;
    HIBYTE(v184) = v18 >> 7;
    uint64_t v21 = (v19 & 0x1F) - 16LL;
    if (((0x2C2Du >> v21) & 1) != 0)
    {
      char v32 = byte_1006BD818[v21];
    }

    else
    {
LABEL_17:
      BYTE11(v184) = 1;
      int v22 = sub_1000A86F0();
      if ((v20 & 1) != 0)
      {
        if ((v20 & 4) != 0)
        {
          if (v22)
          {
            sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE & EXTENDED_ADVERTISING_EVENT_TYPE_DIRECTED_ADV",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v181);
            uint64_t v38 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
            {
              uint64_t v39 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446210;
              uint64_t v188 = v39;
              _os_log_impl((void *)&_mh_execute_header, v38, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }

          char v32 = 1;
        }

        else
        {
          if (v22)
          {
            sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v181);
            uint64_t v33 = (os_log_s *)sub_100086554(0x42u);
            BOOL v34 = os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT);
            char v32 = 0;
            if (!v34) {
              goto LABEL_37;
            }
            uint64_t v35 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v188 = v35;
            _os_log_impl((void *)&_mh_execute_header, v33, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }

          char v32 = 0;
        }
      }

      else if ((v20 & 8) != 0)
      {
        if (v22)
        {
          sub_1001EE134( (uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_SCAN_RSP",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v181);
          uint64_t v36 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v37 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v188 = v37;
            _os_log_impl((void *)&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        char v32 = 4;
      }

      else
      {
        if (v22)
        {
          sub_1001EE134( (uint64_t)"legacy=false LE_ADVERTISING_TYPE_NON_CONNECTABLE_UNDIRECTED",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v181);
          uint64_t v30 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v31 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v188 = v31;
            _os_log_impl((void *)&_mh_execute_header, v30, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        char v32 = 3;
      }
    }

void sub_1001B2B64(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    if (v1 > 4)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  481,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      if (v2 <= v3)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the status of the LE advertising set terminated event",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  v51);
          uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            goto LABEL_6;
          }
        }
      }

      else
      {
        uint64_t v12 = *a1;
        *((_WORD *)a1 + 6) = v3 + 1;
        if (v2 <= (unsigned __int16)(v3 + 1))
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the advertising handle of the LE advertising set terminated event",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  v51);
            BOOL v34 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
              goto LABEL_6;
            }
          }
        }

        else
        {
          uint64_t v13 = *(unsigned __int8 *)(v12 + v3);
          uint64_t v14 = v3 + 2;
          *((_WORD *)a1 + 6) = v3 + 2;
          if ((int)(v2 - (v3 + 2)) <= 1)
          {
            *((_BYTE *)a1 + 15) = 1;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not get the connection handle of the LE advertising set terminated event",  v35,  v36,  v37,  v38,  v39,  v40,  v41,  v51);
              uint64_t v42 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
                goto LABEL_6;
              }
            }
          }

          else
          {
            uint64_t v15 = *(unsigned __int8 *)(v12 + v3 + 1);
            uint64_t v16 = v12 + v14;
            int v17 = *(unsigned __int8 *)(v12 + v14);
            int v18 = *(unsigned __int8 *)(v16 + 1);
            *((_WORD *)a1 + 6) = v3 + 4;
            if (v2 > (unsigned __int16)(v3 + 4))
            {
              *((_WORD *)a1 + 6) = v3 + 5;
              sub_10012D6D8(v17 | (v18 << 8));
              nullsub_63(v13, v15);
              return;
            }

            *((_BYTE *)a1 + 15) = 1;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not get the number of advertising events of the LE advertising set terminated event",  v43,  v44,  v45,  v46,  v47,  v48,  v49,  v51);
              uint64_t v50 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
                goto LABEL_6;
              }
            }
          }
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Not enough data in the packet : %d, expecting at least %d", v4, v5, v6, v7, v8, v9, v10, v1);
    uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
LABEL_6:
    }
      sub_100657858();
  }

void sub_1001B2DE8(int a1, uint64_t *a2, unsigned __int8 a3)
{
  if (*((_BYTE *)a2 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v6 = 0LL;
  }

  else
  {
    uint64_t v6 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
  }

  *(_DWORD *)&v144[3] = 0;
  *(_DWORD *)uint64_t v144 = 0;
  *(_DWORD *)((char *)v143 + 3) = 0;
  v143[0] = 0;
  if (a1 != 1 || (_DWORD)v6 == 30)
  {
    if (a1 == 2 && (_DWORD)v6 != 33)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid enhanced connection complete V2 event packet size : %d, expecting %d",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v6);
        uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  654,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_26:
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the status of the LE enhanced connection complete event",  v40,  v41,  v42,  v43,  v44,  v45,  v46,  v142);
        uint64_t v47 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return;
    }

    unsigned int v23 = *((unsigned __int16 *)a2 + 5);
    uint64_t v24 = *((unsigned __int16 *)a2 + 6);
    uint64_t v25 = *a2;
    *((_WORD *)a2 + 6) = v24 + 1;
    if ((int)(v23 - (v24 + 1)) <= 1)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the connection handle of the LE enhanced connection complete event",  v48,  v49,  v50,  v51,  v52,  v53,  v54,  v142);
        uint64_t v55 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    uint64_t v26 = *(unsigned __int8 *)(v25 + v24);
    unsigned __int16 v27 = *(_WORD *)(v25 + v24 + 1);
    *((_WORD *)a2 + 6) = v24 + 3;
    if (v23 <= (unsigned __int16)(v24 + 3))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the connection role of the LE enhanced connection complete event",  v56,  v57,  v58,  v59,  v60,  v61,  v62,  v142);
        uint64_t v63 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    unsigned __int16 v28 = v24 + 4;
    *((_WORD *)a2 + 6) = v24 + 4;
    if (v23 <= (unsigned __int16)(v24 + 4))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the peer address type of the LE enhanced connection complete event",  v64,  v65,  v66,  v67,  v68,  v69,  v70,  v142);
        uint64_t v71 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v71, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    int v29 = *(unsigned __int8 *)(v25 + (unsigned __int16)(v24 + 3));
    unsigned __int16 v30 = v24 + 5;
    *((_WORD *)a2 + 6) = v30;
    v144[0] = *(_BYTE *)(v25 + v28);
    if ((int)(v23 - v30) <= 5) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  666,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
    }
    sub_1001F0050((uint64_t)&v144[1], v25 + v30, 6uLL);
    __int16 v31 = *((_WORD *)a2 + 6);
    *((_WORD *)a2 + 6) = v31 + 6;
    if (*((_BYTE *)a2 + 15))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the peer address of the LE enhanced connection complete event",  v32,  v33,  v34,  v35,  v36,  v37,  v38,  v142);
        uint64_t v39 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return;
    }

    int v72 = *((unsigned __int16 *)a2 + 5);
    if (v72 - (unsigned __int16)(v31 + 6) <= 5) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  669,  "ByteStream_NumReadBytesAvail(*pBs) >= (6)");
    }
    unsigned __int16 v73 = v31 + 12;
    *((_WORD *)a2 + 6) = v73;
    if (v72 - v73 <= 5)
    {
      uint64_t v141 = "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE";
    }

    else
    {
      if (*((_BYTE *)a2 + 14) == 1)
      {
        sub_1001F0050((uint64_t)v143 + 1, *a2 + v73, 6uLL);
        __int16 v74 = *((_WORD *)a2 + 6);
        *((_WORD *)a2 + 6) = v74 + 6;
        if (*((_BYTE *)a2 + 15))
        {
          sub_1001EE134( (uint64_t)"Could not get the peer address of the LE enhanced connection complete event",  v75,  v76,  v77,  v78,  v79,  v80,  v81,  v142);
          uint64_t v82 = (os_log_s *)sub_100086554(0x42u);
          if (!os_log_type_enabled(v82, OS_LOG_TYPE_ERROR)) {
            return;
          }
          goto LABEL_84;
        }

        LOBYTE(v143[0]) = 1;
        if (*((_BYTE *)a2 + 14) != 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  675,  "(*pBs).__RWFlag == BYTESTREAM_READ");
        }
        unsigned int v83 = *((unsigned __int16 *)a2 + 5);
        if ((int)(v83 - (unsigned __int16)(v74 + 6)) <= 1)
        {
          *((_BYTE *)a2 + 15) = 1;
          sub_1001EE134( (uint64_t)"Could not get the connection interval of the LE enhanced connection complete event",  v90,  v91,  v92,  v93,  v94,  v95,  v96,  v142);
          uint64_t v97 = (os_log_s *)sub_100086554(0x42u);
          if (!os_log_type_enabled(v97, OS_LOG_TYPE_ERROR)) {
            return;
          }
        }

        else
        {
          uint64_t v84 = *a2;
          unsigned __int16 v85 = *(_WORD *)(*a2 + (unsigned __int16)(v74 + 6));
          *((_WORD *)a2 + 6) = v74 + 8;
          if ((int)(v83 - (unsigned __int16)(v74 + 8)) <= 1)
          {
            *((_BYTE *)a2 + 15) = 1;
            sub_1001EE134( (uint64_t)"Could not get the connection latency  of the LE enhanced connection complete event",  v98,  v99,  v100,  v101,  v102,  v103,  v104,  v142);
            uint64_t v105 = (os_log_s *)sub_100086554(0x42u);
            if (!os_log_type_enabled(v105, OS_LOG_TYPE_ERROR)) {
              return;
            }
          }

          else
          {
            unsigned __int16 v86 = *(_WORD *)(v84 + (unsigned __int16)(v74 + 8));
            *((_WORD *)a2 + 6) = v74 + 10;
            if ((int)(v83 - (unsigned __int16)(v74 + 10)) <= 1)
            {
              *((_BYTE *)a2 + 15) = 1;
              sub_1001EE134( (uint64_t)"Could not get the supervision timeout of the LE enhanced connection complete event",  v106,  v107,  v108,  v109,  v110,  v111,  v112,  v142);
              uint64_t v113 = (os_log_s *)sub_100086554(0x42u);
              if (!os_log_type_enabled(v113, OS_LOG_TYPE_ERROR)) {
                return;
              }
            }

            else
            {
              unsigned __int16 v87 = *(_WORD *)(v84 + (unsigned __int16)(v74 + 10));
              *((_WORD *)a2 + 6) = v74 + 12;
              if (v83 <= (unsigned __int16)(v74 + 12))
              {
                *((_BYTE *)a2 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get the central clock accuracy of the LE enhanced connection complete event",  v114,  v115,  v116,  v117,  v118,  v119,  v120,  v142);
                uint64_t v121 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v121, OS_LOG_TYPE_ERROR)) {
                  return;
                }
              }

              else
              {
                *((_WORD *)a2 + 6) = v74 + 13;
                char v88 = *(_BYTE *)(v84 + (unsigned __int16)(v74 + 12));
                if (a1 != 2)
                {
                  __int16 v89 = -1;
                  goto LABEL_68;
                }

                if (v83 <= (unsigned __int16)(v74 + 13))
                {
                  *((_BYTE *)a2 + 15) = 1;
                  sub_1001EE134( (uint64_t)"Could not get the advertising handle of the LE enhanced connection complete V2 event",  v123,  v124,  v125,  v126,  v127,  v128,  v129,  v142);
                  uint64_t v130 = (os_log_s *)sub_100086554(0x42u);
                  if (!os_log_type_enabled(v130, OS_LOG_TYPE_ERROR)) {
                    return;
                  }
                }

                else
                {
                  *((_WORD *)a2 + 6) = v74 + 14;
                  if ((int)(v83 - (unsigned __int16)(v74 + 14)) >= 2)
                  {
                    __int16 v89 = *(_WORD *)(v84 + (unsigned __int16)(v74 + 14));
                    *((_WORD *)a2 + 6) = v74 + 16;
LABEL_68:
                    int v122 = v144[0] & 0xFE;
                    if (v144[0] == 3)
                    {
                      v144[0] = 1;
                    }

                    else if (v144[0] == 2)
                    {
                      v144[0] = 0;
                    }

                    if (v122 == 2) {
                      uint64_t v131 = (unsigned __int8 *)v143;
                    }
                    else {
                      uint64_t v131 = v144;
                    }
                    if (v122 == 2) {
                      uint64_t v132 = v144;
                    }
                    else {
                      uint64_t v132 = 0LL;
                    }
                    sub_1001ADE74(v26, v27, v29, v131, v132, v85, v86, v87, v88, v89, a3);
                    return;
                  }

                  *((_BYTE *)a2 + 15) = 1;
                  sub_1001EE134( (uint64_t)"Could not get the sync handle of the LE enhanced connection complete V2 event",  v133,  v134,  v135,  v136,  v137,  v138,  v139,  v142);
                  uint64_t v140 = (os_log_s *)sub_100086554(0x42u);
                  if (!os_log_type_enabled(v140, OS_LOG_TYPE_ERROR)) {
                    return;
                  }
                }
              }
            }
          }
        }

void sub_1001B355C(int a1, uint64_t *a2)
{
  if (*((_BYTE *)a2 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v4 = 0LL;
  }

  else
  {
    uint64_t v4 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
  }

  memset(v128, 0, 20);
  if (a1 != 1 || (_DWORD)v4 == 15)
  {
    if (a1 == 2 && (_DWORD)v4 != 19)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid periodic advertising sync established V2 event packet size : %d, expecting %d",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v4);
        uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  737,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_26:
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the status of the LE periodic advertising sync established event",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v127);
        uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return;
    }

    unsigned int v21 = *((unsigned __int16 *)a2 + 5);
    uint64_t v22 = *((unsigned __int16 *)a2 + 6);
    uint64_t v23 = *a2;
    *((_WORD *)a2 + 6) = v22 + 1;
    if ((int)(v21 - (v22 + 1)) <= 1)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the sync handle of the LE periodic advertising sync established event",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  v127);
        uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    unsigned int v24 = *(unsigned __int8 *)(v23 + v22);
    LOWORD(v128[0]) = *(_WORD *)(v23 + v22 + 1);
    *((_WORD *)a2 + 6) = v22 + 3;
    if (v21 <= (unsigned __int16)(v22 + 3))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the SID of the LE periodic advertising sync established event",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  v127);
        uint64_t v59 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    unsigned __int16 v25 = v22 + 4;
    *((_WORD *)a2 + 6) = v22 + 4;
    BYTE2(v128[0]) = *(_BYTE *)(v23 + (unsigned __int16)(v22 + 3));
    if (v21 <= (unsigned __int16)(v22 + 4))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the advertiser address type of the LE periodic advertising sync established event",  v60,  v61,  v62,  v63,  v64,  v65,  v66,  v127);
        uint64_t v67 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v67, OS_LOG_TYPE_ERROR)) {
          goto LABEL_38;
        }
      }

      return;
    }

    unsigned __int16 v26 = v22 + 5;
    *((_WORD *)a2 + 6) = v26;
    BYTE3(v128[0]) = *(_BYTE *)(v23 + v25);
    if ((int)(v21 - v26) <= 5) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  745,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
    }
    sub_1001F0050((uint64_t)v128 + 4, v23 + v26, 6uLL);
    __int16 v27 = *((_WORD *)a2 + 6);
    *((_WORD *)a2 + 6) = v27 + 6;
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001EE134( (uint64_t)"Could not get the advertiser address of the LE periodic advertising sync established event",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v127);
      uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_70;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  747,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v68 = *((unsigned __int16 *)a2 + 5);
    if (v68 <= (unsigned __int16)(v27 + 6))
    {
      *((_BYTE *)a2 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get the PHY of the LE periodic advertising sync established event",  v71,  v72,  v73,  v74,  v75,  v76,  v77,  v127);
      uint64_t v78 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
        return;
      }
    }

    else
    {
      uint64_t v69 = *a2;
      *((_WORD *)a2 + 6) = v27 + 7;
      BYTE2(v128[1]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 6));
      if ((int)(v68 - (unsigned __int16)(v27 + 7)) <= 1)
      {
        *((_BYTE *)a2 + 15) = 1;
        sub_1001EE134( (uint64_t)"Could not get the periodic advertsing interval of the LE periodic advertising sync established event",  v79,  v80,  v81,  v82,  v83,  v84,  v85,  v127);
        unsigned __int16 v86 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v86, OS_LOG_TYPE_ERROR)) {
          return;
        }
      }

      else
      {
        WORD2(v128[1]) = *(_WORD *)(v69 + (unsigned __int16)(v27 + 7));
        *((_WORD *)a2 + 6) = v27 + 9;
        if (v68 <= (unsigned __int16)(v27 + 9))
        {
          *((_BYTE *)a2 + 15) = 1;
          sub_1001EE134( (uint64_t)"Could not get the central clock accuracy of the LE periodic advertising sync established event",  v87,  v88,  v89,  v90,  v91,  v92,  v93,  v127);
          uint64_t v94 = (os_log_s *)sub_100086554(0x42u);
          if (!os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
            return;
          }
        }

        else
        {
          *((_WORD *)a2 + 6) = v27 + 10;
          BYTE6(v128[1]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 9));
          *(_DWORD *)((char *)&v128[1] + 7) = 0;
          if (a1 != 2)
          {
LABEL_49:
            uint64_t v70 = sub_10016F5B0(v24);
            sub_1000AE770((uint64_t)v128, v70);
            return;
          }

          if (v68 <= (unsigned __int16)(v27 + 10))
          {
            *((_BYTE *)a2 + 15) = 1;
            sub_1001EE134( (uint64_t)"Could not get Number_Subevents of LE periodic advertising sync transfer received event",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  v127);
            uint64_t v102 = (os_log_s *)sub_100086554(0x42u);
            if (!os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
              return;
            }
          }

          else
          {
            *((_WORD *)a2 + 6) = v27 + 11;
            HIBYTE(v128[1]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 10));
            if (v68 <= (unsigned __int16)(v27 + 11))
            {
              *((_BYTE *)a2 + 15) = 1;
              sub_1001EE134( (uint64_t)"Could not get Subevent_Interval of LE periodic advertising sync transfer received event",  v103,  v104,  v105,  v106,  v107,  v108,  v109,  v127);
              uint64_t v110 = (os_log_s *)sub_100086554(0x42u);
              if (!os_log_type_enabled(v110, OS_LOG_TYPE_ERROR)) {
                return;
              }
            }

            else
            {
              *((_WORD *)a2 + 6) = v27 + 12;
              LOBYTE(v128[2]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 11));
              if (v68 <= (unsigned __int16)(v27 + 12))
              {
                *((_BYTE *)a2 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get Response_Slot_Delay of LE periodic advertising sync transfer received event",  v111,  v112,  v113,  v114,  v115,  v116,  v117,  v127);
                uint64_t v118 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v118, OS_LOG_TYPE_ERROR)) {
                  return;
                }
              }

              else
              {
                *((_WORD *)a2 + 6) = v27 + 13;
                BYTE1(v128[2]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 12));
                if (v68 > (unsigned __int16)(v27 + 13))
                {
                  *((_WORD *)a2 + 6) = v27 + 14;
                  BYTE2(v128[2]) = *(_BYTE *)(v69 + (unsigned __int16)(v27 + 13));
                  goto LABEL_49;
                }

                *((_BYTE *)a2 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get Response_Slot_Spacing of LE periodic advertising sync transfer received event",  v119,  v120,  v121,  v122,  v123,  v124,  v125,  v127);
                uint64_t v126 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v126, OS_LOG_TYPE_ERROR)) {
                  return;
                }
              }
            }
          }
        }
      }
    }

void sub_1001B3BF0(int a1, uint64_t *a2)
{
  if (*((_BYTE *)a2 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v4 = 0LL;
  }

  else
  {
    uint64_t v4 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
  }

  if (a1 != 1 || v4 > 6)
  {
    if (a1 == 2 && v4 <= 9)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid periodic advertising report V2 event packet size : %d, expecting at least %d",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v4);
        uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  793,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_25:
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the sync handle of the LE periodic advertising report event",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v131);
        uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return;
    }

    unsigned int v21 = *((unsigned __int16 *)a2 + 5);
    uint64_t v22 = *((unsigned __int16 *)a2 + 6);
    uint64_t v23 = *a2;
    unsigned __int16 v24 = *(_WORD *)(*a2 + v22);
    *((_WORD *)a2 + 6) = v22 + 2;
    if (v21 <= (unsigned __int16)(v22 + 2))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the TX power of the LE periodic advertising report event",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  v131);
        uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    *((_WORD *)a2 + 6) = v22 + 3;
    if (v21 <= (unsigned __int16)(v22 + 3))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the RSSI of the LE periodic advertising report event",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  v131);
        uint64_t v59 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    char v25 = *(_BYTE *)(v23 + (unsigned __int16)(v22 + 2));
    *((_WORD *)a2 + 6) = v22 + 4;
    if (v21 <= (unsigned __int16)(v22 + 4))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the CTE Type of the LE periodic advertising report event",  v60,  v61,  v62,  v63,  v64,  v65,  v66,  v131);
        uint64_t v67 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v67, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    char v26 = *(_BYTE *)(v23 + (unsigned __int16)(v22 + 3));
    unsigned __int16 v27 = v22 + 5;
    *((_WORD *)a2 + 6) = v22 + 5;
    char v28 = *(_BYTE *)(v23 + (unsigned __int16)(v22 + 4));
    if (a1 == 2)
    {
      if ((int)(v21 - v27) <= 1)
      {
        *((_BYTE *)a2 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the periodic event counter of the LE periodic advertising report event",  v87,  v88,  v89,  v90,  v91,  v92,  v93,  v131);
          uint64_t v94 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
            goto LABEL_56;
          }
        }

        return;
      }

      uint64_t v29 = (unsigned __int8 *)(v23 + v27);
      __int16 v30 = *v29;
      __int16 v31 = v29[1];
      unsigned __int16 v32 = v22 + 7;
      *((_WORD *)a2 + 6) = v22 + 7;
      if (v21 <= (unsigned __int16)(v22 + 7))
      {
        *((_BYTE *)a2 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the subevent of the LE periodic advertising report event",  v103,  v104,  v105,  v106,  v107,  v108,  v109,  v131);
          uint64_t v110 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v110, OS_LOG_TYPE_ERROR)) {
            goto LABEL_56;
          }
        }

        return;
      }

      __int16 v33 = v30 | (v31 << 8);
      unsigned __int16 v34 = v22 + 8;
      *((_WORD *)a2 + 6) = v34;
      char v35 = *(_BYTE *)(v23 + v32);
    }

    else
    {
      __int16 v33 = 0;
      char v35 = 0;
      unsigned __int16 v34 = v22 + 5;
    }

    if (v21 <= v34)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the data status of the LE periodic advertising report event",  v79,  v80,  v81,  v82,  v83,  v84,  v85,  v131);
        unsigned __int16 v86 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v86, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    uint64_t v68 = v34 + 1LL;
    *((_WORD *)a2 + 6) = v34 + 1;
    if (v21 <= (unsigned __int16)(v34 + 1))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the data length of the LE periodic advertising report event",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  v131);
        uint64_t v102 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    char v69 = *(_BYTE *)(v23 + v34);
    *((_WORD *)a2 + 6) = v34 + 2;
    uint64_t v70 = *(unsigned __int8 *)(v23 + v68);
    if (v70 >= 0xF8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Too many data bytes in the LE extended advertising report event.",  v71,  v72,  v73,  v74,  v75,  v76,  v77,  v131);
        uint64_t v78 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
          goto LABEL_56;
        }
      }

      return;
    }

    if (*(_BYTE *)(v23 + v68))
    {
      uint64_t v111 = sub_1000B17F4(*(unsigned __int8 *)(v23 + v68));
      if (v111)
      {
        if (*((_BYTE *)a2 + 14) != 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  820,  "(*pBs).__RWFlag == BYTESTREAM_READ");
        }
        uint64_t v112 = v111;
        uint64_t v132 = *((unsigned __int16 *)a2 + 6);
        uint64_t v133 = *a2;
        if (*((_BYTE *)a2 + 15))
        {
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
          int v113 = 0;
        }

        else
        {
          int v113 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
        }

        if (v113 < (int)v70)
        {
          *((_BYTE *)a2 + 15) = 1;
          goto LABEL_74;
        }

        uint64_t v122 = 0LL;
        do
        {
          v112[v122] = *(_BYTE *)(v133 + v132 + v122);
          ++v122;
        }

        while (&v112[v122] < &v112[v70]);
        *((_WORD *)a2 + 6) += v70;
        if (*((_BYTE *)a2 + 15))
        {
LABEL_74:
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the data of the LE periodic advertising report event",  v123,  v124,  v125,  v126,  v127,  v128,  v129,  v131);
            uint64_t v130 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v130, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          goto LABEL_77;
        }

void sub_1001B426C(uint64_t a1)
{
  if (*(_BYTE *)(a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
    goto LABEL_6;
  }

  uint64_t v2 = *(unsigned __int16 *)(a1 + 12);
  uint64_t v1 = *(unsigned __int16 *)(a1 + 10) - v2;
  if ((_DWORD)v1 != 2)
  {
LABEL_6:
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Invalid periodic advertising sync established event packet size : %d, expecting %d",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v1);
      uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  if (*(_BYTE *)(a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  850,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  __int16 v3 = v2 + 2;
  int v4 = *(unsigned __int16 *)(*(void *)a1 + v2);
  *(_WORD *)(a1 + 12) = v3;
  sub_1000AED0C(v4);
}

void sub_1001B4358(int a1, uint64_t *a2)
{
  if (*((_BYTE *)a2 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v4 = 0LL;
  }

  else
  {
    uint64_t v4 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
  }

  *(int *)((char *)v157 + 3) = 0;
  v157[0] = 0;
  if (a1 != 1 || (_DWORD)v4 == 19)
  {
    if (a1 == 1 && (_DWORD)v4 != 23)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid periodic advertising sync transfer received event packet size : %d, expecting ",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v4);
        uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  883,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_28:
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get status of LE periodic advertising sync transfer received event",  v40,  v41,  v42,  v43,  v44,  v45,  v46,  v153);
        uint64_t v47 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return;
    }

    unsigned int v21 = *((unsigned __int16 *)a2 + 5);
    uint64_t v22 = *((unsigned __int16 *)a2 + 6);
    uint64_t v23 = *a2;
    *((_WORD *)a2 + 6) = v22 + 1;
    if ((int)(v21 - (v22 + 1)) <= 1)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get connection_handle of LE periodic advertising sync transfer received event",  v48,  v49,  v50,  v51,  v52,  v53,  v54,  v153);
        uint64_t v55 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    unsigned int v24 = *(unsigned __int8 *)(v23 + v22);
    unsigned __int16 v25 = *(_WORD *)(v23 + v22 + 1);
    *((_WORD *)a2 + 6) = v22 + 3;
    if ((int)(v21 - (unsigned __int16)(v22 + 3)) <= 1)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get service_data of LE periodic advertising sync transfer received event",  v56,  v57,  v58,  v59,  v60,  v61,  v62,  v153);
        uint64_t v63 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    __int16 v26 = *(_WORD *)(v23 + (unsigned __int16)(v22 + 3));
    *((_WORD *)a2 + 6) = v22 + 5;
    if ((int)(v21 - (unsigned __int16)(v22 + 5)) <= 1)
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get sync_handle of LE periodic advertising sync transfer received event",  v64,  v65,  v66,  v67,  v68,  v69,  v70,  v153);
        uint64_t v71 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v71, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    __int16 v27 = *(_WORD *)(v23 + (unsigned __int16)(v22 + 5));
    *((_WORD *)a2 + 6) = v22 + 7;
    if (v21 <= (unsigned __int16)(v22 + 7))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get advertising_SID of LE periodic advertising sync transfer received event",  v72,  v73,  v74,  v75,  v76,  v77,  v78,  v153);
        uint64_t v79 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v79, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    unsigned __int16 v28 = v22 + 8;
    *((_WORD *)a2 + 6) = v22 + 8;
    if (v21 <= (unsigned __int16)(v22 + 8))
    {
      *((_BYTE *)a2 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get advertiser address_type of LE periodic advertising sync transfer received event",  v80,  v81,  v82,  v83,  v84,  v85,  v86,  v153);
        uint64_t v87 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR)) {
          goto LABEL_46;
        }
      }

      return;
    }

    char v29 = *(_BYTE *)(v23 + (unsigned __int16)(v22 + 7));
    unsigned __int16 v30 = v22 + 9;
    *((_WORD *)a2 + 6) = v30;
    LOBYTE(v157[0]) = *(_BYTE *)(v23 + v28);
    if ((int)(v21 - v30) <= 5) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  895,  "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
    }
    sub_1001F0050((uint64_t)v157 + 1, v23 + v30, 6uLL);
    __int16 v31 = *((_WORD *)a2 + 6);
    *((_WORD *)a2 + 6) = v31 + 6;
    if (*((_BYTE *)a2 + 15))
    {
      sub_1001EE134( (uint64_t)"Could not get advertiser address of LE periodic advertising sync transfer received event",  v32,  v33,  v34,  v35,  v36,  v37,  v38,  v153);
      uint64_t v39 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_79;
    }

    if (*((_BYTE *)a2 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  897,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v88 = *((unsigned __int16 *)a2 + 5);
    if (v88 <= (unsigned __int16)(v31 + 6))
    {
      *((_BYTE *)a2 + 15) = 1;
      sub_1001EE134( (uint64_t)"Could not get advertiser_PHY of LE periodic advertising sync transfer received event",  v95,  v96,  v97,  v98,  v99,  v100,  v101,  v153);
      uint64_t v102 = (os_log_s *)sub_100086554(0x42u);
      if (!os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
        return;
      }
    }

    else
    {
      uint64_t v89 = *a2;
      *((_WORD *)a2 + 6) = v31 + 7;
      if ((int)(v88 - (unsigned __int16)(v31 + 7)) <= 1)
      {
        *((_BYTE *)a2 + 15) = 1;
        sub_1001EE134( (uint64_t)"Could not get Periodic_Advertising_Interval of LE periodic advertising sync transfer received event",  v103,  v104,  v105,  v106,  v107,  v108,  v109,  v153);
        uint64_t v110 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v110, OS_LOG_TYPE_ERROR)) {
          return;
        }
      }

      else
      {
        int v90 = *(unsigned __int8 *)(v89 + (unsigned __int16)(v31 + 6));
        __int16 v91 = *(_WORD *)(v89 + (unsigned __int16)(v31 + 7));
        *((_WORD *)a2 + 6) = v31 + 9;
        if (v88 <= (unsigned __int16)(v31 + 9))
        {
          *((_BYTE *)a2 + 15) = 1;
          sub_1001EE134( (uint64_t)"Could not get Advertiser_Clock_Accuracy of LE periodic advertising sync transfer received event",  v111,  v112,  v113,  v114,  v115,  v116,  v117,  v153);
          uint64_t v118 = (os_log_s *)sub_100086554(0x42u);
          if (!os_log_type_enabled(v118, OS_LOG_TYPE_ERROR)) {
            return;
          }
        }

        else
        {
          int v156 = v90;
          *((_WORD *)a2 + 6) = v31 + 10;
          char v92 = *(_BYTE *)(v89 + (unsigned __int16)(v31 + 9));
          if (a1 != 2)
          {
            char v154 = 0;
            char v155 = 0;
            char v93 = 0;
            char v94 = 0;
            goto LABEL_67;
          }

          if (v88 <= (unsigned __int16)(v31 + 10))
          {
            *((_BYTE *)a2 + 15) = 1;
            sub_1001EE134( (uint64_t)"Could not get Number_Subevents of LE periodic advertising sync transfer received event",  v121,  v122,  v123,  v124,  v125,  v126,  v127,  v153);
            uint64_t v128 = (os_log_s *)sub_100086554(0x42u);
            if (!os_log_type_enabled(v128, OS_LOG_TYPE_ERROR)) {
              return;
            }
          }

          else
          {
            *((_WORD *)a2 + 6) = v31 + 11;
            if (v88 <= (unsigned __int16)(v31 + 11))
            {
              *((_BYTE *)a2 + 15) = 1;
              sub_1001EE134( (uint64_t)"Could not get Subevent_Interval of LE periodic advertising sync transfer received event",  v129,  v130,  v131,  v132,  v133,  v134,  v135,  v153);
              char v136 = (os_log_s *)sub_100086554(0x42u);
              if (!os_log_type_enabled(v136, OS_LOG_TYPE_ERROR)) {
                return;
              }
            }

            else
            {
              char v155 = *(_BYTE *)(v89 + (unsigned __int16)(v31 + 10));
              *((_WORD *)a2 + 6) = v31 + 12;
              if (v88 <= (unsigned __int16)(v31 + 12))
              {
                *((_BYTE *)a2 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get Response_Slot_Delay of LE periodic advertising sync transfer received event",  v137,  v138,  v139,  v140,  v141,  v142,  v143,  v153);
                char v144 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v144, OS_LOG_TYPE_ERROR)) {
                  return;
                }
              }

              else
              {
                char v154 = *(_BYTE *)(v89 + (unsigned __int16)(v31 + 11));
                *((_WORD *)a2 + 6) = v31 + 13;
                if (v88 > (unsigned __int16)(v31 + 13))
                {
                  char v93 = *(_BYTE *)(v89 + (unsigned __int16)(v31 + 12));
                  *((_WORD *)a2 + 6) = v31 + 14;
                  char v94 = *(_BYTE *)(v89 + (unsigned __int16)(v31 + 13));
LABEL_67:
                  uint64_t v119 = sub_10012D6D8(v25);
                  uint64_t v120 = sub_10016F5B0(v24);
                  sub_1000AEDEC(v120, (uint64_t)v119, v26, v27, v29, v157, v156, v91, v92, v155, v154, v93, v94);
                  return;
                }

                *((_BYTE *)a2 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get Response_Slot_Spacing of LE periodic advertising sync transfer received event",  v145,  v146,  v147,  v148,  v149,  v150,  v151,  v153);
                uint64_t v152 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v152, OS_LOG_TYPE_ERROR)) {
                  return;
                }
              }
            }
          }
        }
      }
    }

void sub_1001B4AF8(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  936,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    if (v2 > v3)
    {
      uint64_t v4 = *a1;
      *((_WORD *)a1 + 6) = v3 + 1;
      if ((int)(v2 - (v3 + 1)) <= 1)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get connection_handle of tx power report  event",  v21,  v22,  v23,  v24,  v25,  v26,  v27,  v69);
          unsigned __int16 v28 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
            goto LABEL_15;
          }
        }
      }

      else
      {
        uint64_t v5 = *(unsigned __int8 *)(v4 + v3);
        unsigned __int16 v6 = *(_WORD *)(v4 + v3 + 1);
        *((_WORD *)a1 + 6) = v3 + 3;
        if (v2 <= (unsigned __int16)(v3 + 3))
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get reason of tx power report  event",  v29,  v30,  v31,  v32,  v33,  v34,  v35,  v69);
            uint64_t v36 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
              goto LABEL_15;
            }
          }
        }

        else
        {
          *((_WORD *)a1 + 6) = v3 + 4;
          if (v2 <= (unsigned __int16)(v3 + 4))
          {
            *((_BYTE *)a1 + 15) = 1;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not get phy of tx power report  event",  v37,  v38,  v39,  v40,  v41,  v42,  v43,  v69);
              uint64_t v44 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
                goto LABEL_15;
              }
            }
          }

          else
          {
            char v7 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 3));
            *((_WORD *)a1 + 6) = v3 + 5;
            if (v2 <= (unsigned __int16)(v3 + 5))
            {
              *((_BYTE *)a1 + 15) = 1;
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Could not get TX_Power_Level of tx power report  event",  v45,  v46,  v47,  v48,  v49,  v50,  v51,  v69);
                uint64_t v52 = (os_log_s *)sub_100086554(0x42u);
                if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_15;
                }
              }
            }

            else
            {
              char v8 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 4));
              *((_WORD *)a1 + 6) = v3 + 6;
              if (v2 <= (unsigned __int16)(v3 + 6))
              {
                *((_BYTE *)a1 + 15) = 1;
                if (sub_1000A86F0())
                {
                  sub_1001EE134( (uint64_t)"Could not get TX_Power_Level_Flag of tx power report  event",  v53,  v54,  v55,  v56,  v57,  v58,  v59,  v69);
                  uint64_t v60 = (os_log_s *)sub_100086554(0x42u);
                  if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR)) {
                    goto LABEL_15;
                  }
                }
              }

              else
              {
                char v9 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 5));
                *((_WORD *)a1 + 6) = v3 + 7;
                if (v2 <= (unsigned __int16)(v3 + 7))
                {
                  *((_BYTE *)a1 + 15) = 1;
                  if (sub_1000A86F0())
                  {
                    sub_1001EE134( (uint64_t)"Could not get delta of tx power report  event",  v61,  v62,  v63,  v64,  v65,  v66,  v67,  v69);
                    uint64_t v68 = (os_log_s *)sub_100086554(0x42u);
                    if (os_log_type_enabled(v68, OS_LOG_TYPE_ERROR)) {
                      goto LABEL_15;
                    }
                  }
                }

                else
                {
                  char v10 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 6));
                  *((_WORD *)a1 + 6) = v3 + 8;
                  char v11 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 7));
                  __int16 v12 = v6;
                  if (sub_10012D6D8(v6)) {
                    sub_1001AFF4C(v5, v12, v7, v8, v9, v10, v11);
                  }
                }
              }
            }
          }
        }
      }

      return;
    }
  }

  *((_BYTE *)a1 + 15) = 1;
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"Could not get status tx power report  event", v13, v14, v15, v16, v17, v18, v19, v69);
    uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
LABEL_15:
    }
      sub_100657858();
  }

void sub_1001B4E60(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    if ((_DWORD)v1 == 25)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1360,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v4 = *a1;
      unsigned __int16 v5 = *(_WORD *)(*a1 + v3);
      *((_WORD *)a1 + 6) = v3 + 2;
      if (v2 <= (unsigned __int16)(v3 + 2))
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the status of the read remote used features event",  v35,  v36,  v37,  v38,  v39,  v40,  v41,  v43);
          uint64_t v42 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
            goto LABEL_25;
          }
        }
      }

      else
      {
        *((_WORD *)a1 + 6) = v3 + 3;
        if (v2 <= (unsigned __int16)(v3 + 3)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1364,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned int v6 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 2));
        *((_WORD *)a1 + 6) = v3 + 4;
        if ((int)(v2 - (unsigned __int16)(v3 + 4)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1365,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        int v7 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 3));
        unsigned __int16 v8 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 4));
        *((_WORD *)a1 + 6) = v3 + 6;
        if (v2 <= (unsigned __int16)(v3 + 6)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1366,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        *((_WORD *)a1 + 6) = v3 + 7;
        if (v2 <= (unsigned __int16)(v3 + 7)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1367,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v9 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 6));
        *((_WORD *)a1 + 6) = v3 + 8;
        if (v2 <= (unsigned __int16)(v3 + 8)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1368,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v10 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 7));
        *((_WORD *)a1 + 6) = v3 + 9;
        if (v2 <= (unsigned __int16)(v3 + 9)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1369,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v11 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 8));
        *((_WORD *)a1 + 6) = v3 + 10;
        if (v2 <= (unsigned __int16)(v3 + 10)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1370,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v12 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 9));
        *((_WORD *)a1 + 6) = v3 + 11;
        if (v2 <= (unsigned __int16)(v3 + 11)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1371,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int8 v13 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 10));
        *((_WORD *)a1 + 6) = v3 + 12;
        if (v2 <= (unsigned __int16)(v3 + 12)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1372,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int8 v14 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 11));
        *((_WORD *)a1 + 6) = v3 + 13;
        if (v2 <= (unsigned __int16)(v3 + 13)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1373,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int8 v15 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 12));
        *((_WORD *)a1 + 6) = v3 + 14;
        if ((int)(v2 - (unsigned __int16)(v3 + 14)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1374,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int8 v16 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 13));
        unsigned __int16 v17 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 14));
        *((_WORD *)a1 + 6) = v3 + 16;
        if ((int)(v2 - (unsigned __int16)(v3 + 16)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1375,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v18 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 16));
        *((_WORD *)a1 + 6) = v3 + 18;
        if ((int)(v2 - (unsigned __int16)(v3 + 18)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1376,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v19 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 18));
        *((_WORD *)a1 + 6) = v3 + 20;
        if ((int)(v2 - (unsigned __int16)(v3 + 20)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1377,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v20 = *(_WORD *)(v4 + (unsigned __int16)(v3 + 20));
        *((_WORD *)a1 + 6) = v3 + 22;
        if ((int)(v2 - (unsigned __int16)(v3 + 22)) <= 1) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1378,  "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int8 v44 = v14;
        unsigned __int8 v45 = v13;
        int v49 = v11;
        int v50 = v12;
        int v47 = v9;
        int v48 = v10;
        int v46 = v7;
        uint64_t v21 = (unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 22));
        __int16 v22 = *v21;
        __int16 v23 = v21[1];
        *((_WORD *)a1 + 6) = v3 + 24;
        if (v2 <= (unsigned __int16)(v3 + 24)) {
          sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1379,  "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int16 v24 = v22 | (v23 << 8);
        *((_WORD *)a1 + 6) = v3 + 25;
        unsigned __int8 v25 = *(_BYTE *)(v4 + (unsigned __int16)(v3 + 24));
        uint64_t v26 = sub_10016F5B0(v6);
        sub_1001B002C(v5, v26, v46, v8, v47, v48, v49, v50, v45, v44, v15, v16, v17, v18, v19, v20, v24, v25);
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the capabilites packet : %d expecting at least %d",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  v1);
    uint64_t v34 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
LABEL_25:
    }
      sub_100657858();
  }

void sub_1001B533C(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    uint64_t v28 = 0LL;
    memset(v27, 0, sizeof(v27));
    if ((_DWORD)v1 == 75)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1397,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v4 = *a1;
      unsigned __int16 v5 = *(_WORD *)(*a1 + v3);
      *((_WORD *)a1 + 6) = v3 + 2;
      if (v2 <= (unsigned __int16)(v3 + 2))
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the status of the read remote used features event",  v17,  v18,  v19,  v20,  v21,  v22,  v23,  v26);
          unsigned __int16 v24 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
            goto LABEL_12;
          }
        }
      }

      else
      {
        *((_WORD *)a1 + 6) = v3 + 3;
        uint64_t v6 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 2));
        if ((int)(v2 - (unsigned __int16)(v3 + 3)) < 72)
        {
          *((_BYTE *)a1 + 15) = 1;
        }

        else
        {
          uint64_t v7 = 0LL;
          uint64_t v8 = v4 + (unsigned __int16)(v3 + 3);
          do
          {
            *((_BYTE *)v27 + v7) = *(_BYTE *)(v8 + v7);
            ++v7;
          }

          while (v7 != 72);
          *((_WORD *)a1 + 6) = v3 + 75;
        }

        unsigned __int8 v25 = sub_10012D6D8(v5);
        sub_1001B962C(v6, (uint64_t)v25, (uint64_t)v27);
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the capabilites packet : %d expecting at least %d",  v9,  v10,  v11,  v12,  v13,  v14,  v15,  v1);
    unsigned __int8 v16 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
LABEL_12:
    }
      sub_100657858();
  }

void sub_1001B5510(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    if ((_DWORD)v1 == 3)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1419,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      uint64_t v4 = *a1;
      unsigned __int16 v5 = (unsigned __int8 *)(*a1 + v3);
      int v6 = *v5;
      int v7 = v5[1];
      *((_WORD *)a1 + 6) = v3 + 2;
      if (v2 > (unsigned __int16)(v3 + 2))
      {
        *((_WORD *)a1 + 6) = v3 + 3;
        uint64_t v8 = *(unsigned __int8 *)(v4 + (unsigned __int16)(v3 + 2));
        uint64_t v9 = sub_10012D6D8(v6 | (v7 << 8));
        sub_1001B96AC(v8, (uint64_t)v9);
        return;
      }

      *((_BYTE *)a1 + 15) = 1;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Could not get the status of the read remote used features event",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  v26);
        unsigned __int8 v25 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          goto LABEL_9;
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data for security enable complete event : %d expecting at least %d",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  v1);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
LABEL_9:
    }
      sub_100657858();
  }

void sub_1001B5674(uint64_t *a1)
{
  if (!*((_BYTE *)a1 + 15))
  {
    unsigned int v3 = *((unsigned __int16 *)a1 + 5);
    uint64_t v4 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v3 - v4;
    if ((_DWORD)v1 != 74) {
      goto LABEL_16;
    }
    if (*((_BYTE *)a1 + 14) != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1450,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v5 = *a1;
    unsigned __int16 v6 = *(_WORD *)(*a1 + v4);
    *((_WORD *)a1 + 6) = v4 + 2;
    if (v3 <= (unsigned __int16)(v4 + 2))
    {
      *((_BYTE *)a1 + 15) = 1;
      sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    }

    else
    {
      *((_WORD *)a1 + 6) = v4 + 3;
      if (v3 > (unsigned __int16)(v4 + 3))
      {
        uint64_t v7 = *(unsigned __int8 *)(v5 + (unsigned __int16)(v4 + 2));
        *((_WORD *)a1 + 6) = v4 + 4;
        uint64_t v8 = *(unsigned __int8 *)(v5 + (unsigned __int16)(v4 + 3));
        if (v3 <= (unsigned __int16)(v4 + 4))
        {
          unsigned __int16 v39 = v6;
          *((_BYTE *)a1 + 15) = 1;
          sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
          int v40 = *((unsigned __int8 *)a1 + 14);
          *((_BYTE *)a1 + 15) = 1;
          if (v40 != 1) {
            sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1457,  "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          uint64_t v9 = 0LL;
        }

        else
        {
          *((_WORD *)a1 + 6) = v4 + 5;
          uint64_t v9 = *(unsigned __int8 *)(v5 + (unsigned __int16)(v4 + 4));
          if (v3 > (unsigned __int16)(v4 + 5))
          {
            *((_WORD *)a1 + 6) = v4 + 6;
            uint64_t v10 = *(unsigned __int8 *)(v5 + (unsigned __int16)(v4 + 5));
            if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 6))
            {
              uint64_t v11 = *a1;
              *((_WORD *)a1 + 6) = v4 + 7;
              int v12 = *(unsigned __int8 *)(v11 + (unsigned __int16)(v4 + 6));
              if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 7))
              {
                uint64_t v13 = *a1;
                *((_WORD *)a1 + 6) = v4 + 8;
                unsigned int v14 = *(unsigned __int8 *)(v13 + (unsigned __int16)(v4 + 7));
                if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 8))
                {
                  uint64_t v15 = *a1;
                  *((_WORD *)a1 + 6) = v4 + 9;
                  unsigned int v16 = *(unsigned __int8 *)(v15 + (unsigned __int16)(v4 + 8));
                  if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 9))
                  {
                    uint64_t v17 = *a1;
                    *((_WORD *)a1 + 6) = v4 + 10;
                    char v18 = *(_BYTE *)(v17 + (unsigned __int16)(v4 + 9));
                    unsigned int v49 = v16;
                    if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 10))
                    {
                      uint64_t v19 = *a1;
                      *((_WORD *)a1 + 6) = v4 + 11;
                      char v20 = *(_BYTE *)(v19 + (unsigned __int16)(v4 + 10));
                      if (*((unsigned __int16 *)a1 + 5) > (unsigned __int16)(v4 + 11))
                      {
                        uint64_t v21 = *a1;
                        *((_WORD *)a1 + 6) = v4 + 12;
                        char v22 = *(_BYTE *)(v21 + (unsigned __int16)(v4 + 11));
LABEL_39:
                        int v46 = sub_10012D6D8(v6);
                        HIBYTE(v48) = v20;
                        LOBYTE(v48) = v18;
                        sub_1001B9724(v8, (uint64_t)v46, v7, v9, v10, v12, v14, v49, v48, v22);
                        return;
                      }

void sub_1001B5B84(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1491,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    goto LABEL_9;
  }

  uint64_t v2 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) - (int)v2 <= 1)
  {
LABEL_9:
    *((_BYTE *)a1 + 15) = 1;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Could not get the connection handle of the read remote used features event",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v66);
      unsigned int v14 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  int v3 = *(unsigned __int16 *)(*a1 + v2);
  *((_WORD *)a1 + 6) = v2 + 2;
  uint64_t v4 = sub_10012D6D8(v3);
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1494,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v5 = (uint64_t)v4;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v6 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v6 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1495,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_23;
  }

  uint64_t v15 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) <= v15)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_23:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v35 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v35 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1496,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v17 = 0LL;
    goto LABEL_25;
  }

  uint64_t v16 = *a1;
  *((_WORD *)a1 + 6) = v15 + 1;
  uint64_t v17 = *(unsigned __int8 *)(v16 + v15);
  if (*((unsigned __int16 *)a1 + 5) - ((int)v15 + 1) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_25:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v36 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v36 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1497,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v18 = 0;
    goto LABEL_27;
  }

  unsigned int v18 = *(unsigned __int8 *)(*a1 + v15 + 1);
  *((_WORD *)a1 + 6) = v15 + 3;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v15 + 3) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_27:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v37 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v37 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1498,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v19 = 0;
    goto LABEL_29;
  }

  unsigned int v19 = *(unsigned __int8 *)(*a1 + (unsigned __int16)(v15 + 3));
  *((_WORD *)a1 + 6) = v15 + 5;
  if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v15 + 5))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_29:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v38 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v38 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1499,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v21 = 0;
    goto LABEL_31;
  }

  uint64_t v20 = *a1;
  *((_WORD *)a1 + 6) = v15 + 6;
  unsigned int v21 = *(unsigned __int8 *)(v20 + (unsigned __int16)(v15 + 5));
  if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v15 + 6))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_31:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v39 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v39 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1500,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v23 = 0;
    goto LABEL_33;
  }

  uint64_t v22 = *a1;
  *((_WORD *)a1 + 6) = v15 + 7;
  unsigned int v23 = *(unsigned __int8 *)(v22 + (unsigned __int16)(v15 + 6));
  if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v15 + 7))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_33:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v40 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v40 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1501,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v25 = 0;
    goto LABEL_35;
  }

  uint64_t v24 = *a1;
  *((_WORD *)a1 + 6) = v15 + 8;
  unsigned int v25 = *(unsigned __int8 *)(v24 + (unsigned __int16)(v15 + 7));
  if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v15 + 8))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_35:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v41 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v41 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1503,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v69 = v23;
    unsigned int v70 = v21;
    unsigned int v67 = v18;
    unsigned int v68 = v19;
    unsigned int v27 = 0;
    goto LABEL_37;
  }

  uint64_t v26 = *a1;
  *((_WORD *)a1 + 6) = v15 + 9;
  unsigned int v27 = *(unsigned __int8 *)(v26 + (unsigned __int16)(v15 + 8));
  unsigned int v69 = v23;
  unsigned int v70 = v21;
  unsigned int v67 = v18;
  unsigned int v68 = v19;
  if (*((unsigned __int16 *)a1 + 5) <= (unsigned __int16)(v15 + 9))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_37:
    unsigned int v30 = v27;
    unsigned int v31 = v25;
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    LODWORD(v29) = 0;
    goto LABEL_38;
  }

  uint64_t v28 = *a1;
  *((_WORD *)a1 + 6) = v15 + 10;
  uint64_t v29 = *(unsigned __int8 *)(v28 + (unsigned __int16)(v15 + 9));
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v15 + 10) >= (int)v29)
  {
    if (*(_BYTE *)(v28 + (unsigned __int16)(v15 + 9)))
    {
      unsigned int v30 = v27;
      unsigned int v31 = v25;
      uint64_t v63 = (char *)(v28 + (unsigned __int16)(v15 + 10));
      uint64_t v64 = v74;
      do
      {
        char v65 = *v63++;
        *v64++ = v65;
      }

      while (v64 < (_BYTE *)v74 + v29);
      int v33 = v29;
      uint64_t v42 = v29;
      goto LABEL_39;
    }

    unsigned int v30 = v27;
    unsigned int v31 = v25;
LABEL_38:
    int v33 = 0;
    uint64_t v42 = 0LL;
LABEL_39:
    int v34 = v29;
    unsigned __int16 v32 = *((_WORD *)a1 + 6) + v29;
    *((_WORD *)a1 + 6) = v32;
    uint64_t v29 = v42;
    goto LABEL_40;
  }

  unsigned int v30 = v27;
  unsigned int v31 = v25;
  *((_BYTE *)a1 + 15) = 1;
  unsigned __int16 v32 = *((_WORD *)a1 + 6);
  int v33 = v29;
  int v34 = v29;
LABEL_40:
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1504,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v43 = *a1;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v44 = 0;
  }

  else
  {
    int v44 = *((unsigned __int16 *)a1 + 5) - v32;
  }

  if (v44 >= v33)
  {
    if (v34)
    {
      int v46 = (char *)(v43 + v32);
      uint64_t v47 = v73;
      do
      {
        char v48 = *v46++;
        *v47++ = v48;
      }

      while (v47 < (_BYTE *)v73 + v29);
    }

    unsigned __int16 v45 = *((_WORD *)a1 + 6) + v34;
    *((_WORD *)a1 + 6) = v45;
  }

  else
  {
    *((_BYTE *)a1 + 15) = 1;
    unsigned __int16 v45 = *((_WORD *)a1 + 6);
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1505,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v49 = *a1;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v50 = 0;
  }

  else
  {
    int v50 = *((unsigned __int16 *)a1 + 5) - v45;
  }

  if (v50 >= v33)
  {
    if (v34)
    {
      uint64_t v51 = (char *)(v49 + v45);
      uint64_t v52 = v72;
      do
      {
        char v53 = *v51++;
        *v52++ = v53;
      }

      while (v52 < (_BYTE *)v72 + v29);
    }

    *((_WORD *)a1 + 6) += v34;
  }

  else
  {
    *((_BYTE *)a1 + 15) = 1;
  }

  unsigned __int16 v54 = 0;
  if (v34)
  {
    uint64_t v55 = (unsigned __int8 *)v72;
    do
    {
      __int16 v56 = *v55++;
      v54 += v56;
      --v29;
    }

    while (v29);
  }

  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1510,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v57 = *a1;
  uint64_t v58 = *((unsigned __int16 *)a1 + 6);
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v59 = 0;
  }

  else
  {
    int v59 = *((unsigned __int16 *)a1 + 5) - (_DWORD)v58;
  }

  if (v59 >= v54)
  {
    if (v54)
    {
      uint64_t v60 = (char *)(v57 + v58);
      uint64_t v61 = v71;
      do
      {
        char v62 = *v60++;
        *v61++ = v62;
      }

      while (v61 < (_BYTE *)v71 + v54);
    }

    *((_WORD *)a1 + 6) += v54;
  }

  else
  {
    *((_BYTE *)a1 + 15) = 1;
  }

  sub_1001B97F8(v5, v17, v67, v68, v70, v69, v31, v30, v34, (uint64_t)v74, (uint64_t)v73, (uint64_t)v72, (uint64_t)v71);
}

void sub_1001B63CC(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1530,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    goto LABEL_9;
  }

  uint64_t v2 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) - (int)v2 <= 1)
  {
LABEL_9:
    *((_BYTE *)a1 + 15) = 1;
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Could not get the connection handle of the read remote used features event",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v58);
      unsigned int v14 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return;
  }

  int v3 = *(unsigned __int16 *)(*a1 + v2);
  *((_WORD *)a1 + 6) = v2 + 2;
  uint64_t v4 = sub_10012D6D8(v3);
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1533,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v5 = v4;
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v6 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v6 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1534,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_20;
  }

  uint64_t v15 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) <= v15)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_20:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v28 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v28 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1535,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v17 = 0LL;
    goto LABEL_22;
  }

  uint64_t v16 = *a1;
  *((_WORD *)a1 + 6) = v15 + 1;
  uint64_t v17 = *(unsigned __int8 *)(v16 + v15);
  if (*((unsigned __int16 *)a1 + 5) <= (v15 + 1))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_22:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v29 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v29 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1536,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v19 = 0LL;
    goto LABEL_24;
  }

  uint64_t v18 = *a1;
  *((_WORD *)a1 + 6) = v15 + 2;
  uint64_t v19 = *(unsigned __int8 *)(v18 + v15 + 1);
  if (*((unsigned __int16 *)a1 + 5) <= (v15 + 2))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_24:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v30 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v30 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1537,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v21 = 0LL;
    goto LABEL_26;
  }

  uint64_t v20 = *a1;
  *((_WORD *)a1 + 6) = v15 + 3;
  uint64_t v21 = *(unsigned __int8 *)(v20 + v15 + 2);
  if (*((unsigned __int16 *)a1 + 5) <= (v15 + 3))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_26:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v31 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v31 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1539,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned int v59 = 0;
    goto LABEL_28;
  }

  uint64_t v22 = *a1;
  *((_WORD *)a1 + 6) = v15 + 4;
  unsigned int v59 = *(unsigned __int8 *)(v22 + v15 + 3);
  if (*((unsigned __int16 *)a1 + 5) <= (v15 + 4))
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_28:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v24 = 0LL;
    goto LABEL_29;
  }

  uint64_t v23 = *a1;
  *((_WORD *)a1 + 6) = v15 + 5;
  uint64_t v24 = *(unsigned __int8 *)(v23 + v15 + 4);
  if (*((unsigned __int16 *)a1 + 5) - ((int)v15 + 5) >= (int)v24)
  {
    if (*(_BYTE *)(v23 + v15 + 4))
    {
      uint64_t v55 = (char *)(v23 + v15 + 5);
      __int16 v56 = v63;
      do
      {
        char v57 = *v55++;
        *v56++ = v57;
      }

      while (v56 < (_BYTE *)v63 + v24);
      int v26 = v24;
      uint64_t v32 = v24;
      goto LABEL_30;
    }

void sub_1001B6A64(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 14) != 1) {
    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1315,  "(*pBs).__RWFlag == BYTESTREAM_READ");
  }
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v2 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v2 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1316,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    goto LABEL_13;
  }

  uint64_t v3 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) <= v3)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_13:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v11 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v11 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1317,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v5 = 0LL;
    goto LABEL_15;
  }

  uint64_t v4 = *a1;
  *((_WORD *)a1 + 6) = v3 + 1;
  uint64_t v5 = *(unsigned __int8 *)(v4 + v3);
  if (*((unsigned __int16 *)a1 + 5) - ((int)v3 + 1) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_15:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v12 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v12 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1318,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned __int16 v6 = 0;
    goto LABEL_17;
  }

  unsigned __int16 v6 = *(_WORD *)(*a1 + v3 + 1);
  *((_WORD *)a1 + 6) = v3 + 3;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v3 + 3) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_17:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v13 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v13 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1319,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned __int16 v7 = 0;
    goto LABEL_19;
  }

  unsigned __int16 v7 = *(_WORD *)(*a1 + (unsigned __int16)(v3 + 3));
  *((_WORD *)a1 + 6) = v3 + 5;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v3 + 5) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_19:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    int v14 = *((unsigned __int8 *)a1 + 14);
    *((_BYTE *)a1 + 15) = 1;
    if (v14 != 1) {
      sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  1320,  "(*pBs).__RWFlag == BYTESTREAM_READ");
    }
    unsigned __int16 v8 = 0;
    goto LABEL_21;
  }

  unsigned __int16 v8 = *(_WORD *)(*a1 + (unsigned __int16)(v3 + 5));
  *((_WORD *)a1 + 6) = v3 + 7;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v3 + 7) <= 1)
  {
    *((_BYTE *)a1 + 15) = 1;
LABEL_21:
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    unsigned __int16 v9 = 0;
    goto LABEL_22;
  }

  unsigned __int16 v9 = *(_WORD *)(*a1 + (unsigned __int16)(v3 + 7));
  *((_WORD *)a1 + 6) = v3 + 9;
  if (*((unsigned __int16 *)a1 + 5) - (unsigned __int16)(v3 + 9) >= 2)
  {
    unsigned __int16 v10 = *(_WORD *)(*a1 + (unsigned __int16)(v3 + 9));
    *((_WORD *)a1 + 6) = v3 + 11;
    goto LABEL_23;
  }

void sub_1001B6DF0(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v2 = *((unsigned __int16 *)a1 + 5);
    uint64_t v3 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v2 - v3;
    if ((_DWORD)v1 == 3)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  521,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      if (v2 <= v3)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the advertising handle of the LE Periodic Advertising Subevent Data Request event",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  v39);
          uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
            goto LABEL_11;
          }
        }
      }

      else
      {
        uint64_t v4 = *a1;
        *((_WORD *)a1 + 6) = v3 + 1;
        if (v2 <= (int)v3 + 1)
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the subevent start of the LE Periodic Advertising Subevent Data Request event",  v23,  v24,  v25,  v26,  v27,  v28,  v29,  v39);
            int v30 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
              goto LABEL_11;
            }
          }
        }

        else
        {
          uint64_t v5 = *(unsigned __int8 *)(v4 + v3);
          *((_WORD *)a1 + 6) = v3 + 2;
          if (v2 > (int)v3 + 2)
          {
            uint64_t v6 = *(unsigned __int8 *)(v4 + v3 + 1);
            *((_WORD *)a1 + 6) = v3 + 3;
            nullsub_63(v5, v6);
            return;
          }

          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the subevent data count of the LE Periodic Advertising Subevent Data Request event",  v31,  v32,  v33,  v34,  v35,  v36,  v37,  v39);
            char v38 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
              goto LABEL_11;
            }
          }
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Invalid Periodic Advertising Subevent Data Request event packet size : %d, expecting %d",  v7,  v8,  v9,  v10,  v11,  v12,  v13,  v1);
    int v14 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
LABEL_11:
    }
      sub_100657858();
  }

void sub_1001B6FE4(uint64_t *a1)
{
  if (*((_BYTE *)a1 + 15))
  {
    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
    uint64_t v1 = 0LL;
  }

  else
  {
    unsigned int v3 = *((unsigned __int16 *)a1 + 5);
    uint64_t v4 = *((unsigned __int16 *)a1 + 6);
    uint64_t v1 = v3 - v4;
    if (v1 > 0xA)
    {
      if (*((_BYTE *)a1 + 14) != 1) {
        sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  568,  "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
      if (v3 <= v4)
      {
        *((_BYTE *)a1 + 15) = 1;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Could not get the advertising handle of the LE Periodic Advertising Response Report event",  v20,  v21,  v22,  v23,  v24,  v25,  v26,  v84);
          uint64_t v27 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
            goto LABEL_6;
          }
        }
      }

      else
      {
        uint64_t v13 = *a1;
        *((_WORD *)a1 + 6) = v4 + 1;
        if (v3 <= (int)v4 + 1)
        {
          *((_BYTE *)a1 + 15) = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Could not get the subevent of the LE Periodic Advertising Response Report event",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  v84);
            uint64_t v35 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
              goto LABEL_6;
            }
          }
        }

        else
        {
          uint64_t v14 = *(unsigned __int8 *)(v13 + v4);
          *((_WORD *)a1 + 6) = v4 + 2;
          if (v3 <= (int)v4 + 2)
          {
            *((_BYTE *)a1 + 15) = 1;
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not get the txStatus of the LE Periodic Advertising Response Report event",  v36,  v37,  v38,  v39,  v40,  v41,  v42,  v84);
              uint64_t v43 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
                goto LABEL_6;
              }
            }
          }

          else
          {
            unsigned int v85 = *(unsigned __int8 *)(v13 + v4 + 1);
            uint64_t v15 = v4 + 3;
            *((_WORD *)a1 + 6) = v4 + 3;
            if (v3 <= (int)v4 + 3)
            {
              *((_BYTE *)a1 + 15) = 1;
              if (sub_1000A86F0())
              {
                sub_1001EE134( (uint64_t)"Could not get the number of responses of the LE Periodic Advertising Response Report event",  v44,  v45,  v46,  v47,  v48,  v49,  v50,  v84);
                uint64_t v51 = (os_log_s *)sub_100086554(0x42u);
                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_6;
                }
              }
            }

            else
            {
              *((_WORD *)a1 + 6) = v4 + 4;
              if (*(_BYTE *)(v13 + v15))
              {
                int v16 = *(unsigned __int8 *)(v13 + v15);
                while (1)
                {
                  if (*((_BYTE *)a1 + 14) != 1) {
                    sub_1000E6B88( "/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c",  581,  "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*((_BYTE *)a1 + 15)) {
                    break;
                  }
                  unsigned int v17 = *((unsigned __int16 *)a1 + 5);
                  unsigned int v18 = *((unsigned __int16 *)a1 + 6);
                  if (v17 <= v18) {
                    goto LABEL_37;
                  }
                  *((_WORD *)a1 + 6) = v18 + 1;
                  if (v17 <= v18 + 1)
                  {
                    *((_BYTE *)a1 + 15) = 1;
                    sub_1001EE134( (uint64_t)"Could not get the address type of the LE advertising report event",  v60,  v61,  v62,  v63,  v64,  v65,  v66,  v84);
                    unsigned int v67 = (os_log_s *)sub_100086554(0x42u);
                    if (!os_log_type_enabled(v67, OS_LOG_TYPE_ERROR)) {
                      return;
                    }
                    goto LABEL_6;
                  }

                  *((_WORD *)a1 + 6) = v18 + 2;
                  if (v17 <= v18 + 2)
                  {
                    *((_BYTE *)a1 + 15) = 1;
                    sub_1001EE134( (uint64_t)"Could not get the address of the LE advertising report event",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  v84);
                    uint64_t v75 = (os_log_s *)sub_100086554(0x42u);
                    if (!os_log_type_enabled(v75, OS_LOG_TYPE_ERROR)) {
                      return;
                    }
                    goto LABEL_6;
                  }

                  *((_WORD *)a1 + 6) = v18 + 3;
                  if (v17 <= v18 + 3)
                  {
                    *((_BYTE *)a1 + 15) = 1;
                    sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_47:
                    *((_BYTE *)a1 + 15) = 1;
                    sub_1001EE134( (uint64_t)"Could not get the dataLength of the LE advertising report event",  v76,  v77,  v78,  v79,  v80,  v81,  v82,  v84);
                    uint64_t v83 = (os_log_s *)sub_100086554(0x42u);
                    if (!os_log_type_enabled(v83, OS_LOG_TYPE_ERROR)) {
                      return;
                    }
                    goto LABEL_6;
                  }

                  *((_WORD *)a1 + 6) = v18 + 4;
                  if (v17 <= v18 + 4) {
                    goto LABEL_47;
                  }
                  *((_WORD *)a1 + 6) = v18 + 5;
                  uint64_t v19 = sub_1000B17F4(0LL);
                  nullsub_63(v14, v85);
                  sub_1000B1838(v19);
                  if (!--v16) {
                    return;
                  }
                }

                sub_1001ED1C4((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/le/LE_Events.c");
LABEL_37:
                *((_BYTE *)a1 + 15) = 1;
                sub_1001EE134( (uint64_t)"Could not get the event type of the LE advertising report event",  v52,  v53,  v54,  v55,  v56,  v57,  v58,  v84);
                unsigned int v59 = (os_log_s *)sub_100086554(0x42u);
                if (!os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
                  return;
                }
                goto LABEL_6;
              }
            }
          }
        }
      }

      return;
    }
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"Not enough data in the packet : %d, expecting at least %d",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v1);
    uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
LABEL_6:
    }
      sub_100657858();
  }

void sub_1001B748C(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  if ((int)a1 > 8258)
  {
    if ((int)a1 > 8317)
    {
      if ((_DWORD)a1 == 8318)
      {
        if ((_DWORD)a2)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"Failed to send connection subrating command: %!",  v29,  v30,  v31,  v32,  v33,  v34,  v35,  a2);
            uint64_t v36 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
              goto LABEL_34;
            }
          }
        }

        return;
      }

      if ((_DWORD)a1 != 8325) {
        goto LABEL_32;
      }
    }

    else if ((_DWORD)a1 != 8259)
    {
      if ((_DWORD)a1 == 8260)
      {
        if ((_DWORD)a2) {
          sub_1000AEAA0();
        }
        return;
      }

      goto LABEL_32;
    }

void sub_1001B76E0(uint64_t a1, uint64_t a2)
{
  if (!a1 || !*(_BYTE *)(a1 + 125)) {
    return;
  }
  if ((int)a2 <= 760)
  {
    if (!(_DWORD)a2)
    {
      if (*(_BYTE *)(a1 + 55)) {
        uint64_t v20 = (_DWORD *)(a1 + 56);
      }
      else {
        uint64_t v20 = (_DWORD *)(a1 + 48);
      }
      goto LABEL_21;
    }

    if ((_DWORD)a2 != 634)
    {
      if ((_DWORD)a2 == 706)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Encryption failed, peer removed keys, keepConnectedAfterFailedInitialEncryption=%d",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  *(unsigned __int8 *)(a1 + 264));
          uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        if (!*(_BYTE *)(a1 + 264))
        {
          *(_DWORD *)(a1 + 132) = 6;
          *(_DWORD *)(a1 + 140) = 4833;
          sub_1001B7974(a1);
          return;
        }
      }

      goto LABEL_21;
    }

uint64_t sub_1001B7974(uint64_t a1)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (a1 && sub_10012D5EC(a1)) {
    return sub_1001ABA40(a1);
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"This handle is not a LE connection.", v3, v4, v5, v6, v7, v8, v9, v11);
    uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  return 1310LL;
}

uint64_t sub_1001B7A10(uint64_t a1)
{
  uint64_t v3 = a1;
  if (!a1 || !sub_10012D5EC(a1)) {
    return 1310LL;
  }
  if (!dword_1008ECCA4) {
    return sub_1001ADDD4();
  }
  v2[1] = &v3;
  v2[0] = (const void *)8;
  uint64_t result = sub_1001EE6E8((uint64_t)sub_1001BD924, v2, (unsigned __int16)((dword_1008ECCA4 + 99) / 0x64u), 0LL);
  if ((_DWORD)result) {
    return sub_1001ADDD4();
  }
  return result;
}

void sub_1001B7AA0(uint64_t a1, uint64_t a2)
{
  if (a1 && !(_DWORD)a2)
  {
    uint64_t v24 = 0LL;
    sub_1000B0400((uint64_t)&v24);
    *(_DWORD *)(a1 + 328) = sub_1001F43D4((int *)(a1 + 320), (int *)&v24);
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"LinkReady took %llums from connectionComplete",  v4,  v5,  v6,  v7,  v8,  v9,  v10,  *(unsigned int *)(a1 + 328));
      uint64_t v11 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v12 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v26 = v12;
        _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    goto LABEL_12;
  }

  if (!(_DWORD)a2)
  {
LABEL_12:
    unsigned int v21 = (unsigned __int16)word_1008E89B0;
    if (word_1008E89B0)
    {
      unint64_t v22 = 0LL;
      do
      {
        uint64_t v23 = *(void (**)(uint64_t, void, void))(qword_1008E89B8[v22] + 40LL);
        if (v23)
        {
          v23(a1, 0LL, *(unsigned __int8 *)(a1 + 316));
          unsigned int v21 = (unsigned __int16)word_1008E89B0;
        }

        ++v22;
      }

      while (v22 < v21);
    }

    goto LABEL_17;
  }

  if ((_DWORD)a2 != 719 && *(_BYTE *)(a1 + 124) != 7)
  {
    if (sub_1000A86F0())
    {
      sub_10012EFE0(*(unsigned __int8 *)(a1 + 124));
      sub_1001EE134( (uint64_t)"GAP LinkReadyCB error with status %! during %s, not-disconnecting",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  a2);
      uint64_t v20 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

uint64_t sub_1001B7C4C(uint64_t a1)
{
  __int16 v1 = word_1008E89B0;
  uint64_t v2 = (unsigned __int16)word_1008E89B0;
  if (word_1008E89B0)
  {
    if (word_1008E89B0 == 8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Can't add anymore callbacks.", v3, v4, v5, v6, v7, v8, v9, v14);
        uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 4050LL;
    }

    else
    {
      unsigned __int8 v12 = 0;
      while (qword_1008E89B8[v12] != a1)
      {
        if ((unsigned __int16)word_1008E89B0 <= ++v12)
        {
          uint64_t v2 = v12;
          goto LABEL_11;
        }
      }

      return 0LL;
    }
  }

  else
  {
LABEL_11:
    uint64_t v11 = 0LL;
    qword_1008E89B8[v2] = a1;
    word_1008E89B0 = v1 + 1;
  }

  return v11;
}

uint64_t sub_1001B7D14(uint64_t a1)
{
  __int16 v1 = word_1008E89F8;
  uint64_t v2 = (unsigned __int16)word_1008E89F8;
  if (word_1008E89F8)
  {
    if (word_1008E89F8 == 8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Can't add anymore callbacks.", v3, v4, v5, v6, v7, v8, v9, v14);
        uint64_t v10 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 4050LL;
    }

    else
    {
      unsigned __int8 v12 = 0;
      while (qword_1008E8A00[v12] != a1)
      {
        if ((unsigned __int16)word_1008E89F8 <= ++v12)
        {
          uint64_t v2 = v12;
          goto LABEL_11;
        }
      }

      return 0LL;
    }
  }

  else
  {
LABEL_11:
    uint64_t v11 = 0LL;
    qword_1008E8A00[v2] = a1;
    word_1008E89F8 = v1 + 1;
  }

  return v11;
}

uint64_t sub_1001B7DDC(uint64_t result)
{
  if (word_1008E89B0)
  {
    unsigned __int8 v1 = 0;
    while (qword_1008E89B8[v1] != result)
    {
    }

    uint64_t v3 = qword_1008E89B8[(unsigned __int16)--word_1008E89B0];
    unsigned __int16 v2 = word_1008E89B0;
    qword_1008E89B8[v1] = v3;
    qword_1008E89B8[v2] = 0LL;
  }

  return result;
}

void sub_1001B7E30(unsigned __int8 *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (byte_1008E8A40 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Connection complete, we need to update our own address now",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  v77);
      uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    sub_1001B835C();
  }

  if (a2)
  {
    if (*(_BYTE *)(a2 + 55)) {
      uint64_t v16 = (unsigned __int8 *)(a2 + 56);
    }
    else {
      uint64_t v16 = a1;
    }
    unint64_t v17 = ((unint64_t)v16[1] << 40) | ((unint64_t)v16[2] << 32) | ((unint64_t)v16[3] << 24) | ((unint64_t)v16[4] << 16) | ((unint64_t)v16[5] << 8) | v16[6] | ((unint64_t)*v16 << 48);
    if (sub_1001B8754(v17))
    {
      if (sub_1000A86F0())
      {
        uint64_t v25 = *a1 ? "Random" : "Public";
        sub_1001EE134( (uint64_t)"FastLEConnection:LE_GAP_IsFastLeConnectionEnabledForAddress enabled for %s:%:",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  (uint64_t)v25);
        uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v27 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          *(void *)&uint8_t buf[4] = v27;
          _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      *(_BYTE *)(a2 + 316) = 1;
      *(_BYTE *)(a2 + 317) = sub_1001B890C(v17);
      *(_BYTE *)(a2 + 318) = sub_1001B8AF8(v17);
    }

    if (*(_BYTE *)(a2 + 55))
    {
      int v84 = 0;
      __int128 v82 = 0u;
      __int128 v83 = 0u;
      __int128 v80 = 0u;
      __int128 v81 = 0u;
      *(_OWORD *)__int128 buf = 0u;
      __int128 v79 = 0u;
      *(_DWORD *)&buf[1] = *(_DWORD *)(a2 + 49);
      *(_WORD *)&buf[5] = *(_WORD *)(a2 + 53);
      buf[7] = *(_BYTE *)(a2 + 56);
      *(_DWORD *)&buf[8] = *(_DWORD *)(a2 + 57);
      *(_WORD *)&_BYTE buf[12] = *(_WORD *)(a2 + 61);
      sub_1000BAEA0(buf, 14);
      a1 = (unsigned __int8 *)(a2 + 56);
    }

    if (!(_DWORD)a3)
    {
      if (*(_BYTE *)(a2 + 70) == 1)
      {
        byte_1008E8AF9 &= 0xFCu;
        sub_10019C5B0(0);
      }

      else if (*(_BYTE *)(a2 + 316))
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"FastLEConnection:Skipping startLinkEncryption, pendingAuth=%d",  v35,  v36,  v37,  v38,  v39,  v40,  v41,  *(unsigned __int8 *)(a2 + 317));
          uint64_t v42 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v43 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            *(void *)&uint8_t buf[4] = v43;
            _os_log_impl((void *)&_mh_execute_header, v42, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        *(_BYTE *)(a2 + 125) = *(_BYTE *)(a2 + 317);
      }

      else
      {
        if (!sub_1001B8CE4(a2))
        {
          int v44 = 1;
          *(_BYTE *)(a2 + 125) = 1;
          goto LABEL_35;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"Encryption start fails with status %!", v69, v70, v71, v72, v73, v74, v75, 0LL);
          uint64_t v76 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v76, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }
      }

      int v44 = 1;
      goto LABEL_35;
    }
  }

  if ((_DWORD)a3 != 702)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"GAP_ConnectionCompleteCallback with error stats %! on lm 0x%x",  v28,  v29,  v30,  v31,  v32,  v33,  v34,  a3);
      uint64_t v45 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }
  }

  int v44 = 0;
LABEL_35:
  unsigned __int16 v46 = word_1008E89B0;
  if (word_1008E89B0)
  {
    unsigned __int8 v47 = 0;
    do
    {
      uint64_t v48 = *(void (**)(unsigned __int8 *, uint64_t, uint64_t, uint64_t, BOOL))qword_1008E89B8[v47];
      if (v48)
      {
        if (a2) {
          BOOL v49 = *(_BYTE *)(a2 + 316) != 0;
        }
        else {
          BOOL v49 = 0LL;
        }
        v48(a1, a2, a3, a4, v49);
        unsigned __int16 v46 = word_1008E89B0;
      }

      ++v47;
    }

    while (v46 > v47);
  }

  if (v44 && *(_BYTE *)(a2 + 70) == 1)
  {
    if (*(_DWORD *)(a2 + 132)) {
      sub_1001EE2A0();
    }
    if (*(_BYTE *)(a2 + 316))
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"FastLEConnection:Skipping LE_GAP_ReadRemoteVersionInformation",  v50,  v51,  v52,  v53,  v54,  v55,  v56,  v77);
        uint64_t v57 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v58 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          *(void *)&uint8_t buf[4] = v58;
          _os_log_impl((void *)&_mh_execute_header, v57, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }

    else
    {
      uint64_t v59 = sub_1001B7A10(a2);
      if ((_DWORD)v59)
      {
        uint64_t v60 = v59;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"LE_GAP_ReadRemoteVersionInformation failed %!",  v61,  v62,  v63,  v64,  v65,  v66,  v67,  v60);
          uint64_t v68 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v68, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }

        sub_1001B7AA0(a2, v60);
      }

      else
      {
        *(_DWORD *)(a2 + 132) = 1;
      }
    }
  }

void sub_1001B835C()
{
  if (byte_1008ECCB4 == 1)
  {
    *(_WORD *)__int128 buf = 0;
    sub_1001EEC44(dword_1008ECCB0, buf);
  }

  if (sub_1000A86F0())
  {
    uint64_t v0 = byte_1008ECCA0;
    sub_1001AB9FC();
    sub_1001C63A0();
    sub_1001EE134( (uint64_t)"refreshing PrivateAddressTimer gPrivateMode=%d gOverrideLocalAddress=%d IsConnectionInProgress=%d IsScanI nProgress=%d gHoldStableAddress=%d gHoldStableAddressCount=%d gLeHoldStablePrivateAddressTimer=%d Hold Ti me Remaining=%d:%d",  v1,  v2,  v3,  v4,  v5,  v6,  v7,  v0);
    uint64_t v8 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v9 = sub_1001EDDCC();
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v39 = v9;
      _os_log_impl((void *)&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1001BCCC4();
  byte_1008ECCB4 = 0;
  word_1008ECCB6 = 0;
  sub_1001BFF04();
  if (!byte_1008ECCA0 && (byte_1008ECCA1 & 1) == 0)
  {
    if (sub_10019E568())
    {
      if (byte_1008ECCBA)
      {
LABEL_10:
        byte_1008ECCB8 = 0;
        if (sub_1001BDAC8(byte_1008ECC6D) && sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"createAddress with type %d failed with stats %! in refreshLePrivateAddress",  v10,  v11,  v12,  v13,  v14,  v15,  v16,  byte_1008ECC6D);
          unint64_t v17 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        sub_1001BCDDC( (int *)((char *)&dword_1008ECC6E[2 * byte_1008ECC6D] - byte_1008ECC6D),  1);
        return;
      }

      if ((sub_1001AB9FC() & 1) == 0 && !sub_1001C63A0())
      {
        if (!byte_1008ECCBA)
        {
          byte_1008E8A40 = 0;
          byte_1008ECCBB = 0;
          dword_1008ECCBC = 0;
          word_1008ECCC0 = 0;
        }

        goto LABEL_10;
      }

      if ((byte_1008E8A40 & 1) == 0 && (byte_1008ECCBB & 1) == 0) {
        sub_1000B04EC((uint64_t)&dword_1008ECCBC);
      }
      if (sub_1001C63A0()) {
        byte_1008ECCBB = 1;
      }
      uint64_t v37 = 0LL;
      sub_1000B04EC((uint64_t)&v37);
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Busy with a connection/scan, can't update an address right now (gRefreshLocalAddressOnConnectionCompl ete=%d gRefreshLocalAddressOnScanComplete=%d). Address refresh deferral for %d seconds",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  byte_1008E8A40);
        uint64_t v34 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v35 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v39 = v35;
          _os_log_impl((void *)&_mh_execute_header, v34, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Advertising is starting/stopping, wait with the address change until we're settled",  v18,  v19,  v20,  v21,  v22,  v23,  v24,  v36);
        uint64_t v25 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v26 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          uint64_t v39 = v26;
          _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      byte_1008ECCB8 = 1;
    }

    sub_1001BFD4C();
  }

BOOL sub_1001B8754(unint64_t a1)
{
  if ((a1 & 0xFFFFFFFFFFFFLL) == 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEnabledForAddress compare with zero address",  v2,  v3,  v4,  v5,  v6,  v7,  v8,  v25);
      uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 0LL;
  }

  if (!byte_1008ECCD8) {
    return 0LL;
  }
  if (qword_1008ECCE0[0] != a1)
  {
    unint64_t v11 = 0LL;
    uint64_t v12 = &qword_1008ECCF0;
    while (byte_1008ECCD8 - 1LL != v11)
    {
      uint64_t v13 = *v12;
      v12 += 2;
      ++v11;
      if (v13 == a1)
      {
        BOOL v1 = v11 < byte_1008ECCD8;
        goto LABEL_14;
      }
    }

    return 0LL;
  }

  BOOL v1 = 1LL;
LABEL_14:
  uint64_t v14 = (a1 << 32) & 0xFF0000000000LL | (a1 << 48) | (a1 << 16) & 0xFF00000000LL | a1 & 0xFF000000 | (a1 >> 16) & 0xFF0000 | WORD2(a1) & 0xFF00 | BYTE6(a1);
  if (sub_1000A86F0())
  {
    uint64_t v22 = "Random";
    if (!(_BYTE)v14) {
      uint64_t v22 = "Public";
    }
    sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEnabledForAddress for %s:%: enabled",  v15,  v16,  v17,  v18,  v19,  v20,  v21,  (uint64_t)v22);
    uint64_t v23 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v24 = sub_1001EDDCC();
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v27 = v24;
      _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return v1;
}

uint64_t sub_1001B890C(unint64_t a1)
{
  if ((a1 & 0xFFFFFFFFFFFFLL) != 0)
  {
    unsigned int v1 = byte_1008ECCD8;
    if (byte_1008ECCD8)
    {
      if (qword_1008ECCE0[0] == a1)
      {
        unint64_t v2 = 0LL;
        BOOL v3 = 1;
LABEL_12:
        uint64_t v15 = (a1 << 32) & 0xFF0000000000LL | (a1 << 48) | (a1 << 16) & 0xFF00000000LL | a1 & 0xFF000000 | (a1 >> 16) & 0xFF0000 | WORD2(a1) & 0xFF00 | BYTE6(a1);
        if (sub_1000A86F0())
        {
          uint64_t v23 = "Random";
          if (!(_BYTE)v15) {
            uint64_t v23 = "Public";
          }
          sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEncryptionExpectedForAddress for %s:%: pending:%d",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  (uint64_t)v23);
          uint64_t v24 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v25 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v28 = v25;
            _os_log_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        unsigned int v1 = LOBYTE(qword_1008ECCE0[2 * v2 + 1]) != 0;
        return v3 & v1;
      }

      unint64_t v2 = 0LL;
      uint64_t v13 = &qword_1008ECCF0;
      while (byte_1008ECCD8 - 1LL != v2)
      {
        uint64_t v14 = *v13;
        v13 += 2;
        ++v2;
        if (v14 == a1)
        {
          BOOL v3 = v2 < byte_1008ECCD8;
          goto LABEL_12;
        }
      }
    }

    BOOL v3 = 0;
    return v3 & v1;
  }

  uint64_t result = sub_1000A86F0();
  if ((_DWORD)result)
  {
    sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEncryptionExpectedForAddress compare with zero address",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v26);
    uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
    uint64_t result = os_log_type_enabled(v12, OS_LOG_TYPE_ERROR);
    if ((_DWORD)result)
    {
      sub_100657858();
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001B8AF8(unint64_t a1)
{
  if ((a1 & 0xFFFFFFFFFFFFLL) != 0)
  {
    unsigned int v1 = byte_1008ECCD8;
    if (byte_1008ECCD8)
    {
      if (qword_1008ECCE0[0] == a1)
      {
        unint64_t v2 = 0LL;
        BOOL v3 = 1;
LABEL_12:
        uint64_t v15 = (a1 << 32) & 0xFF0000000000LL | (a1 << 48) | (a1 << 16) & 0xFF00000000LL | a1 & 0xFF000000 | (a1 >> 16) & 0xFF0000 | WORD2(a1) & 0xFF00 | BYTE6(a1);
        if (sub_1000A86F0())
        {
          uint64_t v23 = "Random";
          if (!(_BYTE)v15) {
            uint64_t v23 = "Public";
          }
          sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEncryptionFakeEvent for %s:%: fakeEncryptionEvent:%d",  v16,  v17,  v18,  v19,  v20,  v21,  v22,  (uint64_t)v23);
          uint64_t v24 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v25 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            uint64_t v28 = v25;
            _os_log_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        unsigned int v1 = BYTE1(qword_1008ECCE0[2 * v2 + 1]) != 0;
        return v3 & v1;
      }

      unint64_t v2 = 0LL;
      uint64_t v13 = &qword_1008ECCF0;
      while (byte_1008ECCD8 - 1LL != v2)
      {
        uint64_t v14 = *v13;
        v13 += 2;
        ++v2;
        if (v14 == a1)
        {
          BOOL v3 = v2 < byte_1008ECCD8;
          goto LABEL_12;
        }
      }
    }

    BOOL v3 = 0;
    return v3 & v1;
  }

  uint64_t result = sub_1000A86F0();
  if ((_DWORD)result)
  {
    sub_1001EE134( (uint64_t)"FastLeConnection:LE_GAP_IsFastLeConnectionEncryptionFakeEvent compare with zero address",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  v26);
    uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
    uint64_t result = os_log_type_enabled(v12, OS_LOG_TYPE_ERROR);
    if ((_DWORD)result)
    {
      sub_100657858();
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001B8CE4(uint64_t a1)
{
  uint64_t v3 = a1;
  if (dword_1008ECCA4)
  {
    v2[1] = &v3;
    v2[0] = (const void *)8;
    uint64_t result = sub_1001EE6E8((uint64_t)sub_1001BF900, v2, (unsigned __int16)((dword_1008ECCA4 + 99) / 0x64u), 0LL);
    if (!(_DWORD)result) {
      return result;
    }
    a1 = v3;
  }

  return sub_1001C8D80(a1);
}

void sub_1001B8D50(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!a1) {
    sub_1001EE2A0();
  }
  if (*(_DWORD *)(a1 + 140) && *(_DWORD *)(a1 + 132) == 6)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Link disconnected readyStateReason:%!, readyStatus:LE_READY_DISCONNECTING, overriding",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  *(unsigned int *)(a1 + 140));
      uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        uint64_t v21 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    a2 = *(unsigned int *)(a1 + 140);
  }

  if (mach_continuous_time() <= a4)
  {
    uint64_t v17 = 0LL;
  }

  else
  {
    uint64_t v16 = mach_continuous_time();
    uint64_t v17 = UpTicksToMilliseconds(v16 - a4);
  }

  if (word_1008E89B0)
  {
    unsigned __int8 v18 = 0;
    do
    {
      uint64_t v19 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_1008E89B8[v18] + 8LL);
      if (v19)
      {
        v19(a1, a2, a3, v17);
        if (*(_BYTE *)(a1 + 127)) {
          sub_1001ACBDC((unsigned __int16 *)a1, 7LL);
        }
      }

      ++v18;
    }

    while ((unsigned __int16)word_1008E89B0 > v18);
  }

  if (off_1008E8A48)
  {
    if (!sub_10012EC68())
    {
      off_1008E8A48();
      off_1008E8A48 = 0LL;
    }
  }

uint64_t sub_1001B8EFC(uint64_t result)
{
  unsigned __int16 v1 = word_1008E89B0;
  if (word_1008E89B0)
  {
    uint64_t v2 = result;
    unsigned __int8 v3 = 0;
    do
    {
      uint64_t v4 = *(uint64_t (**)(uint64_t))(qword_1008E89B8[v3] + 16LL);
      if (v4)
      {
        uint64_t result = v4(v2);
        unsigned __int16 v1 = word_1008E89B0;
      }

      ++v3;
    }

    while (v1 > v3);
  }

  return result;
}

uint64_t sub_1001B8F64(uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  unsigned __int16 v5 = word_1008E89B0;
  if (word_1008E89B0)
  {
    uint64_t v10 = result;
    unsigned __int8 v11 = 0;
    do
    {
      uint64_t v12 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(qword_1008E89B8[v11] + 24LL);
      if (v12)
      {
        uint64_t result = v12(v10, a2, a3, a4, a5);
        unsigned __int16 v5 = word_1008E89B0;
      }

      ++v11;
    }

    while (v5 > v11);
  }

  return result;
}

uint64_t sub_1001B8FFC(uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  unsigned __int16 v5 = word_1008E89B0;
  if (word_1008E89B0)
  {
    uint64_t v10 = result;
    unsigned __int8 v11 = 0;
    do
    {
      uint64_t v12 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(qword_1008E89B8[v11] + 32LL);
      if (v12)
      {
        uint64_t result = v12(v10, a2, a3, a4, a5);
        unsigned __int16 v5 = word_1008E89B0;
      }

      ++v11;
    }

    while (v5 > v11);
  }

  return result;
}

void sub_1001B9094(uint64_t a1, uint64_t a2, unsigned int a3)
{
  if (sub_1000A86F0())
  {
    sub_1001AA55C(*(_DWORD *)(a2 + 132));
    sub_1001EE134( (uint64_t)"ReadRemoteVersionInformationCB LMPVersion=%d mfgName=%d LMPSubVersion=%d status %!, ready: %s, role %d",  v6,  v7,  v8,  v9,  v10,  v11,  v12,  a3);
    uint64_t v13 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      int v44 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (!(_DWORD)a1)
  {
    if (*(_DWORD *)(a2 + 132) != 1) {
      sub_1001EE2A0();
    }
    *(_DWORD *)(a2 + 132) = 5;
    if (a3 <= 6)
    {
      uint64_t v29 = 0LL;
      *(_BYTE *)(a2 + 126) = 0;
LABEL_21:
      sub_1001B7AA0(a2, v29);
      return;
    }

    if (*(_BYTE *)(a2 + 70) && (BYTE4(xmmword_1008F6D38) & 8) == 0) {
      goto LABEL_17;
    }
    if (*(_BYTE *)(a2 + 316))
    {
      *(_DWORD *)(a2 + 132) = 2;
      uint64_t v29 = 0LL;
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"FastLEConnection:LE_GAP_ReadRemoteVersionInformationCompleteCallback skipping LE_ReadRemoteUsedFeatur es due to FastLEConnection",  v22,  v23,  v24,  v25,  v26,  v27,  v28,  v42);
        uint64_t v30 = (os_log_s *)sub_100086554(0x42u);
        uint64_t v29 = 0LL;
        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v31 = sub_1001EDDCC();
          *(_DWORD *)__int128 buf = 136446210;
          int v44 = v31;
          _os_log_impl((void *)&_mh_execute_header, v30, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
LABEL_17:
          uint64_t v29 = 0LL;
        }
      }
    }

    else
    {
      uint64_t v33 = sub_1001ADDF8();
      if (!(_DWORD)v33)
      {
        *(_DWORD *)(a2 + 132) = 2;
        *(_BYTE *)(a2 + 126) = 0;
        return;
      }

      uint64_t v29 = v33;
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"ReadRemoteUsedFeatures failed %!", v34, v35, v36, v37, v38, v39, v40, v29);
        uint64_t v41 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
          sub_100657F74();
        }
      }
    }

    int v32 = *(_DWORD *)(a2 + 132);
    *(_BYTE *)(a2 + 126) = 0;
    if (v32 != 5) {
      return;
    }
    goto LABEL_21;
  }

  if (sub_1000A86F0())
  {
    sub_1001EE134( (uint64_t)"ReadRemoteVersionInformationCB %!, waiting for disconnection event",  v14,  v15,  v16,  v17,  v18,  v19,  v20,  a1);
    uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100657F74();
    }
  }

void sub_1001B9328(uint64_t a1, uint64_t a2, char *a3)
{
  char v6 = *a3;
  char v7 = a3[1];
  *(_BYTE *)(a2 + 290) = (a3[4] & 0x60) != 0;
  if ((_DWORD)a1 && *(_DWORD *)(a2 + 140) == 5300)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"ReadRemoteUsedFeaturesCB %!, waiting for disconnection event",  v8,  v9,  v10,  v11,  v12,  v13,  v14,  a1);
      uint64_t v15 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    return;
  }

  if (*(_DWORD *)(a2 + 132) != 2) {
    sub_1001EE2A0();
  }
  if ((_DWORD)a1)
  {
    if ((_DWORD)a1 == 726) {
      uint64_t v16 = 0LL;
    }
    else {
      uint64_t v16 = a1;
    }
    sub_1001B7AA0(a2, v16);
    return;
  }

  if ((v7 & 1) != 0 && sub_10010F2A0())
  {
    int v17 = sub_10011F168() ^ 1;
    if ((v6 & 0x20) != 0)
    {
LABEL_16:
      int v18 = sub_10010F290();
      goto LABEL_19;
    }
  }

  else
  {
    int v17 = 0;
    if ((v6 & 0x20) != 0) {
      goto LABEL_16;
    }
  }

  int v18 = 0;
LABEL_19:
  if (sub_1000A86F0())
  {
    sub_1001AA55C(*(_DWORD *)(a2 + 132));
    sub_10010F290();
    sub_10010F2A0();
    sub_10010F2B0();
    sub_1001EE134( (uint64_t)"Remote Features: %@ , handle %x, ready: %s, EDL [remote %d, local %d], 2M [remote %d, local %d], ChanSel2 [remote %d, local %d] PHYReady:%s, SupportsSubrating: %d",  v19,  v20,  v21,  v22,  v23,  v24,  v25,  (uint64_t)a3);
    uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v38 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((v17 | v18) == 1 && (((v17 | v18 ^ 1) & 1) != 0 || *(_DWORD *)(a2 + 136) != 1))
  {
    if (!*(_BYTE *)(a2 + 152))
    {
      sub_1001AED04(a2, v18, v17, 0LL);
      return;
    }

    uint64_t v27 = sub_1001ABFFC((unsigned __int16 *)a2, 4u);
    if ((_DWORD)v27)
    {
      uint64_t v28 = v27;
      if ((_DWORD)v27 != 4000)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"PhyUpdateComplete LE scaling completed with error %!",  v29,  v30,  v31,  v32,  v33,  v34,  v35,  v28);
          uint64_t v36 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }
      }
    }
  }

  sub_1001B7AA0(a2, 0LL);
}

uint64_t sub_1001B962C(uint64_t result, uint64_t a2, uint64_t a3)
{
  unsigned __int16 v3 = word_1008E89F8;
  if (word_1008E89F8)
  {
    uint64_t v6 = result;
    unsigned __int8 v7 = 0;
    do
    {
      uint64_t v8 = (uint64_t (*)(uint64_t, uint64_t, uint64_t))**((void **)&unk_1008E8A00 + v7);
      if (v8)
      {
        uint64_t result = v8(v6, a2, a3);
        unsigned __int16 v3 = word_1008E89F8;
      }

      ++v7;
    }

    while (v3 > v7);
  }

  return result;
}

uint64_t sub_1001B96AC(uint64_t result, uint64_t a2)
{
  unsigned __int16 v2 = word_1008E89F8;
  if (word_1008E89F8)
  {
    uint64_t v4 = result;
    unsigned __int8 v5 = 0;
    do
    {
      uint64_t v6 = *(uint64_t (**)(uint64_t, uint64_t))(qword_1008E8A00[v5] + 8LL);
      if (v6)
      {
        uint64_t result = v6(v4, a2);
        unsigned __int16 v2 = word_1008E89F8;
      }

      ++v5;
    }

    while (v2 > v5);
  }

  return result;
}

uint64_t sub_1001B9724( uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, int a6, unsigned int a7, unsigned int a8, __int16 a9, char a10)
{
  HIDWORD(v18) = a6;
  unsigned __int16 v10 = word_1008E89F8;
  if (word_1008E89F8)
  {
    uint64_t v15 = result;
    unsigned __int8 v16 = 0;
    do
    {
      int v17 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, void, void, void, uint64_t))(qword_1008E8A00[v16] + 16LL);
      if (v17)
      {
        BYTE2(v18) = a10;
        LOWORD(v18) = a9;
        uint64_t result = v17(v15, a2, a3, a4, a5, HIDWORD(v18), a7, a8, v18);
        unsigned __int16 v10 = word_1008E89F8;
      }

      ++v16;
    }

    while (v10 > v16);
  }

  return result;
}

uint64_t sub_1001B97F8( uint64_t result, uint64_t a2, uint64_t a3, unsigned int a4, unsigned int a5, unsigned int a6, unsigned int a7, unsigned int a8, char a9, uint64_t a10, uint64_t a11, uint64_t a12, uint64_t a13)
{
  unsigned __int16 v13 = word_1008E89F8;
  if (word_1008E89F8)
  {
    uint64_t v16 = result;
    unsigned __int8 v17 = 0;
    do
    {
      uint64_t v18 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, void, void, void, void, void, int, uint64_t, uint64_t, uint64_t, uint64_t))(qword_1008E8A00[v17] + 24LL);
      if (v18)
      {
        LOBYTE(v19) = a9;
        uint64_t result = v18(v16, a2, a3, a4, a5, a6, a7, a8, v19, a10, a11, a12, a13);
        unsigned __int16 v13 = word_1008E89F8;
      }

      ++v17;
    }

    while (v13 > v17);
  }

  return result;
}

uint64_t sub_1001B98C4( uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10)
{
  unsigned __int16 v10 = word_1008E89F8;
  if (word_1008E89F8)
  {
    uint64_t v16 = result;
    unsigned __int8 v17 = 0;
    do
    {
      uint64_t v18 = qword_1008E8A00[v17];
      if (*(void *)(v18 + 24))
      {
        uint64_t result = (*(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(v18 + 32))( v16,  a2,  a3,  a4,  a5,  a6,  a7,  a8,  a9,  a10);
        unsigned __int16 v10 = word_1008E89F8;
      }

      ++v17;
    }

    while (v10 > v17);
  }

  return result;
}

uint64_t sub_1001B998C(uint64_t a1, _WORD *a2)
{
  if (!a2) {
    return 101LL;
  }
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (!sub_10012D5EC(a1)) {
    return 4051LL;
  }
  uint64_t result = 0LL;
  *a2 = *(_WORD *)(a1 + 80);
  return result;
}

uint64_t sub_1001B99EC(uint64_t a1, __int16 *a2)
{
  if (!a2) {
    return 101LL;
  }
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (!sub_10012D5EC(a1)) {
    return 149LL;
  }
  uint64_t result = 0LL;
  __int16 v5 = *(_WORD *)(a1 + 86);
  if (!v5) {
    __int16 v5 = 10;
  }
  *a2 = v5;
  return result;
}

uint64_t sub_1001B9A58(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (!sub_10012D5EC(a1)) {
    return 4052LL;
  }
  uint64_t v6 = a1 + 48;
  if (a3)
  {
    if (*(_BYTE *)(a1 + 55))
    {
      int v7 = *(_DWORD *)(a1 + 56);
      __int16 v8 = *(_WORD *)(a1 + 60);
      *(_BYTE *)(a3 + 6) = *(_BYTE *)(a1 + 62);
      *(_WORD *)(a3 + 4) = v8;
      *(_DWORD *)a3 = v7;
    }

    else
    {
      *(_DWORD *)(a3 + 3) = 0;
      *(_DWORD *)a3 = 0;
    }
  }

  else if (*(_BYTE *)(a1 + 55))
  {
    uint64_t v6 = a1 + 56;
  }

  uint64_t result = 0LL;
  int v10 = *(_DWORD *)v6;
  __int16 v11 = *(_WORD *)(v6 + 4);
  *(_BYTE *)(a2 + 6) = *(_BYTE *)(v6 + 6);
  *(_WORD *)(a2 + 4) = v11;
  *(_DWORD *)a2 = v10;
  return result;
}

BOOL sub_1001B9B0C(uint64_t a1)
{
  BOOL result = 0LL;
  if (a1 && dword_1008F7010)
  {
    BOOL result = sub_10012D5EC(a1);
    if (result) {
      return *(_BYTE *)(a1 + 70) == 1;
    }
  }

  return result;
}

uint64_t sub_1001B9B58(uint64_t a1)
{
  uint64_t result = 0LL;
  if (a1 && dword_1008F7010)
  {
    uint64_t result = sub_10012D5EC(a1);
    if ((_DWORD)result) {
      return *(unsigned __int16 *)(a1 + 80);
    }
  }

  return result;
}

uint64_t sub_1001B9B9C(uint64_t a1)
{
  uint64_t result = 0LL;
  if (a1 && dword_1008F7010)
  {
    uint64_t result = sub_10012D5EC(a1);
    if ((_DWORD)result) {
      return *(unsigned __int16 *)(a1 + 82);
    }
  }

  return result;
}

uint64_t sub_1001B9BE0(uint64_t a1)
{
  uint64_t result = 0LL;
  if (a1 && dword_1008F7010)
  {
    uint64_t result = sub_10012D5EC(a1);
    if ((_DWORD)result) {
      return *(unsigned __int16 *)(a1 + 84);
    }
  }

  return result;
}

uint64_t sub_1001B9C24()
{
  if (!off_1008E8A50) {
    return 121LL;
  }
  off_1008E8A50();
  return 0LL;
}

uint64_t sub_1001B9C50( __int128 *a1, uint64_t a2, int a3, unsigned int a4, unsigned int a5, int a6, int a7, int a8, unsigned __int16 a9, unsigned int a10)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (a1 && sub_10012D5EC((uint64_t)a1))
  {
    if (a10 == 1)
    {
      return sub_1001AD294((uint64_t)a1, a2, a3, a4, a5, a6, a7, a8, a9);
    }

    else if (a10)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"Invalid LE Connection Parameter Request Origin type: %d",  v27,  v28,  v29,  v30,  v31,  v32,  v33,  a10);
        uint64_t v34 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 101LL;
    }

    else
    {
      return sub_1001C9E9C(a1, a2, a3 ^ 1u, a4, a5, a6, a7, a8, a9);
    }
  }

  else
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"This handle is not a LE connection.", v19, v20, v21, v22, v23, v24, v25, v35);
      uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1310LL;
  }

uint64_t sub_1001B9E04(uint64_t a1)
{
  __int16 v1 = word_1008E8A58;
  uint64_t v2 = (unsigned __int16)word_1008E8A58;
  if (word_1008E8A58)
  {
    if (word_1008E8A58 == 8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Can't add anymore callbacks.", v3, v4, v5, v6, v7, v8, v9, v14);
        int v10 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 4053LL;
    }

    else
    {
      unsigned __int8 v12 = 0;
      while (qword_1008E8A60[v12] != a1)
      {
        if ((unsigned __int16)word_1008E8A58 <= ++v12)
        {
          uint64_t v2 = v12;
          goto LABEL_11;
        }
      }

      return 0LL;
    }
  }

  else
  {
LABEL_11:
    uint64_t v11 = 0LL;
    qword_1008E8A60[v2] = a1;
    word_1008E8A58 = v1 + 1;
  }

  return v11;
}

uint64_t sub_1001B9ECC(uint64_t result)
{
  if (word_1008E8A58)
  {
    unsigned __int8 v1 = 0;
    while (qword_1008E8A60[v1] != result)
    {
    }

    uint64_t v3 = qword_1008E8A60[(unsigned __int16)--word_1008E8A58];
    unsigned __int16 v2 = word_1008E8A58;
    qword_1008E8A60[v1] = v3;
    qword_1008E8A60[v2] = 0LL;
  }

  return result;
}

void sub_1001B9F20()
{
  if (word_1008E8A58)
  {
    unsigned __int8 v0 = 0;
    do
    {
      uint64_t v1 = v0;
      unsigned __int16 v2 = (void (*)(void))qword_1008E8A60[v0];
      unsigned __int8 v0 = v1 + 1;
    }

    while ((unsigned __int16)word_1008E8A58 > (v1 + 1));
  }

uint64_t sub_1001B9F84(uint64_t a1)
{
  __int16 v1 = word_1008E8AA0;
  uint64_t v2 = (unsigned __int16)word_1008E8AA0;
  if (word_1008E8AA0)
  {
    if (word_1008E8AA0 == 8)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"Can't add anymore callbacks.", v3, v4, v5, v6, v7, v8, v9, v14);
        int v10 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 4053LL;
    }

    else
    {
      unsigned __int8 v12 = 0;
      while (qword_1008E8AA8[v12] != a1)
      {
        if ((unsigned __int16)word_1008E8AA0 <= ++v12)
        {
          uint64_t v2 = v12;
          goto LABEL_11;
        }
      }

      return 0LL;
    }
  }

  else
  {
LABEL_11:
    uint64_t v11 = 0LL;
    qword_1008E8AA8[v2] = a1;
    word_1008E8AA0 = v1 + 1;
  }

  return v11;
}

void sub_1001BA04C()
{
  if (word_1008E8AA0)
  {
    unsigned __int8 v0 = 0;
    do
    {
      uint64_t v1 = v0;
      uint64_t v2 = (void (*)(void))qword_1008E8AA8[v0];
      unsigned __int8 v0 = v1 + 1;
    }

    while ((unsigned __int16)word_1008E8AA0 > (v1 + 1));
  }

uint64_t sub_1001BA0B0(uint64_t (*a1)(void))
{
  if (off_1008E8A50)
  {
    if (off_1008E8A50 == a1) {
      return 0LL;
    }
    else {
      return 119LL;
    }
  }

  else
  {
    uint64_t result = 0LL;
    off_1008E8A50 = a1;
  }

  return result;
}

uint64_t sub_1001BA0DC(void *a1)
{
  if (off_1008E8AE8)
  {
    if (off_1008E8AE8 == a1) {
      return 0LL;
    }
    else {
      return 119LL;
    }
  }

  else
  {
    uint64_t result = 0LL;
    off_1008E8AE8 = a1;
  }

  return result;
}

uint64_t *sub_1001BA108(uint64_t *result)
{
  qword_1008E8AF0 = *result;
  return result;
}

uint64_t sub_1001BA118(uint64_t a1)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if ((byte_1008E8AF8 & a1) != 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"LE Role 0x%x already set.", v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 4054LL;
  }

  else
  {
    uint64_t result = 0LL;
    byte_1008E8AF8 |= a1;
  }

  return result;
}

uint64_t sub_1001BA1BC( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  uint64_t v8 = a1;
  unsigned int v9 = byte_1008E8AF8;
  if ((byte_1008E8AF8 & a1) != 0)
  {
    byte_1008E8AF8 &= ~(_BYTE)a1;
    BOOL v10 = (v9 & ~(_BYTE)a1 & 0xA) == 0 && (v9 & 0xA) != 0;
    BOOL v11 = (v9 & ~(_BYTE)a1 & 8) == 0;
    int v12 = (v9 & ~(_BYTE)a1 & 5) == 0 && (v9 & 5) != 0;
    if ((v9 & 4) != 0 && (v9 & ~(_BYTE)a1 & 4) == 0)
    {
      a1 = sub_10019DA58();
      v12 |= a1;
    }

    int v13 = v11 & (v9 >> 3);
    if (v10)
    {
      a1 = sub_1001C63D0();
      if (!v13)
      {
LABEL_14:
        if (!v12) {
          return 0LL;
        }
        goto LABEL_22;
      }
    }

    else if (!v13)
    {
      goto LABEL_14;
    }

    sub_1001BA2D4(a1, a2, a3, a4, a5, a6, a7, a8);
    if (v12) {
LABEL_22:
    }
      sub_1001BA310(0);
    return 0LL;
  }

  uint64_t result = sub_1000A86F0();
  if ((_DWORD)result)
  {
    sub_1001EE134((uint64_t)"LE Role 0x%x not set.", v15, v16, v17, v18, v19, v20, v21, v8);
    uint64_t v22 = (os_log_s *)sub_100086554(0x42u);
    uint64_t result = os_log_type_enabled(v22, OS_LOG_TYPE_ERROR);
    if ((_DWORD)result)
    {
      sub_100657858();
      return 0LL;
    }
  }

  return result;
}

uint64_t sub_1001BA2D4( uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = sub_1001ABB4C(0, a2, a3, a4, a5, a6, a7, a8);
  return v8;
}

uint64_t sub_1001BA310(int a1)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (dword_1008ECC5C)
  {
    sub_1001EEB14(dword_1008ECC5C);
    dword_1008ECC5C = 0;
  }

  byte_1008E8AF9 &= 0xFCu;
  byte_1008ECC48 = sub_10019DED4();
  byte_1008ECC58 = 0;
  if (!a1) {
    return sub_10019D6F8();
  }
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_GAP_StopAdvertising Force stop", v2, v3, v4, v5, v6, v7, v8, v11);
    unsigned int v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

  sub_1001BC434();
  byte_1008ECC48 = 0;
  off_1008ECC50 = 0LL;
  sub_10019DA78();
  return 0LL;
}

BOOL sub_1001BA3E4(uint64_t a1)
{
  if ((a1 & 0x1C) == 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Invalid Dual mode support indication in AD flags 0x%x.", v2, v3, v4, v5, v6, v7, v8, a1);
      unsigned int v9 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)__int128 buf = 136446210;
        int v12 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
      }
    }
  }

  return (~(_DWORD)a1 & 0x18) == 0;
}

void sub_1001BA4B8(uint64_t a1)
{
  if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"LE_GAP_ConfigureAppleADVTypePowerAssertionMask mask:%llu", v2, v3, v4, v5, v6, v7, v8, a1);
    unsigned int v9 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)__int128 buf = 136446210;
      uint64_t v11 = sub_1001EDDCC();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  qword_1008F6EC8 = a1;
}

uint64_t sub_1001BA580(uint64_t a1, unint64_t a2, uint64_t (*a3)(void))
{
  uint64_t result = 162LL;
  if (a1 && a2)
  {
    if (!a3) {
      return 101LL;
    }
    if (a2 < 3) {
      return 0LL;
    }
    unint64_t v7 = 2LL;
    do
    {
      if (*(_BYTE *)(a1 + v7) == 1)
      {
        int v8 = 0;
        LODWORD(v9) = v7 + 1;
        int v10 = 16;
      }

      else
      {
        unint64_t v9 = (v7 + 1);
        if (v9 >= a2) {
          return 162LL;
        }
        int v10 = *(_BYTE *)(a1 + v9) & 0x1F;
        if (v10 == 31)
        {
          unint64_t v11 = (v7 + 2);
          if (v11 >= a2) {
            return 162LL;
          }
          int v10 = *(unsigned __int8 *)(a1 + v11) + 31;
          int v8 = 2;
        }

        else
        {
          int v8 = 1;
        }
      }

      int v12 = a3();
      uint64_t result = 0LL;
      unint64_t v7 = (v9 + v10 + v8);
    }

    while (v7 < a2 && v12);
  }

  return result;
}

uint64_t sub_1001BA69C(unsigned __int8 *a1, uint64_t a2, uint8x8_t a3, int16x8_t a4)
{
  if (!a1) {
    goto LABEL_132;
  }
  uint64_t v5 = (unsigned __int8 *)(a2 + 5884);
  unsigned int v6 = *a1;
  *(_BYTE *)a2 = v6 & 0xF;
  *(void *)(a2 + 8) = a1 + 1;
  *(_BYTE *)(a2 + 2555) = a1[24];
  *(_BYTE *)(a2 + 5946) = v6 >> 4;
  *(_WORD *)(a2 + 5968) = *((_WORD *)a1 + 13);
  *(_DWORD *)(a2 + 5970) = *((_DWORD *)a1 + 7);
  *(_BYTE *)(a2 + 5974) = a1[43];
  *(_BYTE *)(a2 + 5981) = a1[44];
  a3.i32[0] = *(_DWORD *)(a1 + 45);
  int16x4_t v7 = (int16x4_t)vmovl_u8(a3).u64[0];
  *(int16x4_t *)a4.i8 = vrev32_s16(v7);
  a4.i32[0] = v7.i32[0];
  *(_DWORD *)(a2 + 5982) = vmovn_s16(a4).u32[0];
  *(_WORD *)(a2 + 5986) = *(_WORD *)(a1 + 49);
  *(_BYTE *)(a2 + 2556) = a1[25];
  *(void *)(a2 + 5992) = a1 + 51;
  unsigned int v8 = *((unsigned __int16 *)a1 + 4);
  *(_WORD *)(a2 + 6022) = v8;
  if (!v8 || (uint64_t v9 = *((void *)a1 + 2)) == 0)
  {
LABEL_132:
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Response is empty.", v115, v116, v117, v118, v119, v120, v121, v170);
      uint64_t v122 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v122, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)__int128 buf = 136446210;
        __int128 v185 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v122, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
      }
    }

    return 0LL;
  }

  char v179 = 0;
  int v10 = 0;
  if (v8 >= 0x672) {
    unsigned int v11 = 1650;
  }
  else {
    unsigned int v11 = v8;
  }
  uint64_t v176 = a2 + 6016;
  uint64_t v175 = a2 + 5907;
  uint64_t v174 = (void *)(a2 + 5914);
  uint64_t v177 = (void *)(a2 + 5633);
  uint64_t v180 = (unsigned __int8 *)(a2 + 5068);
  uint64_t v181 = a2 + 2568;
  __dst = (void *)(a2 + 2521);
  uint64_t v183 = a2 + 20;
  __int128 v182 = (unsigned __int8 *)(a2 + 2520);
  do
  {
    uint64_t v12 = *(unsigned __int8 *)(v9 + (unsigned __int16)v10);
    unsigned __int8 v13 = v12 - 1;
    if ((_DWORD)v12 == 1 || v12 + (unsigned __int16)(v10 + 1) > v11)
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid advertising response data size (%u + %u)",  v124,  v125,  v126,  v127,  v128,  v129,  v130,  v9);
        uint64_t v131 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v131, OS_LOG_TYPE_ERROR)) {
          sub_10065C868();
        }
      }

      uint64_t v17 = 4059LL;
      goto LABEL_113;
    }

    uint64_t v15 = (unsigned __int16)v10 + 2LL;
    int v16 = v15 + v13;
    uint64_t v17 = 0LL;
    switch(*(_BYTE *)(v9 + (unsigned __int16)v10 + 1LL))
    {
      case 1:
        uint64_t v17 = 0LL;
        *(_BYTE *)(a2 + 16) = *(_BYTE *)(v9 + v15);
        goto LABEL_70;
      case 2:
      case 3:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 2LL;
        goto LABEL_18;
      case 4:
      case 5:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 4LL;
        goto LABEL_18;
      case 6:
      case 7:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 16LL;
LABEL_18:
        uint64_t v21 = v183;
        uint64_t v22 = v182;
        goto LABEL_50;
      case 8:
        if ((v12 - 1) < 0x1Fu)
        {
          size_t v79 = (v12 - 1);
          char v80 = 1;
          goto LABEL_64;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid size %d for LE_ADV_RESPONSE_FORMAT_PARTIAL_NAME)",  v33,  v34,  v35,  v36,  v37,  v38,  v39,  v9);
          uint64_t v40 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
            goto LABEL_32;
          }
        }

        goto LABEL_69;
      case 9:
        if ((v12 - 1) < 0x1Fu)
        {
          size_t v79 = (v12 - 1);
          char v80 = 2;
LABEL_64:
          *(_BYTE *)(a2 + 2552) = v80;
          memmove(__dst, (const void *)(v9 + (unsigned __int16)v15), v79);
          uint64_t v17 = 0LL;
          *(_BYTE *)(a2 + v13 + 2521) = 0;
          goto LABEL_70;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid size %d for LE_ADV_RESPONSE_FORMAT_COMPLETE_NAME)",  v43,  v44,  v45,  v46,  v47,  v48,  v49,  v9);
          uint64_t v40 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR))
          {
LABEL_32:
            uint64_t v41 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446466;
            __int128 v185 = v41;
            __int16 v186 = 1024;
            int v187 = 0;
            uint64_t v42 = v40;
            goto LABEL_59;
          }
        }

        goto LABEL_69;
      case 0xA:
        uint64_t v17 = 0LL;
        *(_BYTE *)(a2 + 2553) = *(_BYTE *)(v9 + v15);
        *(_BYTE *)(a2 + 2554) = 1;
        goto LABEL_70;
      case 0xB:
      case 0xC:
      case 0xD:
      case 0xE:
      case 0xF:
      case 0x11:
      case 0x13:
      case 0x17:
      case 0x18:
      case 0x1C:
      case 0x1D:
      case 0x1E:
      case 0x22:
      case 0x23:
      case 0x24:
      case 0x25:
      case 0x27:
      case 0x28:
      case 0x29:
      case 0x2A:
      case 0x2B:
      case 0x2C:
      case 0x2D:
        goto LABEL_27;
      case 0x10:
        goto LABEL_70;
      case 0x12:
        uint64_t v17 = 0LL;
        *(_WORD *)(a2 + 2562) = *(_WORD *)(v9 + v15);
        *(_WORD *)(a2 + 2564) = *(_WORD *)(v9 + v15 + 2);
        goto LABEL_70;
      case 0x14:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 2LL;
        goto LABEL_49;
      case 0x15:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 16LL;
        goto LABEL_49;
      case 0x16:
        uint64_t v50 = (int8x16_t *)(v9 + (unsigned __int16)v15);
        uint64_t v51 = (v12 - 1);
        uint64_t v52 = 2LL;
        goto LABEL_53;
      case 0x19:
        uint64_t v17 = 0LL;
        *(_WORD *)(a2 + 2560) = *(_WORD *)(v9 + v15);
        goto LABEL_70;
      case 0x1A:
        uint64_t v17 = 0LL;
        *(_WORD *)(a2 + 2558) = *(_WORD *)(v9 + v15);
        goto LABEL_70;
      case 0x1B:
        if ((v12 - 1) == 7)
        {
          uint64_t v53 = v9 + (unsigned __int16)v15;
          int v54 = *(_DWORD *)v53;
          __int16 v55 = *(_WORD *)(v53 + 4);
          *(_BYTE *)(v175 + 6) = *(_BYTE *)(v53 + 6);
          *(_WORD *)(v175 + 4) = v55;
          *(_DWORD *)uint64_t v175 = v54;
          v5[22] = 1;
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"AD Response Parsing: LE BT Device Address %: Type %s",  v56,  v57,  v58,  v59,  v60,  v61,  v62,  v175);
            uint64_t v63 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v63, OS_LOG_TYPE_DEFAULT))
            {
              uint64_t v64 = sub_1001EDDCC();
              *(_DWORD *)__int128 buf = 136446210;
              __int128 v185 = v64;
              uint64_t v65 = v63;
              os_log_type_t v66 = OS_LOG_TYPE_DEFAULT;
LABEL_68:
              _os_log_impl((void *)&_mh_execute_header, v65, v66, " %{public}s", buf, 0xCu);
              goto LABEL_69;
            }
          }
        }

        else if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"AD Response Parsing: size of LE BT Address %u in advertisement is not compliant with specification.",  v81,  v82,  v83,  v84,  v85,  v86,  v87,  v12);
          unsigned int v88 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v88, OS_LOG_TYPE_INFO))
          {
            uint64_t v89 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            __int128 v185 = v89;
            uint64_t v65 = v88;
            os_log_type_t v66 = OS_LOG_TYPE_INFO;
            goto LABEL_68;
          }
        }

        goto LABEL_69;
      case 0x1F:
        uint64_t v18 = v9 + (unsigned __int16)v15;
        uint64_t v19 = (v12 - 1);
        uint64_t v20 = 4LL;
LABEL_49:
        uint64_t v22 = v180;
        uint64_t v21 = v181;
LABEL_50:
        uint64_t v67 = sub_1001BF90C(v18, v19, v20, v21, v22);
        goto LABEL_54;
      case 0x20:
        uint64_t v50 = (int8x16_t *)(v9 + (unsigned __int16)v15);
        uint64_t v51 = (v12 - 1);
        uint64_t v52 = 4LL;
        goto LABEL_53;
      case 0x21:
        uint64_t v50 = (int8x16_t *)(v9 + (unsigned __int16)v15);
        uint64_t v51 = (v12 - 1);
        uint64_t v52 = 16LL;
LABEL_53:
        uint64_t v67 = sub_1001BFA8C(v50, v51, v52, a2);
LABEL_54:
        uint64_t v17 = v67;
        goto LABEL_70;
      case 0x26:
        if ((v12 - 1) < 0x20u)
        {
          memmove(v174, (const void *)(v9 + (unsigned __int16)v15), (v12 - 1));
          uint64_t v17 = 0LL;
          v5[61] = v13;
          goto LABEL_70;
        }

        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Invalid size %d for LE_ADV_RESPONSE_FORMAT_TDS)",  v68,  v69,  v70,  v71,  v72,  v73,  v74,  (v12 - 1));
          uint64_t v75 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v75, OS_LOG_TYPE_ERROR))
          {
            uint64_t v76 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446466;
            __int128 v185 = v76;
            __int16 v186 = 1024;
            int v187 = 0xFFFF;
            uint64_t v42 = v75;
LABEL_59:
            _os_log_error_impl( (void *)&_mh_execute_header,  v42,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
          }
        }

        goto LABEL_69;
      case 0x2E:
        uint64_t v17 = 0LL;
        uint64_t v77 = v9 + (unsigned __int16)v15;
        int v78 = *(_DWORD *)v77;
        *(_WORD *)(v176 + 4) = *(_WORD *)(v77 + 4);
        *(_DWORD *)uint64_t v176 = v78;
        goto LABEL_70;
      default:
        if (*(unsigned __int8 *)(v9 + (unsigned __int16)v10 + 1LL) != 255)
        {
LABEL_27:
          sub_1001EE2A0();
LABEL_69:
          uint64_t v17 = 0LL;
          goto LABEL_70;
        }

        if ((v12 - 1) >= 0xFCu)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid size %d for LE_ADV_RESPONSE_FORMAT_MANUFACTURER",  v140,  v141,  v142,  v143,  v144,  v145,  v146,  v9);
            uint64_t v147 = (os_log_s *)sub_100086554(0x42u);
            uint64_t v17 = 162LL;
            if (os_log_type_enabled(v147, OS_LOG_TYPE_ERROR)) {
              goto LABEL_125;
            }
LABEL_113:
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Failed to parse AD response with error %!",  v132,  v133,  v134,  v135,  v136,  v137,  v138,  v17);
              uint64_t v139 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v139, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }

            return v17;
          }

LABEL_129:
          uint64_t v17 = 162LL;
          goto LABEL_113;
        }

        int v23 = *(unsigned __int16 *)(v9 + v15);
        if (v23 != 76)
        {
          if (v23 == 196)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"AD Response parsing: Manufacturer Data vendor 0x%4x",  v24,  v25,  v26,  v27,  v28,  v29,  v30,  196LL);
              uint64_t v31 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
              {
                uint64_t v32 = sub_1001EDDCC();
                *(_DWORD *)__int128 buf = 136446210;
                __int128 v185 = v32;
                _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
          }

          goto LABEL_102;
        }

        int v90 = v10 + 4;
        unsigned int v91 = (unsigned __int16)(v10 + 4);
        break;
    }

    while (1)
    {
      uint64_t v92 = (unsigned __int16)v90 + 1LL;
      uint64_t v93 = *(unsigned __int8 *)(v9 + (unsigned __int16)v90);
      if ((unsigned __int16)(v90 + 1) >= (unsigned __int16)v16)
      {
        if ((v179 & 1) != 0)
        {
          char v179 = 1;
          goto LABEL_102;
        }

        sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid position %d for Apple type %d)",  v163,  v164,  v165,  v166,  v167,  v168,  v169,  v9);
        uint64_t v147 = (os_log_s *)sub_100086554(0x42u);
        uint64_t v17 = 162LL;
        if (!os_log_type_enabled(v147, OS_LOG_TYPE_ERROR)) {
          goto LABEL_113;
        }
        goto LABEL_125;
      }

      uint64_t v94 = v5[21];
      if (v94 <= 0x13)
      {
        v5[21] = v94 + 1;
        *(_BYTE *)(a2 + v94 + 5885) = v93;
      }

      if ((_DWORD)v93 == 18) {
        v5[96] = 1;
      }
      if ((qword_1008F6EC8 & (1 << v93)) != 0)
      {
        uint64_t v172 = (unsigned __int16)v90 + 1LL;
        int v95 = v90;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"found MFGR packet %d, holding power assertion",  v96,  v97,  v98,  v99,  v100,  v101,  v102,  v93);
          log = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(log, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v103 = sub_1001EDDCC();
            *(_DWORD *)__int128 buf = 136446210;
            __int128 v185 = v103;
            _os_log_impl((void *)&_mh_execute_header, log, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }

        qword_1008ECCD0 = sub_1000B05D8();
        int v90 = v95;
        uint64_t v92 = v172;
        if (!dword_1008ECCC8)
        {
          sub_1000B1424();
          sub_1001EE6E8((uint64_t)sub_1001BFCA8, 0LL, 10, &dword_1008ECCC8);
          uint64_t v92 = v172;
          int v90 = v95;
        }
      }

      if ((_DWORD)v93 == 1)
      {
        int v104 = 16;
LABEL_92:
        int v90 = v104 + v92;
        goto LABEL_93;
      }

      int v173 = v93;
      uint64_t v93 = (unsigned __int16)v90 + 2LL;
      if ((unsigned __int16)(v90 + 2) >= (unsigned __int16)v16)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid position %d for Apple type %d)",  v155,  v156,  v157,  v158,  v159,  v160,  v161,  v9);
          uint64_t v147 = (os_log_s *)sub_100086554(0x42u);
          uint64_t v17 = 162LL;
          if (os_log_type_enabled(v147, OS_LOG_TYPE_ERROR)) {
            goto LABEL_125;
          }
          goto LABEL_113;
        }

        goto LABEL_129;
      }

      int v105 = *(_BYTE *)(v9 + v92) & 0x1F;
      if (v105 == 31)
      {
        LODWORD(v92) = v90 + 3;
        int v104 = *(unsigned __int8 *)(v9 + v93) + 31;
        LODWORD(v93) = v173;
        goto LABEL_92;
      }

      int v90 = v93 + v105;
      LODWORD(v93) = v173;
      if (v173 == 138 && v105 == 7) {
        break;
      }
LABEL_93:
      unsigned int v91 = (unsigned __int16)v90;
      if ((unsigned __int16)v90 > (unsigned __int16)v16)
      {
        sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Invalid length %d for Apple type %d)",  v148,  v149,  v150,  v151,  v152,  v153,  v154,  v9);
        uint64_t v147 = (os_log_s *)sub_100086554(0x42u);
        uint64_t v17 = 162LL;
        if (!os_log_type_enabled(v147, OS_LOG_TYPE_ERROR)) {
          goto LABEL_113;
        }
LABEL_125:
        uint64_t v162 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446466;
        __int128 v185 = v162;
        __int16 v186 = 1024;
        int v187 = 162;
        _os_log_error_impl( (void *)&_mh_execute_header,  v147,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
        goto LABEL_113;
      }

      v179 |= (_DWORD)v93 == 2;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"parseADResponse Error [%@] Known invalid packet",  v106,  v107,  v108,  v109,  v110,  v111,  v112,  v9);
      uint64_t v113 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v113, OS_LOG_TYPE_ERROR))
      {
        uint64_t v114 = sub_1001EDDCC();
        *(_DWORD *)__int128 buf = 136446466;
        __int128 v185 = v114;
        __int16 v186 = 1024;
        int v187 = 162;
        _os_log_error_impl( (void *)&_mh_execute_header,  v113,  OS_LOG_TYPE_ERROR,  "%{public}s (status=%{bluetooth:OI_STATUS}u)",  buf,  0x12u);
      }
    }

  os_log_type_t v66 = sub_1002E6E00();
  sub_10002418C(buf, "CONNECTION");
  sub_10002418C(__p, "LeConnectionThirdPartyAppTimeDurationFromStageOneToDisabledValue");
  uint64_t v67 = (*(uint64_t (**)(uint64_t, uint8_t *, void **, int *))(*(void *)v66 + 88LL))(v66, buf, __p, &v74);
  if (v84 < 0) {
    operator delete(__p[0]);
  }
  if (v94 < 0)
  {
    operator delete(*(void **)buf);
    if (!v67) {
      goto LABEL_137;
    }
  }

  else if (!v67)
  {
    goto LABEL_137;
  }

  uint64_t v68 = (os_log_s *)qword_1008F7620;
  if (os_log_type_enabled((os_log_t)qword_1008F7620, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)__int128 buf = 67109120;
    *(_DWORD *)&uint8_t buf[4] = v74;
    _os_log_impl( (void *)&_mh_execute_header,  v68,  OS_LOG_TYPE_DEFAULT,  "LeConnectionThirdPartyAppTimeDurationFromStageOneToDisabledValue =%d (override)",  buf,  8u);
  }

LABEL_102:
    memmove(v177, (const void *)(v9 + v15), v13);
    uint64_t v17 = 0LL;
    *uint64_t v5 = v13;
LABEL_70:
    if ((_DWORD)v17) {
      break;
    }
    int v10 = v16;
  }

  while ((unsigned __int16)v16 < 0x672u);
  if ((_DWORD)v17) {
    goto LABEL_113;
  }
LABEL_116:
  uint64_t v17 = 0LL;
  *(_BYTE *)(a2 + 2557) = sub_1001BA3E4(*(unsigned __int8 *)(a2 + 16));
  return v17;
}

uint64_t sub_1001BB338(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!dword_1008F7010) {
    return 103LL;
  }
  if ((qword_1008E8AF0 & 0x20) == 0)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Local device does not support active scanning.", v3, v4, v5, v6, v7, v8, v9, v43);
      int v10 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 1330LL;
  }

  if (!a1)
  {
    sub_1001EE2A0();
    if (a2) {
      goto LABEL_10;
    }
LABEL_29:
    sub_1001EE2A0();
    goto LABEL_30;
  }

  if (!a2) {
    goto LABEL_29;
  }
LABEL_10:
  if (*(void *)a2 && *(void *)(a2 + 8) && a1 && *(void *)(a2 + 16))
  {
    if ((byte_1008E8AF8 & 0xA) != 0)
    {
      if (unk_1008E8B00 || *(_OWORD *)&xmmword_1008E8B08 != 0LL)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134((uint64_t)"We are already scanning.", v35, v36, v37, v38, v39, v40, v41, v43);
          uint64_t v42 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        return 4060LL;
      }

      else
      {
        unsigned __int16 v15 = *(_WORD *)(a1 + 4);
        if (!v15) {
          unsigned __int16 v15 = *(unsigned __int8 *)(a1 + 1) << 11;
        }
        uint64_t v16 = *(unsigned __int16 *)(a1 + 6);
        if (!*(_WORD *)(a1 + 6))
        {
          if (*(_BYTE *)(a1 + 1)) {
            uint64_t v16 = 18LL;
          }
          else {
            uint64_t v16 = 0LL;
          }
        }

        uint64_t result = sub_1001C5A00( *(_BYTE *)a1 ^ 1u,  v15,  v16,  *(unsigned __int16 *)(a1 + 8),  *(unsigned __int16 *)(a1 + 12),  *(unsigned __int16 *)(a1 + 10),  *(unsigned __int8 *)(a1 + 2),  *(unsigned __int8 *)(a1 + 3),  *(_BYTE *)(a1 + 15),  *(_BYTE *)(a1 + 14),  *(_BYTE *)(a1 + 17),  *(_BYTE *)(a1 + 18),  *(_DWORD *)(a1 + 20),  HIWORD(*(_DWORD *)(a1 + 20)),  *(_WORD *)(a1 + 24),  HIBYTE(*(_WORD *)(a1 + 24)),  (uint64_t (*)(void, void))sub_1001BB5E0,  sub_1001BB5F4,  (uint64_t)sub_1001BB78C,  a3);
        if (!(_DWORD)result)
        {
          if (*(_BYTE *)(a1 + 1)) {
            char v17 = 1;
          }
          else {
            char v17 = 2;
          }
          byte_1008E8B18 = v17;
          uint64_t v18 = *(uint64_t (**)(void, void))(a2 + 16);
          unk_1008E8B00 = *(_OWORD *)a2;
          *(&xmmword_1008E8B08 + 1) = v18;
        }
      }
    }

    else
    {
      if (sub_1000A86F0())
      {
        sub_1001EE134((uint64_t)"We can only scan in Central or Obeserver mode.", v27, v28, v29, v30, v31, v32, v33, v43);
        uint64_t v34 = (os_log_s *)sub_100086554(0x42u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
          sub_100657858();
        }
      }

      return 132LL;
    }

    return result;
  }

uint64_t sub_1001BB5E0()
{
  if (xmmword_1008E8B00) {
    return xmmword_1008E8B00();
  }
  return result;
}

void sub_1001BB5F4(uint64_t a1, uint64_t a2)
{
  if (*(&xmmword_1008E8B00 + 1))
  {
    if (a1 && *(_WORD *)(a1 + 8) && *(void *)(a1 + 16))
    {
      if (byte_1008E8B18 == 1 && (v23[16] & 1) == 0) {
        return;
      }
LABEL_16:
      ((void (*)(_BYTE *, uint64_t))*(&xmmword_1008E8B00 + 1))(v23, a2);
      return;
    }

    if (sub_1000A86F0())
    {
      sub_1001EE134((uint64_t)"Response is empty.", v14, v15, v16, v17, v18, v19, v20, *(uint64_t *)v22);
      uint64_t v21 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)uint64_t v22 = 136446210;
        *(void *)&v22[4] = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_INFO, " %{public}s", v22, 0xCu);
      }
    }

    if (byte_1008E8B18 != 1) {
      goto LABEL_16;
    }
  }

  else if (sub_1000A86F0())
  {
    sub_1001EE134((uint64_t)"No callbacks defined.", v6, v7, v8, v9, v10, v11, v12, *(uint64_t *)v22);
    unsigned __int8 v13 = (os_log_s *)sub_100086554(0x42u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100657858();
    }
  }

void sub_1001BB78C(uint64_t a1, uint64_t a2)
{
  uint8x8_t v4 = (void (*)(uint64_t, uint64_t))off_1008E8B10;
  *(_OWORD *)&xmmword_1008E8B00 = 0uLL;
  off_1008E8B10 = 0LL;
  byte_1008E8B18 = 0;
  if (!byte_1008ECCBA && byte_1008ECCBB == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"scan complete, we need to update our own address now",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  *(uint64_t *)v13);
      uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)unsigned __int8 v13 = 136446210;
        *(void *)&v13[4] = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", v13, 0xCu);
      }
    }

    sub_1001B835C();
  }

  if (v4) {
    v4(a1, a2);
  }
}

uint64_t sub_1001BB8A0( _BYTE *a1, unsigned int a2, unsigned __int8 *a3, uint64_t (*a4)(void, void), uint64_t a5)
{
  unsigned __int16 v133 = 0;
  bzero(v135, 0x672uLL);
  unsigned __int16 v132 = 0;
  bzero(__dst, 0x672uLL);
  if (!a1) {
    sub_1001EE2A0();
  }
  if (!dword_1008F7010) {
    return 103LL;
  }
  if (!a2)
  {
    sub_1001EE134((uint64_t)"You must specify at least numOfInstances>=1", v19, v20, v21, v22, v23, v24, v25, v131);
    uint64_t v26 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
LABEL_22:
    sub_100657858();
    return 101LL;
  }

  if (a2 >= 6)
  {
    sub_1001EE134((uint64_t)"numOfInstances can not be greater than %d", v10, v11, v12, v13, v14, v15, v16, 5LL);
    uint64_t v17 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_22;
  }

  int v27 = sub_10019DED4();
  if (a2 >= 2 && !v27)
  {
    unsigned int v28 = sub_10019DED4();
    sub_1001EE134( (uint64_t)"numOfInstances can not be greater than 1, using regular advertising",  v29,  v30,  v31,  v32,  v33,  v34,  v35,  v28);
    uint64_t v36 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_22;
  }

  if (sub_10019DED4() && sub_10019DED4() < a2)
  {
    unsigned int v37 = sub_10019DED4();
    sub_1001EE134((uint64_t)"numOfInstances can not be greater than %d", v38, v39, v40, v41, v42, v43, v44, v37);
    uint64_t v45 = (os_log_s *)sub_100086554(0x42u);
    if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
      return 101LL;
    }
    goto LABEL_22;
  }

  __memmove_chk(&unk_1008E8B20, a1, 3336LL * a2, 16680LL);
  if (a4)
  {
    unsigned int v46 = 0;
    byte_1008ECC48 = 0;
  }

  else
  {
    unsigned int v46 = byte_1008ECC48;
  }

  if (v46 < a2)
  {
    while (*(unsigned __int16 *)&a1[3336 * v46 + 2] >= 0x4000u)
    {
      LOBYTE(v46) = v46 + 1;
      byte_1008ECC48 = v46;
      uint64_t v18 = 101LL;
    }
  }

  if ((_BYTE)v46)
  {
    char v48 = byte_1008E8AF8;
LABEL_35:
    if ((v48 & 1) != 0)
    {
      char v66 = byte_1008E8AF9 & 0xFC;
    }

    else
    {
      if (*a1) {
        char v49 = 1;
      }
      else {
        char v49 = 2;
      }
      if ((v48 & 4) == 0)
      {
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Role should be broadcaster to enable discoverable states.",  v50,  v51,  v52,  v53,  v54,  v55,  v56,  v131);
          uint64_t v57 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
            sub_100657858();
          }
        }

        return 4055LL;
      }

      char v66 = byte_1008E8AF9 & 0xFC | v49;
    }

    byte_1008E8AF9 = v66;
    uint64_t v18 = sub_1001BBFE4( (uint64_t)&a1[3336 * v46],  (uint64_t)v135,  &v133,  __dst,  &v132,  v46);
    if (!(_DWORD)v18)
    {
      if (a4)
      {
        if (a2 <= 1) {
          uint64_t v67 = 0LL;
        }
        else {
          uint64_t v67 = a4;
        }
        off_1008ECC50 = v67;
      }

      byte_1008ECC58 = 1;
      if (a2 <= 1) {
        uint64_t v68 = (void (*)(uint64_t, uint64_t))a4;
      }
      else {
        uint64_t v68 = sub_1001BC238;
      }
      uint64_t v69 = &a1[3336 * byte_1008ECC48];
      uint64_t v70 = *((unsigned __int16 *)v69 + 1);
      uint64_t v71 = v70;
      if (!*((_WORD *)v69 + 1))
      {
        else {
          uint64_t v70 = 2048LL;
        }
        else {
          uint64_t v71 = 4096LL;
        }
      }

      uint64_t v72 = &a1[3336 * byte_1008ECC48];
      if (v72[3317]) {
        uint64_t v73 = (int *)(v72 + 3310);
      }
      else {
        uint64_t v73 = 0LL;
      }
      uint64_t v74 = sub_10019CD00( (uint64_t)v68,  a5,  v70,  v71,  v72[1],  a3,  7LL,  0LL,  v133,  v135,  v72[3319],  v132,  __dst,  v72[3320],  byte_1008ECC48,  v73,  *(_DWORD *)(v72 + 3321),  BYTE1(*(_DWORD *)(v72 + 3321)),  BYTE2(*(_DWORD *)(v72 + 3321)),  HIBYTE(*(_DWORD *)(v72 + 3321)),  *(_WORD *)(v72 + 3325),  HIBYTE(*(_WORD *)(v72 + 3325)),  v72[3327],  *((void *)v72 + 416));
      if ((_DWORD)v74)
      {
        uint64_t v18 = v74;
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"LE_StartAdvertising failed with status %! currentAdvHandle=%d gMultiAdvCompleteCb=%p numOfInstances=%d ",  v75,  v76,  v77,  v78,  v79,  v80,  v81,  v18);
          uint64_t v82 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v82, OS_LOG_TYPE_ERROR)) {
            sub_100657F74();
          }
        }
      }

      else
      {
        if (a1[3336 * byte_1008ECC48])
        {
          uint64_t v18 = sub_1001EE6E8((uint64_t)sub_1001BC418, 0LL, 300, &dword_1008ECC5C);
          if ((_DWORD)v18)
          {
            if (sub_1000A86F0())
            {
              sub_1001EE134( (uint64_t)"Could not register callback, status:%!",  v123,  v124,  v125,  v126,  v127,  v128,  v129,  v18);
              uint64_t v130 = (os_log_s *)sub_100086554(0x42u);
              if (os_log_type_enabled(v130, OS_LOG_TYPE_ERROR)) {
                sub_100657858();
              }
            }
          }
        }

        else
        {
          uint64_t v18 = 0LL;
        }

        ++byte_1008ECC48;
      }
    }
  }

  else
  {
    switch(a1[1])
    {
      case 0:
        if ((qword_1008E8AF0 & 4) != 0) {
          goto LABEL_87;
        }
        sub_1001EE134((uint64_t)"Device does not support direct advertising.", v58, v59, v60, v61, v62, v63, v64, v131);
        uint64_t v65 = (os_log_s *)sub_100086554(0x42u);
        if (!os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
          return 1330LL;
        }
        goto LABEL_85;
      case 1:
        if ((qword_1008E8AF0 & 8) != 0) {
          goto LABEL_87;
        }
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Device does not support connectable advertising.",  v83,  v84,  v85,  v86,  v87,  v88,  v89,  v131);
          int v90 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v90, OS_LOG_TYPE_ERROR)) {
            goto LABEL_85;
          }
        }

        return 1330LL;
      case 2:
        if ((qword_1008E8AF0 & 2) != 0) {
          goto LABEL_87;
        }
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Device does not support discoverable advertising.",  v91,  v92,  v93,  v94,  v95,  v96,  v97,  v131);
          uint64_t v98 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v98, OS_LOG_TYPE_ERROR)) {
            goto LABEL_85;
          }
        }

        return 1330LL;
      case 3:
        if ((qword_1008E8AF0 & 1) != 0) {
          goto LABEL_87;
        }
        if (sub_1000A86F0())
        {
          sub_1001EE134( (uint64_t)"Device does not support non-connectable advertising.",  v99,  v100,  v101,  v102,  v103,  v104,  v105,  v131);
          uint64_t v106 = (os_log_s *)sub_100086554(0x42u);
          if (os_log_type_enabled(v106, OS_LOG_TYPE_ERROR)) {
LABEL_85:
          }
            sub_100657858();
        }

        return 1330LL;
      default:
LABEL_87:
        char v48 = byte_1008E8AF8;
        if ((byte_1008E8AF8 & 5) != 0)
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"We can't be connectable in Broadcaster mode.",  v107,  v108,  v109,  v110,  v111,  v112,  v113,  v131);
            uint64_t v114 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v114, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          uint64_t v18 = 4061LL;
        }

        else
        {
          if (sub_1000A86F0())
          {
            sub_1001EE134( (uint64_t)"We can only advertise in Peripheral or Broadcaster mode.",  v115,  v116,  v117,  v118,  v119,  v120,  v121,  v131);
            uint64_t v122 = (os_log_s *)sub_100086554(0x42u);
            if (os_log_type_enabled(v122, OS_LOG_TYPE_ERROR)) {
              sub_100657858();
            }
          }

          uint64_t v18 = 132LL;
        }

        break;
    }
  }

  return v18;
}

uint64_t sub_1001BBFE4(uint64_t a1, uint64_t a2, _WORD *a3, void *__dst, _WORD *a5, unsigned int a6)
{
  if (!a2 || !a3 || !__dst || !a5)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"createAdvertisingData: Unexpected <null> pointer parameters",  v12,  v13,  v14,  v15,  v16,  v17,  v18,  v45);
      uint64_t v19 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100657858();
      }
    }

    return 101LL;
  }

  if (*(_BYTE *)(a1 + 3318))
  {
    unsigned int v11 = 0;
    goto LABEL_22;
  }

  unsigned int v11 = 0;
  if (a6 <= 4 && a6 != 2)
  {
    if (*(unsigned __int16 *)(a1 + 1656) > 0x1Cu)
    {
      unsigned int v11 = 0;
      if (a6) {
        goto LABEL_22;
      }
    }

    else
    {
      *(_WORD *)a2 = 258;
      char v20 = byte_1008E8AF9;
      if (a6) {
        char v20 = byte_1008E8AF9 | 2;
      }
      *(_BYTE *)(a2 + 2) = v20;
      unsigned int v11 = 3;
      if (a6) {
        goto LABEL_22;
      }
    }

    if (*(_BYTE *)(a1 + 4))
    {
      *(_WORD *)(a2 + v11) = 2562;
      char v21 = *(_BYTE *)(a1 + 4);
LABEL_21:
      uint64_t v22 = a2 + v11;
      v11 += 3;
      *(_BYTE *)(v22 + 2) = v21;
      goto LABEL_22;
    }

    char v21 = dword_1008ECC68;
    if ((_BYTE)dword_1008ECC68 && dword_1008ECC68 != 127)
    {
      *(_WORD *)(a2 + v11) = 2562;
      goto LABEL_21;
    }
  }

void sub_1001BC238(uint64_t a1, uint64_t a2)
{
  if ((_DWORD)a1 && (_DWORD)a1 != 4073)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"failed to start advertising instance %d with status %! . Abort ! Abort ! Abort !",  v5,  v6,  v7,  v8,  v9,  v10,  v11,  byte_1008ECC48);
      uint64_t v12 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100657F74();
      }
    }

    if (byte_1008ECC48 >= 2u)
    {
      byte_1008ECC48 = sub_10019DED4();
      sub_1001BA310(0);
      sub_10019DCE4();
    }

    off_1008ECC50(a1, a2);
  }

  else
  {
    unsigned int v4 = byte_1008ECC48;
    if (v4 >= sub_10019DED4() || sub_10019E510())
    {
      off_1008ECC50(a1, a2);
      byte_1008ECC48 = 0;
    }

    else
    {
      uint64_t v21 = sub_10019DED4();
      byte_1008ECC48 = 0;
      off_1008ECC50(0LL, a2);
    }
  }

  if (byte_1008ECCB8 == 1)
  {
    if (sub_1000A86F0())
    {
      sub_1001EE134( (uint64_t)"Advertising settled, need to rotate our address now",  v13,  v14,  v15,  v16,  v17,  v18,  v19,  v22);
      char v20 = (os_log_s *)sub_100086554(0x42u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)__int128 buf = 136446210;
        unsigned int v24 = sub_1001EDDCC();
        _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    sub_1001B835C();
    byte_1008ECCB8 = 0;
  }